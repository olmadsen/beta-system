% begin macros

/Begin {
17 dict begin % for spline routines
} def

/End {
end
} def

/l
% args: endx endy beginx beginy capstyle linewidth
{
setlinewidth
setlinecap
moveto
lineto
stroke
} def

/r
% args: upperrightx upperrighty width height
{
/h exch def
/w exch def
moveto
w 0 rlineto
0 h neg rlineto
w neg 0 rlineto
closepath
} def

/e
% args: centerx centery radiusx scaley 
{
/s exch def
/rx exch def
1 s scale
s div rx 0 360 arc
} def

/p
% args: centerx centery angle1 angle2 radiusx scaley 
{
/s exch def
/rx exch def
/a2 exch def
/a1 exch def
/cy exch def
/cx exch def
cx cy moveto
1 s scale
cx cy s div rx a1 a2 arc
closepath
fill
} def

/a
% args: centerx centery angle1 angle2 radiusx scaley arcwidth
{
setlinewidth
/s exch def
/rx exch def
/a2 exch def
/a1 exch def
/cy exch def
/cx exch def
1 s scale
cx cy s div rx a1 a2 arc
stroke
} def

/t
% args: string underlineflag position size fontname
{
findfont
exch scalefont setfont
moveto
{
  gsave
  currentpoint 						
  currentfont /FontInfo get /UnderlineThickness get	
  0 exch 						
  currentfont /FontMatrix get dtransform 		
  setlinewidth pop					
  currentfont /FontInfo get /UnderlinePosition get	
  0 exch 						
  currentfont /FontMatrix get dtransform 		
  exch pop add 						
  moveto						
  dup							
  stringwidth 						
  rlineto 
  stroke 
  grestore
} if
show
} def

/m
% args: points numpoints-1 lastpoint joinstyle capstyle linewidth
{
setlinewidth
setlinecap
setlinejoin
moveto
{lineto} repeat
stroke
} def

% The splines used in Bifrost are partly based on the splines used
% in InterViews.
% We have used these ideas in terms of its copyrigth:
% 
% Copyright (c) 1987, 1988, 1989, 1990, 1991 Stanford University
% Copyright (c) 1991 Silicon Graphics, Inc.
% 
% Permission to use, copy, modify, distribute, and sell this software and 
% its documentation for any purpose is hereby granted without fee, provided
% that (i) the above copyright notices and this permission notice appear in
% all copies of the software and related documentation, and (ii) the names of
% Stanford and Silicon Graphics may not be used in any advertising or
% publicity relating to the software without the specific, prior written
% permission of Stanford and Silicon Graphics.
% 
% THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND, 
% EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY 
% WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  
% 
% IN NO EVENT SHALL STANFORD OR SILICON GRAPHICS BE LIABLE FOR
% ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND,
% OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
% WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF 
% LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE 
% OF THIS SOFTWARE.

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/BSpl {
% usage: points npoints BSpl
0 begin
storexyn
n 1 gt {
  0 0 0 0 0 0 1 1 false subspline
  n 2 gt {
    0 0 0 0 1 1 2 2 false subspline
    1 1 n 3 sub {
    /i exch def
    i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
    } for
    n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
  } if
  n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
} if
end
} dup 0 4 dict put def

/CBSpl {
0 begin
dup 2 gt {
  storexyn
  n 1 sub dup 0 0 1 1 2 2 false subspline
  1 1 n 3 sub {
    /i exch def
    i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
  } for
  n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
  n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
} {
% Poly % multiline
} ifelse
end
} dup 0 4 dict put def

% end macros