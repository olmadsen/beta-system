ORIGIN '../Impl/DatatypesImpl';
-- LIB: attributes --

     (* Descriptor for dynamic reference to X points *)

     XPointDesc: (# p: [1] @ Integer; #);


-- PointArrayAttr: Attributes --
     
     ToXPoints:
       (# xpoints: @Xpointdesc;
	  p: @Point;
	  TM: ^Matrix
       enter TM[]
       do npoints -> xpoints.p.extend;
	  (for i:npoints repeat
	       (* transform point using TM *)
	       private.points[i] -> TM.transformPoint -> p;
	       (* Encode x,y as two shorts in one integer *)
	       (@@xpoints.p[i],p.x) -> TOS'%putshort[0]';
	       (@@xpoints.p[i],p.y) -> TOS'%putshort[1]';
	  for);
       exit xpoints[]
       #);
