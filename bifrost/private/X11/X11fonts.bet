ORIGIN 'BifrostX11impl';

-- CanvasImmediateTextBody: descriptor --
(# (* Need to be in this fragmentgroup to see private attributes of 
    * font info
    *)
   width: @integer;
   xf: ^THIS(guienv).private.xfont;
   nam: @FontName;
   sty: @Style;
   siz: @Integer;
do
   (THIS(BifrostCanvas)[], theFontName, theStyle, theSize) 
     -> SetXFont
     -> (xf[], nam, sty, siz);
   
   (xdisplay, 
   implpart.xdrawable, 
   implpart.xgc,
   pos.x,
   pos.y,
   thestring,
   thestring.lgth) -> XDrawString;
   
   (if underline then
       (if xf.fixedwidth then 
           thestring.length*xf.width -> width;
        else
           (xf.fi, thestring.t, thestring.t.range) -> XTextWidth -> width;
       if);
       
       (xdisplay,
       implpart.xdrawable, 
       implpart.xgc,
       pos.x,
       pos.y + xf.upos,
       width,
       xf.uthick)
         -> XFillRectangle;
   if);
#)

-- SetXFontBody: descriptor --
(# 
do siz -> theCanvas.ZoomDim -> siz;
   
   (nam,sty,siz) -> XCheckFontLoaded -> (xf[],nam,sty,siz);
   
   (* Set font in GC *)
   (xdisplay, theCanvas.implpart.xgc, xf.XfontId) -> XSetFont;
   
   (* Temporarily store the current font in privatePart of theCanvas *)
   xf[] -> theCanvas.implpart.currentxfont[];
   
#)

-- BifrostAttributes: attributes -- 
initBifrostFonts: 
  (# d: @Text;
     stylepattern: @THIS(guienv).private.fonts.stylearray;
     sizepattern:  @THIS(guienv).private.fonts.sizearray;
  do 
     (if debugGraphic then 'InitFonts ... ' -> puttext if);
     (for nam: THIS(guienv).private.fonts.xfonts.range repeat
          &THIS(guienv).private.fonts.stylearray[] 
            -> THIS(guienv).private.fonts.xfonts[nam][];
          
          (for sty: stylepattern.style.range repeat
               &THIS(guienv).private.fonts.sizearray[] 
                 -> THIS(guienv).private.fonts.xfonts[nam].style[sty][];
               
               (for siz: sizepattern.size.range repeat
                    &THIS(guienv).private.xfont[] 
                      -> THIS(guienv).private.fonts.xfonts[nam].style[sty].size[siz][];
                    false ->
                    THIS(guienv).private.fonts.xfonts[nam].style[sty].size[siz].loaded;
                    
               for);
          for);
     for);
     
     InitXFontNames;
     '8x13' -> THIS(guienv).private.fonts.defaultfont.name;
     THIS(guienv).private.fonts.defaultfont[] -> XLoadFontFromName;
     (if debugGraphic then 'done' -> putline if);
  #);

XCheckFontLoaded:
  (# nam, orignam: @FontName;
     sty, origsty: @Style;
     siz, origsiz: @integer;
     legalsiz, legalnam, legalsty, subst: @boolean;
     xf: ^THIS(guienv).private.xfont;
     
  enter (nam,sty,siz)
  do
     (if debugGraphic then 
         'XCheckFontLoaded: Name style size ' -> puttext;
         nam -> screen.putint(# format::<(#do 6->width#)#);
         sty -> screen.putint(# format::<(#do 6->width#)#);
         siz -> screen.putint(# format::<(#do 6->width#)#); newline
     if);
     siz -> origsiz;
     nam -> orignam;
     sty -> origsty;
     false -> subst;
     
     (* range checks *)
     true -> legalsiz -> legalnam -> legalsty;
     (if ((nam<1) or (nam>THIS(guienv).private.fonts.xfonts.range)) then
         (* no such fontname *)
         true -> subst;
         Courier -> nam;
         false -> legalnam;
     if);
     (if ((sty<1) or (sty>THIS(guienv).private.fonts.xfonts[nam].style.range)) then
         true -> subst;
         Plain -> nam;
         false -> legalsty;
     if);
     (if (siz<1) then 
         true -> subst;
         1->siz; 
         false -> legalsiz;
     if);
     (if siz>THIS(guienv).private.fonts.xfonts[nam].style[sty].size.range then
         true -> subst;
         THIS(guienv).private.fonts.xfonts[nam].style[sty].size.range
           -> siz;
         false -> legalsiz;
     if);
     
     findfont:
       (# 
       do THIS(guienv).private.fonts.xfonts[nam].style[sty].size[siz][]->xf[];
          (* check that it is loaded, and if not, do it *)
          (if not xf.loaded then
              (if xf.name.empty then
       	          true -> subst;
                  (if siz>1 then
                      siz-1->siz;
                      restart findfont;
                  if);
       	          THIS(guienv).private.fonts.xfonts[nam].style[sty].size[siz][]
                    -> xf[];
              if);
              xf[] -> XLoadFontFromName;
          if)
       #);
     
     (if subst then
         (if displaywarnings then
             'Sorry, the X server has no font corresponding to '->puttext;
             (if orignam
              // Helvetica then 'Helvetica-' -> puttext;
              // Times then 'Times-' -> puttext;
              // Courier then 'Courier-' -> puttext;
              else 
                 '<' -> put; orignam->putint; '>' -> put;
             if);
             (if origsty
              // Plain then 'Plain-' -> puttext;
              // Bold then 'Bold-' -> puttext;
              // Italic then 'Courier-' -> puttext;
                 else 
                 '<' -> put; origsty->putint; '>' -> put;
             if);
             origsiz -> putint; newline;
         if);
     if);
     
     (if not xf.loaded then
         (if displaywarnings then
             'Sorry, the X server has no font matching \''->puttext;
             xf.name[] -> puttext;
             '\''->put; newline;
         if);
         true -> subst;
         THIS(guienv).private.fonts.defaultFont[] -> xf[];
     if);
         
     (if subst then
         (if displaywarnings then 
             'Substituting with font: \'' -> puttext;
             xf.name[] -> puttext;
             '\''->put; newline;
         if);
         (if legalnam and legalsty and legalsiz then
             (* cache it to avoid work on next call of XCheckFontLoaded *)
             true ->
             THIS(guienv).private.fonts.xfonts[orignam]
             .style[origsty].size[origsiz].loaded;
             xf[] -> THIS(guienv).private.fonts.xfonts[orignam]
             .style[origsty].size[origsiz][];
         if)
     if);
         
     (if debugGraphic then
         'Font to be used: ' -> puttext;
         xf.name[] -> puttext;
         xf.xfontid 
           -> screen.putint(# format::<(#do 10->width#)#); newline
     if);
     
  exit (xf[], nam, sty, siz)
  #);


XLoadFontFromName:
  (# xf: ^THIS(guienv).private.xfont;
  enter xf[]
  do
     (if ((xdisplay, xf.name) -> XLoadQueryFont -> xf.fi)
      //0 then
         (* font does not exist *)
         false -> xf.loaded;
         false -> xf.fixedWidth;
         -1-> xf.height
           -> xf.width
           -> xf.baseLine
           -> xf.firstCharInFont
           -> xf.lastCharInFont;
      else
         xf.fi.id
           -> xf.XFontId;
         
         (xf.fi.maxBounds.width =
         xf.fi.minBounds.width)
           -> xf.fixedWidth;
         xf.fi.maxBounds.width
           -> xf.width;
         xf.fi.maxBounds.ascent 
         + xf.fi.maxBounds.descent
           -> xf.height;
         xf.fi.ascent
           -> xf.baseLine;
         xf.fi.minCharOrByte2
           -> xf.firstCharInFont;
         xf.fi.maxCharOrByte2
           -> xf.lastCharInFont;
         
         true -> xf.loaded;
         xf.fi.maxbounds.descent -> xf.maxdescent;
         xf.fi.maxbounds.ascent -> xf.maxascent;
     if);
  #);


InitXFontNames:
  (# revision: @Integer;
     t: @text;
  do
     xdisplay -> XVendorRelease -> revision;
     (*(if revision >= 1000 then revision div 1000 -> revision if);*)
     (if revision
      // 0 // 1 // 2 then (* X11, X11.1, X11.2 *)
         &InitX11r0;
      else (* X11.{3,4,...}: Using adobe fonts *)
         &InitX11r3
     if);
  #);


InitX11r0:
  (#
  do (if displaywarnings then
         (NONE, 
         'X Font Initialization: X11 servers prior to X11R3 not supported',
         'Unsupported X version') -> AlertUser;
     if);
  #);

InitX11r3:
  (# init: @initname;
     InitTimes:
       (# 
       do ('-adobe-times-medium-r-normal-*-2-*-*-*-*-*-*-*',
          Times, Plain,  1) -> init;
          ('-adobe-times-bold-r-normal-*-2-*-*-*-*-*-*-*',
          Times, Bold,   1) -> init;
          ('-adobe-times-medium-i-normal-*-2-*-*-*-*-*-*-*',
          Times, Italic, 1) -> init;
          
          ('-adobe-times-medium-r-normal-*-2-*-*-*-*-*-*-*',
          Times, Plain,  2) -> init;
          ('-adobe-times-bold-r-normal-*-2-*-*-*-*-*-*-*',
          Times, Bold,   2) -> init;
          ('-adobe-times-medium-i-normal-*-2-*-*-*-*-*-*-*',
          Times, Italic, 2) -> init;
          
          ('-adobe-times-medium-r-normal-*-6-*-*-*-*-*-*-*',
          Times, Plain,  6) -> init;
          ('-adobe-times-bold-r-normal-*-6-*-*-*-*-*-*-*',
          Times, Bold,   6) -> init;
          ('-adobe-times-medium-i-normal-*-6-*-*-*-*-*-*-*',
          Times, Italic, 6) -> init;
          
          ('-adobe-times-medium-r-normal-*-7-*-*-*-*-*-*-*',
          Times, Plain,  7) -> init;
          ('-adobe-times-bold-r-normal-*-7-*-*-*-*-*-*-*',
          Times, Bold,   7) -> init;
          ('-adobe-times-medium-i-normal-*-7-*-*-*-*-*-*-*',
          Times, Italic, 7) -> init;
          
          ('-adobe-times-medium-r-normal-*-8-*-*-*-*-*-*-*',
          Times, Plain,  8) -> init;
          ('-adobe-times-bold-r-normal-*-8-*-*-*-*-*-*-*',
          Times, Bold,   8) -> init;
          ('-adobe-times-medium-i-normal-*-8-*-*-*-*-*-*-*',
          Times, Italic, 8) -> init;
          
          ('-adobe-times-medium-r-normal-*-9-*-*-*-*-*-*-*',
          Times, Plain,  9) -> init;
          ('-adobe-times-bold-r-normal-*-9-*-*-*-*-*-*-*',
          Times, Bold,   9) -> init;
          ('-adobe-times-medium-i-normal-*-9-*-*-*-*-*-*-*',
          Times, Italic, 9) -> init;
          
          ('-adobe-times-medium-r-normal-*-10-*-*-*-*-*-*-*',
          Times, Plain,  10) -> init;
          ('-adobe-times-bold-r-normal-*-10-*-*-*-*-*-*-*',
          Times, Bold,   10) -> init;
          ('-adobe-times-medium-i-normal-*-10-*-*-*-*-*-*-*',
          Times, Italic, 10) -> init;
          
          ('-adobe-times-medium-r-normal-*-11-*-*-*-*-*-*-*',
          Times, Plain,  11) -> init;
          ('-adobe-times-bold-r-normal-*-11-*-*-*-*-*-*-*',
          Times, Bold,   11) -> init;
          ('-adobe-times-medium-i-normal-*-11-*-*-*-*-*-*-*',
          Times, Italic, 11) -> init;
          
          ('-adobe-times-medium-r-normal-*-12-*-*-*-*-*-*-*',
          Times, Plain,  12) -> init;
          ('-adobe-times-bold-r-normal-*-12-*-*-*-*-*-*-*',
          Times, Bold,   12) -> init;
          ('-adobe-times-medium-i-normal-*-12-*-*-*-*-*-*-*',
          Times, Italic, 12) -> init;
          
          ('-adobe-times-medium-r-normal-*-13-*-*-*-*-*-*-*',
          Times, Plain,  13) -> init;
          ('-adobe-times-bold-r-normal-*-13-*-*-*-*-*-*-*',
          Times, Bold,   13) -> init;
          ('-adobe-times-medium-i-normal-*-13-*-*-*-*-*-*-*',
          Times, Italic, 13) -> init;
          
          ('-adobe-times-medium-r-normal-*-14-*-*-*-*-*-*-*',
          Times, Plain,  14) -> init;
          ('-adobe-times-bold-r-normal-*-14-*-*-*-*-*-*-*',
          Times, Bold,   14) -> init;
          ('-adobe-times-medium-i-normal-*-14-*-*-*-*-*-*-*',
          Times, Italic, 14) -> init;
          
          ('-adobe-times-medium-r-normal-*-15-*-*-*-*-*-*-*',
          Times, Plain,  15) -> init;
          ('-adobe-times-bold-r-normal-*-15-*-*-*-*-*-*-*',
          Times, Bold,   15) -> init;
          ('-adobe-times-medium-i-normal-*-15-*-*-*-*-*-*-*',
          Times, Italic, 15) -> init;
          
          ('-adobe-times-medium-r-normal-*-16-*-*-*-*-*-*-*',
          Times, Plain,  16) -> init;
          ('-adobe-times-bold-r-normal-*-16-*-*-*-*-*-*-*',
          Times, Bold,   16) -> init;
          ('-adobe-times-medium-i-normal-*-16-*-*-*-*-*-*-*',
          Times, Italic, 16) -> init;
          
          ('-adobe-times-medium-r-normal-*-17-*-*-*-*-*-*-*',
          Times, Plain,  17) -> init;
          ('-adobe-times-bold-r-normal-*-17-*-*-*-*-*-*-*',
          Times, Bold,   17) -> init;
          ('-adobe-times-medium-i-normal-*-17-*-*-*-*-*-*-*',
          Times, Italic, 17) -> init;
          
          ('-adobe-times-medium-r-normal-*-18-*-*-*-*-*-*-*',
          Times, Plain,  18) -> init;
          ('-adobe-times-bold-r-normal-*-18-*-*-*-*-*-*-*',
          Times, Bold,   18) -> init;
          ('-adobe-times-medium-i-normal-*-18-*-*-*-*-*-*-*',
          Times, Italic, 18) -> init;
          
          ('-adobe-times-medium-r-normal-*-19-*-*-*-*-*-*-*',
          Times, Plain,  19) -> init;
          ('-adobe-times-bold-r-normal-*-19-*-*-*-*-*-*-*',
          Times, Bold,   19) -> init;
          ('-adobe-times-medium-i-normal-*-19-*-*-*-*-*-*-*',
          Times, Italic, 19) -> init;
          
          ('-adobe-times-medium-r-normal-*-20-*-*-*-*-*-*-*',
          Times, Plain,  20) -> init;
          ('-adobe-times-bold-r-normal-*-20-*-*-*-*-*-*-*',
          Times, Bold,   20) -> init;
          ('-adobe-times-medium-i-normal-*-20-*-*-*-*-*-*-*',
          Times, Italic, 20) -> init;
          
          ('-adobe-times-medium-r-normal-*-24-*-*-*-*-*-*-*',
          Times, Plain,  24) -> init;
          ('-adobe-times-bold-r-normal-*-24-*-*-*-*-*-*-*',
          Times, Bold,   24) -> init;
          ('-adobe-times-medium-i-normal-*-24-*-*-*-*-*-*-*',
          Times, Italic, 24) -> init;
          
          ('-adobe-times-medium-r-normal-*-25-*-*-*-*-*-*-*',
          Times, Plain,  25) -> init;
          ('-adobe-times-bold-r-normal-*-25-*-*-*-*-*-*-*',
          Times, Bold,   25) -> init;
          ('-adobe-times-medium-i-normal-*-25-*-*-*-*-*-*-*',
          Times, Italic, 25) -> init;
          
          ('-adobe-times-medium-r-normal-*-26-*-*-*-*-*-*-*',
          Times, Plain,  26) -> init;
          ('-adobe-times-bold-r-normal-*-26-*-*-*-*-*-*-*',
          Times, Bold,   26) -> init;
          ('-adobe-times-medium-i-normal-*-26-*-*-*-*-*-*-*',
          Times, Italic, 26) -> init;
          
          ('-adobe-times-medium-r-normal-*-30-*-*-*-*-*-*-*',
          Times, Plain,  30) -> init;
          ('-adobe-times-bold-r-normal-*-30-*-*-*-*-*-*-*',
          Times, Bold,   30) -> init;
          ('-adobe-times-medium-i-normal-*-30-*-*-*-*-*-*-*',
          Times, Italic, 30) -> init;
          
          ('-adobe-times-medium-r-normal-*-33-*-*-*-*-*-*-*',
          Times, Plain,  33) -> init;
          ('-adobe-times-bold-r-normal-*-33-*-*-*-*-*-*-*',
          Times, Bold,   33) -> init;
          ('-adobe-times-medium-i-normal-*-33-*-*-*-*-*-*-*',
          Times, Italic, 33) -> init;
          
          ('-adobe-times-medium-r-normal-*-34-*-*-*-*-*-*-*',
          Times, Plain,  34) -> init;
          ('-adobe-times-bold-r-normal-*-34-*-*-*-*-*-*-*',
          Times, Bold,   34) -> init;
          ('-adobe-times-medium-i-normal-*-34-*-*-*-*-*-*-*',
          Times, Italic, 34) -> init;
          
          ('-adobe-times-medium-r-normal-*-40-*-*-*-*-*-*-*',
          Times, Plain,  40) -> init;
          ('-adobe-times-bold-r-normal-*-40-*-*-*-*-*-*-*',
          Times, Bold,   40) -> init;
          ('-adobe-times-medium-i-normal-*-40-*-*-*-*-*-*-*',
          Times, Italic, 40) -> init;
          
          ('-adobe-times-medium-r-normal-*-50-*-*-*-*-*-*-*',
          Times, Plain,  50) -> init;
          ('-adobe-times-bold-r-normal-*-50-*-*-*-*-*-*-*',
          Times, Bold,   50) -> init;
          ('-adobe-times-medium-i-normal-*-50-*-*-*-*-*-*-*',
          Times, Italic, 50) -> init;
          
          ('-adobe-times-medium-r-normal-*-60-*-*-*-*-*-*-*',
          Times, Plain,  60) -> init;
          ('-adobe-times-bold-r-normal-*-60-*-*-*-*-*-*-*',
          Times, Bold,   60) -> init;
          ('-adobe-times-medium-i-normal-*-60-*-*-*-*-*-*-*',
          Times, Italic, 60) -> init;
       #);
     InitCourier:
       (# 
       do ('-adobe-courier-medium-r-normal-*-2-*-*-*-*-*-*-*',
          Courier, Plain,  1) -> init;
          ('-adobe-courier-bold-r-normal-*-2-*-*-*-*-*-*-*',
          Courier, Bold,   1) -> init;
          ('-adobe-courier-medium-i-normal-*-2-*-*-*-*-*-*-*',
          Courier, Italic, 1) -> init;
          
          ('-adobe-courier-medium-r-normal-*-2-*-*-*-*-*-*-*',
          Courier, Plain,  2) -> init;
          ('-adobe-courier-bold-r-normal-*-2-*-*-*-*-*-*-*',
          Courier, Bold,   2) -> init;
          ('-adobe-courier-medium-i-normal-*-2-*-*-*-*-*-*-*',
          Courier, Italic, 2) -> init;
          
          ('-adobe-courier-medium-r-normal-*-6-*-*-*-*-*-*-*',
          Courier, Plain,  6) -> init;
          ('-adobe-courier-bold-r-normal-*-6-*-*-*-*-*-*-*',
          Courier, Bold,   6) -> init;
          ('-adobe-courier-medium-i-normal-*-6-*-*-*-*-*-*-*',
          Courier, Italic, 6) -> init;
          
          ('-adobe-courier-medium-r-normal-*-7-*-*-*-*-*-*-*',
          Courier, Plain,  7) -> init;
          ('-adobe-courier-bold-r-normal-*-7-*-*-*-*-*-*-*',
          Courier, Bold,   7) -> init;
          ('-adobe-courier-medium-i-normal-*-7-*-*-*-*-*-*-*',
          Courier, Italic, 7) -> init;
          
          ('-adobe-courier-medium-r-normal-*-8-*-*-*-*-*-*-*',
          Courier, Plain,  8) -> init;
          ('-adobe-courier-bold-r-normal-*-8-*-*-*-*-*-*-*',
          Courier, Bold,   8) -> init;
          ('-adobe-courier-medium-i-normal-*-8-*-*-*-*-*-*-*',
          Courier, Italic, 8) -> init;
          
          ('-adobe-courier-medium-r-normal-*-9-*-*-*-*-*-*-*',
          Courier, Plain,  9) -> init;
          ('-adobe-courier-bold-r-normal-*-9-*-*-*-*-*-*-*',
          Courier, Bold,   9) -> init;
          ('-adobe-courier-medium-i-normal-*-9-*-*-*-*-*-*-*',
          Courier, Italic, 9) -> init;
          
          ('-adobe-courier-medium-r-normal-*-10-*-*-*-*-*-*-*',
          Courier, Plain,  10) -> init;
          ('-adobe-courier-bold-r-normal-*-10-*-*-*-*-*-*-*',
          Courier, Bold,   10) -> init;
          ('-adobe-courier-medium-i-normal-*-10-*-*-*-*-*-*-*',
          Courier, Italic, 10) -> init;
          
          ('-adobe-courier-medium-r-normal-*-11-*-*-*-*-*-*-*',
          Courier, Plain,  11) -> init;
          ('-adobe-courier-bold-r-normal-*-11-*-*-*-*-*-*-*',
          Courier, Bold,   11) -> init;
          ('-adobe-courier-medium-i-normal-*-11-*-*-*-*-*-*-*',
          Courier, Italic, 11) -> init;
          
          ('-adobe-courier-medium-r-normal-*-12-*-*-*-*-*-*-*',
          Courier, Plain,  12) -> init;
          ('-adobe-courier-bold-r-normal-*-12-*-*-*-*-*-*-*',
          Courier, Bold,   12) -> init;
          ('-adobe-courier-medium-i-normal-*-12-*-*-*-*-*-*-*',
          Courier, Italic, 12) -> init;
          
          ('-adobe-courier-medium-r-normal-*-13-*-*-*-*-*-*-*',
          Courier, Plain,  13) -> init;
          ('-adobe-courier-bold-r-normal-*-13-*-*-*-*-*-*-*',
          Courier, Bold,   13) -> init;
          ('-adobe-courier-medium-i-normal-*-13-*-*-*-*-*-*-*',
          Courier, Italic, 13) -> init;
          
          ('-adobe-courier-medium-r-normal-*-14-*-*-*-*-*-*-*',
          Courier, Plain,  14) -> init;
          ('-adobe-courier-bold-r-normal-*-14-*-*-*-*-*-*-*',
          Courier, Bold,   14) -> init;
          ('-adobe-courier-medium-i-normal-*-14-*-*-*-*-*-*-*',
          Courier, Italic, 14) -> init;
          
          ('-adobe-courier-medium-r-normal-*-15-*-*-*-*-*-*-*',
          Courier, Plain,  15) -> init;
          ('-adobe-courier-bold-r-normal-*-15-*-*-*-*-*-*-*',
          Courier, Bold,   15) -> init;
          ('-adobe-courier-medium-i-normal-*-15-*-*-*-*-*-*-*',
          Courier, Italic, 15) -> init;
          
          ('-adobe-courier-medium-r-normal-*-16-*-*-*-*-*-*-*',
          Courier, Plain,  16) -> init;
          ('-adobe-courier-bold-r-normal-*-16-*-*-*-*-*-*-*',
          Courier, Bold,   16) -> init;
          ('-adobe-courier-medium-i-normal-*-16-*-*-*-*-*-*-*',
          Courier, Italic, 16) -> init;
          
          ('-adobe-courier-medium-r-normal-*-17-*-*-*-*-*-*-*',
          Courier, Plain,  17) -> init;
          ('-adobe-courier-bold-r-normal-*-17-*-*-*-*-*-*-*',
          Courier, Bold,   17) -> init;
          ('-adobe-courier-medium-i-normal-*-17-*-*-*-*-*-*-*',
          Courier, Italic, 17) -> init;
          
          ('-adobe-courier-medium-r-normal-*-18-*-*-*-*-*-*-*',
          Courier, Plain,  18) -> init;
          ('-adobe-courier-bold-r-normal-*-18-*-*-*-*-*-*-*',
          Courier, Bold,   18) -> init;
          ('-adobe-courier-medium-i-normal-*-18-*-*-*-*-*-*-*',
          Courier, Italic, 18) -> init;
          
          ('-adobe-courier-medium-r-normal-*-19-*-*-*-*-*-*-*',
          Courier, Plain,  19) -> init;
          ('-adobe-courier-bold-r-normal-*-19-*-*-*-*-*-*-*',
          Courier, Bold,   19) -> init;
          ('-adobe-courier-medium-i-normal-*-19-*-*-*-*-*-*-*',
          Courier, Italic, 19) -> init;
          
          ('-adobe-courier-medium-r-normal-*-20-*-*-*-*-*-*-*',
          Courier, Plain,  20) -> init;
          ('-adobe-courier-bold-r-normal-*-20-*-*-*-*-*-*-*',
          Courier, Bold,   20) -> init;
          ('-adobe-courier-medium-i-normal-*-20-*-*-*-*-*-*-*',
          Courier, Italic, 20) -> init;
          
          ('-adobe-courier-medium-r-normal-*-24-*-*-*-*-*-*-*',
          Courier, Plain,  24) -> init;
          ('-adobe-courier-bold-r-normal-*-24-*-*-*-*-*-*-*',
          Courier, Bold,   24) -> init;
          ('-adobe-courier-medium-i-normal-*-24-*-*-*-*-*-*-*',
          Courier, Italic, 24) -> init;
          
          ('-adobe-courier-medium-r-normal-*-25-*-*-*-*-*-*-*',
          Courier, Plain,  25) -> init;
          ('-adobe-courier-bold-r-normal-*-25-*-*-*-*-*-*-*',
          Courier, Bold,   25) -> init;
          ('-adobe-courier-medium-i-normal-*-25-*-*-*-*-*-*-*',
          Courier, Italic, 25) -> init;
          
          ('-adobe-courier-medium-r-normal-*-26-*-*-*-*-*-*-*',
          Courier, Plain,  26) -> init;
          ('-adobe-courier-bold-r-normal-*-26-*-*-*-*-*-*-*',
          Courier, Bold,   26) -> init;
          ('-adobe-courier-medium-i-normal-*-26-*-*-*-*-*-*-*',
          Courier, Italic, 26) -> init;
          
          ('-adobe-courier-medium-r-normal-*-30-*-*-*-*-*-*-*',
          Courier, Plain,  30) -> init;
          ('-adobe-courier-bold-r-normal-*-30-*-*-*-*-*-*-*',
          Courier, Bold,   30) -> init;
          ('-adobe-courier-medium-i-normal-*-30-*-*-*-*-*-*-*',
          Courier, Italic, 30) -> init;
          
          ('-adobe-courier-medium-r-normal-*-33-*-*-*-*-*-*-*',
          Courier, Plain,  33) -> init;
          ('-adobe-courier-bold-r-normal-*-33-*-*-*-*-*-*-*',
          Courier, Bold,   33) -> init;
          ('-adobe-courier-medium-i-normal-*-33-*-*-*-*-*-*-*',
          Courier, Italic, 33) -> init;
          
          ('-adobe-courier-medium-r-normal-*-34-*-*-*-*-*-*-*',
          Courier, Plain,  34) -> init;
          ('-adobe-courier-bold-r-normal-*-34-*-*-*-*-*-*-*',
          Courier, Bold,   34) -> init;
          ('-adobe-courier-medium-i-normal-*-34-*-*-*-*-*-*-*',
          Courier, Italic, 34) -> init;
          
          ('-adobe-courier-medium-r-normal-*-40-*-*-*-*-*-*-*',
          Courier, Plain,  40) -> init;
          ('-adobe-courier-bold-r-normal-*-40-*-*-*-*-*-*-*',
          Courier, Bold,   40) -> init;
          ('-adobe-courier-medium-i-normal-*-40-*-*-*-*-*-*-*',
          Courier, Italic, 40) -> init;
          
          ('-adobe-courier-medium-r-normal-*-50-*-*-*-*-*-*-*',
          Courier, Plain,  50) -> init;
          ('-adobe-courier-bold-r-normal-*-50-*-*-*-*-*-*-*',
          Courier, Bold,   50) -> init;
          ('-adobe-courier-medium-i-normal-*-50-*-*-*-*-*-*-*',
          Courier, Italic, 50) -> init;
          
          ('-adobe-courier-medium-r-normal-*-60-*-*-*-*-*-*-*',
          Courier, Plain,  60) -> init;
          ('-adobe-courier-bold-r-normal-*-60-*-*-*-*-*-*-*',
          Courier, Bold,   60) -> init;
          ('-adobe-courier-medium-i-normal-*-60-*-*-*-*-*-*-*',
          Courier, Italic, 60) -> init;
       #);
     InitHelvetica:
       (# 
       do ('-adobe-helvetica-medium-r-normal-*-2-*-*-*-*-*-*-*',
          Helvetica, Plain,  1) -> init;
          ('-adobe-helvetica-bold-r-normal-*-2-*-*-*-*-*-*-*',
          Helvetica, Bold,   1) -> init;
          ('-adobe-helvetica-medium-i-normal-*-2-*-*-*-*-*-*-*',
          Helvetica, Italic, 1) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-2-*-*-*-*-*-*-*',
          Helvetica, Plain,  2) -> init;
          ('-adobe-helvetica-bold-r-normal-*-2-*-*-*-*-*-*-*',
          Helvetica, Bold,   2) -> init;
          ('-adobe-helvetica-medium-i-normal-*-2-*-*-*-*-*-*-*',
          Helvetica, Italic, 2) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-6-*-*-*-*-*-*-*',
          Helvetica, Plain,  6) -> init;
          ('-adobe-helvetica-bold-r-normal-*-6-*-*-*-*-*-*-*',
          Helvetica, Bold,   6) -> init;
          ('-adobe-helvetica-medium-i-normal-*-6-*-*-*-*-*-*-*',
          Helvetica, Italic, 6) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-7-*-*-*-*-*-*-*',
          Helvetica, Plain,  7) -> init;
          ('-adobe-helvetica-bold-r-normal-*-7-*-*-*-*-*-*-*',
          Helvetica, Bold,   7) -> init;
          ('-adobe-helvetica-medium-i-normal-*-7-*-*-*-*-*-*-*',
          Helvetica, Italic, 7) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-8-*-*-*-*-*-*-*',
          Helvetica, Plain,  8) -> init;
          ('-adobe-helvetica-bold-r-normal-*-8-*-*-*-*-*-*-*',
          Helvetica, Bold,   8) -> init;
          ('-adobe-helvetica-medium-i-normal-*-8-*-*-*-*-*-*-*',
          Helvetica, Italic, 8) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-9-*-*-*-*-*-*-*',
          Helvetica, Plain,  9) -> init;
          ('-adobe-helvetica-bold-r-normal-*-9-*-*-*-*-*-*-*',
          Helvetica, Bold,   9) -> init;
          ('-adobe-helvetica-medium-i-normal-*-9-*-*-*-*-*-*-*',
          Helvetica, Italic, 9) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-10-*-*-*-*-*-*-*',
          Helvetica, Plain,  10) -> init;
          ('-adobe-helvetica-bold-r-normal-*-10-*-*-*-*-*-*-*',
          Helvetica, Bold,   10) -> init;
          ('-adobe-helvetica-medium-i-normal-*-10-*-*-*-*-*-*-*',
          Helvetica, Italic, 10) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-11-*-*-*-*-*-*-*',
          Helvetica, Plain,  11) -> init;
          ('-adobe-helvetica-bold-r-normal-*-11-*-*-*-*-*-*-*',
          Helvetica, Bold,   11) -> init;
          ('-adobe-helvetica-medium-i-normal-*-11-*-*-*-*-*-*-*',
          Helvetica, Italic, 11) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-12-*-*-*-*-*-*-*',
          Helvetica, Plain,  12) -> init;
          ('-adobe-helvetica-bold-r-normal-*-12-*-*-*-*-*-*-*',
          Helvetica, Bold,   12) -> init;
          ('-adobe-helvetica-medium-i-normal-*-12-*-*-*-*-*-*-*',
          Helvetica, Italic, 12) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-13-*-*-*-*-*-*-*',
          Helvetica, Plain,  13) -> init;
          ('-adobe-helvetica-bold-r-normal-*-13-*-*-*-*-*-*-*',
          Helvetica, Bold,   13) -> init;
          ('-adobe-helvetica-medium-i-normal-*-13-*-*-*-*-*-*-*',
          Helvetica, Italic, 13) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-14-*-*-*-*-*-*-*',
          Helvetica, Plain,  14) -> init;
          ('-adobe-helvetica-bold-r-normal-*-14-*-*-*-*-*-*-*',
          Helvetica, Bold,   14) -> init;
          ('-adobe-helvetica-medium-i-normal-*-14-*-*-*-*-*-*-*',
          Helvetica, Italic, 14) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-15-*-*-*-*-*-*-*',
          Helvetica, Plain,  15) -> init;
          ('-adobe-helvetica-bold-r-normal-*-15-*-*-*-*-*-*-*',
          Helvetica, Bold,   15) -> init;
          ('-adobe-helvetica-medium-i-normal-*-15-*-*-*-*-*-*-*',
          Helvetica, Italic, 15) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-16-*-*-*-*-*-*-*',
          Helvetica, Plain,  16) -> init;
          ('-adobe-helvetica-bold-r-normal-*-16-*-*-*-*-*-*-*',
          Helvetica, Bold,   16) -> init;
          ('-adobe-helvetica-medium-i-normal-*-16-*-*-*-*-*-*-*',
          Helvetica, Italic, 16) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-17-*-*-*-*-*-*-*',
          Helvetica, Plain,  17) -> init;
          ('-adobe-helvetica-bold-r-normal-*-17-*-*-*-*-*-*-*',
          Helvetica, Bold,   17) -> init;
          ('-adobe-helvetica-medium-i-normal-*-17-*-*-*-*-*-*-*',
          Helvetica, Italic, 17) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-18-*-*-*-*-*-*-*',
          Helvetica, Plain,  18) -> init;
          ('-adobe-helvetica-bold-r-normal-*-18-*-*-*-*-*-*-*',
          Helvetica, Bold,   18) -> init;
          ('-adobe-helvetica-medium-i-normal-*-18-*-*-*-*-*-*-*',
          Helvetica, Italic, 18) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-19-*-*-*-*-*-*-*',
          Helvetica, Plain,  19) -> init;
          ('-adobe-helvetica-bold-r-normal-*-19-*-*-*-*-*-*-*',
          Helvetica, Bold,   19) -> init;
          ('-adobe-helvetica-medium-i-normal-*-19-*-*-*-*-*-*-*',
          Helvetica, Italic, 19) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-20-*-*-*-*-*-*-*',
          Helvetica, Plain,  20) -> init;
          ('-adobe-helvetica-bold-r-normal-*-20-*-*-*-*-*-*-*',
          Helvetica, Bold,   20) -> init;
          ('-adobe-helvetica-medium-i-normal-*-20-*-*-*-*-*-*-*',
          Helvetica, Italic, 20) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-24-*-*-*-*-*-*-*',
          Helvetica, Plain,  24) -> init;
          ('-adobe-helvetica-bold-r-normal-*-24-*-*-*-*-*-*-*',
          Helvetica, Bold,   24) -> init;
          ('-adobe-helvetica-medium-i-normal-*-24-*-*-*-*-*-*-*',
          Helvetica, Italic, 24) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-25-*-*-*-*-*-*-*',
          Helvetica, Plain,  25) -> init;
          ('-adobe-helvetica-bold-r-normal-*-25-*-*-*-*-*-*-*',
          Helvetica, Bold,   25) -> init;
          ('-adobe-helvetica-medium-i-normal-*-25-*-*-*-*-*-*-*',
          Helvetica, Italic, 25) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-26-*-*-*-*-*-*-*',
          Helvetica, Plain,  26) -> init;
          ('-adobe-helvetica-bold-r-normal-*-26-*-*-*-*-*-*-*',
          Helvetica, Bold,   26) -> init;
          ('-adobe-helvetica-medium-i-normal-*-26-*-*-*-*-*-*-*',
          Helvetica, Italic, 26) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-30-*-*-*-*-*-*-*',
          Helvetica, Plain,  30) -> init;
          ('-adobe-helvetica-bold-r-normal-*-30-*-*-*-*-*-*-*',
          Helvetica, Bold,   30) -> init;
          ('-adobe-helvetica-medium-i-normal-*-30-*-*-*-*-*-*-*',
          Helvetica, Italic, 30) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-33-*-*-*-*-*-*-*',
          Helvetica, Plain,  33) -> init;
          ('-adobe-helvetica-bold-r-normal-*-33-*-*-*-*-*-*-*',
          Helvetica, Bold,   33) -> init;
          ('-adobe-helvetica-medium-i-normal-*-33-*-*-*-*-*-*-*',
          Helvetica, Italic, 33) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-34-*-*-*-*-*-*-*',
          Helvetica, Plain,  34) -> init;
          ('-adobe-helvetica-bold-r-normal-*-34-*-*-*-*-*-*-*',
          Helvetica, Bold,   34) -> init;
          ('-adobe-helvetica-medium-i-normal-*-34-*-*-*-*-*-*-*',
          Helvetica, Italic, 34) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-40-*-*-*-*-*-*-*',
          Helvetica, Plain,  40) -> init;
          ('-adobe-helvetica-bold-r-normal-*-40-*-*-*-*-*-*-*',
          Helvetica, Bold,   40) -> init;
          ('-adobe-helvetica-medium-i-normal-*-40-*-*-*-*-*-*-*',
          Helvetica, Italic, 40) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-50-*-*-*-*-*-*-*',
          Helvetica, Plain,  50) -> init;
          ('-adobe-helvetica-bold-r-normal-*-50-*-*-*-*-*-*-*',
          Helvetica, Bold,   50) -> init;
          ('-adobe-helvetica-medium-i-normal-*-50-*-*-*-*-*-*-*',
          Helvetica, Italic, 50) -> init;
          
          ('-adobe-helvetica-medium-r-normal-*-60-*-*-*-*-*-*-*',
          Helvetica, Plain,  60) -> init;
          ('-adobe-helvetica-bold-r-normal-*-60-*-*-*-*-*-*-*',
          Helvetica, Bold,   60) -> init;
          ('-adobe-helvetica-medium-i-normal-*-60-*-*-*-*-*-*-*',
          Helvetica, Italic, 60) -> init;
       #);
  do InitTimes;
     InitCourier;
     InitHelvetica;
  #); 


InitName:
  (# xname: @Text;
     nam: @FontName;
     sty: @Style;
     siz: @Integer;
  enter (xname, nam, sty, siz)
  do
     xname -> THIS(guienv).private.fonts.xfonts[nam].style[sty].size[siz].name;
  #);
