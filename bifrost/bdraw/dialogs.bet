ORIGIN 'bdrawenv';
INCLUDE '~beta/guienv/v1.2/stddialogs';
INCLUDE '~beta/guienv/v1.2/fields';

-- Dialogs: descriptor -- 
(#
   ReadText: window
     (# 
        ok:< 
          (# t: ^text;
          do thetext.contents->t[];
             INNER;
          #);
        cancel:< object;
        
        theMessage: @staticText
          (# open::
               (# 
               do (20,10) -> position;
                  (200,30) -> size;
               #);
          #);
        theText: @textField
          (# eventhandler::
               (# onKeyDown:: (# do (if ch//ascii.nl//ascii.cr then ok if) #)
               #);
             open::
               (# 
               do (20,40) -> Position;
                  (200,30) -> Size;
               #);
          #);
        okButton: @pushButton
          (# eventHandler:: (# onMouseUp:: (# do ok #)#);
             open::
               (# 
               do (180,80) -> position;
                  (40,30) -> size;
                  'OK' -> label;
                  true -> border.visible;
               #);
          #);
        cancelButton: @pushButton
          (# eventHandler:: (# onMouseUp:: (# do cancel #)#);
             open::
               (# 
               do (120,80) -> position;
                  (50,30) -> size;
                  'Cancel' -> label;
                  true -> border.visible;
               #);
          #);
        open::<
          (# 
          do (if dialogopened//false then
                 true->dialogopened;
                 hide;
                 theMessage.open;
                 theText.open;
                 okButton.open;
                 cancelButton.open;
                 okButton[] -> defaultButton;
                 (230,120) -> size;
                 INNER;
             if);
          #);
        dialogopened: @boolean;
        popup:
          (# titleText, msgText, defaultText: ^text;
             mainpos, mainsize, mysize: @point;
          enter (titleText[], msgText[], defaultText[])
          do (if dialogopened//false then
                 open;
             if);
             titleText[] -> title;
             msgText[] -> theMessage.label;
             theText.clear;
             defaultText[] -> theText.insert;
             (*(0,defaultText.length) -> thetext.selection;*)
             maincanvas.size -> mainsize;
             size -> mysize;
             maincanvas.position -> mainpos;
             (mainpos.x + (mainsize.x-mysize.x) div 2,
             mainpos.y + (mainsize.y-mysize.y) div 2) -> position;
             showmodal;
          #);
     #);
   
   ReadInteger: ReadText
     (# #);
   Read3Int: ReadInteger
     (# #);
   
   
   readrgb: @Read3Int
     (# #);
   readhsv: @Read3Int
     (# #);
   readcmy: @Read3Int
     (# 
     #);
   
#)

-- InitDialogs: descriptor -- 
(# 
do 
#)

-- ReadIntBody:dopart --
do 
-- ReadRGB: dopart --
do   
-- ReadHSV: dopart --
do
-- ReadCMY: dopart --
do
   
-- BdrawNote: dopart --
do (topwindow[], message[], 'Bdraw Note') -> AlertUser
   
