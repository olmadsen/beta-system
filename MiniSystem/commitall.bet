ORIGIN '~beta/basiclib/betaenv'
---lib:attributes---
chdir: external
  (# dir: [0] @char; res: @integer
  enter dir
  do callC
  exit res
  #);
system: external
  (# cmd: [0] @char; res: @integer
  enter cmd
  do callC
  exit res
  #);
_popen: external
  (# cmd,mode: [0]@char; res: @integer
  enter(cmd,mode)
  do callC
  exit res
  #);
fgetc: external
  (# F: @integer; ch: @char
  enter F
  do callC
  exit ch
  #);
--- program:descriptor ---
(# WS: ^text;
   exe:
     (# dst,src,cmd: ^text;         
     enter(dst[],src[])
     do 'beta -q -o ' -> cmd[];
        dst.copy -> cmd.append;
        ' ' -> cmd.put;
        src.copy -> cmd.append;
        
        'exe: ' -> puttext; cmd[] -> putline;
        cmd -> system
     #); 
   arg: ^Text; 
do 'Update and commit qbeta, qenv and benv\n' -> puttext;
   (if noOfArguments <> 2 then
       'Usage:\ncommitall message' -> putline
    else
       2 -> arguments -> arg[];
       newline;
       'c:/beta/r5.5/MiniSystem/' -> WS[];
       WS -> chdir;   
       'pwd' -> system;
       'gt status' -> system;
       ('bin/qbeta','qbeta/qbeta') -> exe;
       ('bin/qenv','miniEnv/qenv') -> exe;
       ('bin/benv','miniEnv/benv') -> exe;
       
       'ls -lt bin/' -> system;
       
       'git status' -> system;
       'git add .' -> system;
       'git commit -m \'' -> arg.prepend; '\'' -> arg.put;
       '\ncommit: ' -> puttext; arg[] -> putline;
       arg -> system;
       'git push' -> system      
   if);
#)

   
