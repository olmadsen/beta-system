ORIGIN '~beta/guienv/guienv';
INCLUDE 'tableview';
-- program: descriptor --
GUIenv
(# main: @Window
     (# theTableView: @TableView
          (# icon1: ^RichPixmap;
             eventHandler::
               (# onFrameChanged::
                    (# width, height: @integer;
                    do THIS(TableView).size -> (width, height);
                       'table-view: (' -> puttext;
                       width -> putint;
                       ', ' -> puttext;
                       height -> putint;
                       ')' -> putline;
                    #);
               #);
             
             onMouseDown::
               (#
               do (if selection.first > 0 then
                      'selected: ' -> puttext;
                      selection.first -> getText -> putline;
                      newline;
                      (if event.doubleClick then
                          '   double-click' -> putline;
                      if);
                      (if event.buttonState <> 1 then
                          '   show-menu' -> putline;
                      if);
                  if);
               #);
             
             
             addItemByLabel:
               (# label: ^Text;
               enter label[]
               do (# index: @integer;
                  do numberOfItems + 1 -> index;
                     1 -> append;
                     (index, label[]) -> setText;
                     
                     label.reset;
                     (if label.getNonBlank = '(' then
                         (if label.get = '#' then
                             (index, icon1[]) -> setImage;
                         if);
                     if);
                     
                  #);
               #);
             open::<
               (# input: @File;
               do 'icons\\cog.png' -> loadImage -> icon1[];
                  'Scroll Test' -> title;
                  'scrolltest.bet' -> input.name;
                  input.openRead;
                  while:
                    (if not input.eos then
                        input.getline -> addItemByLabel;
                        restart while;
                    if);
                  input.close;
                  interior.refresh;
                  checkScrollValues;
               #);
          #);
        open::
          (#
          do (480, 640) -> size;
             theTableView.open;
             true -> theTableView.bindRight;
             true -> theTableView.bindBottom;
          #);
     #);
do main.open;
#)
