ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'qStdBetaParser';
---LIB:attributes---
qStdBetaChecker: parseStdBetaModule
  (# BetaFragments::<
       (# check::
            (# 
            do 'BetaFragments:check:'->traceCheckN;
            #)
       #);
     AttFrag::<
       (# check::
            (#
            do 'AttFrag:check:'->traceCheckN;
            #);
       #);
     Attributes::<
       (# check::
            (#
            do 'Attributes:check:'->traceCheckN;       
            #);
          localSearch::
            (#
            do '**** Attributes.localSearch:'->traceCheck; NA.T[]->traceCheckN;
               loop:
                 scanSons
                 (#
                 do NA[] -> current.localSearch -> dcl[];
                    (if dcl[] <> none then
                        leave Loop
                    if)
                 #)
            #)
       #);
     BetaDecl::<
       (# localSearch::
            (#
            do
            #);
       #);
     StaticItem::<
       (# check::
            (#
            do 'StaticItem:check:'->traceCheck; doPT -> traceCheckN;
            #)
       #);
     BetaPattern::<
       (# check::
            (#
            do 'BetaPattern:check:'->traceCheckN;
            #);
       #);
     ObjectDesc::<
       (# setUpOrigin::
            (#
            do (*'ObjectDesc:setUpOrigin'->traceCheck; label -> traceCheckN; *)
               origin[] -> sup.setupOrigin; 
               this(ObjectDesc)[] -> att.setUpOrigin;
               this(ObjectDesc)[] -> acp.setUpOrigin;
               true -> done;
            #);
          check::
            (#
            do 'ObjectDesc:check:'->traceCheckN;
            #);
          scanDecls:
            (#
            do (* remember lables of forImpIndex *)
               att.scanSons
               (#
               do
               #)
            #);
          search:
            (# NA: ^BetaName; dcl:  ^BetaDecl
            enter NA[]
            do 'ObjDesc:Search:' -> traceCheckN;
               (if NA.T.length > 0 then 
                   '**** Search:' -> traceCheck; NA.T[] -> traceCheckN; 
                   (if false then
                       '**   in:' -> traceCheckN;
                       doPT -> dumpTN;
                   if);
                   NA[] -> att.localSearch -> dcl[]
               if)
            #);
       #);
     ActionPart::<
       (# check::
            (#
            do 'ActionPart:check:'->traceCheckN;
              (* enterP.check;
               imps.check;
               exitP.check*)
            #)
       #);
     Imperatives::<
       (# check::
            (#
            do 'Imperatives:check:'->traceCheckN;
            #);
       #);
     IfImp::<
       (# check::
            (#
            do 'IfImp:check:'->traceCheckN;
            #)
       #);
     PatternDen::<
       (# check::
            (#
            do 'PatternDen:check:'->traceCheck; doPT -> traceCheckN;
            #)
       #);
     AttributeDenotation::<
       (# check::
            (#
            do 'AttributeDenotation:check:'->traceCheck; doPT -> traceCheckN;
               (if NA.T.length > 0 then 
                   '**** AD:Search:' -> traceCheck; T[] -> traceCheckN; 
                   (If origin[] <> none then 
                       NA[] -> origin.search
                    else
                       'empty'->traceCheckN
               if)if);
               true -> done
            #)
       #);
     
     BetaName::<
       (# setUpOrigin::
            (#
            do (if origin[] = none then
                   'Name:origin is none:'->traceCheck; T[] -> traceCheckN
               if)
            #);
          check::
            (# 
            do 'BetaName:check:'->traceCheck;               
            #)
       #);
              
  do (if doTrace then 
         '***** StdBetaChecker: '->puttext;
         mainFrag.label -> dumpTN;
         mainFrag.setUpOrigin;
         mainFrag.check;
     if)
  #)
