ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'qsemchecker';
---lib:attributes---
restrictions: semchecker
  (# items::<
       (# scanGlobals:
            (# current: ^Property
            do (if superDesc[] <> none then
                   &superDesc.scanGlobals
                   (#
                   do current[] -> this(scanGlobals).current[];
                      inner scanGlobals;
                   #);
                   (if superDesc.props[] <> none then
                       (if superDesc.props.globals[] <> none then
                           superDesc.props.globals.scanSons
                           (# 
                           do current[] -> this(scanGlobals).current[];
                              inner scanGlobals;
                           #);
               if)if)if)
            #);
          checkGlobals:
            (# ok: @boolean;
               NA: ^Apl; (* The Apl being accessed *)
            enter NA[]
            do true -> ok;
               loop:
                 scanGlobals
                 (#
                 do current.doPT -> putline;
                    (* --temp -- false -> ok; (*global restrictions exists *)
                    (* (if (ATd.desc, current.desc) -> qyaCheck then
                     * else
                     *    true -> ok;
                     *    leave loop
                     * if)
                     *)
                 #);
               (if not ok then
                   (if NA.ATd.isPatternDecl then 
                       (*    foo: [Q1,Q2,Q3]
                        *    [Q1,Q2,Q3] must be contained in globals[this(PTN)]
                        * else
                        *   if ATd is data-item --> error
                        *   else
                        *      ???
                        *)            
                   if)
               if)
            #)
       #)
  do inner
  #)
