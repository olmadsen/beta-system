ORIGIN '~beta/basiclib/betaenv'
---lib:attributes---
chdir: external
  (# dir: [0] @char; res: @integer
  enter dir
  do callC
  exit res
  #);
system: external
  (# cmd: [0] @char; res: @integer
  enter cmd
  do callC
  exit res
  #);
_popen: external
  (# cmd,mode: [0]@char; res: @integer
  enter(cmd,mode)
  do callC
  exit res
  #);
fgetc: external
  (# F: @integer; ch: @char
  enter F
  do callC
  exit ch
  #);
--- program:descriptor ---
(# WS: ^text;
   exe:
     (# cmd,subPath,input: ^text; 
        withB,withC,background: @boolean;
        TB,TC: ^Text
     enter(cmd[],subPath[], withB,withC,background,input[])
     do subPath[] -> (WS.copy).append -> TB[]; 
        cmd[] -> (TB.copy).append -> TB[]; 
        TB -> chdir;
        'xbeta ' -> TB[];
        'xbeta ' -> TC[];
        ' -c ' -> TC.append;
        cmd[] -> TB.append;
        cmd[] -> TC.append;
        (if background then '&' -> TB.append; '&' -> TC.append if);
        (if withB then TB -> system if);
        (if withC then TC -> system if);
        WS -> chdir;
     #); 
   T: [10000] @char; S: @text;
   FFF: @integer
do 
   'c:/beta/r5.5/MiniSystem/qbeta/BETAworld/workspace/' -> WS[];
   WS -> chdir;
   (if false then
       ('ls','r') -> _popen -> FFF;
       (for i: 200 repeat
            FFF -> fgetc -> put;
   for)if);
   ('TST','',true,true,false,none)-> exe;
   ('ValueEx','',true,true,false,none)-> exe;
   ('Bank','demo/',true,true,false,none) -> exe;
   ('ComplexEx','demo/',true,true,false,none) -> exe;
   ('BinTree','demo/',true,true,false,none) -> exe;
   ('CoArg','demo/',true,true,false,none) -> exe;
   ('ContainerEx','demo/',true,true,false,none) -> exe;
   ('Static','demo/',true,true,false,none) -> exe;
   ('ArrayExperiment','demo/ArrayDemos/',true,true,false,none) -> exe;
   ('EMC2arrayEx','demo/ArrayDemos/',true,true,false,none) -> exe;
   ('SimpleThreadEx','demo/',false,true,false,none) -> exe;
   ('ForkJoinEx','demo/',false,true,false,none) -> exe;
   ('MonitorDemo','demo/',false,true,false,none) -> exe;
   (* '***** done'->putline;
    * ('TST','',false,true,none) -> exe;
    * 'printenv&' -> system;
    *)
#)

   
