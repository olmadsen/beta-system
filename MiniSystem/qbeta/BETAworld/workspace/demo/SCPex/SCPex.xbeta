SCPex: = LIB.SimpleConcurrentProcesses.System
   -- a recent change to checker/semanticChecker/virtuals/.. implies that
   -- the checker fails with the original position of the dceclartions of
   -- S1,S2,i and par (in Formater)
   Text:
      S1: ? String.String
      S2: ? String.STring
      i: ?integer
      add(S: ?String.String):
          i := i + 1
          %if i = 1 %then% S1 := S
          %if i = 2 %then% S2 := S
      format:
          "Format\n".print
      print:
          S1.print
          S2.print
      -- S1: ? String.String
      -- S2: ? String.STring
      -- i: ?integer
   Writer: = Process("Writer")
      stop::
           console.display
              "Stop Writer\n".print
           Formatter.stop
      Formatter.phrase("Hello ")
      Formatter.phrase("world\n")
      Formatter.endPar
      Writer.suspend
      Formatter.phrase("How ")
      Formatter.phrase("are you?\n")
      Formatter.endPar
      stop
   Formatter: = Process("Formatter")
      par: ? Text
      phrase(phr: ?String.String): entry
         console.display
            phr.print
         par.add(phr)
      endPar: entry
        console.display
           "Formatter:endPar\n".print
        par.format
        Printer.par(par)
        par := Text
      stop::
         console.display
            "Stop Formatter\n".print
         Printer.stop
      -- par: ? Text
      par := Text
   Printer: = Process("Printer")
       par(P: ? Text): entry
          console.display
             "Printer:".print
             P.print
       stop::
          console.display
             "Stop Printer\n".print
   Writer.start
   Formatter.start
   Printer.start
