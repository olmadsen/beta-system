ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'xchecker';
INCLUDE '../miniCompiler/objectcode'
---lib:attributes---
generator: checker
  (# Module::
       (# gen::
            (#
            do ('Comp',12) -> cd.newComponent;
               SO.gen
            #);
       #);
     StaticObject::
       (# gen::
            (#
            do OG.gen
            #)
       #);
     ObjectGeneration::
       (* OI: ObjectInvocation, MP: MainPart *)
       (# gen::
            (#
            do 'OG: '-> puttext; OI.inv.compoundSymb[] -> putline;
               (*OI.inv.ATd.doPT -> putline*)
              ('xxx',this(ObjectTemplate)[]) -> ObjTmpStack.add
            #);
          genClass::
            (#
            do 
               ('QQQ', 1, false, 7,1) -> cd.class;
               (4,3,1) -> CD.endClass
            #);
       #);
     ObjTmpStack: @
       (# item: 
            (# N: ^text; OT: ^ObjectTemplate;
            enter(N[],OT[])
            exit this(item)[]
            #);
          add:
            (# N: ^text; OT: ^ObjectTemplate;
            enter(N[],OT[])
            do (if (top+1-> top) > OTL.range then OTL.range -> OTL.extend if);
               (N[],OT[]) -> item -> OTL[top][]
            #);          
          next:
            (# inx: @integer
            do Loop:
                 (#
                 do inx +1 -> inx;
                    (if inx <= top then
                        OTL[inx].OT.genClass;
                        restart Loop
                    if);
                 #)
               #);
               
          OTL: [10] ^Item; top: @integer;
       #);
     
     cd: @ObjectCode;
     bclst: @File;
  do 'Generate code'->putline;
     'xcode'-> bclst.name;
     bclst.openWrite;
     bclst[] -> cd.init;
     'xbeta'-> cd.comment;
     m.gen;
     ObjTmpStack.next;
     bclst.close;
  #)
