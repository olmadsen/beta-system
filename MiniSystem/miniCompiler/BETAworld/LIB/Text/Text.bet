Text: Stream
  (# %simple%
     (* vfields:
      * 1: pos
      * 2: rep[1]: indexed.range
      * 3: rep[2]: indexed[1]
      * 4: rep[3]: indexed[2]
      * 5: ...
      *)
     putx::<
     (# 
     do pos + 1 -> pos; 
        (if pos <=  T.range then (* we need extend *)
            ch -> T[pos];
           (* (if pos > T.index then
                pos -> T.index
            if)*)
        if)
     #);
     print::<(# (* print *) do (for i: pos repeat T[i] -> put for) #);
     putText::<(#  (* puttext *) do T.scan(#  do currentCh -> putx #) #);
     putRtext::< (# (* putRtext *) do (for i: R.index repeat R[i] -> putx for) #);
     scan: 
       (# currentCh: (#  enter T[inx] exit T[inx] #);
          inx: @ integer
       do (for i: pos repeat i -> inx; inner for)
       #);
     dump: 
       (# 
       do 'P' -> put; ':' -> put; pos -> BETA.putint; ' ' -> put;
          'I' -> put; ':' -> put; T.index -> BETA.putint; ' '-> put;
          'R' -> put; ':' -> put; T.range -> BETA.putint; ' '-> put;
          (for i: T.index repeat T[i] -> put for); 10 -> put
       #);
     pos: @ integer; (* not set by enter  *)
     T:[100] @ char;
     
  enter T[]
  exit T[]
  #)
