banking: @
  (# 
     with dk.au.cs.Collections;
     
     Person:
       (# name: ^Text;
          init:
            (# value: ^Text;
            enter value[]
            do value[] -> name[];
            #);
       #);
     
     x, y: @integer;
     constant:
       (# value: @integer;
       do 13 -> value;
       exit value
       #);
     simple1:
       (# x: @integer;
       do 11 -> x;
       #);
     simple2:
       (# x, y: @integer;
       do 44 -> x;
          x -> y;
       #);
     simple3:
       (#
       do 43 -> x;
       #);
     simple4:
       (#
       do x -> y;
       #);
     simple5:
       (# tripple1:
            (# age: @integer;
               name: ^Text;
               male: @integer;;
            do 25 -> age;
               'James' -> name[];
               1-> male;
            exit (age, name[], male)
            #);
          tripple2:
            (# age: @integer;
               name: ^Text;
               male: @integer;
            enter (age, name[], male)
            do age + 3 -> age;
            exit (age, name[], male)
            #);
          tripple3:
            (# age: @integer;
               name: ^Text;
               male: @integer;
            enter (age, name[], male)
            do (if male= 1 then
                   age - 1 -> age;
               if);
            #);
       do tripple1 -> tripple2 -> tripple3;
       #);
     simple6:
       (# a: @integer;
          r: [3] @integer;
          x: @integer;
       do 87 -> r[2];
          r[2] -> x;
       #);
     a: [9] @integer;
     simple7:
       (# y: @integer;
       do 89 -> a[7];
          a[7] -> y;
       #);
     Bank: @
       (# 
          transfer:
            (# from: ^Account;
               to: ^Account;
               amount: @integer;
            enter (from[], to[], amount)
            do amount -> from.withdraw;
               amount -> to.deposit;
            #);
          Account:
            (# owner: ^Person;
               balance: @integer;
               
               init:
                 (# aPerson: ^Person;
                 enter aPerson[]
                 do aPerson[] -> owner[];
                 #);
               
               deposit:
                 (# amount: @integer;
                 enter amount
                 do balance + amount -> setBalance;
                 #);
               withdraw:
                 (# amount: @integer;
                 enter amount
                 do balance - amount -> setBalance;
                 #);
               setBalance:
                 (# value: @integer;
                 enter value
                 do value -> balance;
                 #);
            #);
       #);
     
     
     example1:
       (# myAccount: @bank.Account;
       do 12 -> myAccount.deposit;
       #);
     example2:
       (# joe: ^Person;
          account1: ^bank.Account;
          jane: ^Person;
          account2: ^bank.Account;
       do &Person[] -> joe[];
          'Joe Smith' -> joe.init;
          &bank.Account[] -> account1[];
          joe[] -> account1.init;
          100 -> account1.deposit;
          
          &Person[] -> jane[];
          'Jane Doe' -> jane.init;
          &bank.Account[] -> account2[];
          jane[] -> account2.init;
          300 -> account2.deposit;
          
          (account1[], account2[], 50) -> bank.transfer;
       #);
     example3:
       (# createAccountFor:
            (# name: ^Text;
               thePerson: ^Person;
               theAccount: ^bank.Account;
            enter name[]
            do &Person[] -> thePerson[];
               name[] -> thePerson.init;
               &bank.Account[] -> theAccount[];
               thePerson[] -> theAccount.init;
            exit theAccount[]
            #);
          theAccount: ^bank.Account;
       do 'Jane Smith' -> createAccountFor -> theAccount[];
          13 -> theAccount.deposit;
       #);
     simple:
       (#
       do simple1;
          simple2;
          simple3;
          simple4;
          simple5;
          simple6;
          simple7;
       #);
     example:
       (#
       do example1;
          example2;
          example3;
       #);
     lists:
       (# lst: ^List;
          name: ^Text;
       do &List[] -> lst[];
          lst.init;
          'Joe' -> lst.append;
          'Jane' -> lst.append;
          'Jack' -> lst.append;
          'Dan' -> lst.append;
       #);
     
     comp:
       (# producer: @
            (# value: @integer;
            do 1 -> value;
               producer.suspend;
               11 -> value;
               producer.suspend;
               111 -> value;
               producer.suspend;
               1111 -> value;
               producer.suspend;
               11111 -> value;
               producer.suspend;
            exit value
            #);
          f: @integer;
       do 
          producer -> f;
          f -> putint; 10 -> put;
          producer -> f;
          f -> putint; 10 -> put;
          producer -> f;
          f -> putint; 10 -> put;          
          producer -> f;
          f -> putint; 10 -> put;
       #);
  do (**
     simple;
     example;
     lists;*)

     comp;
  #)
