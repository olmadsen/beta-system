JobShopSimulation: @
  (# With Simulation;
     init:
       (# P1: ^Process
       do &Order[] -> P1[];
          'Scarlett' -> P1;
       exit P1[]
       #);
     MachineGroup:
       (# 
          init: (# enter (id[],nm) do &Queue[] -> Q[] #);
          request: (# do nm - 1 -> nm; (if nm < 0 then Q[] -> (current).wait if) #);
          release: (# do nm + 1 -> nm; (if nm <= 0 then Q.first -> (current).activate if) #);
          id: ^text;
          nm: @integer; (* no. of machines in group *)
          Q: ^Queue
       #);
     Order: Process(# do (for i: 10 repeat i ->  putint; ' ' -> put; 12 -> hold for) #)


     P: ^Process
  do 'Job shop simulation: '.print;
     'Q'->put;
     init -> P[];
     (P[],120) -> Simulate
     
  #)


