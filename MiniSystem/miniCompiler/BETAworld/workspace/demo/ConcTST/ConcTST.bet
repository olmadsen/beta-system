ConcTST: @
  (# S: @
       (# fox: (# ch: @char enter ch do ch -> put #);
       do (for i: 100 repeat
               '0' + (i mod 10) -> fox;
               (if i = 33 then
                   disable;
                   'Entered critical region > '.print
               if);
               (if i = 50 then
                   ' < Leaving critical region'.print; newline;
                   enable
               if)
          for)
       #);
     R: @
       (# foo: 
            (# V: @integer 
            enter V 
            do '!' + V -> put;
               (if V < 4 then V + 1 -> foo if)
            #);
          
       do (for i: 100 repeat 
               (i mod 10) -> foo
          for)
       #);
     
     ch: @char
       
  do 
     (for i: 10 repeat
          'a' + i - 1 -> put; 
          newline;
          100 -> S.attach;
          newline;
          100 -> R.attach;
          newline;
     for)
  #)
