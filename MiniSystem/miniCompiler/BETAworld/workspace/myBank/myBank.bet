myBank: @
  (# with dk.au.cs.SimpleAccounts;
     
     manager: @ 
       (# Joe: ^Account;
          Liza: ^Account;
          total: @integer;
          go: 
            (# V: @integer
            do &Account[] -> Joe[];
               &Account[] -> Liza[];
               100 -> Joe.deposit -> total;
               300 -> V;
               V + 50 -> Liza.deposit -> total;
               (for i: 5 repeat 
                    (if i = 1 then 
                        50 -> Liza.withdraw -> total
                     else
                        (if (1 < i) and (i < 5) then
                            10 + i*10 -> Joe.withdraw -> total
                         else
                            12 -> Liza.deposit -> total;
                            112 -> Joe.deposit -> total
                    if)if)
               for);
               'J' -> put; ':' -> put;
               Joe.balance -> putint; ' ' -> put;
               'L' -> put; ':' -> put;
               Liza.balance -> putint; ' ' -> put;
               Joe.balance +  Liza.balance -> total; ' ' -> put;
            exit total
            #)
       #);
     V: @integer;
     msg: @text

  do manager.go -> V;
     V -> msg.putint;
     msg.newline;
     msg.print;
     10 -> put;
  #)
