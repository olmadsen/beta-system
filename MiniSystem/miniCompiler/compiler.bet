ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'lexer';
INCLUDE 'parser';
INCLUDE 'checker';
INCLUDE 'generator';
INCLUDE 'betaVM';
BODY 'parseStdBeta'
---program:descriptor---
(# compile: @generator;
   FN: ^text;
   VM: @betaVM
       (# allocEvent::
            (#
            do '\n***Alloc:' -> RTT.puttext;

            #);
          doEvent::
            (#
            do '\n***Do:' ->  RTT.puttext;

            #);
          rtnEvent::
            (#
            do '\n***Rtn:' ->  RTT.puttext;

            #)
       #);
   
   L: @LOG;
   RTT: @File;
   betaLib: ^compile.Node
do 'New BETA compiler: ' -> puttext;
   2 -> arguments -> FN[] -> putline;
   ((FN[],'..log') -> mkAuxName, false) -> L.open;
   (L[],false,none,FN[]) -> compile;
   (if not compile.hasErrors then
       (FN[],'..run') -> mkAuxName -> RTT.name;
       RTT.openWrite;
       (compile.descs[],compile.mainDescNo,RTT[]) -> VM.execute;
       compile.parseStdBeta -> betaLib[];
       RTT.close;
   if)
#)
