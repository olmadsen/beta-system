ORIGIN '~beta/guienv/guienvsystemenv';
(*ORIGIN '~beta/basiclib/betaenv';*)
INCLUDE '~beta/guienv/guienv';
INCLUDE 'lexer';
INCLUDE 'parser';
INCLUDE 'checker';
INCLUDE 'generator';
INCLUDE 'betaVM';
BODY 'parseStdBeta'
---program:descriptor---
SystemEnv
(# compile: @generator;
   FN: ^text;
   VM: @betaVM
       (# allocEvent::
            (#
            do '\n***Alloc:' -> RTT.puttext;

            #);
          doEvent::
            (#
            do '\n***Do:' ->  RTT.puttext;

            #);
          rtnEvent::
            (#
            do '\n***Rtn:' ->  RTT.puttext;

            #);
          done:: (# do stop #);
       #);
   setWindowEnv:: (# do myWindowEnv[] -> THEwINDOWeNV[]#);
   myWIndowEnv: @ guienv;
   L: @LOG;
   RTT: @File;
   betaLib: ^compile.Node
do 'New BETA compiler - SVN version: ' -> puttext;
   2 -> arguments -> fixExtension_bet -> FN[] -> putline;
   ((FN[],'..log') -> mkAuxName, false) -> L.open;
   (L[],false,none,FN[]) -> compile;
   (if not compile.hasErrors then
       (FN[],'..run') -> mkAuxName -> RTT.name;
       RTT.openWrite;
       VM.init; (* two inits? *)
       (compile.descs[],compile.mainDescNo,RTT[]) -> VM.execute.init;
       VM.execute[] -> fork;
       'After fork'->putline
   if)
#)
