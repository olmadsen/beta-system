ORIGIN '../scrollingresultset';
INCLUDE 'odbcbody';
-- scrollingResultSetFetchAbsolute: DoPart --
do
     (# rc: @shortint; pcrow: @integer; rowstatusarray: @shortint
     do
        (THIS(resultSet).private.hstmt,SQL_FETCH_ABSOLUTE,index,@@ pcrow,@@
         rowstatusarray)->SQLExtendedFetch->rc;
        (if rc
         // SQL_SUCCESS then
            THIS(resultSet).private.setData->result[]
         // SQL_NO_DATA then
            EOT->result[]
         // SQL_SUCCESS_WITH_INFO then
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)
              ->resultSetNotification
         else
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)->resultSetException
        if)
     #);
   INNER  

-- scrollingResultSetFetchFirst: DoPart --
do
   1->fetchAbsolute;
     (# rc: @shortint; pcrow: @integer; rowstatusarray: @shortint
     do
        (THIS(resultSet).private.hstmt,SQL_FETCH_FIRST,0,@@ pcrow,@@
         rowstatusarray)->SQLExtendedFetch->rc;
        (if rc
         // SQL_SUCCESS then
            THIS(resultSet).private.setData->result[]
         // SQL_NO_DATA then
            EOT->result[]
         // SQL_SUCCESS_WITH_INFO then
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)
              ->resultSetNotification
         else
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)->resultSetException
        if)
     #);
   INNER fetchfirst  

-- scrollingResultSetFetchLast: DoPart --
do
   1->fetchAbsolute;
     (# rc: @shortint; pcrow: @integer; rowstatusarray: @shortint
     do
        (THIS(resultSet).private.hstmt,SQL_FETCH_LAST,0,@@ pcrow,@@
         rowstatusarray)->SQLExtendedFetch->rc;
        (if rc
         // SQL_SUCCESS then
            THIS(resultSet).private.setData->result[]
         // SQL_NO_DATA then
            EOT->result[]
         // SQL_SUCCESS_WITH_INFO then
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)
              ->resultSetNotification
         else
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)->resultSetException
        if)
     #);
   INNER  

-- scrollingResultSetFetchNext: DoPart --
do
     (# rc: @shortint; pcrow: @integer; rowstatusarray: @shortint
     do
        (THIS(resultSet).private.hstmt,SQL_FETCH_NEXT,0,@@ pcrow,@@
         rowstatusarray)->SQLExtendedFetch->rc;
        (if rc
         // SQL_SUCCESS then
            THIS(resultSet).private.setData->result[]
         // SQL_NO_DATA then
            EOT->result[]
         // SQL_SUCCESS_WITH_INFO then
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)
              ->resultSetNotification
         else
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)->resultSetException
        if)
     #);
   INNER  

-- scrollingResultSetFetchPrior: DoPart --
do
     (# rc: @shortint; pcrow: @integer; rowstatusarray: @shortint
     do
        (THIS(resultSet).private.hstmt,SQL_FETCH_PRIOR,0,@@ pcrow,@@
         rowstatusarray)->SQLExtendedFetch->rc;
        (if rc
         // SQL_SUCCESS then
            THIS(resultSet).private.setData->result[]
         // SQL_NO_DATA then
            EOT->result[]
         // SQL_SUCCESS_WITH_INFO then
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)
              ->resultSetNotification
         else
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)->resultSetException
        if)
     #);
   INNER  

-- scrollingResultSetFetchRelative: DoPart --
do
     (# rc: @shortint; pcrow: @integer; rowstatusarray: @shortint
     do
        (THIS(resultSet).private.hstmt,SQL_FETCH_RELATIVE,increment,@@ pcrow,@@
         rowstatusarray)->SQLExtendedFetch->rc;
        (if rc
         // SQL_SUCCESS then
            THIS(resultSet).private.setData->result[]
         // SQL_NO_DATA then
            EOT->result[]
         // SQL_SUCCESS_WITH_INFO then
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)
              ->resultSetNotification
         else
            (none,SQL_HANDLE_STMT,THIS(resultSet).private.hstmt)->resultSetException
        if)
     #);
   INNER  

-- scrollingResultSetScanReverse: DoPart --
do
   fetchLast->current[];
   L2:
     (# 
     do
        pattern[]
          ->set
            (#
               varNotDeclared:: 
                 (# propagate::  (#  do true->value #)
                 do name[]->THIS(set).varNotDeclared
                 #);
               columnNotFound:: 
                 (# propagate::  (#  do true->value #)
                 do name[]->THIS(set).columnNotFound
                 #)
            #);
        (if not (current[] = EOT) then
            INNER scanReverse; fetchPrior->current[]; restart L2
        if)
     #)  

-- resultSetScanReverseVarNotDeclared: DoPart --
do
   'Variable named \''->msg.append;
   name[]->msg.append;
   '\' not declared in this connection'->msg.append;
   INNER  

-- resultSetScanReverseUnknownColumn: DoPart --
do
   'Unknown column: \''->msg.append;
   name[]->msg.append;
   '\' is not in the resultSet'->msg.append;
   INNER  

-- scrollingSupported: DoPart --
do
     (# rc: @shortint; infoValue: @integer
     do
        (THIS(connection).private.hdbc,SQL_SCROLL_OPTIONS,@@ infoValue,4,NULL)
          ->SQLGetInfo->rc;
        (if rc
         // SQL_SUCCESS then
            (infoValue <> SQL_SO_FORWARD_ONLY)->value
         // SQL_SUCCESS_WITH_INFO then
            (none,SQL_HANDLE_STMT,THIS(connection).private.hdbc)
              ->connectionNotification
         else
            (none,SQL_HANDLE_STMT,THIS(connection).private.hdbc)->connectionException
        if)
     #);
   INNER  
