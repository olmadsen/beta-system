ORIGIN '../betadbc';
INCLUDE '~beta/basiclib/formatio';
-- program: Descriptor --
(#
   sqlCon: @connection;
   stmt: @sqlCon.directSqlStatement;
   rs: ^sqlCon.resultSet;
   stmtTxt: ^text
do
   (2->arguments,3->arguments,4->arguments)->sqlCon.open;
   'SELECT Star1.name, Star2.name FROM MovieStar AS Star1, MovieStar AS Star2\n'
     ->stmtTxt[];
   ' WHERE Star1.address = Star2.address AND Star1.name < Star2.name'
     ->stmtTxt.append->stmt->putline;
   newline;
   stmt.execute->rs[];
   '%50s%s\n'
     ->putFormat
       (#  do (1->rs.getColumn).name[]->s; (2->rs.getColumn).name[]->s #);
   newline;
   rs.scan
     (# 
     do '%50s%s\n'->putFormat (#  do current.s->s; current.s->s #)
     #)
#)  

