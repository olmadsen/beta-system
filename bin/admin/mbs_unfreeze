#!/usr/local/bin/perl5 -s
#-*-Perl-*-

require "dirlist";

if ($MACHINETYPE eq "NTI") { # windows
    $command="attrib -r /s *";
} else { # unix
    $command='chmod -R u+w .';
}

#--------- don't change below 

print "This script will recursively add write-permission for\n";
print "all files and directories in MBS $RELEASE.\n\n";

print "Are you sure that you want to do this? (no/yes) ";

$yes = &GetAnswer();
exit if ($yes ne 'yes');

print "Really sure? ";
$yes = &GetAnswer();
exit if ($yes ne 'yes');

print "\nWould you like to be prompted for each directory? (yes/no) ";
$doprompt = &GetAnswer();

foreach $dir (@Dirs) {
    $basedir = "$betalib/$dir";
    next if (!-d &path($basedir));
    if ($doprompt eq "yes"){
	print "\nRecursively add write-permission for\n";	
	print "all files and directories in \n";
	print "  $basedir? (y/n/q) ";
	$answer = &GetAnswer();
	if ($answer eq "y"){
	    # just go on
	} elsif ($answer eq "n"){
	    next;
	} elsif ($answer eq "q"){
	    exit 0;
	}
    } else {
	print "**** Changing permissions in $basedir\n";
    }
    print "cd $basedir\n" if ($verbose);
    chdir(&path($basedir)) || die "cannot chdir($basedir)";
    print "$command\n" if ($verbose);
    system "$command";
    exit(1) if ($?);
}
