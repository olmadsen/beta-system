#!/bin/sh

# Recompile entire release 4.0.1.

#---------- configuration ------------

# compiler version
BETA="$BETALIB/bin/beta -qwl"

RELEASE=r4.0.1

. $BETALIB/configuration/r4.0/env.sh

if [ "$MACHINETYPE" = "SUN4" ]
then
	DYNSTAT="--static"
	TMPDIR=.
	export TMPDIR
	echo DYNSTAT=$DYNSTAT 
	echo TMPDIR=$TMPDIR
fi
if [ "$MACHINETYPE" = "SGI" ]
then
	dostrip=no
else
	dostrip=yes
fi
if [ "$dostrip" = "yes" ]
then
	echo Compiling and stripping the standard applications in $RELEASE
else
	echo Compiling the standard applications in $RELEASE
	echo No stripping on SGI!!
	echo Notice!! som applications must be recompile manually
	echo beta -o $objdir/foo foo is not possible on SGI currently!
fi

echo ""
echo cd $BETALIB/meta/v5.1
cd $BETALIB/meta/v5.1
rm -f $objdir/*.gso
echo "******* $BETA -o "$MACHINETYPE"gen gen"
$BETA -o "$MACHINETYPE"gen gen
if [ "$dostrip" = "yes" ]
then	
	strip "$MACHINETYPE"gen
fi
echo ""

echo ""
echo cd $BETALIB/bobsgen/v1.5
cd $BETALIB/bobsgen/v1.5
rm -f $objdir/*.gso
echo "****** MAKING exbobs and tabc"
make
if [ "$dostrip" = "yes" ]
then
	strip "$MACHINETYPE"exbobs
	strip "$MACHINETYPE"tabc
fi
echo ""

echo ""
echo cd $BETALIB/prettygen/v5.1
cd $BETALIB/prettygen/v5.1
rm -f $objdir/*.gso
echo "******* $BETA -o "$MACHINETYPE"makepretty makepretty"
$BETA -o "$MACHINETYPE"makepretty makepretty
if [ "$dostrip" = "yes" ]
then
	strip  "$MACHINETYPE"makepretty
fi
echo ""

echo ""
echo cd $BETALIB/prettygen/v5.1
cd $BETALIB/prettygen/v5.1
echo "******* $BETA -o "$MACHINETYPE"morepretty morepretty"
$BETA -o "$MACHINETYPE"morepretty morepretty
if [ "$dostrip" = "yes" ]
then
	strip "$MACHINETYPE"morepretty
fi
echo ""

echo ""
echo cd $BETALIB/pretty/v5.1
cd $BETALIB/pretty/v5.1
rm -f $objdir/*.gso
echo "******* $BETA -o "$MACHINETYPE"pp pp"
$BETA -o "$MACHINETYPE"pp pp
if [ "$dostrip" = "yes" ]
then
	strip "$MACHINETYPE"pp
fi
echo ""

echo ""
echo cd $BETALIB/editor/v5.1
cd $BETALIB/editor/v5.1
rm -f $objdir/*.gso
echo "******* $BETA $DYNSTAT -o "$objdir"/"$MACHINETYPE"sif sif"
$BETA $DYNSTAT -o "$objdir"/"$MACHINETYPE"sif sif
if [ "$dostrip" = "yes" ]
then
	strip "$objdir"/"$MACHINETYPE"sif
fi
echo ""

echo ""
echo cd $BETALIB/debugger/v2.2
cd $BETALIB/debugger/v2.2
rm -f $objdir/*.gso
echo "******* $BETA -o "$objdir"/valhalla valhalla"
$BETA -o "$objdir"/valhalla valhalla
if [ "$dostrip" = "yes" ]
then
	strip "$objdir"/valhalla
fi
echo ""

if [ "$MACHINETYPE" = "SUN4S" ]
then
	echo ""
	echo cd $BETALIB/freja/v2.2
	cd $BETALIB/freja/v2.2
	echo "******* $BETA -o "$objdir"/"$MACHINETYPE"freja "$MACHINETYPE"freja" 
	$BETA -o "$objdir"/"$MACHINETYPE"freja "$MACHINETYPE"freja 
	if [ "$dostrip" = "yes" ]
	then
		strip "$objdir"/"$MACHINETYPE"freja
	fi
	echo ""
fi

echo ""
echo cd $BETALIB/interfacebuilder/v1.4
cd $BETALIB/interfacebuilder/v1.4
rm -f $objdir/*.gso
echo "******* $BETA $DYNSTAT -o "$MACHINETYPE"frigg frigg"
$BETA $DYNSTAT -o "$MACHINETYPE"frigg frigg
if [ "$dostrip" = "yes" ]
then
	strip "$MACHINETYPE"frigg
fi
echo ""

echo ""
echo cd $BETALIB/objectbrowser/v2.1/psbrowser
cd $BETALIB/objectbrowser/v2.1/psbrowser
rm -f $objdir/*.gso
echo "******* $BETA -o "$MACHINETYPE"psbrowser psbrowser"
$BETA -o "$MACHINETYPE"psbrowser psbrowser
if [ "$dostrip" = "yes" ]
then
	strip  "$MACHINETYPE"psbrowser 
fi
echo ""

echo ""
echo cd $BETALIB/distribution/v1.2
cd $BETALIB/distribution/v1.2
rm -f $objdir/*.gso
echo "******* $BETA -o "$MACHINETYPE"ensembleDeamon ensembleDeamon"
$BETA -o "$MACHINETYPE"ensembleDeamon ensembleDeamon
if [ "$dostrip" = "yes" ]
then	
	strip  "$MACHINETYPE"ensembleDeamon
fi
echo ""

echo ""
echo cd $BETALIB/utils/betatar/v1.1
cd $BETALIB/utils/betatar/v1.1
rm -f $objdir/*.gso
echo "******* $BETA -o "$objdir"/betatar betatar"
$BETA -o "$objdir"/betatar betatar
if [ "$dostrip" = "yes" ]
then
	strip "$objdir"/betatar
fi
echo ""

echo ""
echo cd $BETALIB/utils/betawc/v1.1
cd $BETALIB/utils/betawc/v1.1
rm -f $objdir/*.gso
echo "******* $BETA -o "$objdir"/betawc betawc"
$BETA -o "$objdir"/betawc betawc
if [ "$dostrip" = "yes" ]
then
	strip "$objdir"/betawc
fi
echo ""

echo ""
echo cd $BETALIB/utils/betafs/v1.1
cd $BETALIB/utils/betafs/v1.1
rm -f $objdir/*.gso
echo "******* $BETA -o "$objdir"/betafs betafs"
$BETA -o "$objdir"/betafs betafs
if [ "$dostrip" = "yes" ]
then
	strip "$objdir"/betafs
fi
echo ""

echo $0 COMPLETE
