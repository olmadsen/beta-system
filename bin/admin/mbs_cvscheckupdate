#!/usr/local/bin/perl5 -s
#-*-Perl-*-

require "dirlist";

$|=1;

print "checking if cvs update is needed (by means of cvs -n update) in $RELEASE\n";

foreach $dir (@Dirs) {
    if ($CvsTags{$dir} =~ /^\%(\S+)/) {
	next if ($1 eq 'IGNORE');
	next if ($1 eq 'NONCVS');
	print "Unknown '%'-tag in CvsTag: \"$1\", skipping $dir\n";
	next;
    }
    $basedir = "$betalib/$dir";
    next if (!-d &path($basedir));
    if (!-d &path("$basedir/CVS")) {
	print "Missing CVS directory in $dir!  Skipping! \n";
	print "Please rename $dir and restart.\n";
	next;
    }
    print "**** cvs -qn update -Pd in $basedir ****\n";
    chdir &path($basedir) or die "Unable to chdir: $!";
    &cvs("-qn update -Pd");
    exit(1) if ($?);
}
