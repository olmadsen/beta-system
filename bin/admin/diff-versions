#!/bin/csh
if ( $#argv == 3 || $#argv == 2) then
  if ( $#argv == 3 ) then
     if ( $1 == 'r' ) then
       set DIFFREC=1
       shift
     else
       echo "Usage: $0:t [r] version1-path version2-path"
       exit 1
     endif
  endif
  set dir1=$1
  set dir2=$2
  foreach f ($dir1/*.bet)
	set f=$f:t
	diff -biw $dir1/$f $dir2/$f >& /tmp/beta$$
        if ( $status == '1' ) then
	   echo "";echo "######################### diff -biw $dir1/$f $dir2/$f";echo ""
           cat /tmp/beta$$#;rm /tmp/beta$$
        endif
  end
  if ( -d $1/private && -d $2/private  ) then
     set dir1=$1/private
     set dir2=$2/private
     foreach f ($dir1/*.bet)
	  set f=$f:t
	  diff -biw $dir1/$f $dir2/$f >& /tmp/beta$$
          if ( $status == '1' ) then
             echo "";echo "######################### diff -biw $dir1/$f $dir2/$f";echo ""
             cat /tmp/beta$$#;rm /tmp/beta$$
          endif
     end
  endif
  if ( $?DIFFREC ) then
    foreach d ($dir1/*)
      if ( -d "$d" ) then
        set d2=`basename "$d"`
        if ( -d "$dir2/$d2" ) then
          if ( $d2 != hp && $d2 != hpux8 && $d2 != sun3 && $d2 != sun4 ) then
            $0 "r" "$d" "$dir2/$d2"
          else
            echo "Skipping binary ($d2)"
          endif
          else
            echo "Only in $dir1 : $d2"
        endif
      endif
    end
  endif
else
  echo "Usage: $0:t [r] version1-path version2-path"
  exit 1
endif 
