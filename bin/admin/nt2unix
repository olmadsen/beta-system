#!/usr/local/bin/perl

if ($#ARGV == -1) {
    print "Usage:\n";
    print "nt2unix <files or wildcard>\n";
    exit 1;
}

foreach $file (@ARGV) {
    next if ($file =~ /~$/);
    print "$file\n";
    open(IN, $file) || die "$0: Cannot open file: $file: $!\n";
    @contents = <IN>;
    close IN;

    unlink("$file~");
    rename($file, "$file~");

    open(OUT, ">$file") || die "$0: Cannot write output $!";
    binmode OUT; # Important if your cygwin has DOS newlines as default!!!
    
    foreach $line (@contents) {
	#$line =~ s/\xd//g;
	$line =~ s/\xd\xa$/\xa/g;
	print OUT $line;
    }
    close OUT;
}
