#!/bin/sh

# config:

BETALIB=/users/beta/inst/           # destination BETALIB
HOST=ariel				    # host for BETALIB
SOURCE=/users/beta/r4.2/export/tarfiles     # where to find the files
ARCHITECTURES="sgi.pe" #"sun4s sgi hpux9pa linux"
PACKAGES="system lidskjalv lib xt yggdrasil valhalla editor freja frigg bifrost contrib ymer"

# don't change below

if [ `hostname` != $HOST ]
then
  echo $0: only on $HOST
  exit 1
fi

if [ ! -d $BETALIB ]
then
  echo $0: the new betalib "$BETALIB" does not exist.
  exit 1
fi

echo ""
echo "****** THIS WILL INSTALL BETA IN $BETALIB *****"
echo ""
echo -n "Are you sure that this is what you want to do? "
read answer 
if [ "$answer" != "yes" ]
then
  exit 0
fi

cd $BETALIB

echo ""
echo Changing access permissions for $BETALIB.
echo If this script fails or is interrupted, please issue the
echo command \'chmod 755 $BETALIB\' 
echo to re-open for access to $BETALIB.

chmod 700 $BETALIB

echo ""
echo Changing permissions in $BETALIB...
chmod -R u+w .

for machine in $ARCHITECTURES
do
  echo Installing for $machine
  for package in $PACKAGES
  do
     echo Installing $package for $machine ....
     cat $SOURCE/$machine/$package.tar.* | gunzip | tar xf -
  done
done

echo ""
echo Restoring access permissions for $BETALIB.

chmod 755 $BETALIB
  
echo ""
echo    Verify that the statictics-directory is present.
echo      - If it isn't, get it using 'cvs export'
echo      - Make sure everyone has write-permission to all files in stat:
echo        chmod -R a+w statistics
echo ""
echo and then manually compile contrib for all architectures:
echo $ARCHITECTURES.




