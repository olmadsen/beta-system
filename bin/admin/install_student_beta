#!/bin/sh

# config:

BETALIB=/usr/local/lib/beta  		# destination BETALIB
HOST=pinus				# host for BETALIB
ARCHITECTURES="sun4s sun4 hpux9pa hpux9mc linux"
PACKAGES="system lib xt mps valhalla editor bifrost"

# don't change below

if [ `hostname` != $HOST ]
then
  echo $0: only on $HOST
  exit 1
fi

echo ""
echo "****** THIS WILL INSTALL BETA IN $BETALIB *****"
echo ""
echo -n "Are you sure that this is what you want to do? "
read answer 
if [ "$answer" != "yes" ]
then
  exit 0
fi
echo -n "Really sure? "
read answer 
if [ "$answer" != "yes" ]
then
  exit 0
fi

cd $BETALIB

echo ""
echo Changing access permissions for $BETALIB.
echo If this script fails or is interrupted, please issue the
echo command \'chmod 755 $BETALIB\' 
echo to re-open for access to $BETALIB.

chmod 700 $BETALIB

echo ""
echo Changing permissions in $BETALIB...
chmod -R u+w .

for machine in $ARCHITECTURES
do
  echo Installing for $machine
  for package in $PACKAGES
  do
     echo getting $package for $machine ....
     ( rsh mjolner.dk "cd /home/mjolner/ftp-betareal/pub/$machine; cat $package.tar.*" ) \
     | gunzip | tar xvf -
  done
done

for machine in $ARCHITECTURES
do
  echo Installing lidskjalv for $machine
  ( rsh mjolner.dk "cd /home/mjolner/ftp-lidskjalv/pub/$machine; cat lidskjalv.tar.*" ) \
  | gunzip | tar xvf -
done

echo Getting contrib...
( rsh mjolner.dk "cd /home/mjolner/ftp/pub/contrib; cat contrib.tar.*" ) | gunzip | tar xvf -
echo done

echo ""
echo Restoring access permissions for $BETALIB.

chmod 755 $BETALIB
  
echo ""
echo Now do this:
echo "  setenv BETALIB $BETALIB"
echo "  make_currentlinks"
echo ""
echo and then manually compile contrib for all architectures:
echo $ARCHITECTURES.