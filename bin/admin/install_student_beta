#!/bin/sh

# config:

BETALIB=/usr/local/lib/beta/r4.0.2/	    # destination BETALIB
HOST=pinus				    # host for BETALIB
SOURCE=/users/beta/r4.0.2/export/tarfiles   # where to find the files
ARCHITECTURES="sun4s sgi hpux9pa linux"
PACKAGES="system lidskjalv lib xt yggdrasil valhalla editor freja frigg bifrost contrib ymer"

# don't change below

if [ `hostname` != $HOST ]
then
  echo $0: only on $HOST
  exit 1
fi

if [ ! -d $BETALIB ]
then
  echo $0: the new betalib "$BETALIB"
  exit 1
fi

echo ""
echo "****** THIS WILL INSTALL BETA IN $BETALIB *****"
echo ""
echo -n "Are you sure that this is what you want to do? "
read answer 
if [ "$answer" != "yes" ]
then
  exit 0
fi
echo -n "Really sure? "
read answer 
if [ "$answer" != "yes" ]
then
  exit 0
fi

cd $BETALIB

echo ""
echo Changing access permissions for $BETALIB.
echo If this script fails or is interrupted, please issue the
echo command \'chmod 755 $BETALIB\' 
echo to re-open for access to $BETALIB.

chmod 700 $BETALIB

echo ""
echo Changing permissions in $BETALIB...
chmod -R u+w .

for machine in $ARCHITECTURES
do
  echo Installing for $machine
  for package in $PACKAGES
  do
     echo Installing $package for $machine ....
     cat $SOURCE/$machine/$package.tar.* | gunzip | tar xf -
  done
done

echo ""
echo Restoring access permissions for $BETALIB.

chmod 755 $BETALIB
  
echo ""
echo Now do this:
echo "  setenv BETALIB $BETALIB"
echo "  make_currentlinks"
echo ""
echo and then manually compile contrib for all architectures:
echo $ARCHITECTURES.
