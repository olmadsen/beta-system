#!/usr/local/bin/perl -s
#-*-Perl-*-

push(@INC, $ENV{'BETALIB'} . "/bin/admin");

require "env.perl";

sub FixPretty {
    local($grammar) = @_;
    if ($OS eq "WIN" or $OS eq "UNIX") {
	system("$betalib/bin/generator $grammar");
	system("$betalib/bin/bobsit $grammar");
	system("$betalib/bin/morepretty $grammar");
    } else {
	die "Missing handling of $OS\n";
    }
}

opendir(DIR, $CURRENTDIR);
@Files = readdir(DIR);
closedir(DIR);

foreach $file (@Files) {
    if ($file =~ /^([^\-]+)\-pretty\.pretty$/i) {
	$grammar = $1;
	print "Fixing $grammar\n";
	if (!$Simulate) {
	    &FileCopy("$grammar-pretty.pretty", "$grammar-pretty.pgram");
	    &FixPretty($grammar);
	}
    }
}
