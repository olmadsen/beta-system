ORIGIN '../preprocess';

--PreprocessBody:descriptor--
(# cmd: ^text;
do (* FIXME: should use process!!! *)
   
   'cp '->cmd[];
   (idlfilename[],'') -> ast.thePathhandler.localpath -> cmd.append;
   ' ' -> cmd.append;
   (cfilename[],'') -> ast.thePathhandler.localpath -> cmd.append;
   cmd[] -> report;
   cmd -> system;
   
   '/usr/local/bin/gcc -E -P ' -> cmd[];
   defines.scan
   (# 
   do '-D ' -> cmd.append;
      current[] -> cmd.append;
      ' ' -> cmd.append;
   #);
   '-o ' -> cmd.append;
   (ifilename[],'') -> ast.thePathhandler.localpath -> cmd.append;
   ' ' -> cmd.append;
   cfilename[] -> cmd.append;
   cmd[] -> report;
   cmd -> system;
   
   (if not preserve then
       'rm -f '->cmd[];
       cfilename[] -> cmd.append;
       cmd[] -> report;
       cmd -> system;
   if);
#)

-- DeleleIFile: descriptor --
(# 
do (if not preserve then
       'rm -f ' -> cmd[];
       ifilename[] -> cmd.append;
       cmd[] -> report;
       cmd -> system;
   if);
#)
