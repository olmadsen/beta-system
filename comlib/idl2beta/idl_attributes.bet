ORIGIN '~beta/basiclib/v1.6/betaenv';
--LIB: attributes--
idl_attributes:
  (* MIDL definitions of IDL attributes, as taken from
   * http://premium.microsoft.com/msdn/library/sdkdoc/ov-iface_3dmb.htm
   *)
  (# 
     print_text: 
       (# s: ^stream; name, value: ^text;
       enter (s[], name[], value[])
       do (if value[]<>NONE then
              name[] -> s.puttext;
              '(' -> s.put;
              value[] -> s.puttext;
              ') ' -> s.puttext;
          if)
       #);
     print_bool:
       (# s: ^stream; name: ^text; value: @boolean;
       enter (s[], name[], value)
       do (if value then
              name[] -> s.puttext;
              ' ' -> s.put;
          if);
       #);
          
     alias_marshal: @
       (# 
          call_as:
            (* Maps a nonremotable function to a remote procedure
             * call.
             *)
            ^text;
          iid_is:
            (* Provides the interface identifier of the COM interface
             * that is the object of the pointer.
             *)
            ^text;
          transmit_as:
            (* Converts a data type to a simpler type for
             * transmission over a network.
             *)
            ^text;
          wire_marshal:
            (* Similar to transmit_as but you implement the routines
             * to size, marshal, unmarshal, and free the data.
             *)
            ^text;
          print:
            (# s: ^stream;
            enter s[]
            do (s[], 'call_as', call_as[]) -> print_text;
               (s[], 'iid_is', iid_is[]) -> print_text;
               (s[], 'transmit_as', transmit_as[]) -> print_text;
               (s[], 'wire_marshal', wire_marshal[]) -> print_text;
            #);
       #); 
     asynchronous: @
       (# async:
            (* When applied to a function parameter, defines a handle
             * that allows the caller to make an asynchronous call and
             * return immediately without waiting for results, and
             * later resynchronize with the callee to receive data
             * after the call completes. The async attribute is also
             * used in ACF files to define an asynchronous handle for
             * a procedure or an entire interface.
             *)
            @boolean;
          maybe:
            (* The client making this remote procedure call does not
             * expect any response indicating delivery or completion
             * of the call, and delivery is not guaranteed. This is in
             * contrast to message operations where no response is
             * expected but the delivery is guaranteed.
             *)
            @boolean;
          message:
            (* The remote procedure call is to be treated as an
             * asynchronous message from the client to the server. The
             * client makes the call and returns immediately, while
             * the actual call is handled by the message-queuing
             * transport (ncadg_mq).
             *)
            ^text;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'async', async) -> print_bool;
               (s[], 'maybe', maybe) -> print_bool;
               (s[], 'message', message[]) -> print_text;
            #);
       #);
     array_size: @
       (# 
          size_is:
            (* Specifies the amount of memory to be allocated for
             * sized pointers, sized pointers to sized pointers, and
             * single- or multidimensional arrays.
             *)
            ^text;
          max_is:
            (* The maximum value for an array index. *)
            ^text;
          length_is:
            (* The number of array elements to be transmitted. *)
            ^text;
          first_is:
            (* The index of the first array element to be
             * transmitted.
             *)
            ^text;
          last_is:
            (* Gives the index of the last array element to be
             * transmitted.
             *)
            ^text;
          string:
            (* Indicates that the one-dimensional char, wchar_t, byte
             * (or equivalent) array, or the pointer to such an array,
             * is to be handled as a string.
             *)
            @boolean;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'size_is', size_is[]) -> print_text;
               (s[], 'max_is', max_is[]) -> print_text;
               (s[], 'length_is', length_is[]) -> print_text;
               (s[], 'first_is', first_is[]) -> print_text;
               (s[], 'last_is', last_is[]) -> print_text;
               (s[], 'string', string) -> print_bool;
            #);
       #);
     
     data_type: @
       (# 
          ull_asynch:
            (* Specifies that the type being defined is an
             * ansynchronous handle.
             *)
            @boolean;
          handle:
            (* Specifies a custom handle type specific to the
             * application.
             *)
            ^text;
          ms_union:
            (* Controls the NDR alignment of nonencapsulated unions.
             * Use on typedefsfor backward compatibility with
             * interfaces built with MIDL 1.0 or 2.0.
             *)
            @boolean;
          pipe:
            (* Allows transmission of an open-ended stream of typed
             * data across a remote procedure call. An in pipe
             * parameter allows the server to pull the data stream
             * from the client during a remote procedure call. An out
             * pipe parameter allows the server to push the data
             * stream back to the client.  
             *)
            ^text;
          transmit_as: 
            (* Used for custom marshaling to specify how a data type
             * will be transmitted over a network.
             *)
            ^text;
          v1_enum:
            (* Directs that the specified enumerated type be
             * transmitted as a 32-bit entity, rather than the 16-bit
             * default.
             *)
            @boolean;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'ull_asynch', ull_asynch) -> print_bool;
               (s[], 'handle', handle[]) -> print_text;
               (s[], 'ms_union', ms_union) -> print_bool;
               (s[], 'pipe', pipe[]) -> print_text;
               (s[], 'transmit_as', transmit_as[]) -> print_text;
               (s[], 'v1_enum', v1_enum) -> print_bool;
            #);
       #);
     
     directional: @
       (# 
          in:
            (* The parameter is being passed from the caller to the
             * callee.
             *)
            @boolean;
          out:
            (* The parameter is being passed from the callee to the
             * caller.
             *)
            @boolean;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'in', in) -> print_bool;
               (s[], 'out', out) -> print_bool;
            #);
       #);
     function_call: @
       (# 
          message:
            (* The remote procedure call is to be treated as an
             * asynchronous message from the client to the server. The
             * client makes the call and returns immediately, while
             * the actual call is handled by the message-queuing
             * transport (ncadg_mq).
             *)
            @boolean;
          maybe:
            (* The client making this remote procedure call does not
             * expect any response indicating delivery or completion
             * of the call. This is in contrast to message operations
             * where no response is expected but the delivery is
             * guaranteed.
             *)
            @boolean;
          broadcast:
            (* The remote procedure call is to be sent to all of the
             * servers on the network. The client accepts the first
             * return and subsequent replies from other servers are
             * discarded.
             *)
            @boolean;
          idempotent:
            (* The call does not change state and returns the same
             * information each time it is called with the same input
             * parameters.
             *)
            @boolean;
          callback:
            (* Designates a function that resides in the client
             * application, that the server can call to obtain
             * information from the client.
             *)
            @boolean;
          call_as:
            (* Maps a non-remotable function to a remote procedure
             * call.
             *)
            ^text;
          local:
            (* Designates a local procedure for which MIDL does not
             * generate stub code. Not valid for object interface
             * functions.
             *)
            @boolean;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'message', message) -> print_bool;
               (s[], 'maybe', maybe) -> print_bool;
               (s[], 'broadcast', broadcast) -> print_bool;
               (s[], 'idempotent', idempotent) -> print_bool;
               (s[], 'callback', callback) -> print_bool;
               (s[], 'call_as', call_as[]) -> print_text;  
               (s[], 'local', local) -> print_bool;
            #);
       #);
     interface_header: @
       (# 
          uuid:
            (* Designates a 128-bit value that distinguishes an
             * interface from all other interfaces. The actual value
             * may represent a GUID, a CLSID, or an IID.
             *)
            ^text;
          local:
            (* Directs the MIDL compiler to generate header files
             * only. An interface must have either a uuid or a local
             * attribute.
             *)
            @boolean;
          ms_union:
            (* Controls the NDR alignment of nonencapsulated
             * unions. Use for backward compatibility with interfaces
             * built on MIDL 1.0 or 2.0.
             *)
            @boolean;
          object:
            (* Identifies the interface as a COM interface and
             * directs the MIDL compiler to generate proxy/stub code
             * instead of RPC client and server stubs.
             *)
            @boolean;
          version:
            (* Identifies a particular version of an interface in
             * cases where multiple versions of the interface exist.
             * Because COM interfaces are immutable, you cannot use
             * the version attribute on an object interface.
             *)
            ^text;
          pointer_default:
            (* Specifies the default pointer type for all pointers
             * except for those included in parameter lists. The
             * default type can be unique, ref, or ptr.
             *)
            ^text;
          endpoint:
            (* Specifies a static (well-known) endpoint on which a
             * server application will listen for remote procedure
             * calls.
             *)
            ^text;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'uuid', uuid[]) -> print_text;
               (s[], 'local', local) -> print_bool;
               (s[], 'ms_union', ms_union) -> print_bool;
               (s[], 'object', object) -> print_bool;
               (s[], 'version', version[]) -> print_text;
               (s[], 'pointer_default', pointer_default[]) -> print_text;
               (s[], 'endpoint', endpoint[]) -> print_text;
            #);
       #);
     
     performance: @
       (# 
          ignore:
            (* Designates that a pointer contained in a structure or
             * union and the object indicated by the pointer is not to
             * be transmitted
             *)
            @boolean;
          local:
            (* Designates a function that is local to the application
             * for which MIDL does not need to generate stub code.
             *)
            @boolean;
          wire_marshal:
            (*
             * Defines a data type as a simpler type for transmission
             * over a network and allows you to implement marshaling
             * and unmarshaling routinesfor the type.
             *)
            @boolean;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'ignore', ignore) -> print_bool;
               (s[], 'local', local) -> print_bool;
               (s[], 'wire_marshal', wire_marshal) -> print_bool;
           #);
       #);
     
     
     
     pointer_type: @
       (# 
          ptr:
            (* Designates a pointer as a full pointer, with all the
             * capabilities of a C-language pointer, including
             * aliasing.
             *)
            @boolean;
          ref:
            (* Designates the simplest type of pointer in MIDL¾one
             * that simply provides the address of some data.
             * Reference pointers can never be NULL.
             *)
            @boolean;
          unique:
            (* Lets a pointer be NULL, but does not support aliasing.
             *)
            @boolean;
          pointer_default:
            (* Applied to an interface to specify the default pointer
             * type for all pointers in that interface, except for
             * top-level parameter pointers, which automatically
             * default to ref pointers
             *)
            @boolean;
          iid_is:
            (* Provides the interface ID of the COM interface that is
             * the object of the pointer.
             *)
            ^text;
          string:
            (* Specifies that the pointer points to a string.  *)
            @boolean;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'ptr', ptr) -> print_bool;
               (s[], 'ref', ref) -> print_bool;
               (s[], 'unique', unique) -> print_bool;
               (s[], 'pointer_default', pointer_default) -> print_bool;
               (s[], 'iid_is', iid_is[]) -> print_text;
               (s[], 'string', string) -> print_bool;
            #);
       #);
     
     struct_union: @
       (# 
          switch:
            (* Selects the discriminant for an encapsulated union. *)
            ^text;
          switch_is: @
            (* Identifies the discriminant for a non-encapsulated
             * union.
             *)
            (# expression: ^text;
               declarator: ^text;
            #);
          switch_type:
            (* Identifies the type of the discriminant for a
             * non-encapsulated union.
             *)
            ^text;
          ignore:
            (* Designates that a pointer contained in a structure or
             * union and the object indicated by the pointer is not to
             * be transmitted.
             *)
            @boolean; 
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               (s[], 'switch', switch[]) -> print_text;
               (if switch_is.expression[]<>NONE then
                   'switch_is' -> s.puttext;
                   '(' -> s.put;
                   switch_is.expression[] -> s.puttext;
                   ') ' -> s.puttext;
                   switch_is.declarator[] -> s.puttext;
               if);
               (s[], 'switch_type', switch_type[]) -> print_text;
               (s[], 'ignore', ignore) -> print_bool;
            #);
       #);
     
     typelib: @
       (#
          aggregatable:
            (* Defines the coclass as supporting objects that can
             * directly expose another object's interface pointer.
             *)
            ^text;
          appobject:
            (* Identifies the coclass as an application object, which
             * is associated with a full EXE application.
             *)
            ^text;
          bindable:
            (* Indicates that the property supports data
             * binding. This allows the client to be notified whenever
             * a property has changed value.
             *)
            @boolean;
          coclass:
            (* Provides a listing of the supported interfaces for a
             * component object.
             *)
            ^text;
          control:
            (* Identifies a coclass or library as a COM control, from
             * which a container site will derive additional type
             * libraries or component object classes.
             *)
            ^text;
          custom:
            (* Defines a custom attribute (one not defined in MIDL).
             *)
            ^text;
          default:
            (* Indicates that the interface or dispinterface, defined
             * within a coclass, represents the default interface.
             *)
            @boolean; 
          defaultbind:
            (* Indicates the single, bindable property that best
             * represents the object.
             *)
            ^text; 
          defaultcollelem:
            (* Flags the property as an accessor funtion for an
             * element of the default collection. Used for Visual
             * Basic® code optimization.
             *)
            ^text;
          defaultvalue:
            (* Allows specification of a default value for a typed
             * optional parameter.
             *)
            ^text;
          defaultvtbl:
            (* Allows an object to have two different source
             * interfaces.
             *)
            ^text;
          dispinterface:
            (* Defines a set of properties and methods on which you
             * can call IDispatch::Invoke.
             *)
            ^text;
          displaybind:
            (* Indicates a property that should be displayed to the
             * user as bindable.
             *)
            ^text;
          dllname:
            (* Defines the name of the DLL that contains the entry
             * points for a module.
             *)
            ^text;
          dual:
            (* Identifies an interface that exposes properties and
             * methods both through IDispatch and directly through the
             * vtable.
             *)
            ^text;
          entry:
            (* Specifies an exported function or constant in a module
             * by identifying the entry point in the DLL.
             *)
            ^text;
          helpcontext:
            (* Specifies a context ID that lets the user view
             * information about this element in the Help file.
             *)
            ^text;
          helpfile:
            (* Sets the name of the Help file for a type library. *)
            ^text;
          helpstring:
            (* Specifies a character string that is used to describe
             * the element to which it applies.
             *)
            ^text;
          helpstringdll:
            (* Sets the name of the DLL to use to perform the
             * document string lookup.
             *)
            ^text;
          hidden:
            (* Indicates that the item exists but should not be
             * displayed in a user-oriented browser.
             *)
            ^text; 
          id:
            (* Specifies a DISPID for a member function (either a
             * property or a method, in an interface or
             * dispinterface).
             *)
            ^text;
          immediatebind:
            (* Indicates that the database will be notified
             * immediately of all changes to a property of a
             * data-bound object.
             *)
            ^text; 
          lcid:
            (* When applied to the library statement, along with a
             * localeID argument, identifies the locale for a type
             * library or for a function argument and lets you use
             * international characters inside the library
             * block. Within a library statement, from the point where
             * the lcid attribute is used, MIDL will accept input
             * localized according to the specified locale.
             *)
            ^text;
          library:
            (* Instructs the MIDL compiler to generate type library
             * information for the interfaces and classes referenced
             * inside the statement.
             *)
            ^text;
          licensed:
            (* Indicates that the coclass to which it applies is
             * licensed, and instances must be created using
             * IClassFactory2.
             *)
            ^text;
          nonbrowsable:
            (* Indicates that the property appears in an object
             * browser (which does not show property values), but does
             * not appear in a properties browser (which does show
             * property values).
             *)
            ^text;
          noncreatable:
            (* Prevents a client from using the default class factory
             * to create instances of an object interface.
             *)
            ^text;
          nonextensible:
            (* Specifies that the IDispatch implementation includes
             * only the properties and methods listed in the interface
             * description and cannot be extended with additional
             * members at run time.
             *)
            ^text;
          oleautomation:
            (* Indicates that an interface is compatible with
             * Automation.
             *)
            ^text;
          optional:
            (* Specifies an optional parameter for a member function.
             *)
            @boolean;
          propget:
            (* Specifies a property accessor function. *)
            @boolean;
          propput:
            (* Specifies a property-setting function. *)
            @boolean;
          propputref:
            (* Specifies a property-setting function that uses a
             * reference instead of a value.
             *)
            @boolean;
          public:
            (* Ensures that an alias declared with typedef becomes
             * part of the type library.
             *)
            ^text;
          readonly:
            (* Prohibits assigning a new value to a variable. *)
            ^text;
          replaceable:
            (* Tags an interface as having default behaviors. *)
            ^text; 
          requestedit:
            (* Indicates that the property supports the OnRequestEdit
             * notification.
             *)
            ^text;
          restricted:
            (* Specifies that a library, or member of a module,
             * interface, or dispinterface cannot be called
             * arbitrarily.
             *)
            ^text;
          retval:
            (* Designates the parameter that receives the return
             * value of the member.
             *)
            @boolean;
          source:
            (* Indicates that a member of a coclass, property, or
             * method is a source of events.
             *)
            ^text;
          string:
            (* Indicates that the one-dimensional char, wchar_t, byte
             * (or equivalent) array or the pointer to such an array
             * must be treated as a string.
             *)
            @boolean;
          uidefault:
            (* Indicates that the type information member is the
             * default member for display in the user interface.
             *)
            @boolean;
          usesgetlasterror:
            (* Specifies that a module entry point uses SetLastError
             * to return error codes and that a caller can then call
             * GetLastError to retrieve the error code if there is an
             * error on entering a function.
             *)
            ^text;
          uuid:
            (* Designates a unique identifier for a type library,
             * coclass, or interface.
             *)
            ^text;
          vararg:
            (* Specifies that the function takes a variable number of
             * arguments.
             *)
            ^text;
          version:
            (* Identifies a particular version of a type library. *)
            ^text;
          print:
            (# s: ^stream;
            enter s[]
            do '; ' -> s.puttext;
               '...' -> s.puttext;
            #);
       #);
     
     print:
       (# s: ^stream;
       enter s[]
       do s[] -> alias_marshal.print;
          s[] -> asynchronous.print;
          s[] -> array_size.print;
          s[] -> data_type.print;
          s[] -> directional.print;
          s[] -> function_call.print;
          s[] -> interface_header.print;
          s[] -> performance.print;
          s[] -> pointer_type.print;
          s[] -> struct_union.print;
          s[] -> typelib.print;
       #);
  #);
