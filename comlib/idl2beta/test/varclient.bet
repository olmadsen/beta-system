ORIGIN '~beta/comlib/comlib';
INCLUDE 'ExDisp';

--PROGRAM: descriptor--
(# CLSID_IE: ^CLSID;
   clsstr: @BSTR;
   IID_Web: @IID;
   pIWebBrowser2: ^IWebBrowser2;
   str: @BSTR;
   url: @VARIANT;
   empty: @VARIANT;
   hr: @HRESULT;
   
   ie_progid: (# exit 'InternetExplorer.Application.1' #);
   
do 0->CoInitialize;
   
   ie_progid -> clsstr.setText;
   clsstr[] -> CLSIDFromProgID -> CLSID_IE[];
   IWebBrowser2_IID -> IID_Web; 
   
   'Create component and get interface IWebBrowser2'->putLine;
   
   (CLSID_IE[], NONE, CLSCTX_LOCAL_SERVER, IID_Web[])
     -> CoCreateInstance->pIWebBrowser2[];
   
   'CoCreateInstance done'->putLine;

   (if pIWebBrowser2[]<>NONE then
       'Succeeded creating component.'->putLine;
       'Initializing BSTR' -> putline;
       'http://www.mjolner.com/' -> str.setText;
       'Initializing URL VARIANT' -> putline;
       VT_BSTR -> url.vt;
       str -> url.bstrVal;
       'Initializing empty VARIANT' -> putline;
       VT_EMPTY -> empty.vt;
       'Calling pIWebBrowser2.visible' -> putline;
       1 -> pIWebBrowser2.putvisible; (* pIWebBrowser2.visible gives fatal error in compiler *)
       'Calling pIWebBrowser2.Navigate2' -> putline;
       (url[], empty[], empty[], empty[], empty[])->pIWebBrowser2.Navigate2;
       'Releasing interface' -> putline;
       pIWebBrowser2.Release;
       'Succeeded releasing interface IWebBrowser2'->putline;
    else
       'Could not create component'->putline;
   if); 
   'CoUninitialize'->putline;
   CoUninitialize;
   'CoUninitialize done'->putline;
#)
