ORIGIN '~beta/comlib/comlib';
INCLUDE 'ExDisp';

--PROGRAM: descriptor--
(# CLSID_Web: @CLSID;
   IID_Web: @IID;
   pIWebBrowser2: ^IWebBrowser2;
   str: @BSTR;
   url: @VARIANT;
   empty: @VARIANT;
   hr: @HRESULT;
   
do 0->CoInitialize;
   
   IWebBrowser2_IID -> IID_Web; 
   
   'Create component and get interface IConv'->putLine;
   
   (CLSID_Web[], NONE, CLSCTX_INPROC_SERVER, IID_Web[])
     -> CoCreateInstance->pIWebBrowser2[];
   
   'CoCreateInstance done'->putLine;

   (if pIWebBrowser2[]<>NONE then
       'Succeeded creating component.'->putLine;
       (* Initializing BSTR and VARIANT *)
       'http://www.mjolner.com/' -> str.setText;
       VT_BSTR -> url.vt;
       str -> url.bstrVal;
       VT_EMPTY -> empty.vt;
       (* Calling pIWebBrowser2.Navigate2 *)
       (url[], empty[], empty[], empty[], empty[])->pIWebBrowser2.Navigate2;
       'Releasing interface' -> putline;
       pIWebBrowser2.Release;
       'Succeeded releasing interface IWebBrowser2'->putline;
    else
       'Could not create component'->putline;
   if); 
   'CoUninitialize'->putline;
   CoUninitialize;
   'CoUninitialize done'->putline;
#)
