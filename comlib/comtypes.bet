ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'holders';
BODY 'private/comtypesbody';
--LIB: attributes--

(*
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1992-98
 *       All rights reserved.
 *)


HRESULT: 
  (# value: @int32;
     succeeded: (# exit value>=0 #);
     failed: (# exit value<0 #);
  enter value
  exit THIS(HRESULT)[]
  #);
HRESULTHolder: Holder
  (# value: @HRESULT enter value exit value #);

GUID: holder
  (# 
     Binary: @DATA
       (# Data1: @int32u;
          Data2: @int16u;
          Data3: @int16u;
          Data4_0: @int8u;
          Data4_1: @int8u;
          Data4_2: @int8u;
          Data4_3: @int8u;
          Data4_4: @int8u;
          Data4_5: @int8u;
          Data4_6: @int8u;
          Data4_7: @int8u;
       #);
     setFromText:
       (* Accepts the following format only (no checking!):
        *   '32bb8320-b41b-11cf-a6bb-0080c7b2d682'
        *)
       (# <<SLOT GUIDsetFromTextLib: attributes>>;
          t: ^Text; p: @Int32;
       enter T[]
       do <<SLOT GUIDSetFromText: descriptor>>   
       #);
     getAsText:
       (# T: ^Text;
       do <<SLOT GUIDGetAsText: descriptor>>
       exit T[]
       #);
  enter setFromText
  exit getAsText
  #);     

CLSID: GUID(# #);
IID: GUID(# #);

GUIDHolder: Holder
  (# value: @GUID enter value exit value #);
CLSIDHolder: Holder
  (# value: @CLSID enter value exit value #);
IIDHolder: Holder
  (# value: @IID enter value exit value #);
