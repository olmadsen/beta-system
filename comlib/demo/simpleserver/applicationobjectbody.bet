ORIGIN 'applicationobject';
INCLUDE '~beta/win32lib/winerror';

-- QueryInterfaceImpl: doPart --
do (if debug then
       errMsg.clear;
       'applobject_QueryInterfaceImpl begin. ' -> errMsg.putText;
       errMsg[] -> screen.putline;
   if);
   
   riid[]->aGUID.binary[];
   none ->ppvObject;
      
   (if true
    // aGUID[]->Unknown_IID.equal 
    // aGUID[]->SimpleServer_IID.equal then
       THIS(IUnknown)[]->ppvObject;
    else
       (if debug then
            errMsg.clear;
           'applobject_QueryInterfaceImpl fails. ' -> errMsg.putText;
           errMsg[] -> screen.putline;
       if);
   if);
   
   (if ppvObject[] <> none then
       ppvObject.ref.AddRef; 
       NOERROR->result;
       (if debug then
           errMsg.clear;
           'Application Object returning interface pointer.' -> errMsg.puttext;
           errMsg[] -> screen.putline;
       if);
    else
       E_NOINTERFACE->result;
       (if debug then
           errMsg.clear;
           'Application Object is not returning interface pointer.' 
             -> errMsg.puttext;
           errMsg[] -> screen.putline;
       if);
   if);
   
   (if debug  then
       errMsg.clear;
       'applobject_QueryInterfaceImpl done.' -> errMsg.putLine;
       errMsg[] -> screen.putline;
   if); 
   
-- AddRefImpl: doPart --
do (if debug then 
       'applobj_AddRefImpl begin.' -> errMsg.putLine;
       errMsg[] -> screen.putline;
   if);
   
   m_cRef + 1 -> m_cRef -> result;
   
   (if debug then 
       errMsg.clear;
       'applobj_AddRefImpl done.' -> errMsg.putLine; 
       errMsg[] -> screen.putline;
   if);
   
-- ReleaseImpl: doPart --
do (if debug then 
       errMsg.clear;
       'applobj_ReleaseImpl begin.' -> errMsg.putLine; 
       errMsg[] -> screen.putline;
   if);
   
   m_cRef - 1 -> m_cRef -> result;
   
   (if (0=m_cRef) then
       'm_cRef = 0. Should we deallocate something?' -> screen.putline;
   if);
   
   (if debug then 
       errMsg.clear;
       'applobj_ReleaseImpl done. m_cRef = ' -> errMsg.putText; 
       m_cRef -> errMsg.putint;
       errMsg[] -> screen.putline;
   if);
   
-- printImpl: doPart --
do 'printImpl. str = ' -> screen.putline;
   str.getText -> screen.putline;
