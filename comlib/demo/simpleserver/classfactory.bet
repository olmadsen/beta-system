ORIGIN '~beta/guienv/guienv';
BODY 'classfactorybody';

INCLUDE 
'~beta/comlib/Unknwn'
'~beta/comlib/comlib'
'applicationobject';


-- guienvlib: attributes --

(* This class factory object creates Hypervise objects. *)

myCF: IClassFactory
  (# errMsg: @Text;
     debug: @boolean;
     
     m_cRef: @int32u; (* Used for reference counting. *)
     
     Unknown_IID, ClassFactory_IID: @IID;
     
     theApplObject: ^ApplicationObject; 
     
     init:
       (# 
       do (* TRUE -> debug;  *)
          IUnknown_IID->Unknown_IID;
          IClassFactory_IID -> ClassFactory_IID;
       #);
     
     QueryInterface::<
       (# aGUID: @GUID
       <<SLOT QueryInterfaceImpl: doPart>>
       #);
     
     AddRef::<
       (# 
       <<SLOT AddRefImpl: doPart>>
       #);
     
     Release::<
       (# 
       <<SLOT ReleaseImpl: doPart>>
       #);
     
     CreateInstance::<
       (# 
       <<SLOT CreateInstanceImpl: doPart>>
       #);
     
     LockServer::<
       (# 
       <<SLOT LockServerImpl: doPart>>
       #);
  #);
