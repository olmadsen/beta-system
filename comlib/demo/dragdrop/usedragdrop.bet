ORIGIN '~beta/guienv/guienv';
INCLUDE '~beta/guienv/controls'
        '~beta/win32lib/winuserconsts'
        '~beta/comlib/comlib'
        'dragdrop';
-- program: Descriptor --
guienv
  (#
     mainWindow: @window
       (#
          theDropTarget: @DropTarget
            (#
               media:: 
                 (# 
                 do
                    (if CF_TEXT->typeIsSupported then
                        CF_TEXT->preferredType
                    if)
                 #);
               drop:: 
                 (# 
                 do
                    (if type = CF_TEXT then
                        '\nFoelgende er blevet droppet:'->putline;
                        asText->putline;
                        newline
                     else
                        'Hvilken type er blevet droppet?'->putline
                    if)
                 #)
            #);
          open::< 
            (# 
            do
               (265,140)->size;
               (500,140)->position;
               target_btn.open;
               'Drag\'n\'drop demo'->title;
               theDropTarget.register
            #);
          eventHandler::< 
            (#
               onAboutToClose::<  (#  do theDropTarget.revoke; terminate #)
            #);
          target_btn: @pushbutton
            (#
               open::< 
                 (# 
                 do
                    'Drop Target'->label;
                    (225,100)->size;
                    (20,20)->position;
                    INNER
                 #);
               eventHandler::< 
                 (#
                    onMouseUp::<  (#  do theDropTarget.revoke; terminate #)
                 #)
            #)
       #);
     InitOLE:
       (# hr: @HRESULT
       do
          0->OleInitialize->hr;
          (if hr.failed then 'OleInitialize failed!'->putline if)
       #)
  do InitOLE; mainWindow.open
  #)  

