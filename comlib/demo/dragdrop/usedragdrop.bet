ORIGIN '~beta/guienv/guienv';
INCLUDE '~beta/guienv/controls'
        '~beta/win32lib/winuserconsts'
        '~beta/comlib/comlib'
        'dragdrop';
-- program: Descriptor --
guienv
  (#
     mainWindow: @window
       (#
          open::< 
            (# 
            do
               (265,140)->size;
               (500,140)->position;
               target_btn.open;
               'Drag\'n\'drop demo'->title
            #);
          eventHandler::< 
            (#
               onAboutToClose::< 
                 (#  do target_btn.theDropTarget.revoke; terminate #)
            #);
          target_btn: @pushbutton
            (#
               theDropTarget: @DropTarget
                 (#
                    media:: 
                      (# 
                      do
                         'Typer:'->putline;
                         (for i: types.range repeat
                           types[i]->putint; newline
                         for);
                         (if CF_TEXT->typeIsSupported then
                             CF_TEXT->preferredType
                         if);
                         (if 15->typeIsSupported then 15->preferredType if)
                      #);
                    drop:: 
                      (# 
                      do
                         (if type = 15 then
                             '\nDroppede type 15'->putline; newline
                          else
                             'Hvilken type er blevet droppet?'->putline
                         if)
                      #)
                 #);
               open::< 
                 (# 
                 do
                    'Drop Target'->label;
                    (225,100)->size;
                    (20,20)->position;
                    INNER ;
                    theDropTarget.register
                 #);
               eventHandler::< 
                 (#
                    onMouseUp::<  (#  do theDropTarget.revoke; terminate #)
                 #)
            #)
       #);
     InitOLE:
       (# hr: @HRESULT
       do
          0->OleInitialize->hr;
          (if hr.failed then 'OleInitialize failed!'->putline if)
       #)
  do InitOLE; mainWindow.open
  #)  

