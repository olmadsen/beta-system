ORIGIN 'Unknwn';
INCLUDE 'comtypes';
BODY 'private/comlibbody';
--LIB: attributes--

(*
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1992-98
 *       All rights reserved.
 *)

CoInitialize: external
  (# LPVoid,hresult: @Int32;
  enter LPVoid
  do CallStd; 
  exit hresult
  #);
CoUninitialize: external
  (# 
  do CallStd;
  #);

CLSIDFromProgID: 
  (# progid: ^BSTR;
     theclsid: ^CLSID;
  enter progid[]
  do <<SLOT CLSIDFromProgID: descriptor>>
  exit theclsid[]
  #);

CoCreateInstance:
  (# theclsid: ^CLSID; 
     outer: ^IUnknown;
     Flags: @Int32;
     theiid: ^IID;
     Iptr: ^IUnknown;
  enter (theclsid[], outer[], Flags, theiid[])
  do <<SLOT CoCreateInstance: descriptor>>   
  exit Iptr[]
  #);


(* ole2.h *)
(* WINOLEAPI OleInitialize(LPVOID pvReserved); *)
OleInitialize: external
  (# pvReserved: @integer;
     hResult: @integer;
  enter pvReserved
  do CallStd;
  exit hResult
  #);

(* WINOLEAPI_(void) OleUninitialize(void); *)
OleUninitialize: external
  (# 
  do CallStd;
  #);

(* Drag/Drop APIs *)

RegisterDragDrop: external
  (# hwnd: @integer; (* HWND *)
     pDropTarget: @integer; (* LPDROPTARGET *)
     hRes: @integer;
  enter (hwnd, pDropTarget)
  do callStd;
  exit hRes
  #);
     
RevokeDragDrop: external
  (# hwnd: @integer; (* HWND *)
     hRes: @integer;
  enter hwnd
  do callStd;
  exit hRes
  #);

DoDragDrop: external
  (# pDataObj: @integer; (* LPDATAOBJECT *)
     pDropSource: @integer; (* LPDROPSOURCE *)
     dwOKEffects: @integer; (* DWORD *)
     pdwEffect: @integer; (* pdwEffect *)
     hRes: @integer;
  enter (pDataObj, pDropSource, dwOKEffects, pdwEffect)
  do callStd;
  exit hRes
  #);

(* Clipboard APIs *)

OleSetClipboard: external
  (# pDataObj: @integer; (* LPDATAOBJECT *)
     hRes: @integer;
  enter pDataObj
  do callStd;
  exit hRes
  #);

OleGetClipboard: external
  (# ppDataObj: @integer;
     hRes: @integer;
  enter ppDataObj
  do callStd
  exit hRes
  #);

OleFlushClipboard: external
  (# hRes: @integer;
  do callStd;
  exit hRes
  #);

OleIsCurrentClipboard: external
  (# pDataObj: @integer; (* LPDATAOBJECT *)
     hRes: @integer;
  enter pDataObj
  do callStd;
  exit hRes
  #);

(* objbase.h *)
CoRegisterClassObject: external
  
  (# rclsid: @integer
       (* Class identifier (CLSID) to be registered *);
     pUnk: @integer
       (* Pointer to the class object *);
     dwClsContext: @integer
       (* Context for running executable code *);
     flags: @integer
       (* How to connect to the class object *);
     lpdwRegister: @integer
       (* Pointer to the value returned *);
     result: @integer
       (* This function supports the standard return values E_INVALIDARG,
        * E_OUTOFMEMORY, and E_UNEXPECTED, as well as the following: S_OK:
        * The class object was registered successfully.  CO_E_OBJISREG:
        * Already registered in the class object table.
        *); 
  enter (rclsid,pUnk,dwClsContext,flags,lpdwRegister)
  do callStd;
  exit result
  #);

CoRevokeClassObject: external
  (# lpdwRegister: @integer
       (* Pointer to the value returned in CoRegisterClassObject *);
     result: @integer;
  enter lpdwRegister
  do callStd
  exit result
  #);

(* oleauto.h *)
RegisterActiveObject: external
  (# punk: @integer; (* IUnknown FAR* *)
     rclsid: @integer; (* REFCLSID *)
     dwFlags: @integer; (* DWORD *)
     pdwRegister: @integer; (* unsigned long FAR* *)
     result: @integer;
  enter (punk, rclsid, dwFlags, pdwRegister)
  do callStd;
  exit result
  #);

RevokeActiveObject: external
  (# dwRegister: @integer; (* unsigned long *)
     pvReserved: @integer; (* void FAR *)
     result: @integer;
  enter (dwRegister, pvReserved)
  do callStd;
  exit result
  #);


ComErrorMessage: external
  (* Display "msg" followed by a human-readable explanation
   * of the error encoded in "hr".
   * Source: private/external/errormessage.cpp
   *)
  (# msg: [0]@char;
     hr: @int32;
  enter (msg, hr)
  do CallC
  #);

--IUnknownLib: attributes--
Query: 
  (* More user-friendly version of QueryInterface than the 
   * autogenerated one in Unknwn.bet.
   *)
  (# theIID: ^IID;  
     Iptr: ^IUnknown;
     hr: @HRESULT;
  enter theIID[]
  <<SLOT IUnknownQuery: dopart>>
  exit Iptr[]
  #);
