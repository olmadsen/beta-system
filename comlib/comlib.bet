ORIGIN 'Unknwn';
INCLUDE 'comtypes';
BODY 'private/comlibbody';
--LIB: attributes--

(*
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1992-98
 *       All rights reserved.
 *)

CoInitialize: external
  (# LPVoid,hresult: @Int32;
  enter LPVoid
  do CallStd; 
  exit hresult
  #);
CoUninitialize: external
  (# 
  do CallStd;
  #);

CLSIDFromProgID: 
  (# progid: ^BSTR;
     theclsid: ^CLSID;
  enter progid[]
  do <<SLOT CLSIDFromProgID: descriptor>>
  exit theclsid[]
  #);

CoCreateInstance:
  (# theclsid: ^CLSID; 
     outer: ^IUnknown;
     Flags: @Int32;
     theiid: ^IID;
     Iptr: ^IUnknown;
  enter (theclsid[], outer[], Flags, theiid[])
  do <<SLOT CoCreateInstance: descriptor>>   
  exit Iptr[]
  #);
          
ComErrorMessage: external
  (* Display "msg" followed by a human-readable explanation
   * of the error encoded in "hr".
   *)
  (# msg: [0]@char;
     hr: @int32;
  enter (msg, hr)
  do CallC
  #);


--IUnknownLib: attributes--
Query: 
  (* More user-friendly version of QueryInterface than the 
   * autogenerated one in Unknwn.bet.
   *)
  (# theIID: ^IID;  
     Iptr: ^IUnknown;
     hr: @HRESULT;
  enter theIID[]
  <<SLOT IUnknownQuery: dopart>>
  exit Iptr[]
  #);
