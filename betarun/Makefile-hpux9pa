
#########  betarun.o / betarun.a ########

betarun.o: C/c.common.o CRUN/c.run.o GC/c.gc.o P/c.p.o
	ld -r -o betarun.o C/c.common.o CRUN/c.run.o GC/c.gc.o  P/c.p.o

betarun.a: C/c.common.o CRUN/c.run.o GC/c.gc.o  P/c.p.o
	mv C/end.o end.o
	rm C/c.common.o CRUN/c.run.o GC/c.gc.o betarun.a
	ar -r betarun.a C/*.o GC/*.o CRUN/*.o  P/*.o

C/c.common.o: ALWAYS
	cd C;  make -f Makefile-hpux9pa PROF="$(PROF)" PE=$(PE)

P/c.p.o: ALWAYS
	cd P;  make -f Makefile-hpux9pa PROF="$(PROF)" PE=$(PE)

CRUN/c.run.o: ALWAYS
	cd CRUN; make -f Makefile-hpux9pa PROF="$(PROF)"

GC/c.gc.o: ALWAYS
	cd GC; make -f Makefile-hpux9pa PROF="$(PROF)" 

######### betarun_v.o / betarunv.a #########

betarun_v.o: C/c.common.valhalla CRUN/c.run.valhalla GC/c.gc.valhalla  P/c.p.valhalla
	ld -r -o betarun_v.o C/c.common.valhalla CRUN/c.run.valhalla GC/c.gc.valhalla P/c.p.valhalla

betarunv.a: C/c.common.valhalla CRUN/c.run.valhalla GC/c.gc.valhalla P/c.p.valhalla
	mv C/end.o end.o
	rm C/c.common.valhalla CRUN/c.run.valhalla GC/c.gc.valhalla P/c.p.valhalla betarunv.a
	ar -r betarunv.a C/*.o GC/*.o CRUN/*.o P/*.o

C/c.common.valhalla: ALWAYS
	cd C;  make -f Makefile-hpux9pa valhalla PROF="$(PROF)" PE=$(PE)

P/c.p.valhalla: ALWAYS
	cd P;  make -f Makefile-hpux9pa valhalla PROF="$(PROF)" PE=$(PE)

CRUN/c.run.valhalla: ALWAYS
	cd CRUN; make -f Makefile-hpux9pa valhalla PROF="$(PROF)"

GC/c.gc.valhalla: ALWAYS
	cd GC; make -f Makefile-hpux9pa valhalla PROF="$(PROF)"

valhalla: betarun_v.o

######### betarun_sym.o (variant of betarun_v.o) #########

betarun_sym.o: C/c.common.sym CRUN/c.run.sym GC/c.gc.sym P/c.p.sym
	ld -r -o betarun_sym.o C/c.common.valhalla CRUN/c.run.valhalla GC/c.gc.valhalla P/c.p.valhalla

C/c.common.sym: ALWAYS
	cd C;  make -f Makefile-hpux9pa valhalla PROF="-g $(PROF)" 

CRUN/c.run.sym: ALWAYS
	cd CRUN; make -f Makefile-hpux9pa valhalla PROF="-g $(PROF)"

GC/c.gc.sym: ALWAYS
	cd GC; make -f Makefile-hpux9pa valhalla PROF="-g $(PROF)"

P/c.p.sym: ALWAYS
	cd P;  make -f Makefile-hpux9pa valhalla PROF="-g $(PROF)" 

sym: betarun_sym.o

######### betarun_ugc.o (variant of betarun_debug.o) ##########

betarun_ugc.o: C/c.common.ugc GC/c.gc.ugc P/c.p.ugc CRUN/c.run.ugc
	/bin/rm -f betarun_ugc.o C/c.common.debug GC/c.gc.debug P/c.p.debug CRUN/c.run.debug
	ld -r -o betarun_ugc.o C/*.o GC/*.o CRUN/*.o P/*.o

C/c.common.ugc: ALWAYS
	cd C; make -f Makefile-hpux9pa debug PROF="-Ddo_unconditional_gc $(PROF)"

CRUN/c.run.ugc: ALWAYS
	cd CRUN; make -f Makefile-hpux9pa debug PROF="-Ddo_unconditional_gc $(PROF)" 

GC/c.gc.ugc: ALWAYS
	cd GC; make -f Makefile-hpux9pa debug PROF="-Ddo_unconditional_gc $(PROF)"

P/c.p.ugc: ALWAYS
	cd P; make -f Makefile-hpux9pa debug PROF="-Ddo_unconditional_gc $(PROF)"

ugc: betarun_ugc.o


######### betarun_debug.o ##########

debug: betarun_debug.o

betarun_debug.o: C/c.common.debug CRUN/c.run.debug GC/c.gc.debug P/c.p.debug
	ld -r -o betarun_debug.o C/c.common.debug CRUN/c.run.debug GC/c.gc.debug P/c.p.debug 

C/c.common.debug: ALWAYS
	cd C; make -f Makefile-hpux9pa debug PROF="$(PROF)"

P/c.p.debug: ALWAYS
	cd P; make -f Makefile-hpux9pa debug PROF="$(PROF)"

CRUN/c.run.debug: ALWAYS
	cd CRUN; make -f Makefile-hpux9pa debug PROF="$(PROF)" 

GC/c.gc.debug: ALWAYS
	cd GC; make -f Makefile-hpux9pa debug PROF="$(PROF)"

########## All ###########

all:
	make -f Makefile-hpux9pa clean
	make -f Makefile-hpux9pa
	make -f Makefile-hpux9pa clean
	make -f Makefile-hpux9pa valhalla
	make -f Makefile-hpux9pa clean
	make -f Makefile-hpux9pa ugc
	make -f Makefile-hpux9pa clean
	make -f Makefile-hpux9pa debug

########## Misc ##########

tags:
	etags GC/*.[hc] P/*.[hc] CRUN/*.[hc] C/*.[hc] C/data.gen Makefile-* C/Makefile-* GC/Makefile-* CRUN/Makefile-*

clean: ALWAYS
	-rm -f *~
	-rm -f C/xmakefile GC/xmakefile P/xmakefile NEWRUN/xmakefile CRUN/xmakefile
	cd C; make -f Makefile-hpux9pa clean
	cd P; make -f Makefile-hpux9pa clean
	cd CRUN; make -f Makefile-hpux9pa clean
	cd GC; make -f Makefile-hpux9pa clean
	sh -c 'if [ -d TST ]; then cd TST; make clean; fi'

commit:
	cvscom

com:
	cvscom

ALWAYS:
	
