#
# OPTIONS
#  RTINFO:   Allow the runtime system to write out information during pe.
#  RTDEBUG:  Allow consistency check during pe.
#

CPP  = gcc -E
MAKE = make

all: xmakefile
	$(MAKE) -f xmakefile\
        "C_FLAGS  =  -Dcrts -D${MACHINETYPE} "\
        "C_OPT = -O6 -Wuninitialized -Wunused $(PROF)" \
	"MAIN     = c.gc.o"

debug: xmakefile
	$(MAKE) -f xmakefile\
        "C_FLAGS  =  -Dcrts -D${MACHINETYPE} -DRTDEBUG -DRTVALHALLA"\
        "C_OPT = -O6 -g -Wuninitialized -Wunused $(PROF)" \
	"MAIN     = c.gc.debug"

xmakefile: ymakefile-GC
	rm -f xmakefile
	cp ymakefile-GC ymakefile.c
	$(CPP) -undef -Dcrts ymakefile.c |\
	sed -e 's/^#.*//' -e 's/^[ \f\t][ \f\t]*$$//' -e 's/^ //' |\
	sed -n -e '/^..*$$/p' > xmakefile
	rm ymakefile.c

clean: xmakefile
	$(MAKE) -f xmakefile clean "MAIN = dummy"
	-rm -f xmakefile *.o *.debug *.valhalla

ymakefile-GC:
