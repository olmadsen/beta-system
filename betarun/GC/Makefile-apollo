CPP  =  /lib/cpp -Uhpux -Dapollo
MAKE = make

all: betarun debug

betarun: xmakefile
	echo cd GC >> ../build
	touch ../C/data.h
	$(MAKE) -f xmakefile -n \
        "C_FLAGS= " \
        "C_OPT  = -O" \
	MAIN=c.gc.o >> ../build
	echo cd .. >> ../build

debug: xmakefile
	echo cd GC >> ../build.debug
	$(MAKE) -f xmakefile -n \
        "C_FLAGS= -DRTDEBUG -DRTVALHALLA" \
        "C_OPT  = -g" \
	MAIN=c.gc.debug >> ../build.debug
	echo cd .. >> ../build.debug

xmakefile: ymakefile-GC
	rm -f xmakefile
	cp ymakefile-GC ymakefile.c
	$(CPP) ymakefile.c |\
	sed -e 's/^#.*//' -e 's/^[ \f\t][ \f\t]*$$//' -e 's/^ //' |\
	sed -n -e '/^..*$$/p' > xmakefile
	rm ymakefile.c

clean:
	-rm -f xmakefile
	-rm -f \#* *~

