------- AttachBasicComponent: System ----
StackStart: cvar;

AttBC: public
  (#
     { Attach the basic component. }
     
     { Input variable. }
     theComp: Component = RegCall;
     
     { Used variables. }
     exitAddress: CodeArea = AddrReg1;
     futureObject: Item    = RegCall;
     theObj:       Item   = RegThis;
     stackPointer: StackArea = SP;
     theProto:     ProtoType = AddrReg1;
     startAddress: CodeArea = AddrReg1
  do
     (if debug then
         (if linux then
             (code '	pushal' code);
             call NotifyRTDebug;
             (code '	popal' code);
         if)
     if);
     
     (if debug then call Ck if);
     
     stackPointer -> StackStart;
     { Push the bottom component block.                      }
     { Terminates the list of component blocks on the stack. }
     push 0;  push 0;  push 0;
     
     0            -> ActiveCallBackFrame;
     stackPointer -> lastCompBlock;
     
     theComp -> BasicItem;  { Save a reference to the betaenv object in BasicItem. } 
     24 -> BasicItem+;      { It is used as origin in MakeTextObj }
    
     TerminateBasicComponent[] -> exitAddress;
     push exitAddress;
     exitAddress -> theComp.CallerLSC;
     
     { Attach the component. }
     theComp -> ActiveComponent;
     
     theComp[24][] -> futureObject;
     
     futureObject.ProtoType -> theProto;
     clear theObj;
     theProto.TopMpart -> startAddress;
     goto startAddress; {AddrRegs ok; stack ok, too}
     
     TerminateBasicComponent:
     (if debug then call Ck if);
     push 0;
     call BetaExit
  #)

