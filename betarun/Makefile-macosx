INCLUDES = -IC -IP
DEFINES = -Dmacosx

MondoBuild = C/define.h


C_ObjDir = $(OBJDIR)/C
NEWRUN_ObjDir = $(OBJDIR)/NEWRUN
GC_ObjDir = $(OBJDIR)/GC
P_ObjDir = $(OBJDIR)/P

COMPILE = cc -g -c $(CFLAGS) $(INCLUDES) $(DEFINES)

C_Objects = \
	$(C_ObjDir)/data.o \
	$(C_ObjDir)/argument.o \
	$(C_ObjDir)/betaenv.o \
	$(C_ObjDir)/cbfa.o \
	$(C_ObjDir)/dot.o \
	$(C_ObjDir)/exit.o \
	$(C_ObjDir)/floats.o \
	$(C_ObjDir)/group.o \
	$(C_ObjDir)/initialize.o \
	$(C_ObjDir)/outpattern.o \
	$(C_ObjDir)/property.o \
	$(C_ObjDir)/sighandler.o \
	$(C_ObjDir)/scanobjects.o \
	$(C_ObjDir)/valhallaComm.o \
	$(C_ObjDir)/valhallaSOCKETS.o \
	$(C_ObjDir)/heapview.o \
	$(C_ObjDir)/labelnametable.o \
	$(C_ObjDir)/sockets.o \
	$(C_ObjDir)/betaerror.o \
	$(C_ObjDir)/rtdebug.o 
	
GC_Objects = \
	$(GC_ObjDir)/aoa.o \
	$(GC_ObjDir)/aoafreelist.o \
	$(GC_ObjDir)/aoatoioa.o \
	$(GC_ObjDir)/block.o \
	$(GC_ObjDir)/copyobject.o \
	$(GC_ObjDir)/ioa.o \
	$(GC_ObjDir)/misc.o \
	$(GC_ObjDir)/objectsize.o \
	$(GC_ObjDir)/stack.o \
	$(GC_ObjDir)/newrun_stack.o \
	$(GC_ObjDir)/lvra.o


	
	
NEWRUN_Objects = \
	$(NEWRUN_ObjDir)/AllocateComponent.o \
	$(NEWRUN_ObjDir)/AllocateDopartObject.o \
	$(NEWRUN_ObjDir)/AllocateItem.o \
	$(NEWRUN_ObjDir)/AllocateObjectRep.o \
	$(NEWRUN_ObjDir)/AllocateRefRep.o \
	$(NEWRUN_ObjDir)/AllocateStackObject.o \
	$(NEWRUN_ObjDir)/AllocateValRep.o \
	$(NEWRUN_ObjDir)/COM.o \
	$(NEWRUN_ObjDir)/Attach.o \
	$(NEWRUN_ObjDir)/CallBack.o \
	$(NEWRUN_ObjDir)/CheckReferenceAssignment.o \
	$(NEWRUN_ObjDir)/CInterface.o \
	$(NEWRUN_ObjDir)/CopyCtext.o \
	$(NEWRUN_ObjDir)/CopyRefRep.o \
	$(NEWRUN_ObjDir)/CopySliceRefRep.o \
	$(NEWRUN_ObjDir)/CopySliceValRep.o \
	$(NEWRUN_ObjDir)/CopyText.o \
	$(NEWRUN_ObjDir)/CopyValRep.o \
	$(NEWRUN_ObjDir)/ExitObjects.o \
	$(NEWRUN_ObjDir)/ExtendRefRep.o \
	$(NEWRUN_ObjDir)/ExtendValRep.o \
	$(NEWRUN_ObjDir)/Main.o \
	$(NEWRUN_ObjDir)/MakeTextObj.o \
	$(NEWRUN_ObjDir)/Misc.o \
	$(NEWRUN_ObjDir)/NewRefRep.o \
	$(NEWRUN_ObjDir)/NewValRep.o \
	$(NEWRUN_ObjDir)/PerformGC.o \
	$(NEWRUN_ObjDir)/Qua.o \
	$(NEWRUN_ObjDir)/Structure.o \
	$(NEWRUN_ObjDir)/Suspend.o
	
P_Objects = \
	$(P_ObjDir)/domain.o \
	$(P_ObjDir)/misc.o \
	$(P_ObjDir)/objectTable.o \
	$(P_ObjDir)/PException.o \
	$(P_ObjDir)/PExport.o \
	$(P_ObjDir)/PImport.o \
	$(P_ObjDir)/proto.o \
	$(P_ObjDir)/PSfile.o \
	$(P_ObjDir)/referenceTable.o \
	$(P_ObjDir)/sequenceTable.o \
	$(P_ObjDir)/specialObjectsTable.o \
	$(P_ObjDir)/transitObjectTable.o \
	$(P_ObjDir)/trie.o \
	$(P_ObjDir)/des.o \
	$(P_ObjDir)/pit.o \
	$(P_ObjDir)/storageblock.o \
	$(P_ObjDir)/storagemanager.o \
	$(P_ObjDir)/cache.o \
	$(P_ObjDir)/unswizzle.o	
	

Objects = $(C_Objects) $(NEWRUN_Objects) $(GC_Objects) $(P_Objects)

betarun_v.o: $(Objects)
	ld -r -o betarun_v.o $(Objects)

betarun_debug.o: $(Objects)
	ld -r -o betarun_debug.o $(Objects)

$(Objects) : $(MondoBuild)


$(C_ObjDir)/%.o : C/%.c
	$(COMPILE) $< -o $@

$(NEWRUN_ObjDir)/%.o : NEWRUN/%.c
	$(COMPILE) $< -o $@

$(GC_ObjDir)/%.o : GC/%.c
	$(COMPILE) $< -o $@

$(P_ObjDir)/%.o : P/%.c
	$(COMPILE) $< -o $@




