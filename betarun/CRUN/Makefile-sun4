#
# OPTIONS
#  RTINFO:   Allow the runtime system to write out information during pe.
#  RTDEBUG:  Allow consistency check during pe.
#  RTLAZY:   Allow dangling (negative) references.
#

CPP  = cc -E
MAKE = make

all: xmakefile
	csh -f -c 'make -f xmakefile\
        "C_FLAGS=-I../C -DRTINFO -DRTLAZY" \
        "C_OPT= -O6 $(PROF)" \
	"MAIN=c.run.o" |& egrep -v "(call-clobbered|included from)"'

debug: xmakefile
	csh -f -c 'make -f xmakefile \
	"C_FLAGS=-I../C -DRTINFO -DRTDEBUG -DRTLAZY" \
	"C_OPT= -g -O6  $(PROF)" \
	"MAIN = c.run.debug" |& egrep -v "(call-clobbered|included from)"'

lazy: xmakefile
	csh -f -c 'make -f xmakefile \
	"C_FLAGS=-I../C -DRTINFO -DRTLAZY" \
	"C_OPT= -g -O6  $(PROF)" \
	"MAIN = c.run.lazy" |& egrep -v "(call-clobbered|included from)"'

lazydebug: xmakefile
	csh -f -c 'make -f xmakefile \
	"C_FLAGS=-I../C -DRTINFO -DRTLAZY -DRTDEBUG" \
	"C_OPT= -g -O6  $(PROF)" \
	"MAIN = c.run.lazydebug" |& egrep -v "(call-clobbered|included from)"'

xmakefile: ymakefile-CRUN
	rm -f xmakefile
	$(CPP) ymakefile-CRUN |\
	sed -e 's/^#.*//' -e 's/^[ \f\t][ \f\t]*$$//' -e 's/^ //' |\
	sed -n -e '/^..*$$/p' > xmakefile

clean: xmakefile
	$(MAKE) -f xmakefile clean
	-rm -f xmakefile *.o *.debug

ymakefile-CRUN:
