#
# OPTIONS
#  RTINFO:   Allow the runtime system to write out information during pe.
#  RTDEBUG:  Allow consistency check during pe.
#  RTLAZY: Allow dangling references
#

CPP  = cc -E
MAKE = make

all: xmakefile
	$(MAKE) -f xmakefile\
        "C_FLAGS  = -DRTINFO"\
        "C_OPT = -O6 -Wuninitialized -Wunused $(PROF) $(DEMO)" \
	"MAIN = c.common.o"


debug: xmakefile
	$(MAKE) -f xmakefile \
        "C_FLAGS  = -DRTINFO -DRTDEBUG"\
        "C_OPT = -O6 -g -Wuninitialized -Wunused  $(PROF)" \
	"MAIN = c.common.debug"

lazy: xmakefile
	$(MAKE) -f xmakefile \
        "C_FLAGS  = -DRTINFO -DRTLAZY"\
        "C_OPT = -O6 -g -Wuninitialized -Wunused  $(PROF)" \
	"MAIN = c.common.lazy"

lazydebug: xmakefile
	$(MAKE) -f xmakefile \
        "C_FLAGS  = -DRTINFO -DRTLAZY -DRTDEBUG"\
        "C_OPT = -O6 -g -Wuninitialized -Wunused  $(PROF)" \
	"MAIN = c.common.lazydebug"

xmakefile: ymakefile-C
	rm -f xmakefile
	$(CPP) ymakefile-C |\
	sed -e 's/^#.*//' -e 's/^[ \f\t][ \f\t]*$$//' -e 's/^ //' |\
	sed -n -e '/^..*$$/p' > xmakefile

clean: xmakefile
	$(MAKE) -f xmakefile clean
	-rm -f xmakefile *.o *.debug

ymakefile-C:

