CPP  =  /lib/cpp -Uhpux -Dapollo
MAKE = make

all: betarun debug



betarun: xmakefile
	echo cd C >> ../build
	$(MAKE) -f xmakefile -n \
        "C_FLAGS= $(DEMO)" \
        "C_OPT  = -O" \
	MAIN=c.common.o >> ../build
	echo cd .. >> ../build

debug: xmakefile
	echo cd C >> ../build.debug
	$(MAKE) -f xmakefile -n \
        "C_FLAGS= -DRTDEBUG -DRTVALHALLA" \
        "C_OPT  = -g" \
	MAIN=c.common.debug >> ../build.debug
	echo cd .. >> ../build.debug

xmakefile: ymakefile-C
	rm -f xmakefile
	cp ymakefile-C ymakefile.c
	$(CPP) ymakefile.c |\
	sed -e 's/^#.*//' -e 's/^[ \f\t][ \f\t]*$$//' -e 's/^ //' |\
	sed -n -e '/^..*$$/p' > xmakefile
	rm ymakefile.c

clean:
	-rm -f xmakefile
	-rm -f \#* *~ data.h data.c

