MAKEFILE = Makefile
BASEDIR =$(BETALIB)\betarun\v2.6\nti\c
ORD_SRC  = end.c initialize.c betaenv.c outpattern.c argument.c property.c            exit.c cbfa.c wordsort.c
EXT_SRC  =  sighandler.c
GEN_SRC  = data.gen export.h declare.h
INC_SRC  = macro.h beta.h define.h constant.h heap.h object.h function.h
SOURCES  = $(Makefile) $(ORD_SRC) $(EXT_SRC) $(GEN_SRC) $(INC_SRC)
OBJFILES  = end.obj initialize.obj betaenv.obj outpattern.obj argument.obj property.obj            exit.obj cbfa.obj wordsort.obj sighandler.obj
INCLUDES = $(INC_SRC) data.h
CC_OPT  = $(C_OPT) $(C_FLAGS)
all: $(OBJFILES) data.obj

data.c: data.gen declare.h
	echo generating data.c
	copy declare.h + data.gen tmpdata.c
	$(CPP) $(C_FLAGS) tmpdata.c
	copy data.pre + tmpdata.i data.c
	del tmpdata.i
	del tmpdata.c
data.h: data.gen export.h
	@echo 'generating data.h'
	copy export.h + data.gen tmpdata.c
	$(CPP) $(C_FLAGS) tmpdata.c
	ren tmpdata.i data.h
	del tmpdata.c
$(OBJFILES): $(INCLUDES) $(GEN_SRC)
	$(CC) -c $(CC_OPT) $*.c
data.obj: data.c
	$(CC) -c $(CC_OPT) $*.c
