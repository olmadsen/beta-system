GEN_SRC  = data.gen export.h declare.h

INC_SRC  = macro.h beta.h define.h constant.h heap.h object.h function.h valhallaComm.h valhallaSOCKETS.h valhallaFindComp.h

OBJFILES  =  initialize.obj betaenv.obj outpattern.obj argument.obj property.obj exit.obj cbfa.obj wordsort.obj sighandler.obj sockets.obj group.obj dot.obj lazyref_gc.obj scanobjects.obj heapview.obj floats.obj valhallaComm.obj valhallaFindComp.obj valhallaSOCKETS.obj


INCLUDES = $(INC_SRC) data.h
CC_OPT  = $(C_OPT) $(C_FLAGS)
all: $(OBJFILES) data.obj

data.c: data.gen declare.h
	@echo generating data.c
	copy /Q declare.h + data.gen tmpdata.c
	$(CPP) $(C_FLAGS) tmpdata.c
	copy /Q data.pre + tmpdata.i data.c
	del /Q tmpdata.i
	del /Q tmpdata.c
data.h: data.gen export.h
	@echo 'generating data.h'
	copy /Q export.h + data.gen tmpdata.c
	$(CPP) $(C_FLAGS) tmpdata.c
	ren /Q tmpdata.i data.h
	del /Q tmpdata.c
$(OBJFILES): $(INCLUDES) $(GEN_SRC)
	$(CC) -c $(CC_OPT) $*.c
data.obj: data.c
	$(CC) -c $(CC_OPT) $*.c
