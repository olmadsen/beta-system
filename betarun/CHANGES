******************************************
******       BETARUN CHANGES         *****
****** Latest changes at top of file *****
******************************************

SEK: 31/01/2001:
	Fixed error preventing persistentstore to be opened/closed twice.
	File: P/storageblock.c

PA: 15/01/2001:
	Needed to add condition for PERSIST in "PA: 10/01/2001"
	fix, to cope with hpux9pa, which does not implement
	new persistence.

PA: 10/01/2001:
	Fixed problem caused by "SEK Mon Oct 30 12:38:37 MET 2000"
	which caused proxyTrapHandler not to be set up for any
	UNIX platform. Thus refnone was not caught.
	Moved initialization of proxyTrapHandler to
	SetupBetaSignalHandlers().

PA: 07/01/2001:
	Added astRef in lowlevel beta.dumps

PA: 29/12/2000:
	Fix of CInterface for RUN (make it work old way until MG
	completes RUN version of new way: CTextPool must be *allocated*
	in data.gen).
	Introduced DoUGC variable in all RUN allocationroutines,
	making IgnoreUGC property and doUGC() function work on
	intel too.

PA: 22/12/2000
        Reverted IOAActive flag change of "PA+HML+LES: 4/12/2000"
        and instead introduced inIOAGc flag for the profiler.
        IOAActive has semnatic meaning that may be disturbed by
        setting it immediately at the beginning and end of IOAGc.

MG: ??/12/2000: 
        Change of CInterface for eliminating of 
        "Text parameter to C routine too big (max. 1000 bytes)"
	CRUN+NEWRUN

PA: 8/12/2000
	Added IgnoreUGC property and doUGC() function to control 
	unconditional GC.

PA: 6/12/2000:
	Introduced global var DoUGC to allow turning on and of
	unconditional GC during excution (via lowlevel debugger).

PA+HML+LES: 4/12/2000:
        Changes to make nti MessageBox displayed after beta.dump
	behave correctly even if error is during display update
	(Paint event). Would previously cause an infinite chain
	of MessageBoxes.

	In GC/ioa.c the setting of the flag IOAActive in IOAGc
	has been moved to the very top of IOAGc() and likewise the
	clearing has been moved to the very end. This is to make
	profiling more precise (identification of whether you are
	in GC or in other extrernal code).

HML: 17/11/00:
	Added A global variable "ProfBetaStackTop" used by a new
        experimental sampling profiler.

	apu:nti_ms>cvs -nq up
	M C/data.gen

   
PA: 13/11/00:
	NEWRUN/ExitObjects.c: Implemented ExOx for sgi/ppcmac
	RUN/ExitObjects.run: Implemented ExOx for intel

SEK: Mon Nov  6 16:31:45 MET 2000

        Implemented new strategy for close of stores. Whenever a store
        is closed all persistent objects in memory that cannot be
        removed because they are referred from transient objects
        through non-ref-none checked reference cells (like origin
        pointers and offline allocated static objects, ..) - all such
        objects are marked as not being persistent. In effect a copy
        of the persistent objects is kept in memory.

	(sek@geri) sun4s> cvs -nq up
	M P/objectTable.c
	M P/objectTable.h
	M P/storageblock.c
        
PA: 06/11/2000:
	Implemented preliminary ExOx function in CRUN/ExitObject.c
	Used for experimenting with general leave.

PA: 06/11/2000:
	Abstracted detailed stackpart traversal of SPARC stack frames
	into new function TraverseSparcStackPart.
	Used by beta.dump and valhallaFindComp.
	To be used by ExitObjects too.
	C/outpattern.c CVS:1.270

PA: 06/11/2000:
	Fixed setup of SubRangeErrLow and SubRangeErrHigh in
	{CRUN,RUN,NEWRUN}/CInterface to fix beta.dump additional
	info for Slice Rep errors when calling externals.
	Fixed reference dumps for Slice Rep Errors.
	Added TST/tstdump/tstdump39.bet, which test index error
	combined with complex exit part.

SEK Wed Nov  1 09:30:24 MET 2000:
	NewCopyObject og CopyObjectToAOA i 'aoa.c' tager en ekstra parameter
	'forceAOAAllocation' som gives videre til 'AOAAllocate'. Dette er
	nødvendig for helt at slippe for den globale variabel
	'forceAOAAllocation'

	Jeg har ikke foretaget nogle målinger på hvor meget dette betyder for
	effektivitet af IOAGc.

	(sek@geri) sun4s> cvs -nq up
	M C/function.h
	M GC/aoa.c
	M GC/copyobject.c
	M GC/ioa.c

SEK Tue Oct 31 14:37:28 MET 2000:

    	Rettede fejl introduceret ved commit beskrevet i 'Mon Oct 30
	12:38:37 MET 2000

	Fjernede global variable forceAOAAllocation, og gjorde den til et
	argument til 'AOAallocate' istedet for.

	(sek@geri) sun4s> cvs -nq up
	M CHANGES
	M C/data.gen
	M C/function.h
	M GC/aoa.c
	M GC/copyobject.c
	M GC/lvra.c
	M P/PImport.c
	M P/objectTable.c
	M P/referenceTable.c
	M P/unswizzle.c

SEK Mon Oct 30 12:38:37 MET 2000

        Flyttede initialisering af persistens håndtering fra 'initialize' til
	'registerRebinderFunc'

	Persistens håndtering bliver nu initialiseret når man kalder
	persistentstore.init, og ikke under initialisering af runtime
	systemet.

HML 7/10/2000:

	files: buildppcbetarun, Makefile-ppc
	- Added ppcbetarun_ugc.obj as a target

	files: beta.h, betaenv.c, define.h 
	- Removed unecessary mac specific #includes
	
	files: outpattern.c
	- added a macspecific #include
	
	files: macsockets.c
	- Fixed a critical bug that made it impossible for a
	  socket generator to generate more than one connection.
	  The wrong socket was beeing set to synchronous.
	  
	  files: sighandler.c
	- Inserted a call to proxyTrapHandler (necessary for PersistenceStore):

	files: valhallaComm.c
	- Fixed a bug in adjust_header in the code that adjusts the
	  group_headers to point the actual code-starts and code-ends.
	
	files: valhallaSockets.c
	- Inserted a call to GiveTime() in valhalla_readDataMax on
	  ppcmac, that allows debuggee to actually send some data.
	  

	files: aoa.c, PExport.c, PImport.c, proto.c, PSFile.c,
		 storageBlock.c, unswizzle.c
	  - #defined ntohl(x) x
	
	files: block.c
	  - implemented newProtectedArea by just returning 
		void *theArea = (void *) 0x80000000;
	  all addresses from 0x80000000 to 0xFFFFFFFF will
	  generate a trap exception to the proxyTrapHandler.
	 
	files: CheckReferenceAssignment.c, P/misc.c, storageBlock.h,
	- changed things like #include "../P/PException.h" to just 
	#include "PException.h"
	
	
	files: CInterface.c, CopySliceRefRep.c, CopySliceValRep.c, Qua.c
	- enabled the runtime wrappers
	
	
	files: cache.c, cache.h, des.c, des.h, storagemanager.c/h
	- removed unix specific #includes not necessary on the mac.
	
	files: des.c
	- implemented strdup() (NOT part of ansi C).
	
	files: PSFile.c
	- implemented fileExists()

FGC Mon Oct  9 16:41:34 MET DST 2000
	files: 	valhallaComm.c valhallaFindCom.c
		- fixed mising obj frame in valhalla stack 
		- perhaps still problems
		GC/newrun_stack, 
		- changes macro trace_stack  (was using __line__  )

