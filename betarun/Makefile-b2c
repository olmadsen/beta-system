
betarun.o: C/c.common.o CRUN/c.run.o GC/c.gc.o
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
        if [ ! -d $${objdir} ]; then mkdir $${objdir}; fi; \
        ld -r -o $${objdir}/betarun.o C/c.common.o CRUN/c.run.o GC/c.gc.o'

C/c.common.o: ALWAYS
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
	export MACHINETYPE; \
	cd C;  make PROF="$(PROF)" PE="$(PE)"'

CRUN/c.run.o: ALWAYS
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
	export MACHINETYPE; \
	cd CRUN; make PROF="$(PROF)"'

GC/c.gc.o: ALWAYS
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
	export MACHINETYPE; \
	cd GC; make PROF="$(PROF)"'


debug: betarun_debug.o

betarun_pe.o: C/c.common.o CRUN/c.run.o GC/c.gc.o
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
        if [ ! -d $${objdir} ]; then mkdir $${objdir}; fi; \
        ld -r -o $(objdir}/betarun_pe.o C/c.common.o CRUN/c.run.o GC/c.gc.o'

pe:
	rm -f C/c.common.o C/initialize.o
	PE="-DPE"; export PE; make betarun_pe.o
	rm -f C/c.common.o C/initialize.o

betarun_debug.o: C/c.common.debug CRUN/c.run.debug GC/c.gc.debug
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
        if [ ! -d $${objdir} ]; then mkdir $${objdir}; fi; \
        ld -r -o $${objdir}/betarun_debug.o C/c.common.debug CRUN/c.run.debug GC/c.gc.debug'

C/c.common.debug: ALWAYS	
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
	export MACHINETYPE; \
	cd C; make debug PROF="$(PROF)"'

CRUN/c.run.debug: ALWAYS
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
	export MACHINETYPE; \
	cd CRUN; make debug PROF="$(PROF)"'

GC/c.gc.debug: ALWAYS
	sh -c '. /users/beta/configuration/r3.0/env.sh.b2c; \
	export MACHINETYPE; \
	cd GC; make debug PROF="$(PROF)"'

########## All ###########

all:
	make clean
	make
	make pe 
	make clean
	make valhalla
	make clean
	make debug

tags:
	etags GC/*.[hc] CRUN/*.[hc] C/*.[hc] C/data.gen Makefile-* C/Makefile-* GC/Makefile-* CRUN/Makefile-*

clean: ALWAYS
	cd C; make clean
	cd CRUN; make clean
	cd GC; make clean
	sh -c 'if [ -d TST ]; then cd TST; make clean; fi'

commit:
	cvscom

com:
	cvscom

tar:
	tar -cvf betarun.tar *.make C/*.c C/*.h CRUN/*.c CRUN/*.h CRUN/*.S GC/*.c

ALWAYS:
