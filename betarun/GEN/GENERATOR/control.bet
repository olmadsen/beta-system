ORIGIN '~beta/basiclib/v1.2/betaenv';
BODY   './translate'
[[
----- INCLUDE './asmfile'
----- Lib: Attributes ----
Control:
(#
  AsmFile:@AssemblerFile;

do
  blok:
  (#
    Usage:(# do 'USAGE: ' -> putText; 1 -> Arguments -> putText;
                ' [-o <name> ] <filenames>' -> putLine #);
     StartOfFilenames: @integer; 
     aText, OutFileName: ^text
  do
    (if (NoOfArguments <= 1)//true then Usage; leave blok if);
    2 -> StartOfFilenames -> Arguments -> aText[]; 

    (if ('-o' -> aText.Equal)//true then
       (if (NoOfArguments <= 3)//true then Usage; leave blok if);      
        3 -> Arguments -> OutFileName[]; 
        4 -> StartOfFilenames
     else
        AsmFile.Machine -> OutFileName[];
        '-run.s' -> OutFileName.Append;
    if);

    OutFileName[] -> AsmFile.Name;
    AsmFile.OpenWrite;
    AsmFile.Prolog; 

    StartOfFilenames -> Arguments ->
     (# filename:^text enter filename[] do <<SLOT Translate:descriptor>> #);

    AsmFile.Epilog;
    AsmFile.Close
  #)
#);

---]]
