RUNDEPS= \
RUN/AllocateComponent.run \
RUN/AllocateItem.run \
RUN/AllocateRefRep.run \
RUN/AllocateStackObject.run \
RUN/AllocateValRep.run \
RUN/Attach.run \
RUN/AttachBasicComponent.run \
RUN/Basics.run \
RUN/CInterface.run \
RUN/CheckReferenceAssignment.run \
RUN/ComponentStack.run \
RUN/CopyCText.run \
RUN/CopyRefRep.run \
RUN/CopySliceRefRep.run \
RUN/CopySliceValRep.run \
RUN/CopyText.run \
RUN/CopyValRep.run \
RUN/DataRegs.run \
RUN/Declaration.run \
RUN/ExitObjects.run \
RUN/ExtendRefRep.run \
RUN/ExtendValRep.run \
RUN/MakeTextObj.run \
RUN/Misc.run \
RUN/NewRefRep.run \
RUN/NewValRep.run \
RUN/PerformGC.run \
RUN/Structure.run \
RUN/Qua.run \
RUN/Suspend.run


tar: intel.asm builds
	rm -f C/data.h C/data.c
	tar -cvf betarun.tar intel.asm build build.debug C

demo:
	make tar

intel.asm: RUN/intel.run RUN/inteladditions.run $(RUNDEPS)
	make asm

asm: 
	- ../GEN/intel/gen -o intel.asm RUN/intel

builds: 
	@echo MAKING BUILD SCRIPTS ---------
	echo echo assembling intel.asm > build
	echo asm intel.asm >> build
	echo echo compiling C sources >> build
	echo echo assembling intel.asm > build.demo
	echo asm intel.asm >> build.demo
	echo echo compiling C sources >> build.demo
	echo echo assembling intel.asm > build.debug
	echo asm intel.asm >> build.debug
	echo echo compiling C sources >> build.debug
	cd C; make clean; make
	DEMO="-DDEMO"; export DEMO; cd C; make clean; make
	cd GC; make clean; make
	echo echo linking betarun.o >> build
	echo ld -r -o betarun.o C/c.common.o GC/c.gc.o intel.bin >> build
	echo echo linking betarun.demo >> build.demo
	echo ld -r -o betarun.demo C/c.common.o GC/c.gc.o intel.bin >> build.demo
	echo echo linking betarun.debug >> build.debug
	echo ld -r -o betarun.debug C/c.common.o GC/c.gc.o intel.bin >> build.debug

gen:
	cd ../GEN/intel; make

tags:
	etags *.run RUN/*.run GC/*.[hc] CRUN/*.[hc] C/*.[hc] C/data.gen

clean: ALWAYS
	@echo Do \'cvs update\' on a SUN
	cd C; make clean
	cd GC; make clean
	- rm -f *.group intel.asm intel.tar build build.demo build.demo
	- rm -f *~ \#*
	- rm -f RUN/*.group RUN/*~

commit:
	echo Do \'cvs commit\' on a SUN

com:
	echo Do \'/users/beta/bin/scripts/cvscom\' on a SUN



ALWAYS:

