ORIGIN 'signature'
---descLocation:doPart---
do (if (desc[] <> none) and not desc.isNull then
       (desc[],true) -> EH.descName ->  S[];
    else
       'NoName!'->S[]
   if);
   316->trace(# 
             do 'location:'->xT; S[] -> xT;
                xN; desc[] -> xA
             #);
   (if not desc.isNull then
       (if desc.label = gram.mainPart then
           desc[] -> sematt.MainPartDesc -> desc[]
       if);
       (if desc.label
        // gram.objectDescriptor then
           desc.descId -> (formId[],descNo);
           desc.son->N; N.brother->N;
           (if N.isSlot then 
               (* desc has mainPart slot *)
               desc[] -> slotLocation -> location[] (* is this what we want? *)
            else 
               (* check if do-part is a slot *)
               N.son->N;     (* att-part*)
               N.brother->N; (* action-part*)
               N.son->N;     (* enter-part*)
               N.brother->N; (* do-part *)
               (if N.isSlot then 
                   (* desc has do-part slot *)
                   desc[] -> slotLocation-> location[] (* is this what we want? *)
                else
                   formId.makeUC;
                   (desc.frag[]).fullName -> location[];
                   (if desc.frag.category 
                    // gram.attributesForm then
                       location[] -> stripForm -> location[];
                    else
                       location[] -> stripFileAndForm -> location[];
                       desc.frag.root[] -> astAsAstIndex -> N;
                       316 -> trace(#
                                   do 'location:fragName:' -> xT;
                                      N[] -> xA
                                   #);
                       (N[],true)
                         -> EH.DescName 
                         -> location.append
                   if)
               if)
           if)
        // gram.unExpanded then
           desc[] -> slotLocation -> location[]
   if)if);
   316->trace(#
             do 'is: ' -> xT;
                (if location[] = none then
                    'unknown' -> xT
                 else 
                    (if location.length = 0 then 
                        'local' -> xT
                     else
                        location[] -> xT
             if)if)#)
   
