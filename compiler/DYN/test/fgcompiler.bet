ORIGIN '~beta/basiclib/systemenv';
INCLUDE '../compilerfacade';
-- program: Descriptor --
systemEnv
  (#
     aFGcompiler: @protoFgCompiler;
     anObject: @ (# a: @integer; b: @text #);
     theMPS: ^ASTinterface;
     aFF: ^theMPS.fragmentForm;
     aFG: ^theMPS.fragmentGroup;
     BETACFL: ^theMPS.beta;
     anAST: ^theMPS.ast;
     aFileName: ^Text
  do
     3->anObject.a;
     'This is a very simple test of the FG compiler\n'->anObject.b;
     aFGcompiler.init;
     anObject[]->aFGcompiler.setContext;
     aFGcompiler.getMPS->theMPS[];
     aFGcompiler.getBETACFL->BETACFL[];
     (aFGcompiler.getDynamicFragmentGroup).name->aFileName[];
     aFilename[]->BETACFL.openBetaFragmentGroup->aFG[];
     'aDynamicFragment'->BETACFL.makeBETAfragmentForm->aFF[];
     (BETACFL.objectDescriptor,'(# do a->putInt; newLine; b[]->putLine #)',
      aFF[])->BETACFL.parseText;
     aFF.name->aFG.fragmentList.deleteLocalName;
     aFF[]->aFG.fragmentList.addFragment;
     aFG[]->aFGcompiler.compile
  #)  

