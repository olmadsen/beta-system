ORIGIN '~beta/basiclib/systemenv';
INCLUDE '../compilerfacade';
-- program: Descriptor --
systemEnv
  (#
     anASTcompiler: @protoAstCompiler;
     anObject: @ (# a: @integer; b: @text #);
     theMPS: ^ASTinterface;
     aFF: ^theMPS.fragmentForm;
     BETACFL: ^theMPS.beta;
     anAST: ^theMPS.ast
  do
     2->anObject.a;
     'This is a very simple test of the AST compiler\n'->anObject.b;
     anAstCompiler.init;
     anObject[]->anAstCompiler.setContext;
     anAstCompiler.getMPS->theMPS[];
     anAstCompiler.getBETACFL->BETACFL[];
     'aDynamicFragment'->BETACFL.makeBETAfragmentForm->aFF[];
     (BETACFL.objectDescriptor,'(# do a->putInt; newLine; b[]->putLine #)',
      aFF[])->BETACFL.parseText->anAST[];
     anAST[]->anAstCompiler.compile
  #)  

