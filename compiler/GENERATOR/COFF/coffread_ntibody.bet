ORIGIN 'coffreadbody';
INCLUDE 'coff_ms';

--CoffFileCheckFilehdrMagic: descriptor--
(# 
do (hdr.f_magic=IMAGE_FILE_MACHINE_I386) -> ok 
#)
   
--CoffRelocTypeAsText: dopart--
do (if type
    // IMAGE_REL_I386_ABSOLUTE then 'IMAGE_REL_I386_ABSOLUTE'->desc[];
    // IMAGE_REL_I386_DIR16 then 'IMAGE_REL_I386_DIR16'->desc[];
    // IMAGE_REL_I386_REL16 then 'IMAGE_REL_I386_REL16'->desc[];
    // IMAGE_REL_I386_DIR32 then 'IMAGE_REL_I386_DIR32'->desc[];
    // IMAGE_REL_I386_DIR32NB then 'IMAGE_REL_I386_DIR32NB'->desc[];
    // IMAGE_REL_I386_SEG12 then 'IMAGE_REL_I386_SEG12'->desc[];
    // IMAGE_REL_I386_SECTION then 'IMAGE_REL_I386_SECTION'->desc[];
    // IMAGE_REL_I386_SECREL then 'IMAGE_REL_I386_SECREL'->desc[];
    // IMAGE_REL_I386_REL32 then 'IMAGE_REL_I386_REL32'->desc[];
    else
       'unknown reloc type: ' -> desc[];
       type -> desc.putint;
   if);

