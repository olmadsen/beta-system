ORIGIN '~beta/basiclib/betaenv';
INCLUDE '~beta/javalib/java/lang/String';
PACKAGE 'org.eclipse.ui.betaeditor.beta';

(* Including hand generated java interface works *)
INCLUDE 'eclipseStuff';

(* Including auto-generated java interface makes 
 * generated constructor in BetaAutoIndentStrategy 
 * be unverifiable: Loads undefined argument 1:
 *     5: aload_1
 *)
(*
INCLUDE 'org/eclipse/jface/text/IDocument';
INCLUDE 'org/eclipse/jface/text/DocumentCommand';
INCLUDE 'org/eclipse/jface/text/DefaultAutoIndentStrategy';
 *)

---LIB:attributes---

BetaAutoIndentStrategy: DefaultAutoIndentStrategy
  (# __init: 
       (# 
       do %setup 'betaenv'; 
       #);
     customizeDocumentCommand: proc
       (# d: ^IDocument; c: ^DocumentCommand; S: ^String; i: @integer;
       enter(d[],c[])
       do 'customizeDocumentCommand: BETA putline!' -> putline;
          c.text[] -> S[];
          d.get -> S[];
          (if false then
              d.getLineoffset -> i;
          if);
          (if false then
              (* Generates BETA Text object and results in ClassCastException *)
              'Some text' -> c.text[];
          if);
          (1,1,'Fisk') -> d.replace;
          (if false then
              (* Verification error: S.equals enters ^Object, 
               * compiler generates beta/lang/Object
               *                    ^^^^
               *)
              (if true
               // ('\t' -> S.equals) then 'indent' -> putline;
               // ('\n' -> S.equals) then 'newLine' -> putline;
               else
                  'insert: ' -> puttext; S[] -> putline;
              if);
           else
              (if true
               // ('\t' -> S.compareTo_String)=0 then 'indent' -> putline;
               // ('\n' -> S.compareTo_String)=0 then 'newLine' -> putline;
               else
                  'insert: ' -> puttext; S[] -> putline;
              if);

          if);
       #);
     (* Do not specify class name: compiler will think this is an external class
      * and not generate anything.q
      * 
      * 
      * do 'org/eclipse/ui/betaeditor/beta/BetaAutoIndentStrategy' -> className
      *)
  #);

(* External classes used *)


