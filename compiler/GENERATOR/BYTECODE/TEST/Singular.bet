origin '~beta/basiclib/betaenv'
---lib:attributes---
Singular: class
  (# X_singular: @ class
       (# V: @integer;
          set: proc(# N: @integer enter N do N -> V #);
          get: proc(# N: @integer do V -> N exit N #);
       #);
     
     set: proc(# N: @integer enter N do N -> X_singular.set #);
     get: proc(# N: @integer do X_singular.get -> N exit N #);
     foo: class
       (# go:< proc(# do inner #);
       #);  
     newSingularFooSub: 
       (# R,R2: ^foo ; x,y: @integer
       do &foo(# go::(# do 'Here is singular subpattern of foo'->putline #)#)
          [] -> R[];            
          R[] -> R2[] ;;
          (# do 'Here is singular insertion' -> putline #);
             (*          (# do  x -> y #);
          (# dummy: @integer do  x -> y #);*)
       exit R[]
       #) 
  #); 
---program:descriptor---  
(# S:  ^Singular; 
   q: @integer;
   f1,f: ^S.foo  
do &Singular[] -> S[]; 
   17 -> S.set; 
   S.get -> q;  
   q -> putint; 
   newline;  
   S.newSingularFooSub -> f[]; 
   f.go    
#)   

 

