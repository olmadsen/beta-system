
 Notes for the preliminary .NET version of the BETA language compiler.

  *****************************************************************
  *** PLEASE READ SECTIONS A, B, C, D BEFORE USING ANY OF THIS! ***
  *****************************************************************

A. Prerequisites
================

1. The Microsoft .NET Framework Final version must be installed.
   Download: [http://msdn.microsoft.com/downloads/default.asp?url=/downloads/sample.asp?url=/msdn-files/027/000/976/msdncompositedoc.xml]
   Direct:
   [http://download.microsoft.com/download/.netframesdk/SDK/1.0/W98NT42KMeXP/EN-US/setup.exe]

B. Installation of BETA_Net
===========================

1. There is no installer.
   Simply unzip BETA_Net.zip. This will create a directory named
   BETA_Net.
   The compiler nbeta.exe resides at the toplevel of this directory.
   Make sure you have the BETA_Net directory in your search path, if
   you want to invoke the compiler from other directories.

2. Set BETALIB.
   You must set the environment variable BETALIB to the location of
   your BETA_net directory before using the compiler.
   Do this in Start->Control Panels->System->Environment.
   

C. Using the compiler
=====================

1. The compiler is named 'nbeta.exe'.

2. The compiler is invoked from the commandline in a shell, e.g. from
   cmd.exe.
   Also known to work with cygwin bash [http://www.cygwin.com/setup.exe]

3. The compiler is invoked by typing
     > nbeta foo
   where foo.bet is a BETA source file containing the definition of
   the PROGRAM fragment.


D. Known preliminary limitations
================================

1. Currently only a subset of BETA is implemented.

2. This is a VERY PRELIMINARY release. The compiler and the generated
   programs may fail fatally in many situations. 
   USE AT YOUR OWN RISK!

3. The compiler is somewhat noisy. This is partly caused by IlAsm.exe
   being somewhat noisy.

4. All source files constituting an executable must currently reside
   in the same directory.
   We intent to generate strong assemblies and config files for
   solving this later.

5. At most one compiled program can reside in a given directory without
   recompilation. That is: If a program foo.bet is compiled into
   foo.exe in a directory and subsequently another program bar.bet 
   is compiled into bar.exe in that same directory then foo.exe will
   no longer function correctly.
   To recompile foo into a functional state do this:
     > del program.dll foo.astL
     > nbeta foo

6. The debug information generated by the BETA compiler is still 
   somewhat rudimentary. Some functions may not be
   possible to step into using DbgCLR or Visual Studio.NET (see
   below), for instance.

7. Local variables in classes corresponding to BETA patterns are
   currently named F12, F16, ... instead of their actual names. Thus
   these are the names that will appear when inpected in a debugger.

8. BETA patterns used as classes must currently be prefixed with the
   keyword "class" and BETA patterns used as methods must likewise be
   prefixed with keyword "proc".


E. Using the CLR debugger
=========================

1. Along with the free .NET framework comes a stand alone source level
   debugger named DbgCLR.exe. It typically resides in 
   "C:\Program Files\Microsoft.Net\FrameworkSDK\GuiDebug\DbgCLR.exe"

2. Open DbgCLR.exe by double clicking its icon in the Windows Explorer.

3. Given that foo.bet has been compiled to foo.exe, you may now
   specify foo.exe in menu item [Debug->Program to debug].

4. Now set a breakpoint at the beginnig of the program:
   From menu item [Debug->New Breakpoint (Ctrl-B)] specify
   breakpoint in Function "program.do".

5. Now start the program using menu item [Debug->Start (F5)].
   The program will now stop at the do-part of the PROGRAM fragment.
   You can now single step, inspect variables etc. at BETA source
   level.

6. Please notice that the debug information generated by the BETA
   compiler still is somewhat rudimentary. Some functions may not be
   possible to step into, for instance.

7. Possibly we will later generate a foo.dln file for DbgCLR.exe


F. Using Visual Studio .NET
===========================

1. If you have Visual Studio .NET you can also debug and browse your
   program via VS.NET. The way to open the files are slightly
   different than in DbgCLR, though (see above).

2. To debug foo.exe produced from foo.bet, you first choose menu item
   [File->Open Solution...].
   
3. In the dialog that appears, you choose 
   "Files of types: All project files" and navigate to foo.exe.
   Double click foo.exe.

4. Now set a breakpoint at the beginnig of the program:
   From menu item [Debug->New Breakpoint (Ctrl-B)] specify
   breakpoint in Function "program.do".

5. Now start the program using menu item [Debug->Start (F5)].
   The program will now stop at the do-part of the PROGRAM fragment.
   You can now single step, inspect variables etc. at BETA source
   level.

6. Please notice that the debug information generated by the BETA
   compiler still is somewhat rudimentary. Some functions may not be
   possible to step into, for instance.

7. Possibly we will later generate a foo.sln file for Visual Studio.NET

8. We intend to investigate the many possibilities that Visual Studio
   offers, by letting it "know" the BETA language, e.g. having syntax
   coloring, allowing it to call the compiler as part of a build etc.


G. Cross language support
=========================

1. You may use libraries written in BETA in other languages.
   You just compile the BETA library, possibly using 'nbeta -x' (no
   linking), and then reference it from the other language.
   An example is in Bclass.bet and BclassUser.cs. Compilation
   statements are:

    nbeta -x Bclass.bet
    csc /r:System.dll /r:tstenv.dll /r:Bclass.dll BclassUser.cs 

   The .NET classes generated from the BETA patterns are not yet
   documented. This documentation will follow later.

   Notice the instantiation of BETA objects, which must specify an
   origin object (in BclassUser.cs null is used - this is potentially
   dangerous).

2. BETA code can call code and use types from other languages.
   There are problems with handling assembly references for this,
   though.
   It is safe to use any class or method from assembly [mscorlib] and 
   [System.Windows.Forms] - the compiler simply generates external
   assembly declarations for these in all generated IL files.
   Currently, before using a class/method in an external non-BETA 
   assembly, it must be declared using the predefined patterns
   External and ExternalClass. See dotnettstenvbody.bet and hello5.bet
   for examples.

3. The cross language support is expected to be significantly improved
   in a later version. E.g. we expect to make the compiler lookup the
   declarations in external non-BETA assemblies, thus avoiding the
   need for declaring these manually.


H. Further information
======================

If you have any questions, problems, comments etc. regarding BETA.Net,
please contact [mailto:beta@daimi.au.dk].

We intend to set up a web page with project description etc. at a
later time.
