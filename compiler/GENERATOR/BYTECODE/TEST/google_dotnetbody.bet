ORIGIN 'google';
--LIB: attributes--

String: ExternalClass
  (# ToCharArray: proc
       (# result: [0]@char
       exit result
       #);
  do '[mscorlib]System.String' -> className;
  #);
ResultElement: ExternalClass
  (# URL: ^String;
  do '[GoogleSearchService]ResultElement' -> className;
  #);
GoogleSearchResult: ExternalClass
  (# resultElements: [0]^ResultElement;
  do '[GoogleSearchService]GoogleSearchResult' -> className;
  #);
GoogleSearchService: ExternalClass
  (# 
     doGoogleSearch: proc
       (# key: ^String;
          q: ^String;
          start: @int32;
          maxResults: @int32;
          filter: @boolean;
          restrict: ^String;
          safeSearch: @Boolean;
          lr, ie, oe: ^String;
          result: ^GoogleSearchResult;
       enter (
          key[], 
          q[], 
          start, 
          maxResults, 
          filter, 
          restrict[], 
          safeSearch, 
          lr[], 
          ie[], 
          oe[])
       exit result[]
       #) 
  do '[GoogleSearchService]GoogleSearchService' -> className;
  #);

--DoSearchGoogle: dopart--
do (# google: ^GoogleSearchService;
      result: ^GoogleSearchResult;
   do &GoogleSearchService[] -> google[];
      ((*BetaLicenseKey*)'hweCKhQvbXY6kvKmOpDS2P3lTqQ5ggBu', 
      query[], 
      0, 
      10, 
      false, 
      '', 
      false, 
      '', 
      'latin1', 
      'latin1')
        -> google.doGoogleSearch
        -> result[];
      'Number of results: ' -> puttext;
      result.resultElements.range -> putint;
      newline;
      
      (for i:result.resultElements.range repeat
           result.resultElements[i].URL[] -> current[];
           current[] -> putline;
           INNER SearchGoogle;
      for);
   #)
