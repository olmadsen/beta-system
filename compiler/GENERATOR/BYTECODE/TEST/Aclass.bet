(*origin '~beta/basiclib/betaenv' *)
origin 'tstenv'
---lib:attributes---
Aclass: class
  (# V: @integer;
     set: proc
       (# n: @integer
       enter n
       do 17 -> V;
          n -> V; 
          n+V -> V
       #);
     set2: proc
       (# n: @integer; X: @integer
       enter n
       do 17 -> X;
          n -> X;
          n+1 -> X
       #);
     get: proc(#  do exit V #);
     fisk: proc
       (# n: @integer
       enter n
       do (if (n < V) and (n >= 0) then
              'add' -> putline;
              V+n -> V
           else
              (if (n < V) or ( n < 0) then
                  'sub' -> putline;
                  V-n -> V
               else
                  'neg' -> putline;
                  -V -> V
       if)if)#) 
          
  #);

---program:descriptor---
(# S,R: ^Aclass; 
   V: @integer;

do &Aclass[] -> S[];
   8->S.set;
   S.get -> V;  
   V -> putint;
   newline;
   S[] -> R[];
   9 -> R.set; (* V = 18 *) 
   R.get -> V; 
   V -> putint;
   newline;
   10 -> R.fisk; (* V = (18 + 10 = 28 *)
    R.get -> V;
   V -> putint;
   newline; 
   -6 -> R.fisk; (* V = (28 + 6 = 34 *)
    R.get -> V;
   V -> putint;
   newline; 
   40 -> R.fisk; (* V = -34 *) 
   R.get -> V;
   V -> putint;
   newline;
#)
 

 
 
