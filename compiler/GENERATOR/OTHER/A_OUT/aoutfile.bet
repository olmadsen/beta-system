ORIGIN '~beta/basiclib/binfile';
INCLUDE 'a_out';
MDBODY sun4 'aoutfile_sun4body';

(* aoutfile.bet:
 *   Pattern for manipulating object files in a.out format.
 *
 *   $Id: aoutfile.bet,v 1.2 2001-11-22 13:05:26 corry Exp $
 *)


--LIB: attributes--

aoutfile: binfile
  (# 
     <<SLOT AoutFileLib: attributes>>;
     
     putNlist:
       (* Put a symbol table entry on file.
        * sym.n_desc ignored.
        *)
       (# sym: @nlist
       enter 
          (sym.word1 (* n_name or n_strx *),
          sym.n_type,
          sym.n_value)
       <<SLOT AoutFilePutNlist: dopart>>
       #);
     
     putSparcExec:
       (* Put SPARC exec header on file *)
       (# e: @exec;
       enter 
          (e.a_dynamic,
          e.a_toolversion,
          e.a_machtype,
          e.a_magic,
          e.a_text,
          e.a_data,
          e.a_bss,
          e.a_syms,
          e.a_entry,
          e.a_trsize,
          e.a_drsize)
       <<SLOT AoutFilePutSparcExec: dopart>>
       #);
     
     putSparcReloc:
       (* Put SPARC relocation entry on file *)
       (# rel: @reloc_info_sparc
       enter 
          (rel.r_address,
          rel.r_index,
          rel.r_extern,
          rel.r_type,
          rel.r_addend)
       <<SLOT AoutFilePutSparcReloc: dopart>>
       #);
  #);
