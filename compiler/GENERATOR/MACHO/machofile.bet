ORIGIN '~beta/basiclib/binfile';
INCLUDE 'macho';

-- lib: attributes --

machofile: binfile
  (# putMachHeader:
       (# 
          header: ^mach_header;
          pb: @putBytes;
       enter header[]
       do (@@header.magic, mach_header_size) -> pb;
       #);
     putMachSegment:
       (# segment: ^segment_command;
          pb: @putBytes;
       enter segment[]
       do (@@segment.cmd, segment_command_size) -> pb;
       #);
     putMachSection:
       (# sect: ^section;
          pb: @putBytes;
       enter sect[]
       do (@@sect.sectname1, section_size) -> pb;
       #);
     putSymtab:
       (# symtab: ^symtab_command;
          pb: @putBytes;
       enter symtab[]
       do (@@symtab.cmd, symtab_command_size) -> pb;
       #);
     putDysymtab:
       (# dysymtab: ^dysymtab_command;
          pb: @putBytes;
       enter dysymtab[]
       do (@@dysymtab.cmd, dysymtab_command_size) -> pb;
       #);
  #);
