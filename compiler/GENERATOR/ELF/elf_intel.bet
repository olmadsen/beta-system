ORIGIN 'elf';
LIB_ITEM 'elf';

(* elf_intel.bet:
 *    INTEL dependent ELF definitions.
 *
 *    $Id: elf_intel.bet,v 1.5 2002-03-15 13:30:45 corry Exp $
 *) 

--LIB: attributes--

(* From linux/elf.h *)

(* This is the info that is needed to parse the dynamic section of the file *)
DT_NULL: 	(# exit 0 #);
DT_NEEDED: 	(# exit 1 #);
DT_PLTRELSZ: 	(# exit 2 #);
DT_PLTGOT: 	(# exit 3 #);
DT_HASH: 	(# exit 4 #);
DT_STRTAB: 	(# exit 5 #);
DT_SYMTAB: 	(# exit 6 #);
DT_RELA: 	(# exit 7 #);
DT_RELASZ: 	(# exit 8 #);
DT_RELAENT: 	(# exit 9 #);
DT_STRSZ: 	(# exit 10 #);
DT_SYMENT: 	(# exit 11 #);
DT_INIT: 	(# exit 12 #);
DT_FINI: 	(# exit 13 #);
DT_SONAME: 	(# exit 14 #);
DT_RPATH: 	(# exit 15 #);
DT_SYMBOLIC: 	(# exit 16 #);
DT_REL: 	(# exit 17 #);
DT_RELSZ: 	(# exit 18 #);
DT_RELENT: 	(# exit 19 #);
DT_PLTREL: 	(# exit 20 #);
DT_DEBUG: 	(# exit 21 #);
DT_TEXTREL: 	(# exit 22 #);
DT_JMPREL: 	(# exit 23 #);
DT_LOPROC: 	(# exit 0x70000000 #);
DT_HIPROC: 	(# exit 0x7fffffff #);

(* This info is needed when parsing the symbol table *)
STB_LOCAL: 	(# exit 0 #);
STB_GLOBAL: 	(# exit 1 #);
STB_WEAK: 	(# exit 2 #);

STT_NOTYPE: 	(# exit 0 #);
STT_OBJECT: 	(# exit 1 #);
STT_FUNC: 	(# exit 2 #);
STT_SECTION: 	(# exit 3 #);
STT_FILE: 	(# exit 4 #);

(* Probably not needed:
 * typedef struct dynamic{
 *   Elf32_Sword d_tag;
 *   union{
 *     Elf32_Sword d_val;
 *     Elf32_Addr  d_ptr;
 *   } d_un;
 * } Elf32_Dyn;
 *)

(* The following are used with relocations *)

R_386_NONE: 	(# exit 0 #);
R_386_32: 	(# exit 1 #);
R_386_PC32: 	(# exit 2 #);
R_386_GOT32: 	(# exit 3 #);
R_386_PLT32: 	(# exit 4 #);
R_386_COPY: 	(# exit 5 #);
R_386_GLOB_DAT: (# exit 6 #);
R_386_JMP_SLOT: (# exit 7 #);
R_386_RELATIVE: (# exit 8 #);
R_386_GOTOFF: 	(# exit 9 #);
R_386_GOTPC: 	(# exit 10 #);
R_386_NUM: 	(# exit 11 #);

