ORIGIN 'elffile';
INCLUDE 'elf_sparc';
INCLUDE '../binarystreambody'
--program: descriptor--
(# bc: @elffile;
   shstr: ^text;
   putb: @bc.putbytes;
   
   t: ^ text; 
   buf: @text;
   B: @binaryStream;
   a,secStart,sectName,sectType: @integer;
do 1->arguments->t[]->putline;

   t[] -> B.restore;
   
   (for i: 16 repeat B.get->put for);
   
   B.getShort->a->putInt; newline;
   B.getShort->a->putInt; newline;

   B.getLong->a->putInt; newline;
   B.getLong->a->putInt; newline;
   B.getLong->a->putInt; newline;
   
   B.getLong->secStart->putInt; newline;
   
   secStart->B.rep.top;
   (B.rep.R.range*4-5) -> a;
   L: (if B.rep.top < a then
          B.getLong->sectName;
          B.getLong->sectType;
          (if sectTYpe
           //SHT_SYMTAB then
              'Symbol table'->putLine;
           //SHT_STRTAB then
              'String table'->putLine
          if);
          sectName->putInt; newline;
          sectType->putInt; newline;
          (for j: 8 repeat
               B.getLong->putInt; newline
               (* SHT_SYMTAB *)
          for);
          newline;
          restart L
      if)

   
#)

