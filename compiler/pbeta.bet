ORIGIN  'compiler';
INCLUDE '~beta/basiclib/systemenv';
INCLUDE '~beta/sysutils/envstring';
BODY 'SYNTHESIZER/synthesizer';
BODY 'CONTROL/translate_asmbody';
BODY 'GENERATOR/BYTECODE/bytecodebackend';
BODY 'GENERATOR/BYTECODE/bytecodetarget';

BODY 'GENERATOR/BYTECODE/bytecodebackend_prebody';

(* INCLUDE '~beta/profiler/profiler'; *)
-----program: descriptor---
systemEnv
(# IC: @InteractiveCompiler
     (# 
        ActivateCompiler::
          (* Force regeneration of rootfragment, assuming it has program slot *)
          (# objdir: @directory
               (# delfile: @deletefile
                    (# nosuch::(# do true->continue #);
                       error::(# do true->continue #);
                    #)
               #);
             e: @diskentry;
          do 'pre' -> objdir.name;
             rootfragment[] -> e.path;
             (if objdir.entry.exists then
                 '.pra'  -> (e.path.name.prefix).append -> objdir.delfile;
                 '.clst' -> (e.path.name.prefix).append -> objdir.delfile;
                 '.prc'  -> (e.path.name.prefix).append -> objdir.delfile;
             if);
          #);
     #);
   (* prof: @Profiler;*)
   
   
do (* prof.prepare;
    * true -> prof.switch;
    *)
   'OBS! Use switch 135 if using the new component syntax \n'
   'Currently only relevant for the compiler developer'
     -> putline;
   
   true -> IC.comp.trans.common.switch[120];
   true -> IC.comp.trans.common.switch[121];
   true -> IC.comp.trans.common.switch[122];
   true -> IC.comp.trans.common.switch[129];
   true -> IC.comp.trans.common.switch[182];
   true -> IC.comp.trans.common.switch[189];
   true -> IC.comp.trans.common.switch[23]; (* Save job file *)
   true -> IC.comp.trans.common.switch[14];  (* NO refNone check *)
   true -> IC.comp.trans.common.switch[327]; (* Use Component.java *)

   (* Supress noise in compiler distributed *)
   true -> IC.comp.trans.common.switch[188];

   'pre' -> IC.comp.targetMachine;

   IC;
   (* false -> prof.switch;
    * prof.conclude;
    *)
#)
