<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<title>Special BETA Constructs for JVM/CLR Support</title>
<link rev="made" href="mailto:beta@daimi.au.dk">
<LINK REL="stylesheet" HREF="http://www.daimi.au.dk/~beta/doc/style/miadoc.css" TYPE="text/css">
</HEAD>

<BODY>

<H1>Special BETA Constructs for JVM/CLR Support</H1>

To facilitate a more smooth interoperability with JVM and CLR, a
number of special constructs have ben introduced into BETA. These
constructs are mostly temporary workarounds, to get things up and
running, and will be attempted handled in a more elegant way in a
future release.

<H2>Restricted Patterns</H2>

A number of special superpatterns are available, which will modify the
way BETA code is mapped to JVM/CLR code. These are:

<OL>
<LI><CODE>ExternalClass</CODE><BR>
...
<LI><CODE>class</CODE><BR>
...   
<LI><CODE>proc</CODE><BR>
...
<LI><CODE>static_proc</CODE><BR>
...
<LI><CODE>cons</CODE><BR>
...
<LI><CODE>static_cons</CODE><BR>
...
</OL>

Notice, that since these are to be used as superpatterns, you cannot
specify a "real" superpattern. We hope to introduce a notation a la
the .NET attributes into BETA, to allow for specifying thiese
restrictions without using superpattern notation.

<H2>Specifying JVM Packages</H2>

BETA code compiled with <CODE>jbeta</CODE> by default is emitted to
the JVM package named <CODE>beta</CODE>. If another package is to be
used (e.g. to because some java code is to use the BETA generated
code), a new BETA property has been defined:

<PRE class=beta>
PACKAGE 'org.foo.bar';
</PRE>

This property can be added in the beginning of the file, typically just
after <CODE>ORIGIN</CODE>.

<H2><A NAME="ExternalClass">External Class Declarations</A></H2>
...
<H3>Specializations of ExternalClasses</H3>
... dopart vs. no dopart ...
<H3>JVM Interfaces</H3>
The Java virtual machine use different calling conventions when
calling interface-methods and class-methods. To inform <CODE>jbeta</CODE> about
this, the pipe character '|' should be used as the first character when
specifying the <CODE>className</CODE> for :

<PRE class=beta>
do '<B>|</B>.....' -&gt; className;
</PRE>


<H3>CLR value types</H3>
The .NET CLR use different calling conventions when
calling methods on reference types and valuetypes. To inform <CODE>nbeta</CODE> about
this, the ad chracter '@' should be used as the first character when
specifying the <CODE>className</CODE> for a value type:

<PRE class=beta>
do '<B>@</B>...' -&gt; className
</PRE>


<H2><A NAME="Constructors">Constructors</A></H2>
There are four ways to declare a constructor in BETA code:

<UL>
<LI><CODE>_init</CODE>
<LI><CODE>__init</CODE>
<UL>
<LI><CODE>%setup</CODE>
</UL>
<LI><CODE>cons</CODE>
<LI><CODE>static_cons</CODE>
</UL>
<H3>Instantiation</H3>
<UL>
<LI>Use &amp;XXX[] -&gt; ...
<LI>Use (arg1, arg2, ..., argN) -&gt; &amp;XXX -&gt; ...
<LI>Call method declared as <CODE>proc</CODE> on object
<LI>Call method declared as <CODE>static_proc</CODE> on pattern
</UL>


<P>
<HR>
<P>
<H2>Overloaded Methods</H2>

Specify procname.

<P>
<HR>
<P>
<H2>Not Yet Specifiable</H2>
<UL>
<LI>Static fields
</UL>


</BODY>
</HTML>