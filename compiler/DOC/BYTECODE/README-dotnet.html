<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<title>BETA.Net README</title>
<link rev="made" href="mailto:beta@daimi.au.dk">
<LINK REL="stylesheet" HREF="http://www.daimi.au.dk/~beta/doc/style/miadoc.css" TYPE="text/css">
</HEAD>

<body>

<H1>BETA.Net/BETA.Java README</H1>

Notes for the preliminary .NET and Java VM versions of the BETA language compiler.
<P>

<TABLE border=2 align=center>
<TR>
<TD>
<SPAN style="color:red; font-weight:bold; font-style:italic;">PLEASE READ SECTIONS A, B, C, D BEFORE USING ANY OF THIS!</SPAN>
</TD>
</TABLE>


<H2>DISCLAIMER</H2>

This is a <B>VERY PRELIMINARY</B> release. The compiler and the generated
programs may fail fatally in many situations. 
<B>USE AT YOUR OWN RISK</B>!


<H2>A. Prerequisites</H2>

<H3>A1. Microsoft .NET Framework</H3>

The current implementation has been tested with version 1.0 of the
Microsoft .NET Framework. We have not yet tested the version 1.1beta
(Everett).
<OL>
<LI>
   The Microsoft .NET Framework Final version must be installed before
using the .NET version of the BETA compiler.

<UL>
<LI>
   Download page:<BR>
   <A HREF="http://msdn.microsoft.com/netframework/downloads/howtoget.asp">http://msdn.microsoft.com/netframework/downloads/howtoget.asp</A>
</OL>

<H3>A2. Java JDK</H3>
<OL>
<LI>
   The Java JDK version 1.4 or later must be installed before
using the Java VM version of the BETA compiler.

<UL>
<LI>
   Download page for J2SE SDK version 1.4:<BR>
   <A HREF="http://java.sun.com/j2se/1.4/download.html">http://java.sun.com/j2se/1.4/download.html</A> 
</UL>
</OL>

<H2>B. Installation of BETA.Net and BETA.Java</H2>

<OL>
<LI>
   There is no installer.<BR>
   Simply unzip <CODE>BETA_Net-&lt;date&gt;.zip</CODE>. This will create a directory named
   <CODE>BETA_Net</CODE>.<BR>
   The compilers nbeta.exe and jbeta.exe resides in the bin subdirectory.
   Make sure you have the BETA_Net/bin directory in your search PATH, if
   you want to invoke the compiler from other directories.

<LI>
   Set <CODE>BETALIB</CODE>.<BR>
   You must set the environment variable <CODE>BETALIB</CODE> to the location of
   your <CODE>BETA_net</CODE> directory before using the compiler.
   Do this in 
<PRE>
         Start->Settings->Control Panels->System->Advanced->Environment Variables
</PRE>
<LI>
   You can set up these environment variables by using scripts placed
   in the top directory of the unpacked directory:<BR>
   If you are using Windows <CODE>cmd.exe</CODE> as shell issue the
   command
<<PRE>
   cmd_setup.bat
</PRE>
   and if you are using Cygwin <CODE>bash</CODE>, issue the command
<PRE>
   . bash_setup.sh
</PRE>

   
<LI>
   Example programs reside in the <CODE>examples</CODE> subdirectory.

<LI>
   Due to a known issue (listed below), you should start by compiling
   <CODE>examples/betaenv</CODE> before compiling anything else:<BR>
<B>.NET:</B>
<PRE>
         cd %BETALIB%\examples    # windows syntax
         nbeta -cw betaenv 
</PRE>
<B>.Java:</B>
<PRE>
         cd $BETALIB/examples     # UNIX syntax
         jbeta -cw betaenv
</PRE>
   (assuming <CODE>BETALIB</CODE> and <CODE>PATH</CODE> set as
   described)<BR>
   The <CODE>-cw</CODE> options to this first compilation prevents 
   display of some confusing errors, that are caused by errors in the 
   compiler during the compilation of the basic environment 
   <CODE>betaenv</CODE>. A single fatal error will still occur when
   using <CODE>nbeta</CODE> for this compilation, though. Please
   ignore this.
<P>
   To simplify this, in the <CODE>examples</CODE> directory,
   a GNU Makefile and a Windows BAT file is present,
   that can do this for you:<BR>
   If you are using Windows <CODE>cmd.exe</CODE> as shell issue the
   command
<PRE>
   make_clean.bat
</PRE>
   and if you are using Cygwin <CODE>bash</CODE>, issue the command
<PRE>
   make clean
</PRE>

<LI>
   Very preliminary background documentation (mostly working notes) reside in the
   <A HREF="index.html"><CODE>documentation</CODE></A> subdirectory.
</OL>
   

<H2>C. Using the compiler</H2>

<OL>
<LI>
   The compiler generating .NET executables is named
<CODE>nbeta.exe</CODE>, and the compiler generating Java class files
is named <CODE>jbeta.exe</CODE>.

<LI>
   The compiler is invoked from the commandline in a shell, e.g. from
   <CODE>cmd.exe</CODE>.
   Also known to work with cygwin bash <A HREF="http://www.cygwin.com/setup.exe">[http://www.cygwin.com/setup.exe]</A>

<LI>
   The compiler is invoked by typing

<PRE class=beta>
nbeta foo
</PRE>

or 

<PRE class=beta>
nbeta foo
</PRE>

   where <CODE>foo.bet</CODE> is a BETA source file containing the definition of
   the <CODE>PROGRAM</CODE> fragment.
   <BR>Likewise for <CODE>jbeta</CODE>.
<LI>
   On the .NET platform, the DLLs and EXEs produced by the BETA compiler should in general
   be verifiable (using <CODE>peverify.exe</CODE>).<BR>
   As a convenience the compiler can automatically verify each DLL/EXE
   just after it is produced. To do this invoke the compiler with
   switch 37, i.e.:
<PRE class=beta>
nbeta -s 37 foo.bet
</PRE>

</OL>


<H2>D. Known preliminary issues</H2>

<OL>
<LI>
   Currently only a subset of BETA is implemented.

<LI>
   All source files constituting an executable must currently reside
   in the same directory.<BR>
   We intent to generate strong assemblies and config files and/or use
   the Global Assembly Cache for solving this later.

<LI>
   Because of (1) and (2) the standard BETA libraries are NOT part
   of this preliminary distribution. A slightly modified version of
   the standard <CODE>betaenv</CODE> is included, though. It can be
   found in <CODE>examples/betaenv.bet</CODE>.

<LI>
   For both the <CODE>clr</CODE> and the <CODE>jvm</CODE>
   platform, if you remove the <CODE>betaenv.ast(L)</CODE> file or
   make changes to betaenv.bet, you <EM>must</EM> recompile
   <CODE>betaenv</CODE> separately with <CODE>nbeta</CODE> 
   or <CODE>jbeta</CODE>  (as
   decribed above) before compiling other
   programs. Otherwise you may get weird semantic errors in programs,
   that are actually correct.

<LI>
   (Not really a limitation, more an addition to BETA)<BR>
   BETA patterns used only as classes can be prefixed with the
   keyword <CODE>class</CODE> and BETA patterns used only as methods can likewise be
   prefixed with keyword <CODE>proc</CODE>. This will reduce the number of
   generated .NET classes.
</OL>


<H2>E. Using the CLR debugger(s)</H2>

<OL>
<LI>
   For a description of debugging using DbgCLR, see
   <A HREF="Debugging.html#dbgclr">documentation/Debugging.html#dbgclr</A>

<LI>
   For a description of debugging using CorDbg, see
   <A HREF="Debugging.html#cordbg">documentation/Debugging.html#cordbg</A>

<LI>
   Possibly we will later generate a <CODE>foo.dln</CODE> file for <CODE>DbgCLR.exe</CODE>
</OL>


<H2>F. Using Visual Studio .NET</H2>
<OL>
<LI>
   For a description of debugging using Visual Studio .NET, see
   <A HREF="Debugging.html#vsnet">documentation/Debugging.html#vsnet</A>

<LI>
   Possibly we will later generate a <CODE>foo.sln</CODE> file for Visual Studio.NET

<LI>
   We intend to investigate the many possibilities that Visual Studio
   offers, by letting it "know" the BETA language, e.g. having syntax
   coloring, allowing it to call the compiler as part of a build etc.
</OL>

<H2>G. Using jdb</H2>
<OL>
<LI>
   For a description of debugging using the Java debugger <CODE>jdb</CODE>, see
   <A HREF="Debugging.html#jdb">documentation/Debugging.html#jdb</A>

</OL>



<H2>H. Cross language support</H2>

<OL>
<LI>
   You may use libraries written in BETA in other languages.
   You just compile the BETA library, using <CODE>nbeta -x</CODE> (no linking), 
   and then reference it from
   the other language.
   A simple example is in <CODE>Bclass.bet</CODE> and 
   <CODE>BclassUser.cs</CODE>/<CODE>BclassUser.java</CODE>. 
   Compilation statements are given in the start of the C# and Java files.
   <BR>
   NOTICE: The DLLs and class files generated for BETA files currently 
   reside in the <CODE>clr</CODE> and <CODE>jvm</CODE> sub
   directories (to avoid cluttering the source directory).

   As described in the compilation directives you must therefore tell
   <CODE>csc</CODE>/<CODE>javac</CODE> where to find the DLL's and class files.<BR>
   Also at run-time you must tell the .NET Framework/JVM where to find
   these DLL's / class files. On .NET This is most easily done by
   making a config file like <CODE>BclassUser.exe.config</CODE>. 
   The content is currently always the same as
   this file (i.e. independent of the actual executable).
   <BR>
   For JVM you specify this using the <CODE>-classpath</CODE> option
   for the Java VM.
<BR>
   The .NET/Java classes generated from the BETA patterns are not yet
   fully documented. Preliminary documentation (working notes) reside 
   in the <A HREF="index.html"><CODE>documentation</CODE></A> subdirectory.

<LI>
   BETA code can call code and use types from other languages.<BR>
   Currently, before using a class/method in an external non-BETA 
   assembly, it must be declared using the predefined patterns
   <CODE>External</CODE> and <CODE>ExternalClass</CODE>. 
   See <CODE>examples/hellobox.bet</CODE>, and
   <CODE>examples/hellographics.bet</CODE> for .NET examples.<BR>
   See <CODE>examples/helloapplet.bet</CODE> for a Java-only example.
   <BR>
   You might also want to stud <CODE>examples/google.bet</CODE>
   which use different external classes for .NET and Java using the
   <CODE>MDBODY</CODE> fragment mechanism in the BETA compiler,
   see
   <CODE>examples/google_clrbody.bet</CODE> and 
   <CODE>examples/google_jvmbody.bet</CODE>.

<LI>
   The cross language support is expected to be significantly improved
   in a later version. E.g. we expect to make the compiler lookup the
   declarations in external non-BETA assemblies/classes, thus avoiding the
   need for declaring these manually.
</OL>


<H2>I. Further information</H2>

If you have any questions, problems, comments etc. regarding BETA.Net
or BETA.Java,
please contact <A HREF="mailto:beta@daimi.au.dk">[mailto:beta@daimi.au.dk]</A>.
<P>
The latest version of this page is always available at
<A HREF="http://www.daimi.au.dk/~beta/ooli">
The Object-Oriented Language Interoperability Homepage
</A>

</body>
</html>
