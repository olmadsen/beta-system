Changes made to v5.1
--------------------

-----------------------------------------------------------------------
OLM:28/9/94     implementation of new primitive operations

                Involves changes to a large number of fragments

                New machine-slots

                rotaleLeft, rotateRight
                gPutBits, gGetBits, gGetSignedBits

                Note:   the 'dr' parameter to byteSwap has been changed to 

                        ar: @adrRegOperand

                Some slots in machine have been changed to dopart-slots
--------------------------------------------------------------------------
OLM: 12/10/94   Bug fix in itemevval: TST/FEJL/exitdynref.bet

                elimination of all trace calls in itemevval

                Bug fix in synthesizer.bet: localMap boolean->integer
                Cmachine gav T1MACHINEATT indgang i proto-tabellen


OLM: 13/10/94   Bug fix for virtual constant patterns as in
                        TST/FEJL/virt.bet

                The problem in TST/FEJL/virt2.bet was the same as
                the one for exitdynref
                
                Bug fix for constant patterns used as static objects:
                        TST/FEJL/constitem.bet

OLM: 14/10/94   Bug fix for missing clearing of register after QUA-check.
                Only relevant for hp, mac, nt, linux and snake.

OLM: 14/10/94   Bug fix for missing clearing of register used to
                pass data-ref from external call. Such reference are
                now passed in data-register.

OLM: 16/10/94   Bug fix in conncetion with this(B).x - stupid typos:-(: 
                        /TST/FEJL/this1

-----------------------------------------------------------------------

KJM: 03/11/94   Check-in of changes made since initial creation of CVS archive:

                added output stream for compiler messages. Currently
                assigned to screen. More stream should be added to 
		differentiate the output.

                Rewriting of compiler argument reader (interactive.bet)
                Added several new arguments, including '--' POSIX compilance...

                Added verboseLevels (compiler messages):
                  verbose, default, actions, nothing

                Fixed several b2c bugs in Cmachine and gen3body

                MPS: made new version 5.0, changed top to hashtable, no longer
                a fragment group.
                OLM: you should get version 5.0 of mps, betaast, pretty. 
		It should however be possible to still use version 4.9, 
		if you prefer. v5.0 of mps is still under development.

------------------------------------------------------------------------

OLM: 19/10/94	Bug fixes for computed remote: TST/FEJL/tstcomprem2

OLM: 22/10/94	Bug fix for virtual/bindings of basic patterns
		and structure references for basic patterns:
			TST/FEJL/simplevarptn.bet

		BUT: the fix relies on the binding descriptor has been
		checked, since its descKind is used. If it is NOT
		checked it cannot be a basic pattern, however, so 
		the fix should work!

OLM: 26/10/94	Bug fix for computed remote: TST/FEJL/COMPRM/comprem4
		added to TST/FEJL/tstcomprem2

		
OLM: 27/10/94	Extension: since Lidskjalv apparently made use of
			A: (# ... #)
		   	B: A(# do .... this(A).foo; ... #)
	        which should have been reported as an error, it is
		now allowed to do as above. I.e. this(P) may now
		be an enclosing pattern or a superpattern of an enclosing
		pattern 

OLM: 5/11/94	Extension: The compiler now accepts qualifications like
			R: ^P.T
		where P is a pattern.

OLM: 6/11/94	Changes made in the checking of attribute-denotations:
		In declarartions like:
			P: <AD>(# ... #)
			X: @<AD>
			Y: ^<AD>
		It is now checked that <AD> is a 'static' denotation:
		-	A name 'A' is always static
		-	In a remote-name 'R.A', 'R' must be a static object
		-	Use of 'this(A).T' is static
		-	Only in 'Y: ^P.T', can 'P' be a pattern
		-	Denotations using 'R[e]', and (foo).bar are NOT static

		This means that e.g. descriptors like:
			R[e].A(# ... #)
			(foo).bar(# ... #)
			R.P(# ... #) where 'R' is a dynamic ref.
		are ONLY allowed in imperatives.

		OBS!: the code generation for ';R[e].A(# ... #)' and
		      '(foo).bar(# ... #)' will  work in most cases,
		      but if 'e' or 'foo' are complicated expressions
		      the compiler may run out of registers. If you trace
		      using opt 193, you will be informed about a register
		      which is NOT frozen.
		      A complete robust implementation of this should be made!
		OBS!: For (foo).bar(# ... #) there may also a problem with
 		      virtual:PRE/ENC. This is a tricky issue. The current code
		      works for a number of examples, but more testing is
		      needed.

		For 	Y: ^R.P where R is a dynamic reference, the compiler
		will, however, ONLY report a warning and suggest to use
			Y: ^A.P	where A is the qualification of R.
		The reason for only giving a warning is that this feature is
		used a lot in the current libraries/frameworks.
		Note: that when using option 19 (no qua warn), this warning
		will NOT be printed.
		A future release may change the warning to an error

OLM: 7/11/94	A warning is now given for 'inner' appearing in singular
		inserted objects like:
			(# do ... (# ... do ...; inner; ... #); ... #)

OLM: 7/11/94	Elimination of unused code in synthlibbody:genadr for for-index

OLM: 7/11/94	Code optimization for if-imp. An if-imp consisting of 
		constant labels will be implemented as an indexed case-imp.

		Preliminary timings have indicated that if there
		are less than 8 constant alternatives, it is more efficient
		to use the origin if-implementation by testing sequentially.
		This is based on the assumption that on average half of
		the alternatives need to tested. Each alternative takes
		3-4 instructions to test. The case-implementation has
		a fixed no of 9-10 instructions. For 8 cases, on average
		4*3 or 4*4 instructions will be executed. Variation on
		delayed nop, and memory access may account for differences
		in counting and measuring.

		Also the case-code is only generated if then min and max
		value of the constants are such that:
			(max-min+1) * <= noOfCases

		I.e. at most half of the case-table is 'wasted'.

		Obviously the above depends on the architecture, and
		perhaps the compiler should chose dependent on the target.
		I.e. we should discuss the above parameters for selecting
		the case-implementation.

		New machine slot: 
			jmpReg - jump to address in register operand
			chkCase - check if case-index is within range

------------------------------------------------------------------------------
OLM: 15/11/94:	Bug fix for missing checker error on
			foo: (#do ... (# do leave foo #); ... #)
		(FEJL/restart1.bet)

		Bug fix for inner in
			foo: (# do ... (#do inner #); ... #)
		Must be empty action (FEJL/inner1.bet)
			
OLM: 17/11/94:	Optimization of array access R[e] to use
			ld [%i0+%l1], ..
		Previously %l1 was explicitly added to %i0

OLM: 17/11/94:	Converted a number of descriptor slots to dopart slots
		and removed some unused ones in SUN4machine.bet

OLM: 18/11/94:	Optimized array element acces by moving shift-instr.
		delay slot in index check.This opt. and the one mentioned
		above for array access saved 15-16 Kbyte code for the compiler
		(with all libaries). Dont know what it means for time, but
		'mange baekke smaa'.

OLM: 5/12/94:	Bug fix for FEJL/comprefnegativedatareg.bet
		Introduced toReg3 in machine. Used in gen1body:newVirt

OLM: 8/12/94:  	Bug fix for ..db files. FEJL/zdb2.bet. In
			---x:a--- P(# ... #)
		descNo 1 is not a real prototype, since it just transfer
		calls to descNo 2, which is the one for P(# ... #).
		I.e. descNo 1 should not be in the ..db files.

OLM: 16/12/94:	New implementation of QUA-check. The old implementation
		was buggy. A QUA-check was not always generated even
		if the checker said so. And a QUA-check could be generated
		even if the checker did not report this. These cases were, 
		however, rare!
		The new implementation generates QUA-check if and only
		if this was reported by the checker.
		In addition a number of superflous QUA-checks have been 
		eliminated.

		(1)	V:<..; s,r: ^V; s[]->r[] (* same virtual }
		(2)     A: (# V: <T ; s: ^v #);
			X: @A; q: @T;
		        q[]->X.s[]		 (* X.V=T since X is static *)
		(3)     AA: A(# V::T1 #);
			Y: ^A; 
			q[]->Y.s[]		(* Y.V=T1 since :: is used *)

		Examples of this may be found in the file

			~olm/beta/system/v5.1/TST/znewqua.bet

		and the folloiwng 'hello-world' for covariance:

		origin'~beta/basiclib/v1.4/betaenv'
		---program:descriptor---
		(# Point:
		     (# x,y: @integer;
		        thisPoint:<Point;
		        equal:< booleanValue
		          (# p: ^thisPoint
		          enter p[]
		          do (p.x=x) and (p.y=y)->value; INNER
		          #);
		     #);
		   ColorPoint: Point
		     (# c: @integer;
		        thisPoint::<colorPoint;
		        equal::<
		          (#
		          do p.c=c and value->value; INNER
		          #);
		     #);
   
		   X1,X2: @Point; Y1,Y2: @ColorPoint;
		   P1,P2: ^Point; C1,C2: ^Point
		do X1[]->P1[]; X2[]->P2[]; Y1[]->C1[]; Y2[]->C2[];
		   
		   X1[]->X2.equal;       '1.'->putline;
		   Y1[]->X1.equal;       '2.'->putline;
		   Y1[]->Y2.equal;       '3.'->putline;
		   X1[]->Y1.equal;   (* compile-time error *)
   
		   P1[]->P2.equal; '4.'->putline;
		   C1[]->P1.equal; '5.'->putline;
		   C1[]->C2.equal; '6.'->putline;
		   P1[]->C1.equal;  (* run-time error *)

		#)

		Try it!!

		It is pretty tricky to implement this stuff. In order to trace
		that the checker and code gen agree on QUA-check, option 60
		may be used. Option 60 will override options 19 and 42
		and trace ONLY QUA-warnings (other warnings are suppressed).

		In addition to the checker warnings for QUA-checks, the
		code generator will also inform about actual QUA-checks being 
		issued.

		THE CHECKER WARNINGS AND CODE GEN WARNINGS MUST BE THE SAME!

		Unfortunately some confuison may appear:

		(1)  (r[],s[])->foo

		     may neede QUA_check for both r[]->foo.enter1 and
		     s[]->foo.enter2

		     The checker will, hwoever, only issue one warning since
		     the AST only allow one message pr node and its immediate
 	             nodes. THis was originally introduced to avoid rolling
                     error messages, but for warnings it is a bad idea.
		
		     The code-generator will issue two warnings!

		(2)   V:< T;  s: ^T; r: ^V;

		      &V[] -> s[] -> r[]

		      here the checker will issue a warning for s[] -> r[],
		      but the code-generator will issue no warning. The reason
		      is that the codegenerator actually generates

			  &V[]-> REG; REG->s[]; REG->r[]

		      and for REG->r[], it knows that REG and r are qualified
		      by the same virtual.

		      The checker could be smarter or the codegenerator
		      could follow the checker more strictly.

		      This situation is actually present in

			   mps/v../property.bet

		      In any case the following reordering will avoid
		      the QUA-check

			 &V[] -> r[] -> s[];

	   	The new QUA-implementation has been tested on the compiler
		itself inclusing ALL used libraries. In adition a number of
		container demo-examples have bee tried.

		The mps/betaast STILL have a large number of QUA-checks.
		The other libraries also have some.

		PLEASE CHECK ALL QUA-CHECKS BEING REPORTED! They may be
		the result of sloppy/buggy programming. 
		Please check if you think the compiler should avoid them.
		Please check if you can actually eliminate them.
		They are expensive.

		The ones I've checked in the mps seem not possible to avoid.
		In e.g. containers there are some that look odd, and which
		I dont understand whether or not they can be eliminated.

OLM: 18/12/94	Changes to ..db files as specified by Soeren

-------------------------------------------------------------------------------
OLM: 19/12/94	Bug fix: mixed expressions of reals and chars 
		(variables and constants) did not work. See FEJL/realchar.bet

OLM: 20/12/94:	Bug fix: sun4/sun4s problem with external calls returning
		reals. No check for busy %f0. Fixed. See FEJL/busyf0.bet

OLM: 21/12/94:	Bug fix: no error message for singular external descriptors.
		See: FEJL/singularexternal

OLM: 22/12/94:	Preliminary implementation of

			W::V where V:< ...

		i.e. a final binding to a virtual pattern. It is VERY 
		preliminary and needs extensive testing!

OLM: 23/12/94:	Changes to refAsg

		Note gen1.bet chkHeap: clear fjernet! 
		KIM: I hope this will not create problems with missing
		cleared registers!!

OLM: 1/1/95:	Optimized implementation of asgRefAdr and asgRefReg for 
		sun4/sun4s. This was done to eliminate superflous
		register copies and register clears. The address of the 
		destination-cell of a ref.asg was previously computed
		in one of %i2,%i3,%i4. It is now computed in %g1, which is
		where ChkRA expects it. And %g1 needs not be cleared.

		Saved 120Kbyte for the compiler!

		KIM: to do this optimization, the slots 

			asgRefAdr and asgRefReg

		were moved from machinebody to SUN4machine. FOR ALL OTHER
		platforms, the original slots from machinebody can just be
		moved to the appropriate FOOmachine.bet. Perhaps similar
		optimizations can be made for some of the other platforms,
		it is probably mainly relevant for RISC machines like SNAKE.

OLM: 2/1/95:	Eliminated thisVal in evVal and its subclasses and instead
		this(xxEvVal) is used. This is cleaner and more efficient,
		but requires more careful programming. In

			R.thisVal->S[]

		thisVal produces a copy of R and sets R.released to true, i.e.
		a subsequent R.release will have no effect. This is NOT the 
		case with
	
			R.{exit this(evVal)[]}->S[]

		where R.release will be a problem. Such a problem has been
		fixed for floatEvVal:radd.

		KIM: for LINUX/NT you should be especially aware of 
		float-errors with this change!
<<<<<<< CHANGES
------------------------------------------------------------------------------
OLM: 3/1/95:	Eliminated docheck:setmode and similar patterns.

OLM: 4/1/95:	Eliminated generation of empty G-parts.  For patterns 
		like  P: (# a,b: @integer do ... #)
		there is no need for a G-part. The prototype has
		the G-entry point for all descriptors and calls this
		address when allocating an object (AlloI, etc).
		If G-part exists, the 'Return' entry-point is inserted
		in the prototype.

		PETER: it should be investigated if it is better to insert
		a '0' (zero) here and then let AlloI test for zero before
		jumping. On Sparc I have made the following measurements:

		1 In the case of no G-part it is cheaper to test for zero
		  instead of jumping, since jumps disturbs the code cash.

		2 If a G-part exists, it is clearly more expensive to test
		  before jumping.

		I dont know what is best in a program with a lot of 
		real and empty G-parts!

		The same applies to (empty) inners.

		This optimization saved 255Kbyte for the compiler!

OLM: 5/1/95:	Fixed bug in code gen for 'fisk'->s[]->r[]
		See FEJL/text2ref.bet

OLM: 7/1/95:	Eliminated M-part for descriptors of the form
		   P(# ... do INNER #)
	        where P has the same form. I.e. the do-part consists of
		exactly one inner. The descriptor may have an enter/exit-part.

		Consider
			A: (# do INNER #)
		        B: A(# do ... #);

		Previously execution of 'B' implied a jsr A.M-part, where
		inner implied a jsr to B.M-part.

		Now execution of 'B' implies a direct jsr B.M-part.

		Previously execution of 'A' implied a jsr A.M-part. This
		is no longer possible. Instead an indirect jsr is made
		via the prototype inner-table for A. This will imply
		execution of Return (See below). Execution of 'A' is thus
		now made in the same way as execution of 'X' where
			X: ^object
		in which case the M-part of 'X' is not know.

		This optimization requires a change of the protype-inner table.
		Previously:

				Return
				A.M-part
			A.Txx:	...

				Return
				B.M-part
				A.M-part
			B.Tyy:	...
		Now:

				Return
				Return		<--------------------
			A.Txx:	...

				Return
				B.M-part
				B.M-part	<--------------------
			B.Tyy:	...

		This change may affect beta.dump and the debugger!!

		This optimization should save execution time and probably
		also result in smaller code-size. The reason that the code-size
		is not guaranteed to shrink is that execution of 'A' above
		via an indirect jump is more expensive on e.g. sparc than
		a direct jsr A.M-part. (12 bytes instead of 4 bytes). 
		For the compiler 30Mbyte of code was saved. The reduction in
		execution time for the tst-programs was hardly measurable.

		The 'A'-situation may be common when using virtuals as in:

			T: (# V:<(# ... do inner #);  ...
			   do ...;V; ...
			   #)

		This change should work without any changes to the RT-routines
		for components (attach, suspend, etc). 

		Currently option 499 MUST be used.

		Probably incompatible with previously compilers. I.e.
		everything from betaenv MUST be recompiled!?

		At least if a predessor file (INCLUDE or ORIGIN) is 
		translated using 499, the fragment must ALSO be 
		translated using 499!

OLM: 8/1/95:	Further optimization of eliminating G-parts. In the first
		optimization, a pattern with an explicit super-pattern
		was always marked as needing a G-part. This is only necessary
		if the super needs a G-part and the super and this both needs
		an origin, and (of course) if this itself has explicit 
		G-code. This saved another 49Kbyte for the compiler of which
		26Kbyte is code.

		Note: Elimination of empty G-parts is ASLO NOT backward
		compatible as with the Mi-part elimination described above.
		Option 499 must there also be used for this optimization.

OLM: 9/1/95: 	Added check for empty file. A file is reported empty if
	  	it has no forms and the only properties are 'comment' and
		'doneCheck'. Note this will give an error if the file
		consists of just a comment. This should be fixed in the mps.

OLM: 16/1/95:	Bugfix in ChkCprocEnter for loop in prefix-chain.
			FEJL/gris.bet

OLM: 16/1/95:	Bug fix for code gen for computed remote: (E).x.y
			FEJL/wilf1.bet

OLM: 17/1/95:	Special putInt, etc for code gen (machine:BC), including
		dopart slot for BS:putS, etc.

OLM: 18/1/95:	Code optimization for sparc for generation of non-local
		virtuals. See SUN4machine: getVirtualOriginStart1/2.
		AdrRegOperand can now also represent o-registers. 
		oRegOperand should be eliminated. And iRegOperand and 
		gRegOperand can be handled the same way

OLM: 21/1/95:	Improved code-generation for simple if. In
		   (if a<b then ... if)
		the boolean exp 'a<b' is no longer transformed into a 
 		boolean value (0 or 1). The conditional jump
		is made directly. This means that the above syntax is 
		faster than
			(if a<b //true then ... if)

OLM: 21/1/95:	Boolean  expressions are now implemented as short-circuit.
		I.e in
		     B1 or B2	B2 is NOT evaluated if B1 is true
		     B1 and B2	B2 is NOT evaluated if B1 is false

OLM: 21/1/95:	All (if B //true then ...if) eliminated from compiler
		(machine specific parts, only sun4s)

OLM: 22/1/95:	Improved codegen for (if NOT B then ... if). 'Not' does
	  	NOT generate extra instructions, since the jump-condition
		is negated. 
		All (if B // false then... if) will now be faster to write as
			(if NOT B then ... if)

OLM: 22/1/95:	Bug fix: superfluous jmp at the end of simple-if with no else.

OLM: 23/1/95:	Bug fix for NONE transfer to external struc-var
			FEJL/nonecallback.bet

OLM: 23/1/95:	Bug fix for loops in superchain in desc of virtual binding
			FEJL/virtualloop

OLM: 24/1/95:	Bug fix for computed-remote in exit-part. See
			FEJL/comprem12.bet
		OBS! Not a complete solution:-(


OLM: 25/1/95:	BUG IN RegAdrInx for LINUX and NT: a non-index-check
		generation is missing. Needed for new primitive operations.
!!!!!!>>>>	Fix mailed to Pingel - MUST also be updated for Linux!

OLM: 31/1/95:	Further optimization of static part objects with no G-part.
		Saved an instruction when storing origin for these.

OLM: 31/1/95:	Removed most a-reg clearings for SPARC. Were previously
		needed since an InxRegAdr:aReg could point into a rep-obj.
		This is no longer the case, see 'OLM: 17/11/94' (first one).
		A-regs are still cleared at first entry into a frame.
		PETER: this needs a GC-debug-test for checking if there
		       are adr.-registers with illegal values!!!
		KIM: It should be checked if this and 'OLM: 17/11/94'
	  	     can also be applied to SNAKE.
		     And, if the CISCS do a superflous clear.

OLM: 31/1/95:	For mch.cpMem, a dataRegOperand may be returned if an
		intermediate register is used for copying. This register
		is then used by the compiler further on. Improves code
		for a->b->c. Also possible for cpMemByte, cpMemHalf, but
		not obvious that it is an improvement, since the register
		will need to cleared - an extra instruction also in the
		case of a->b. Currently only used by SPARC.
		KIM: SNAKE might do the same.
		     And x386 may also, but probably more complicated!

OLM: 1/2/95:	Code optimization in itemEvval. SimpleFixXadr introduced
		as a simpler version of fixXadr for certian simple
		cases. Get rids of a number of push/pop of addresses.

OLM: 4/2/95:	Code optimization for sparc. Instead of

			set 	T111FOO,%i1
			call	AlloI
			nop

		The following code is now generated.

			sethi	%hi(T111FOO),%i1
			call i	AlloI
			add	%i1,%lo(T111FOO),%i1

		Snake and other riscs may do the same - see CallAlloPrim
		in machine.bet

OLM: 5/2/95:	Bug fix in localLabLoadAdr counting for sparc.

OLM: 25/2/95:	Found memory-leak bug! 

OLM: 25/2/95:   Finished new checker for assignment, binary and unary 
		operators. 
		The following tables show legal combinations of operands
		and the result type. 

		Entries NOT shown are illegal.
		Entries marked with '*' are illegal.

		Abbreviations:	int	means 	integer
				bool	means	boolean
				iref	means 	item reference
				cref	means	component reference
				sref	means	structure reference

		NONE is both an iref and a cref.

		In addition to the above types, there is also a primitive type.
		The result of any primitive operation %OP has this type.
		This type is compatible with most other types. I.e. it can e.g
		be assigned compared with/to int, bool, char.
		A complete specification is not yet available.

		For assignment binary operators rows and columns show left 
		and right operands respectively, and the elements show the 
		result type.

		Assignment: -> 

			     | int  | char | real | bool | iref | cref | sref
		       	-----------------------------------------------------
			int  | int  | char | real |  +   |  *   |  *   |  *
			-----------------------------------------------------
			char | int  | char |  *   |  *   |  *   |  *   |  *
			-----------------------------------------------------
			real | int  |  *   | real |  *   |  *   |  *   |  *
			-----------------------------------------------------
                        bool |  *   |  *   |  *   | bool |  *   |  *   |  *
			-----------------------------------------------------
			iref |  *   |  *   |  *   |  *   | iref |  *   |  *
			-----------------------------------------------------
			cref |  *   |  *   |  *   |  *   |  *   | cref |  *
			-----------------------------------------------------
			sref |  *   |  *   |  *   |  *   |  *   |  *   | sref


		Binary operators:  +  -  *  div

			     | int  | char  | real
		       	---------------------------
			int  | int  | int   | real
			---------------------------
			char | int  | int   | ERROR
			---------------------------
			real | real | ERROR | real


		Binary operator:  mod

			     | int  | char 
		       	-------------------
			int  | int  | int  
			-------------------
			char | int  | int  

		Binary operator:  / (char will probably be eliminated here!) 


			     | int  | char  | real
		       	---------------------------
			int  | real | real  | real
			---------------------------
			char | real | real  | ERROR
			---------------------------
			real | real | ERROR | real

		Binary operators:  =  <>


			     | int  | char | real | bool | iref | cref | sref
		       	-----------------------------------------------------
			int  | bool | bool | bool |  *   |  *   |  *   |  *
			-----------------------------------------------------
			char | bool | bool | bool |  *   |  *   |  *   |  *
			-----------------------------------------------------
			real | bool | bool | bool |  *   |  *   |  *   |  *
			-----------------------------------------------------
                        bool |  *   |  *   |  *   | bool |  *   |  *   |  *
			-----------------------------------------------------
			iref |  *   |  *   |  *   |  *   | bool |  *   |  *
			-----------------------------------------------------
			cref |  *   |  *   |  *   |  *   |  *   | bool |  *
   			-----------------------------------------------------
			sref |  *   |  *   |  *   |  *   |  *   |  *   | bool

		Binary operators:  <  <=  >  >=


			     | int  | char | real | bool | sref
		       	----------------------------------------
			int  | bool | bool | bool |  *   |  *
			----------------------------------------
			char | bool | bool | bool |  *   |  *
			----------------------------------------
			real | bool | bool | bool |  *   |  *
			----------------------------------------
                        bool |  *   |  *   |  *   | bool | *
			----------------------------------------
			sref |  *   |  *   |  *   |  *   | bool


		Binary operators:  and or

			     | bool
			------------
			bool | bool

		Unary operators:  +  -

			int, char, real result type is the same as operand type

		Unary operator:  not

			bool	result type is 	bool


OLM: 25/2/95:	Fixed problem with missing dataReg dealloc for reg2float.
			FEJL/regoverflow.bet

OLM: 25/2/95:	Incorporated KIMs changes to SUN4machine for handling 'set'.

OLM: 25/2/95:	Moved do-part of pattern control to new slot in controlbody
=======

--------------------------------------------------------------------------

KJM: 5/1/95:    Check-in:

		Four output-streams added to system.bet:
		  infostream,tracestream,messagestream,bugstream
		Used everywhere.

		Changes in Cmachine, gen2body,  for PowerPC
		Changes in dobody for optimizing b2c label generation
		Hacks in genlib for b2c Pascal external generation
		Added file Casmlink_ppc (for PowerPC job file generation)
		Added file Cbeta_ppc
		
		Added virtuals groupSaved, semanticErrors in system.bet
		Called from control and checkbody, to be used by Sif.>>>>>> 1.
----------------------------------------------------------------------------

OLM: 27/2/95:	Fix missing dataReg clear for %and, etc

OLM: 27/2/95:	Changed 'add' to 'or' for loading prototype. (sun4/sun4s)

OLM: 28/2/95:   Bug in evaluations like R[i]##->h##. See FEJL/sb*.bet
		Als fixes dataReg negative in (if R[i]## ... if). sb3.bet.

OLM: 28/2/95:	Bug in new typechecking - old unary stuff deleted.

OLM: 28/2/95:	SetHi/setLo used putInt to write integers. Gave problems
		with large integers like 0x80000000. 
		Instead a putHex is used. (sun4s/sun4)

OLM: 28/2/95:	Bugfix for crash after certain semantic errors, caused
		by new type checker.

OLM: 1/3/95:	Bug fix in PutSet in SUN4machine. OR should be AND.

OLM: 3/3/95:	Added machine slots for supporting generation of binary 
		sparc code:

			targetEntryPointInfo addTargetInfo

OLM: 7/3/95:	Checker error when using data in external cproc.
		Change to chkCprocDesc:handlecStrucPar. Fix in
		initTerm also necessary. In fact there was a bug that
		might imply a missing check of data-subs for fragments
		NOT being parsed.
		Error example in elfbody.bet and FEJL/data{1,2}.bet

OLM: 7/3/95:	Bug fix in new type checker: FEJL/avs.bet

-----------------------------

OLM: 8/3/95:	Merge with latest changes from DAIMI.
		Moved sun4(s) dependency from dobody:gencase to SUN4machine

OLM: 9/3/95:	Changed bleu in gBle to ble for SUN4machine, but bGle
		has apparently never been used?

OLM: 17/3/95:	Completed sun4s version for generating ELF-files directly
		without using .s-files and the assembler.

		Relevant files:

			SUN4SBbeta.bet
			SUN4Bmachine.bet
			SUN4SBasmlink.bet
			SUN4Self.bet
			sparc.bet
			ELF/*

		To generate a compiler, SUN4Sbeta.bet MUST be compiled USING
		beta5.1 - It cannot compile using beta5.0, since it makes
		use of new syntax for primitive operations.

		CAUTION must be taken when compiling:

		1.	make shure that SUN4Sbeta and SUN4beta
			(i.e. the version generating .s-files)
			are compiled with beta5.0 - ALL involved files
			must be compiled using beta5.0

		2. 	Then compile SUN4SBbeta using beta5.1

		This is currently necessary since the ELF compiler
		files are in the  v5.1 directory.

		Eventually beta5.1 will be frozen and the ELF-compiler
		will be a new version. And from then on ONLY the ELF-compiler
		will be supported.

		The ELF-compiler can make an assembly listing of the generated
		code using switch 18. The assembly file is written to a file
		'foo...s'. It is NOT on 'foo..s' in order NOT to confuse
		the dependency analysis. This will probably be changed in
		a future version.

		Switch 39 together with 18 dumps the code in hex instead
		of assembly.

		An .o-file can be inspected using e.g

			dump -vcghortf foo.o

		New slot:  entryPointsInsert:doPart

OLM: 17/3/95:	Bug fix for error in virtual binding: FEJL/virtorg.bet

OLM: 17/3/95:	Fixed char +OP char to be of type integer instead of char

OLM: 18/3/95:	Bug fix in docheckbody.bet: bifrost/bdraw/actions computed
		remote triggered call of  'BsPn->ChkVB', but BsPn has
		no value here. Changed to 'sort->ChkVB'!

OLM: 18/3/95:  	Bug fix in evval2.bet:realEvval:asgtoReal: use of cpmem
		must deAlloc the returned dataRegOperand

OLM: 18/3/95:	The compiler now in interactive mode accepts all arguments 
		that may appear on the command line. Minor changes:

		- an argument error will in interactive mode NOT make
		  the compiler stop and it will NOT print all the 
		  valid arguments. It prints an error message and informs
		  that "-h" will print all valid arguments

		- a switch list '-s 18 19 0' will no longer need the
		  terminating zero. Any non-number will terminate the
		  sequence as in

			beta5.1 -s 18 19 tst
		
		- Note: a line of input in interactive mode will ALWAYS
	          imply a compilation even if no fragment file is given.
		  The terminating newline will imply a compilation
		  like an empty like. This might be a surprise to the
		  user in some cases. E.g. when typing '-h'

		- It is a bit hard to test all combinations, so there may
		  be some surprises:-)

OLM: 18/3/95:	Bug fix for compiler call with empty argument as in
			beta5.1 ""
		Does no longer give index error. Strange error messges may
		appear for calls like
			beta5.1 "-w -q tst"

----------------------------------------------------------------------------

OLM: 23/3/95:	Bug fix for sun4s/elf compiler: push of o-register in
		external calls

OLM: 25/3/95:	Bug fix sun4s/sun4s compilers (including elf): error in
		push/pop of float registers: FEJL/pushfloat.bet

OLM: 29/3/95:	Bug fix for data reg overflow in boolean exp: FEJL/kjm1.bet

OLM: 30/3/95:	Copied basiclib/v1.5/numberio*.bet to the compiler directory
		since the v1.4 version og getreal do not work. system.bet
		and SUN4Bmachine.bet includes this version of numberio.
		The problem occured for float constants for ELF-compiler
			FEJL/bfloat*.bet

OLM: 1/4/95:	Bug fix in boolexpeval and other places in evbody.bet: 
		baseadr[] => baseAdr.copy. Freja problem as in : FEJL/toby1.bet

		Perhaps only necessary with .copy if baseAdr is used again
		later in evbody?

OLM: 4/4/95:	Sparc/sun4 version for generation of a.out. New files
			SUN4Bbeta.bet
			SUN4aout.bet 
			SUN4Basmlink.bet
			A_OUT/*

OLM: 5/4/95:	Adapted basiclib/v1.5/numberio for use in compiler.
		Special version needed since compiler is basiclib/v1.4 based.
		In addition v1.5/numberio uses new low level syntax 
		which is NOT supported by beta5.0 and beta5.1 MUST be 
		compiled using beta5.0 to ensure proper bootstrap sequence.
		Some routines have been eliminated from the special numberio.
		When basiclib/v1.5 compiler version is made, v1.5/numberio
		should be used.

OLM: 6/4/95:	Bug fix in itemevval:asgToItem. Problem when exit R,
		where R: ^T (i.e. dynamic). Similar to previous fix in
		fixXadr. FEJL/guirefnone*.bet

PA: 10/4/95:
		Changed job files so that make files are invoked from the
		directory, that they reside in.

PA: 10/4/95:
		Fixed some ..db offsets in SUN4machine.bet

PA: 10/4/95:
		changed "d0Tmp: word 0" to "d0Tmp: long 0" in
		HPmachine.bet

OLM: 10/4/95:	Added switch 47 to also generate endian information in 
		prototypes for big machines on the request of Alexandre.
		This should considered to be generated always.

OLM: 11/4/95:	Added variable Mjolner: ^text to interactive.bet. If none
		it is initialized to 'Mjolner'. Can be defined in
		e.g. NTbeta to e.g. 'Mj?lner'->IC.Mjolner[], etc.
		Must ALWAYS consists of 7 chars in order NOT to corrupt
		the formatting of the demo text.

OLM: 12/4/95:	Bugfix in virtual:thedesc for finalbinding problem with
			FEJL/rene1.bet

OLM: 12/4/95:	Change to controlbody such that for 'unknown property'
		it is printed for which file the problem is. Small change
		to text of 'has no value in file'.

OLM: 12/4/95:   Changed asmext for SUN4SBasmlink and SUN4Basmlink to
                return '-BETA-'. This means the the dependency analysis checks
                for files 'foo-BETA-' instead of 'foo..s'. This is to allow
                for 'foo..s' to exists when mixing e.g. SUN4Sbeta and
                SUN4SBbeta. Originally asmext returned the empty string, but
                this may confuse the dependency analysis if the binary 'foo'
                is placed in e.g. 'sun4s'.

-------------------------------------------------------------------------------

OLM: 19/4/95:	Changes in chkdescbody, genlib and SUN4machine to support
		general repetitions.

		The change to regAdrIndex in SUN4machine must be made in
		a similar way for all platforms, i.e. any XXXmachine.

		The corresponding run-time routines MUST be implemented.

		Currently switch 48 must be used. 

SPD: 19/4/95:	Optimized PushAdr in LINUXmachine to be smaller, faster and
		not use any registers.

PA: 20/4/95:	Changed RegAdrLoadAdr in SNAKEmachine to use the same strategy
		as in SUN4machine. Some big guienv programs would otherwise 
		get a bus error.

OLM: 20/4/95:	Changes in do-body to support leave/restart P where P
		is a general pattern and leave/restart/P is within
		a nested inserted pattern

		The corresponding run-time routines MUST be implemented.

		Currently switch 48 must be used. 

OLM: 23/4/95:	Bug fix for sun4(s): adrReg overflow. Introduced adrTmp
		and changed SUN4machine:RegAdrLoadAdrRegOp.
			FEJL/opg2.bet
		Same change necessary for SUN4Bmachine. - done -

OLM: 24/4/95: 	Bug fix: evval2:computedEvVal:toDataRegX. Changed dr.deAlloc
		to relese to elim. dataReg negative in 'enter R.new'.
		FEJL/newRep.bet, FEJL/fib2.bet

PA: 25/4/95:	Changed A_OUT/aoutfile and ELF/elffile to use binfile.
		Moved PutBytes from aoutfile/elffile to binfile.
		Changed binfile SLOTs to be dopart slots.

PA: 25/4/95:	Added ELF/elf_intel.bet with intel specific ELF definitions

PA: 26/4/95:	Fragmented a lot of code from Machinearray to MachinearrayBody.
		Changed some slots from descriptor to dopart.

PA: 26/4/95:	Added ELF/elffile_intelbody.
		The ELF file produced by ELF/elfuse on "ceres" (Linux 1.2),
		is accepted by ld if added to existing link directive.
		ld accepts mixtures of a.out and ELF files.
		Linux object files may be inspected by 'objdump -x file'
		or 'objdump -xd file'. The latter includes disassembly.

OLM: 29/4/95:	Changed regAdrIndex in SUN4[B]machine such the the
		size of repetition prototype for general repetitions is
		32 - NOT 16 as for simple repetitions.

		This change MUST be performed for ALL platforms.

OLM: 29/4/95:	Checker did not catch error in R1[]->R2[] where R1,R2 are
		repetitions; FEJL/repfasg1.bet

OLM: 29/4/95:	Bug fix: An 'super has no inner' error appeared in Valhalla
		and Soerens objectbrowser and jlk's ditto, even if the
		super actually had an inner. Pattern docheck:CheckBinding
		had an enter parameter preDesc, which was NOT declared
		in this pattern and therefore collapsed with a glocal variable
		in checkDesc. Renamed and declared to originPreDesc.

OLM: 29/4/95:	Added support for ..go files in SUN4Self.bet and SUN4aout.bet

---------------------------------------------------------------------------

OLM: 1/5/95:	Fixed compiler to inline exit-part of patterns like
			NoWork: (#exit inner #)
		Used by Dave Ungar in his richards.bet benchmark.

PA: 1/5/95:	Changed numberio*.bet to compilernumberio*.bet
		Changed SLOTS in compilernumberio*.bet likewise.
		To avoid linker error in sif, that uses basiclib/v1.4/numberio.

OLM: 7/5/95:	Bug fix evbody:strucRef for R[i]##=T##; toReg2->toReg3;
				FEJL/MEGL/*

OLM: 7/5/95:	Changed 0->ldCst to gClr in evval2:computedEvVal.toDreg

OLM: 7/5/95:	Implemented getByteAt, ...; the get operations were all
		missing. tstnewprim updated. New machineSlot:

     *******			ldSignedVl

		MUST be implemented for all XXXmachine.bet 

OLM: 8/5/95: 	Bug fix for this(b)[] appearing in situations like
		A: (# B: A(# do ... this(B)[] ... exit this(B)[] #)
		See comment in chkevalbody:chkExeOrRef, FEJL/thisBug

PA: 9/5/95:	Added/updated

			LINUXBmachine.bet
			LINUXBbeta.bet
			LINUXelf.bet
			LINUXBasmlink.bet
			intel.bet
		
		which is a start of a binary compiler for linux.
		The instructions in mini.bet:

			origin 'tstenv'
			---program:descriptor---
			(# a,b: @integer;
			do a->b;
			   b->a;
			   a+b->a;
			#)

		are now generated correctly, except for register numbers, 
		which become 0 (%eax) most of the time.

PA: 15/5/95:	Updated LINUXBmachine:{allocA,allocD,regL2F} according to Ole's
		instructions.
		The above mini.bet is now generated correctly!
		When comparing with an object file produced by the assembler,
		this object file should first be transformet into elf format
		using

PA: 15/5/95:	Changed names:
		LINUXBmachine.bet -> INTELBmachine.bet
		LINUXelf.bet -> INTELelf.bet

		Split INTELBmachine into INTELBmachine and INTELmstate.
		INTELelf now has origin in INTELmstate. Makes compilation
		turn around time smaller.
------------------------------------------------------------------------------

OLM: 16/5/95:   Changed the type of arguments of machine: ldVl, cpReg, etc to
		be address, registerOperand, etc.

      *****	Warning: this may imply that you get checker errors
		in some XXXmachine.bet. A number of errors were present
		in the various SUNxxxmachine.bet
		It should, however, be possible to fix these errors

OLM: 16/5/95:	Fixed remaining 2 power optimization for div/mod - was
		missing for all but simple addresses. 



		   objcopy --output-target=elf32-i386 <as.fname> <elf.fname>

		Then the files can be compared using objdump.
		To generate a map of the code produced by as call as like this:
		
		   as -als -o foo.as.o foo..s > foo.as.s

		This will include a dump of each byte generated for the object file
		Remember that 32 bit literals in the code have little 		byte order.

SPD: 17/5/95	Updated files to accomodate for the support of multiple SDKs
		on nti. This involves putting the asm/obj files into a subdir
		'nti/<sdk>' instead of just 'nti'. Also '$' must be expanded
		properly to become 'nti/<sdk>'. It is therefore very important
		to use $ instead of nti in PROPERTIES!!!!

		Updated some tst programs to support nti object files (at
		last)!

		Updated NTIbeta.bet, NTIasmlink.bet and NTImachine.bet. First
		time ever!

PA: 18/5/95:	Added a few more isXXXop to machine.
		Introduced trueValue to make smaller code.
		Use of isXXXop in INTELBmachine.
		Added RegisterOperandLib in machine and put freg attribute
		into it in INTELBmachine.

PA: 18/5/95:	Fixed format of one error message in docheck.
		Fixed a few details in option explanations in interactive.bet

OLM: 23/5/95:	Fixed problmes with chars like '\141' not always being
		accepted as a char, but sometimes as a text. There is now
		a general fragment 'scanBetaText' (in compiler directory)
		which scans a string 'Foo\n bar\141\\' and interprets
		'\n', '\141', etc as single chars. It defines new
		textlib attributes and could be moved to basiclib.

OLM: 29/5/95:	Changed BOBS lexer to disallow carriage return (cr) and 
		newline (nl) in strings. Any character x escaped as in
		\x is allowed. This includes nl,cr,fs, etc. Of course this
		rule does NOT overide the the interpretations of \n,\t,etc.

OLM: 29/5/95:	Changed BOBS lexer such that nl and cr are NOT allowed in
		nonterminals. 

OLM: 30/5/95:	Fixed semattbody:isStandard to handle FEJL/slotstruc:
			foo: <<SLOT foo:desriptor>> ... foo##

OLM: 30/5/95:	Fix bug such that 'negative' options like "-s -5" works

PA: 30/5/95:	Added regF operation to registerOperand.
		Used on linux and snake to get physical register number.
		Added saveDbgInf pattern to avoid having to include
		machinebody in XXXmachine.bet.
		Affected: machine.bet, machinebody.bet, XXXmachine.bet.
		In XXXmachine.bet the following slots must be defined:

			--DataRegOpRegF: dopart--
			--AdrRegOpRegF: dopart--
			--FloatRegOpRegF: dopart--

		If the regF operation on register operands is not used in the
		XXXmachine, the three slots can be left empty. 

PA: 30/5/95:	Temporarily commented out dividion optimization in evlib.bet, 
		because	of error.

PA: 30/5/95:	Added support for valhalla in HPUX9PAbeta.
		That is: support for ..gs and ..go files, betarunv.o,
		and checked all incIP.
		Affected files: HPUX9PAbeta.bet, SNAKEasmlink.bet
		SNAKEmachine.bet.

PA: 30/5/95:	SNAKEmachine.bet:
		Now saves %r3 (this) on RefStack across external calls.
		Callprimitive is now implemented directly instead
		of using CallCproc (which conflicts with the above fix).
		Added Push/Pop2Refs to optimize situations with
		two sequential pushes/pops.
		Checks on regF in most places where COPY reg1, reg2
		is generated to avoid copies from a register to itself.

PA: 30/5/95:	Progress in binary intel generator.
		The program

			origin 'tstenv';
			--program: descriptor--
			(# r: [7]@char;
			do (for i:7 repeat
			        i -> r[i]
			   for)
			#)

		is now generated correctly, except that local jump offsets
		are numerically 4 too small.
		Affected: INTELBmachine.bet, INTELmstate.bet, intel.bet.

PA: 1/6/95:	The above error in local jump offsets has now been fixed.
		Also general emitALUinst has been implemented.

OLM: 1/6/95:	Eliminated from machine.bet: ByteRegadr, ByteInxRegAdr; the 
		following slots can be removed from all XXXmachine.bet:

		<<SLOT ByteRegAdrPutOp:descriptor>>
		<<SLOT ByteRegAdrIndex:descriptor>>
		<<SLOT ByteInxRegAdrPutOp:descriptor>>
          	<<SLOT ByteInxRegAdrLoadAdrOp:descriptor>>

OLM: 1/6/95:	Bug fix for virtual bindings
			V:: <<SLOT ...>>; V::< <<SLOT ... >>;
		an error msg is now given. FEJL/baat.bet

OLM: 1/6/95:	Bug fix for certain cases of (R.p).f(# ...#);
			FEJL/compremsb{1,2}.bet
		This construct has NOT been used very much and there may
		easily be more problems

OLM: 1/6/95:	Bug fix wen an external call-back routine is called from
		Beta. Error message is given by code generator, but should
		in the future be done by checker. Problem is that when a
		pattern is called it may not be know if it is externall
		or call-back. A similar ad-hoc check is made to ensure
		that externals with enter-parameters actuallly get enter values

OLM: 1/6/95:	Bug fix for &this(P) in checker - an error is given now.
			FEJL/newthis.bet

OLM: 2/6/95:	Changed BOBS such that \<nl>, \<cr> and \<fs> are NOT allowed;
		compiler gives warning if a null-char is in a string.

PA: 2/6/95:	Fixed LINUXmachine so that it compiles with the 
		improved types of ldVal etc (OLM: 16/5/95).

PA: 2/6/95:	Implemented solution for save of d0 in temporary
		memory location in motorola differently:
		Used to be implemented using textOperands, but this was
		impossible with the stricter types for ldVal and stVal.
		Instead a global LocalLab "d0Tmp" is declared in machine
		and defined where the textual label was previously
		defined (in beginPrototypes in XXXmachine, where XXX is
		HP or MAC).
		The usages of this label (CODEmachine) is then via two
		new patterns staValInLab and loadValFromLab in 
		machine.

PA: 2/6/95:	Fixed various errors in HPmachine arising from
		the stronger type check on ldVal, stval etc.
		Especially there has been many errors in the two
		slots asgRefAdr and asgRefReg, which have been 
		changed to be identical on HP, LINUX, SNAKE.
		Do they belong in XXXmachine?
		
PA: 2/6/95:	Fixed ldSignedVl for HPmachine.
		tst now works on hpux8 except for tstreal (operand
		mismatch in assembler) and tstcproc (pattern data
		operations all fail).

PA: 2/6/95:	Further bound offset in inxRegAdrOp in machine.

PA: 2/6/95:	Added increment of machine.IP at jump table generation

OLM: 3/6/95:	Fixed power2 optimization for div and mod to work for
		negative numbers. And fixed mult,div,mod to handle
		negative power-2. I.e.

			E * l, -E * l, E * (-l), -E * (-l)
			E div l, -E div l, E div (-l), -E div (-l)
			E mod l, -E mod l, E mod (-l), -E mod (-l)
		
		Note, this optimization is rather tricky, so please test
		carefully on all platforms.The following rules are used:

			E * p   = E * -p
			E div p = E div -p
			E mod p = E mod -p and sign(E mod +-p) = sign(E)

OLM: 3/6/95:	Recall/change of 1/6/95 above for call-back. It is now possible
		to call a call-back routine from Beta. This turned out to
		be just as easy as to mark an external as being 'real'
		external or for callBack. Valhalla needs to know the
		descriptors that have a prototype. Prototypes are generated
		in the following situations:

			((desc.descKind = general)  and not desc.insertable)
			or
			(desc.descKind = callBack)

		descKind   = byte[0] of  desc.kind = sem.att. no 5
		insertable = bit[13] of  desc.kind

		OBS! Requires a complete re-check starting from betaenv;
		otherwise execution of a call-back from Beta is an empty action

---------------------------------------

OLM: 12/6/95:	Bug fix; evval2.bet; floatEvVal:unMinus. 
		Reuse needed for result reg.

OLM: 12/6/95:	Bug fix; gen1body; putInx,getInx;
		Original elimination of ByteRegAdr, etc. did not work for 
		Linux, Nt, Mac, and HP

PA: 12/6/95:    Fixed 3 errors in LINUXmachine:
                isPrimRegOp is now furhterbound in primRegOperand.
                Added missing tab in stValInLab.
                Implemented ldSignedVl correctly.
                tstcproc still fails on LINUX (tstdata, tstcproc).
 
PA: 14/6/95:    Fixed errors in evval2.bet and gen1body.bet according to Oles
                instructions.
                Fixes the error that cstructs did not work on non-RISC's
                after elimination of ByteInxRegAdr etc.
 
PA: 19/6/95:    Fixed errors in machine.bet according to Oles instructions.
                Fixes the error that a bootstrapped beta5.1 on linux
                gived AdrReg negative errors.

OLM: 20/6/95:	Bug fix; machine.bet; toCallReg; 
		adrReg was released before used, which confused ix86 register 
		assignments; showed up when translating  compiler by itself

OLM: 20/6/95:	New feature; system.bet ; compiler; 
		The compiler has a new exception

			fragmentError:< exception
		          (# group: ^AST.fragmentGroup; errMsg: ^text ;
          		     CloseGroup: ^object;
                          enter(group[],errMsg[],CloseGroup[])
			  ...
			  #)

		This exception is called whenever there is a fragment error
		like no 'free slot for fragment'.  The compiler (interactive)
		calls CloseGroup which closes the group. Sif and other
		tools might not want to do that. See interactive.bet for
		example of use.
 
PA: 21/6/95:    Made userDefinedBetarun global in asmlink (actually there
                was already a global one, but it was not assigned in
                addBetaRun???
                Added '-lsocket -lnsl' in SUN4Sasmlink for userDefinedBetarun
                and when compiling with -g. Needed by valhalla part of RTS on
                Solaris.
 
PA: 22/6/95:    Changed cmpFloat in HPmachine because stupid HP assembler
                does not understand "fcmp.d %freg,%freg".
 
OLM: 21/6/95:	Bug fix; synthlibbody.bet, machine.bet, SUN4machine.bet
		and a some more files; general repetitions.
		Fixed general header size to be 28; fixed bug in index
		calculation for general virtual and slot defined reps.

OLM: 22/6/95:	New feature/bug fix; synthlibbody, machine,SUN4machine; 
		fixed remaining problmes with general repetitions;
		seems to work!

------------------------------------------------------------------------------

OLM: 24/6/95:	Bug fix; virtual.bet; remote. FEJL/madsnvirt.bet
			(# theA: @ (# B: (# C:(# V:< charValue #)#)#);
			   theB: @theA.B(##);
			   theC: @theB.C(# V::< (# do 'b'->value #)#)
			#)
		Bug problem since C is not local to theB, but theA.B.
                See comment in pattern remote in virtual.bet

OLM: 27/6/95: 	Bug fix; synthlibbody.bet; genAdr;
		fejl omkring manglende 8-byte alignment for index til
		generelle repetitions

OLM: 27/6/95	Bug fix; initterm.bet; unexpanded nont's; FEJL/Band.bet
		Som unexpanded nonterminals gave compiler crash.
		
PA: 28/6/95:	Made special case for MinInt in PutI in machine.bet.
		Without this special case the code for the following program
		would not assemble on snake, linux, nti:

			ORIGIN '~beta/basiclib/v1.4/betaenv';
			--PROGRAM: descriptor--
			(# 
			do 0x80000000 -> putint;
			#)

PA: 28/6/95:	Made "beta --mute" really mute:
		In interactive.bet: Set switch 90 if --mute.
		In synthesizer.bet: Test for verboselevel before
			putting out '.' before prototype generation.
		In initterm.bet: Test for verboselevel before
			putting out special letters in check of betaenv.
		In docheck.bet: Test for verboselevel before
			putting out information about lst file after warnings.

		Now the warnings that cannot be suppressed even with -w
		is the only output when using --mute.

OLM: 28/6/95:	Bug fix; chkdescbody.bet; chkdesc; 
		The 3/6/95 call-back fix did not work for subpatterns of
		callBack patterns.

OLM: 28/6/95	Function change; checklibbody.bet; markDesc;
		The 3/6/95 call-back fix was NOT beta5.0 compatible;
		The call-back fix is now only made when switch 499 is used.

OLM: 28/6/95	Revision of 20/6/95 fragmentError interface that has been
		changed to (the actual exception is called fragmentError)::

		     fragmentExceptionType: exception
		       (# FG: ^AST.fragmentGroup;
		          FF: ^AST.fragmentForm;
		          slot: ^AST.slotDesc;
		          errNo: @integer;
		          errMsg: ^text;
		          CloseGroup: ^object;
		       enter(FG[],FF[],slot[],errNo,errMsg[],CloseGroup[]) 
		       do errMsg->msg;
		          INNER 
		       #);

		FF[] and slot[] may be NONE; Sif should always check for this
		since there may be errors introduced in the changes.
		errNo means:

		0:  	"Error in property list"
		    	see 1st call of fragmentError in controlbody;
		        FF[] = slot[] = NONE

		1-7, 	see fragErr in semattbody; either FF or slot
			is NONE; be careful!

-------------------------------------------------------------------------------

OLM: 29/6/95	Bug fix; control*.bet; FEJL/fisk*.bet
		test for empty file did not always work.

OLM: 29/6/95	Exception interface; compiler;
		Added fragment group to compiler MsgException;

		Sif should carefully check that FG[]<>NONE.

		The error messages may have to be cleaned up
		and some of the messages are still printed on 
		messagestream and not to the exception msg text.

		In general the compiler should be cleaned up about
		all error messages and use exceptions.

PA: 4/7/95:	General repetitions:
		Moved exact_log2 from evlib.bet to com.bet to
		avoid repeating the code in each XXXmachine.bet.
		Updated RegAdrIndex in all XXXmachine except SUN4machine
		to handle general repetitions.
		tstgeneralrep now works on sun4s, sun4, hpux9pa.
		Not yet tested: New, Extend, Copy, CopySlice for all
		4 general repetition types.

PA: 4/7/95:	Removed unnecessary include of machinebody in
		several XXXmachine.bet.
		Removed include of ~beta/basiclib/v1.4/numberio
		in NTImachine. May be the cause of the current problem
		on NTI (compiler crashing during test of tstenv, 
		crash happens in getNumber).
		No turned out to be a "qword" that should be a "dword".

PA: 4/7/95:	Cmachine.bet:
		Implemented ldSignedVl. stValInLab, ldValFromLab.
		Fixed RegAdrIndex to handle general reps.
		Removed ByteReg* slots.
		Fixed other errors, so that Cmachine now compiles.

PA: 5/7/95:	d0tmp error.
		The MC68 specific d0tmp lab was initialized in initGen.
		This is however, called several times.
		Fixed in HPmachine by doing it in initMachine instead.
	KIM:	Should be done in Macmachine too.

PA: 6/7/95:	General repetitions on motorola.
		Change in MC68machine for general reps.

	>>>>>>	There is a problem that for tstgeneralrep some
		instructions like the following is generated for 
		general repetitions:

		lea.l	(0,%a2,%d0.l*24),%a1

		This is illegal scale for motorola.
		However, in MC68machine slot RegAdrIndex the
		size is calculated correctly (only use scaled
		addressing if size=1,2,4,8, otherwise explicit
		multiply), so the scale of 24 is set later.
		I have identified the place to be in synthlibbody
		approx. line 88 (marked with datpete:).
		But i cannot figure out a condition for NOT 
		overwriting the A.size at that place.

	>>>>>	When this has been figured out, the corresponding
		change for RegAdrIndex should be done in 
			LINUXmachine
			INTELBmachine
			NTImachine

PA: 6/7/95:	Ole's new tstcontrol dumps for motorola.
		Turned out to be because the branch in chkcase
		should be *unsigned*.
		Fixed in HPmachine. 
	KIM:	MacMachine should be fixed likewise.

PA: 6/7/95:	Added 
		   (if first<last then (* datpete 6/7/95 *)
		around call of ldTmp in asmlink.bet since Elmer
		had a case, where ldTmp was called with an empty
		string, resulting in a link error.

PA: 11/7/95:	Changed divide optimization in evlib.bet:
		Used to call gCmp and gBge, which are NOT implemented
		on Snake. Now uses cmpAndJmp.
		In general gCmp and gBxx are only used in the 
		XXmachines, that implements them. So maybe they
		should be removed from machine.bet?
		Would simplify binary intel generator.

PA: 13/7/95:	Fixed error in interactive.bet which cause infinite loop
		after hitting RETURN on initial "Type fragment file name"
		prompt.

PA: 13/7/95:	Fixed link directive in SUN4SBasmlink when compiling
		with -g.

OLM: 2/8/95:	Bug fix for general repetitions; synthlibbody; PA 6/7/95
		report ob offset bug fixed.


OLM: 13/8/95:	PropError in controlBody now calls an exception PropertyError
		in system.bet. Is bound in interactive. Sif should now be
		able to catch these errors.

OLM: 14/8/95:	Bug fix; semattbody.bet; file and slot name conflict;
		FEJL/Dictionary.bet has a doPart slot called Dictionary
		which confuses the compiler. The compiler did check for
		identical slot names; this check has been extended to check
		if a file with attributes slot has the same file name as one
		of its slots and if so this is an error; this is only a
		limited extension of what is needed. In general a complete
		check for slot/file name conflicts must be made.

OLM: 14/8/95:	Bug fix; chklst.bet; catch of recursion in enter/exit lists;
		FEJL/zchklst.bet

OLM: 14/8/95:	Bug fix; chkevalbody.bet; illegal ciffer in number;
		FEJL/num1.bet

OLM: 20/8/95:	A warning is given if an external entry-point includes a
		blank or a control character.

OLM: 26/8/95:	Bug fix; synthlibbody.bet; origin for final bindings;
		Original bug in ymer; FEJL/final1.bet; tsvirt2 updated.

OLM: 26/8/95:	Comparison between boolean and integer (aBool = anInt)
		is made into a warning instead of an error to make
		beta5.1 compatible with beta5.0 in the sense that 
		basiclib/v1.4 can be translated by beta5.1; necessary
		for a consistent release 3.1.
		In beta5.2, assignment/comparison between bool and int
		will be an error.

PA: 30/8/95:	Changed link directives in LINUXasmlink and LINUXBasmlink
		to make --static work on linux 1.2 and also split up
		LD_LIBRARY_PATH into several -Lxxx directives to make
		the linker able to find the X libraries.

PA: 31/8/95:	Updatede RegAdrIndex in LINUXmachine to handle general 
		repetitions like in MC68machine.

OLM: 30/8/95:	Changed general repetition implementation to always
		allocate rep elemens off line. The inline implementation
		has a problem with
			R: [12] @ T; S: ^T
			R[3][] -> S[];
			4->R.extend;

		It is difficult and expensive to implement extend such that
		S also refers R[3] after the extension. With allocating
		the elemenst as references to objects, this problem does
		not exist.

OLM: 31/8/95:	Compiler output mode quiet is now default

OLM: 31/8/95:	Bug fix; control:top.open did not catch OtherFileError
		exception from mps; it does now; calls compiler exception
		notExisting which has got a modified error msg.

OLM: 3/9/95:	Compiler assumes option -g pr. default, i.e. generation
		of debugable code.

OLM: 3/9/95:	Bug fix; synthlibbody.bet;  adr. reg. oveflow; FEJL/list2list

OLM: 3/9/95:	Change to trace/ctrace; operations, T,A,I,NL, changed to:
		xT,xA,xI,xN. The reason was that there too often were
		names clashes with variables to be traced.

OLM: 4/9/95:	Fixed mute option to truly mute - changes to systembody 
		and Xasmlink; only SUN4Sasmlink updated;
		NOTE: systembody:init maskes a scan of options, which means
		that option syntax for mute is hardcoded into systembody.

OLM: 14/9/95:	Bug fix; synthlibbody.bet; fix of 26/8: final binding had a missing
		case for gram.nameApl; only gram.remote was corrected

OLM: 19/9/95:	Bug fix; genlib; missing gc-ref info for R: ##eternal; major
		problem for callback calls in GUIenv; FEJL/callback1.bet

PA: 19/9/95:	Bug fix: TST in sparc.bet should use orcc, but used subcc.
		Did not work for negative refs. Fixed.

OLM: 19/9/95:	Bug fix; genlib:bindvirtuals:final2virt; problem with
		originreg being used wrongly; FEJL/madsnfinal.bet;
		
PA: 4/10/95:	Changed HPmachine to support hpux9mc

PA: 4/10/95:	Bug Fix: Fixed QUA error in op1ToEBX in gDiv in LINUXmachine.

PA 4/10/95:	Dreadfull hack for hpux9mc: have to add -lXhp11 if linking with
		-lX11, since I cannot change ~beta/Xt/v1.8/xlib.bet!!