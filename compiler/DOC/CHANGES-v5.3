CHANGES for compiler version 5.3

------------------------------------------------------------------------------

OLM: 2/9/96:	Constructed version 5.3 based on v5.2; initial version
		with first version of preemptive scheduling/multi-tasking
		support (MT-support).

		To run the sun4s version with MT-supprt use switch 64.

		Switch 64 is incompatible with beta and this compiler
		run without switch 64.

------------------------
The following changes are also made in version 5.1.3

OLM: 27/6/96:	Eliminated use of general repetition in searchbody, since
		wrong code apparently is generated. 
-------------------------

PA: 9/9/96:	Fixed "real" error in SNAKEmachine: The .CALL directive
		did not immediately precede the corresponding BL instruction
		generated by CallCproc.
		Fixed SNAKEasmlink to use dynamic link for -lm -lc too.
		(NOT done in v5.1.3.)

PA: 11/9/96:	Added instructions anticipated to be used for implementing
		multiprocessor-safe semaphores:
		sparc.bet: added ldstub.
		intel.bet: added lock_prefix (see comment on usage in file)
PA: 17/9/96:	Added two more synchronization instructions in sparc.bet:
		swap and stbar.

PA: 19/9/96:	Transferred the unquote hack to NTIasmlink from the v5.2 
		correction branch.

PA: 19/9/96:	Implemented R.%lock and R.%unlock for sparc.
		Changed files: semattbody (PrimitiveToNumber), 
		evbody (EvalBody.newRemotePrim), 
		chkevalbody (ChkNewPrim),
		machine (new lock and unlock operations)
		and SUN4Bmachine (implementation for sparc).

PA: 21/9/96:	Implemented R.%enablePreemption and R.%disablePreemption 
		for sparc.
		Changed files: The same as for "PA: 19/9/96".

OLM: 24/9/96:	Fixed traceXcall to work for Linux; changes to genexternal.bet

PA: 22/9/96:	Optimized R.%enablePreemption and R.%disablePreemption 
		for sparc. Changed files: SUN4Bmachine.

PA: 25/9/96:	Changed eoo in INTELmstate to generate correct ..db files for 
                intel.
                Added empty slots for externalDispatch, Lock, Unlock, enablePreemption,
		disablePreemption, allocObj in INTELBmachine to be able to link
		linux compiler.

OLM: 23/9/96:	Added support for new betarun naming conventions a la
			betarun_v_mt.o
		Basically the run-time system is named 'betarun'.
		The following switches can be used to select other versions
			of betarun:
		Switch 	69:	'_pe'		personal edition
			13	'_debug'	debug version
			41	'_v'		valhalla version

		Only one of the above can be applied at the same time;
		if several are used, they take precedence in the above
		order, i.e. if 69 is set the other are ignored. 41 is true
		by default.

		Independently the following can be appended

		Switch	64:	'_mt'		multi-tasking version

PA: 26/9/96:	Fixed R.%enablePreemption and R.%disablePreemption for sparc:
		Now releases PreemptionLevel.Lock after use.

OLM: 1/10/96:	RT-routines NewVR and ExtVR have been expanded into calls
		NewVR1, NewVR2, NewVR4, NewVR8, NewVRG,
		ExtVR1, ExtVR2, ExtVR4, ExtVR8, ExtVRG

		They all get their parameters in primRegs!

		All RT-routines are now initialized using intPrimCall
		instead of some being initialized using initExternalCall.
		InitExternalCall is ONLY used for initializing real
		external calls to C, Pascal, etc.

OLM: 2/10/96:	CopyVR, CopySVR have been replace by CopyVR1, etc. similar
		to NewVR above. Parameter transfer is now also in primRegs.

MG: 7/10/96:	Added DOC/preemption.doc.

PA/MG: 7/10/96:	A lot of changes in BetaRun.bet:
		comp.CallerLSC was not set to -1 when attach was called
		(the allocated register dr was never initialized).
		Now tests for recursive attach and attach of terminated 
		component - general interface for calling BetaError added.
		Severe bug in Att: By using the same abstraction 
		(SaveCompReturn), the current object was saved in
		both the component to attach and in the calling component.
		Morten's conc1 AND tst both works now.
		Known bugs: 
		1. If the sheduler is suspended, an Illegal Instruction
		   results shortly after it is re-attached.
		   (can be provoked by commenting in the call of "eat"
		   in the shceduler itself).
		2. GC caused by ordinary runtime routines will make things 
		   go bananas.
		3. Several places in BetaRun.bet references are assigned
		   without checking if ChkRA should be called.	
		   E.g. when assigning ActiveComponent to comp.callerComp
		   in Attach etc.
		   FIXED in "PA: 8/10/96#2".
		4. Still we need to consider sharing of variables
		   in a multiprocessor situation (e.g. ActiveComponent).

PA: 7/10/96:	Added (empty) fragments externalDispatch, Lock, Unlock, 
		enablePreemption, disablePreemption, allocObj to
		LINUXmachine, SUN4machine, NTImachine, INTELBmachine, SNAKEmachine,
		MIPSmachine to make the corresponding compilers link.


PA: 8/10/96:	Changed all files in DOC into html format.
		New files can be created from the template "empty.html".
		Notice that '<' must be typed %lt; (even within <PRE>), and
		that '>' must be typed &gt;.

		To use from NetScape, add the following bookmark (assuming
		that you have the compiler checked out in beta/system/v5.3
		relative to your home dir):

		file:///users/$(USER)/beta/system/v5.3/DOC/index.html

		where $(USER) is your user-name.
		
		Alternatively you can use the ~beta source

		file:///users/beta/system/v5.3/DOC/index.html

		but here the documents may not always be up-to-date
		(can be made up-to-date with a 'cvs update', though).

PA: 8/10/96#2:	BetaRun.bet changes: 

		Added symbolic constants for
			fixed registers (regIOA etc.)
			special prototypes (ByteRepPTValue etc.)
			limit for CtextPool (MAXCTEXTPOOL)
			limit range for LVRA allocation (LARGE_REP_SIZE)
		These are not used consequently yet.

		Added pattern AssignRef to be used whenever a reference
		is assigned into an object in a runtime routine.
		Updates AOA-to-IOA root table if necessary.
		I have tried to find all places where it is needed and
		have replaced the code these places.
		Fixes bug 3. in "PA/MG: 7/10/96" above.

PA: 9/10/96:	Changed default import lists in AssemblerHeader for
		SNAKEmachine and NTImachine to use the new names
		for CopyVR, CopySVR, ExtVR, NewVR.

PA: 10/10/96:	Fixed SnakeMachine: PrimReg5 is now in %r22 (never used
		before on snake). Fixed PutD to allow %r22 to be used
		(gave "Illegal Dataregister" before fix).
		Fixed DOC/Registers.html: Snake register mapping was
		completely wrong).

OLM: 16/10/96:	Implemented call-back, an ObjS in BetaRun.bet. Introduced
		leSx, etc. which all return false to be able to run tst
		programs.

		MISSING:

		callBack: test for CBA overflow;
			  flush of code cash

		leS, etc: real implementations

OLM: 17/10/96:	Implemented simple version of ExO; 

		MISSING:	it does NOT traverse the stack;
				it just sets thisObject and jumps.
				But it works in all, but very tricky cases:-)

OLM: 17/10/96:	Implemented preliminary versions of AlloVr1, ..., NewVR1, ...

		MISSING: 	allocation in LVRA for large objects

		Not implemented: ExtendVR1, ..., and Allo/New/Extend for
		general repetitions.

OLM: 18/10/96:	Fixed problem in genlib about assuming more than 4 primReg's
		for genereal rep primitives. The same problem may appear
		in other places for the Intel platforms. It is often assumed
		that a primReg is a register; on Intel it is a memory
		location just as primReg>4 on MIPS is a memory location.
		By using the operation toPrimDest evrywhere, this problem
		should be taken care of.

PA: 21/10/96:	sparc.bet: added iflush and iflush_i.

PA: 1/11/96:	Eliminated x-names for runtime routines for
		switch 64.
		Affected files:
			BetaRun.bet
			CODEmachine.bet
			evbody.bet
			evval2.bet
			gen1body.bet
			gen2body.bet
			genlib.bet
			itemevval.bet
			refevval.bet
			synthlibbody.bet
		None of the routines implemented in BetaRun.bet are
		present in MT runtime system anymore, and thus no
		conflicts arise from using the ordinary names.

PA: 1/11/96:	BetaRun.bet:
		Implemented eqS, neS, ThisS.

PA: 1/11/96:	SUN4SBasmlink:
		Added -D_REENTRANT in CC directive for switch 64.
		This is reuired for all external files when using threads.
		Added -lthreads in link directive for swtich 64.
		However, I had to comment it out again, since installation
		of the AlarmHandler used for periodic interrrupts causes
		core dump. Need to look further into signal handlers
		in connection with threads.

PA: 1/11/96:	tst and conc1 works as before my changes above.
		There are some problems in tstvarptn because 
		relational struc-comparisons (except eqS, neS)
		are not implemented properly.

PA: 6/11/96:	Changed generation of _start in BetaRun.bet
		according to gcc-lib.
		Needed to get signal handlers work with -lthread.

PA: 7/11/96:	DOC/Registers.html: Fixed descr. of g-registers
		for sparc (multithreaded), which were wrong.

PA: 7/11/96:	Changed SUN4Bmachine.bet and BetaRun.bet:
		General use of register constants instead of
		hard coded global register numbers.

PA: 7/11/96:	Changed adrReg from being %g5 (an error) to %i5
		in SUN4Bmachine.
		NOT necessary to change anything in SUN4machine (asm).

PA: 7/11/96:	Changed sparc register allocation to be:

			regIOA: (#  exit G5 #);
			regIOATopOff: (#  exit G6 #);

			regRefTopOff: (#  exit G2 #);
			regDataTopOff: (#  exit G3 #);
			regIOALimit: (#  exit G4 #);
			regActiveStack: (#  exit G7 #);

		in order not to use %g7, which is used by 
		libthread.
		This solution makes tst run until TstCproc, when linked
		with -lthread.
		Next step will be eliminating %g7 use, by using the
		ActiveStack *variable* directly.
		Updated SUN4machine, SUN4Bmachine, DOC/Registers.html.

PA: 8/11/96:	Changes in SUN4Bmachine and BetaRun.bet:
		ActiveStack is NOT fix-allocated to %g7 anymore.
		%g7 is NOT used at all.
		ActiveStack now has to be saved/loaded to/from
		variable at all uses.
		tst now works when linked with -lthread!
		conc1 dies after a while, though.

OLM: 10/11/96:	Added semantic error (114) for '!' operator

PA: 11/11/96:	Changes in BetaRun.bet:
		Added IncVar and calls it at start of each
		RT routine if linked with betarun.debug.
		Helps in debug situations.
		Renamed AllocStack to AlloSO in accordance
		to other variants of RTS.

PA: 11/11/96:	Changes in BetaRun.bet:
		Moved allocation of all global variables
		into one place. They must be dealt with soon.
		Fixed error in PreemptiveCall with respect
		to ActiveStack. 
		BOTH tst and conc1 now works (linked with -lthread).

PA: 12/11/96:	BetaRun.bet:
		Moved declaration of all global variables into
		C runtime system, in order to get an overview
		of global variables (concerning sharing).

PA: 12/11/96:	SUN4Bmachine:
		Eliminated use of BetaStackTop when switch[64].

PA: 13/11/96:	DOC/preemption.html:
		Included Ole's design-draft for concurrency and
		made a bibliography section.
		Started on specification on how to deal with each
		global variable in multiple threads.

PA: 14/11/96:	DOC/preemption.html:
		Finished first version of description of global variables,
		global registers, and signalhandling in multithreaded
		execution.

PA: 14/11/96:	DOC/preemption.html:
		Improved table of contents.

PA: 20/11/96:	BetaRun.bet: Added EmitFuncText to use when calling
		e.g. mutex_lock(&cbfa_lock).
		Synchronization using mutex_lock() in CopyCPP.

PA: 25/11/96:	BetaRun.bet and SUN4SBbeta.bet:
		Changes for thread-specific data.
		All global data should now be properly protected.

PA: 29/11/96:	Fixed various bugs in binary windows compiler.
		tst now runs until tstqua2 in tstref:

		OK
		Hello world!
		.
		Repetition: abcdefghijklmnopqrstuvwxyz0123456789.
		Repetition: abcdefghijklmnopqrstuvwxyz0123456789.
		Repetition: abcdefghijklmnopqrstuvwxyz0123456789.
		Reference : abcdefghijklmnopqrstuvwxyz012345678

OLM: 1/12/96:	Changed form betaast/v5.2 to betaast/v5.1.1 (betaast/v5.1.1
		has been changed to included the v5.2 parts for handling
		returnOff. 

		betaast/v5.2 is now superflouos. It should however NOT 
		removed until Henrik Roen has changed his version of the 
		compiler.

		Similarly, dependency/v1.2.1 is used and dependency/v1.3 can
		be removed.

PA: 2/12/96:	Fixed bug in swap-case in cmpAndJmpFloat in INTELBmachine, LINUXmachine,
		NTImachine.

PA: 2/12/96:	BetaRun.bet: Use of getnewIOASlice.
		Not yet tested.

PA: 2/12/96:	More changes in windows 32 coff.
		tst now runs until tstcase.

PA: 3/12/96:	Made binfile a pattern instead of a set of file attributes.
		This was done in order to make binding of the binary-
		virtual possible.
		Fixed all uses of binfile in compiler 
		(elf, coff, a.out, mac68k).

PA: 3/12/96:	Fixed remaining relocation bugs in WIN32coff.bet.
		tst generated by binary MS COFF compiler now runs!
 
PA: 4/12/96:	Major changes in SUN4Bmachine and BetaRun.bet:
		Started on IOA heap reorganization.
		Non-switch64 behavious should be OK, but switch 64
		will definately not work for the moment.

PA: 5/12/96:	More changes in SUN4Bmachine and BetaRun.bet.
		IOA heap reorganization for switch 64 is now
		done (except for minor problem with doGCx).
		But tst fails in AOAtoIOAInsert. Probably a minor
		bug in AssignRef or ChkHeap.

PA: 6/12/96:	BetaRun.bet + SUN4Bmachine:
		Fixed bugs in ChkHeap, Assignref and MkTO.
		tst now runs to tstbreak with new IOA organization.

MG: 6/12/96	Initial setup for GNU SDK in NTI files.
		(check-in by datpete)

PA: 9/12/96:	Support for generating garbage-collector consistency
		checks from BetaRun.bet.

		Tst now runs until TstLVRA, where it dies in NewVR4.
		BUT there is a strange bug: If 'NumNewVR1'->IncVar
		is inserted in start of NewVR1, then the error in
		TstBreak, mentioned above, occurs!!
		IncVar is made in a safe way: It performs a save,
		and then only uses %l-registers in the new register window.
		The error happens although no errors are detected by full 
		consistency check until tstbreak (full scan of entire heap 
		after EACH allocation). And NewVR1 is only used by TstRep 
		and TstRefRep.
		The error at TstLVRA and this error may be related.

		Also created AttTC entry point, which is to be the initial
		entry called when a component is asked to be attached
		to a separate thread/processor. The C-runtime routine
		attToProcessor can now be called with a component as 
		argument, and it wil spawn a thread, that executes
		AttTC with the given component as argument.

		Some confusion remains: AttTC is supposed to do some of the 
		stuff, that AttBC does for the initial thread. But AttBC
		is rather hacked-up, e.g. it allocates the basic component
		*twice* (according to Ole in order to terminate correctly).

PA: 9/12/96:	SUN4SBasmlink+SUN4Sasmlink:
		Now always links with '-lsocket -lnsl'.
		Should fix error reported by pahe: When linking guienv
		program with --noDebug, you used to get link errors for
		some socket and nsl entries.

PA: 9/12/96:	TST/tstreal.bet:
		incorporated test for error reported by Kai Petzke:
		When comparing reals on linux, sometimes '<' behaved
		like '<=' etc. The error was fixed in "PA: 2/12/96".

PA+MG: 10/12/96:
		MT progress:
		Fixed problem with IncVar by not using save-restore, but
		instead allocating dataregs.

		Fixed error in AlloR, which assumed %o1 safe across 
		a call of doGCx.

		tst now works with new IOA allocation!

PA+MG: 10/12/96:
		MT progress:
		Implemented attToProcessor, so that the following program
		now works:


ORIGIN 'tstenv';
--PROGRAM: descriptor--
(# attToProcessor: external
     (# comp: @integer;
        tid: @integer;
     enter comp
     exit tid
     #);
   t: @integer;
   a: @|(# p: @put; do L: (# do (for 1000000 repeat 1->t; for);'.'->p; restart L #)#);
   b: @|(# p: @put; do L: (# do (for 1000000 repeat 2->t; for);'!'->p; restart L #)#);
   c: @|(# p: @put; do L: (# do (for 1000000 repeat 1->t; for);'*'->p; restart L #)#);
   d: @|(# p: @put; do L: (# do (for 1000000 repeat 1->t; for);'_'->p; restart L #)#);
do @@a -> attToProcessor -> t;
   @@b -> attToProcessor -> t;
   @@c -> attToProcessor -> t;
   d;
#)

This actuelly invokes all 4 processors on ariel, as can be seen from this top:

  PID USERNAME PRI NICE  SIZE   RES STATE   TIME   WCPU    CPU COMMAND
19856 datpete  -25    0 2944K 2672K cpu     6:26 79.67% 99.96% threads

A normal 1-thread process can only get 25% CPU. And TIME runs with a speed
of 4 times real time.


PA+MG: 11/12/96:
		MT progress:
		A lot of clean up in MT code.
		Added thread specific (debug)counters for runtime routines.
		The above thread program now works also if component d is
		started in a thread (and main program terminates).

		It is evident that the assignment to the common variable
		t above slows down concurrent execution significantly.
		When thread a, b, c is killed (the first 3 Cntl-C the program
		receives will do this) then process d actually runs much
		faster. If the 't' written to is declared locally in each
		component, this speedup is not seen.
		Thus the processors clearly spends a lot of time synchronizing
		memory stores.

PA+MG: 16/12/96:
		MT progress:
		Eliminated need for save/restore in doGCx (and V-entries).
		TST/tst and TST/threads both works.
		Next step will be fix of GC combined with attToProcessor.

OLM: 26/12/96:	Opgraded the compiler to use ~beta/r4.0.1.

		Changed stop in interactive on illegal command line options
		from failure to normal.

OLM: 27/12/96:	Fixed error message for transAccesError. A 'perfect'
		error message can only be made by improving the exception
		interface from mps, since transAccessErr in 
		dependency/controlbody should does not know which file
		that causes the problem. The parameter 'm' has this encoded,
		but is not directly usable.

OLM: 27/12/96:	Fixed bug when using 'origin.x' in dopart slots

OLM: 28/12/96:	Bug fix in chklst; crashed for certain types of semantic
		list errors; FEJL/sand.bet

OLM: 28/12/96:	Bug fix for dataReg negative for SGI.

OLM: 4/1/97:	Fixed bug in sun4s with respect to missing save of busy
		floating point registers for external calls;
		FEJL/real*.bet.

OLM: 5/1/97:	Further fix of 4/1/97 since arguments to nested external
		calls must be stacked. Added test case to tstreal; this
		test case DOES NOT WORK FOR SGI and HPUX9PA; a similar
		test case in ~olm/beta/system/v5.2/TST/FEJL/real2.bet	
		gives seg. fault when terminating on linux!

PA: 7/1/96:	Fixed usage of scanSearchPath in NTIBasmlink.bet.
		Fixed comments which suggests identical usage in
		other XXXasmlink.bet.

OLM: 7/1/97:	Bug fix for intel: INTELBmachine, LINUXmachine.
		Float register push do NOT work:
		(1) float registers cannot be pushed, 
		(2) rep.fMax does NOT work for recursive calls of pushDataReg/popDataReg.
		Code calling push/pop for float registers have been commented out.

>>>>>>		It is still NOT known whether stack overflow on float register
		stack is a problem or not, and how to handle a possible problem!

>>>>>>		The use of rep.fMax in case of nested push/pop may also be 
		a problem on other platforms! On platforms where float registers 
		are pushed, rep.fMax MUST be a parameter like max.

PA: 8/1/96:	Added the above change (in PushDataReg and PopDataReg) in NTImachine
		too.

OLM: 9/1/97:	Yet another rep.fMax fix for INTELB, LINUX, NTImachine.

OLM: 21/1/97:	Bug in error message for non-accessible file 
		(/users/beta/sun4s/foo.bet)

OLM: 22/1/97:	Bug fix compiler crash when binding virtual in descriptor with no
		super pattern; FEJL/noSuper.bet

PA+MG: 23/1/97:	INTELBmachine.bet:
		Changes for pascal external support incorporated
		from NTImachine.

OLM: 8/2/97:	Added implementation of %thiss object; see DOC/NewPrim.html

OLM: 14/02/97:	Eliminated ..gs and .go file extensions (switch[55]) for sun4s

OLM: 1/03/97:	Made a test in translate_controlbody for checking if
		.lst file exists bewfore closing it!

OLM: 12/03/97:	Included v5.2 correction for PPCmachine: PA:10/3/97
		ExternalReturn, etc.

PA: 12/3/97:	Updated DOC/Build.html to reflect actual implementation

PA: 12/3/97:	Included changes from v5.2 in INTEL, NTI, LINUX.
		This includes the following:

		PA: 24/2/97:
		Fixed bug in free/reuse of registers INTEL registers.
		The mechanism for reusing a register saved in MEMORY did not
		work. Fixed in FreeAdr, FreeData, DataRegOpReuse, AdrRegOpReuse
		in INTELBmachine, LINUXmachine, NTImachine.

		PA: 24/2/97:	
		Eliminated lots of unnecessary "push -4" in intel code.
		Changed PushDataReg+PopDataReg in INTELBmachine, NTImachine, 
		LINUXmachine.

		PA: 27/2/97:
		Added quote of build commands in asmlink.bet. Otherwise
		commands containing ';' would end the echo command and 
		start executing the rest of the echo-arguments as commands.
		See e.g. basiclib/v1.5/private/iget_unixbody for example
		BUILD that would otherwise fail.

		PA+MG: 6/3/97:
		Fixed two stupid bugs in ByteSwap in INTELBmachine.


PA:  11/3/97:	evval2.bet:
		TxtCstVal.pushCpar, case 4:
		if-structure was wrong leading to 
		
			'Pascal Text longer than 255 chars!' -> CError
			
		eventhough the length was ok.
		Fixed.
	>>>	Ole: Please check!
	>>>	THIS ppcmac ADDITION WAS NOT PRESENT IN TxtCstVal.pushCpar
		IN compiler/v5.3!

PA: 13/3/97:	Fixed typo in corrections made by "PA: 24/2/97" in
		NTImachine and LINUXmachine:
		In DataRegOpReUse a "rN+1->N" had become "+1->N"
		causing lots of dataReg negative errors in textual
		generators for nti/linux.

PA: 13/3/97:	Added error handling for elffile instance in
		GENERATOR/LINUX/LINUXelf.bet and for cofffile instance in
		GENERATOR/NTI/WIN32coff.bet.
		Code taken from GENERATOR/SUN4S/SUN4Self.bet.

PA: 13/3/97:	Added pattern LongBL in GENERATOR/HPUXPA/SNAKEmachine
		(copied from my old CVS version of system/v5.3, which I will
		now delete).

PA: 17/3/97:	Removed inclusion of machinetype in CONTROL/system.
		It is now included in betaenv.

PA: 18/3/97:	Minor SPARC/SUN4S changes:
		Removed MAKE directive in SUN4S/SUN4Self.bet
		Changed OBJFILE directive in SPARC/SPARCmachine.bet
		to a BUILD directive.
		In SUN4SBasmlink.bet, I removed generation of shell-function 
		BetaAsm, and moved definition of BetaMake shell-function into 
		make:descriptor, to prevent generation
		of it in cases, where it is not needed.
		Added check for constant size in format3i in sparc.bet.
		Checked that it works (provoked error in ldCst), and then
		commented it out again.
	>>>	Ole, should it be inserted? It will cost a little a
		code generation time, but it will catch places, where we
		may have forgotten to check if constants can be in 13 bit.

PA: 18/3/97:	BetaRun.bet:
		In PreemptiveSusp, now savedIOALimit is restored from TSD,
		in case it has been nullified by AlarmHandler.

PA+MG: 19/3/97:	Fixed in AddCommand for NTI and UNIX asmlinks:
		Test for exit status in build command, and exit of
		job file if the command failed.

PA: 21/3/97:	Added NTIbeta.rc in GENERATOR/NTI, and 
		RESOURCE directives in NTIbeta.bet+NTIBbeta.bet.

PA+MG: 21/3/97:	A lot of small fixes in BetaRun.
		TST/tst and TST/conc1 now work.
		TST/threads works, except that something goes wrong at GC

OLM: 22/03/97:	Bug fix in checklibbody and gdbody for problem with
		compiling container and containerBody when the latter needed
		to be parsed and checked without parsing and checking
		the former. The problem was that e.g. sematt:insertable
		was called with a doPart and not a descriptor. Perhaps
		it should always be checked that the argument is a descriptor.
		However, the bug is VERY hard to reproduce. Almost any small
		change to containerBody makes the problem go away! Some
		better understanding of the problem is needed. It is,
		however, fixed for the moment!

OLM: 22/02/97:  Eliminated compilernumberio for sun4s and sgi.
		Must also be done for other platforms!

OLM: 23/03/97:  Added division-by--zero check to SGI. Error message is:
		'Floating point exception'. Should be: 'Division by zero'.

OLM: 23/03/97:	Bug fix; compile-time qua-error in FEJL/oslo.bet.

OLM: 24/03/97:	Eliminated ..gs and .go file extensions (switch[55]) for sgi.

OLM: 25/03/97:	Eliminated getData and getAdr from machine.bet; added a
		semi-execption for registeroverflow; this is a preparation
-->		for inlinNX; THIS REQUIRES CHANGED to XXXmachine slots
		getAdr and getData where rNo now should be rN; have been 
		changed for most platforms. In addition semi-exceptions
		DataRegOverflow and AdrReghOverflow may now be called.

OLM: 28/03/97:	Introduced in machine.bet, pattern InlineNx, with new
-->		SLOTS, saveCodeState,RestoreCodeState, which MUST be
		added to all XXXmachine.bet files. They can be empty
		initially. They are ONLY relevant if inlineNX (switch 211)
		is set.

OLM: 28/03/97:	Fix for inlineNX to mark static descriptors as not inlineNX.

OLM: 28/03/97:	Bug fix for SquareRoot demo flaoting porint error on sgi.
	  	%f0 was erroneously saved on stack; also accordingly to
		the MIPS manual there must be a delay slot following a
		floating-point compare.

OLM: 28/03/97:	Introduced elimination of 'simple' dead code fo simple if-imp;
		in (if X then ... else ... if), where X is one of true, false,
		or P (where P: (#exit true #)/(#exit false #)), code is only
		generated for the corresponding then- or else-part. 
		Peter: DON'T start misusing this:-)

OLM: 06/04/97:	Added sparc optimization to make use of delay slot in simple
		cases. Currently switch 216 must be used.

OLM: 13/04/97:	Added support for new primitive

			R.%xsuspend

		(it is called "xsuspend" since a reserved name like "suspend"
		cannot syntactically be placed after %)
		where R must be component (not yet checked). The address
		of R is passed in primReg1 and SuspX is called.

OLM: 20/04/97:	Added various sparc V-entry point optimizations to make
		use of delay slots. V-entry points generated using switch
		68 and 216 (see above) uses 3-4% more code than without!
		Should preferably take less code:-(

OLM: 26/04/97:	Added optimization for generating code for
		origin such that superflous intermediate register
		is eliminated.

PA: 1/5/97:	Changed link directive for NTI-MS binary compiler
		to preserve symbols in executables (for valhalla).
		Affected: NTIBasmlink.

PA: 5/5/97:	Initial implementation of Z.%xsuspend. Not yet tested.

PA: 6/5/97:	Implementation of Z.%xsuspend now seems to work.

OLM: 22/5/97:	Bug fix for switch 68; GC field for part objects NOT properly
		defined.

PA/OLM:16/6/97:	Un-intended rcm-branch merged into tip version;
		integrated with 'new' mps version;
		putSet constant (0xffff) fixed in PPCmachine.

OLM: 16/7/97:	Fix of SGI-bug introduced by olm:26/4/97

OLM: 17/7/97:	Fix of bug in semattbody:descCase (externalVirtual), only
		showed up on little endian machines;
		added a few more verbose messages for code generation.

OLM: 18/7/97:	Replace use of local binfile.bet to the one in basiclib/v1.6.

OLM: 22/7/97:	Reimplemented getNextArgument in interactive to avoid
		keyboard input. To avoid component suspend.

OLM: 25/7/97:	Fixed SGI bug with external calls in exit list

OLM: 26/7/97:	Fixed bugs in checkslots: no reporting of unbound slots in
		betaenv; and only one slot error reported at a time.

PA: 28/7/97:	Moved various machine-independant betarun-related constants from 
                GENERATOR/SPARC/RUN/BetaRun.bet to CONTROL/com.bet.
		In SYNTHESIZER/gen2body and GENERATOR/SPARC/RUN/BetaRun.bet, 
		storing of initial age of new objects is only done if IOAMinAge 
		is non-zero, since newly allocated objects are cleared as of 
		betarun/v3.0. Experiments are going on with IOAMinAge=0.

OLM: 28/7/97:	Fixed bug in eliminating (if false then ... if)

OLM: 28/7/97:	Attempt to make beta -o sgi/tst tst work for SGI.

OLM: 30/7/97:	Switches 65 (betadata) 66 (merge of inner dispatch with
		virtual dispatch) is now standard, test for these switches 
		have been eliminated. Switch 65 is now used for new version
		of 64 (multi tasking).
		MANY changes due to new 65.
		Fixed bug in general reuse of delay slots.

OLM: 3/8/97:	Source extension ('.bet') is no longer case sensitive.

OLM: 4/8/97:	Fixed problem with passing more floats than %O-regs on sun4s.
		The 3rd float in tstvarargs is passed in %O5 and on stack.
		We need to extend tst to cases where the whole float is 
		passed on the stack, and also a case where the float is NOT
		split between register and stack. Complicated:-(

		Still not fixed for SGI and PPCMAC!

OLM: 4/8/97:	Included PPCMAC changes from ~beta/r4.1/COMPILERCHANGESMAC.

PA: 4+5+6/8/97:	Changes for switch65:
		CHANGES IN COMPILER:
		--------------------
		1. SaveReturn now uses AssignRef for storing dyn.
		2. AssignRef now only performs one test, and then calls ChkRA 
		   to do the rest. Gives less code, but more calls.
		3. AlloI1 now use AssignRef to store origin.
		4. AlloI2 now use AssignRef to store origin and dyn.
		5. In Return:Descriptor we now restore return address to 
		   %o7 and return with RETL (instead of %i7 and RET).
		6. In gen1body:initialseq we now call a new routine AlloBC,
		   which corrects the Origin of BasicItem to be 0 instead
		   of 16 (which is used as origin from main when calling V1BETAENV to
		   ensure that V1BETAENV actually allocates).
		   Still, however, a GC (or consistency check) triggered from
		   V1BETAENV (or V9BETAENV called from V1BETAENV) will be confused
		   by the "reference" being 16.
		   Ideally generation of V1BETAENV should be handled specially,
		   since it will never be a part object (and you can't say 
		   THIS(betaenv)##).
		7. In AlloSO, if using switch 13, a test i generated which tests
		   that the stack object was not allocated in AOA.
		   This is fatal, since information about IOA roots in stack objects
		   are NOT maintained (would require ChkRA in each reference push).
		   This problem is hard to fix - best way is to simply eliminate
		   the need for stack objects!
		8. In AlloC, if using switch 13, a test i generated which tests
		   that the component was not allocated in AOA.
		   This may be fatal, since the component is allocated by first
		   allocating the item, then allocating 24+itemsize for the 
		   component, and the COPYING the item into the component.
		   If the component is allocated directly in AOA, the copying
		   of the item might create new AOA-to-IOA references, without
		   adding them to the AOAtoIOAtable.
		   Can be fixed by scanning the item for references.
	        9. In AttBC the setup of BasicItem was fixed (an ADD should be ADD_I).

		CHANGES IN RUNTIME SYSTEM
		-------------------------
		1. In doGC, if object was allocated directly in AOA, then
		   IOATop was still increased by IOASliceSize, leading to
		   IOATop>IOALimit!
		2. In doGC IOAtoAOAthreshold was set to 2 if 2 consecutive
		   IOAGc did not make room enough for object.
		   Corrected to IOAMinAge+1 (IOAMinAge is now 0 - used to be 1).
		3. The allocation routines that are not yet generated by BetaRun.bet
		   are in C and have their own register window.
		   In case one of these provokes a GC, the registers %i0, %i1, and
		   %o0 MUST be updated in the BETA register window.
		   This is now done with an assembler wrapper CallWithFullSave
		   in C/sparcdep.h, which saves these registers in TSD 
		   (thread specific data, which is updated by GC).
		   The routines still missing in BetaRun.bet are:
			HandleIndexErr
			*ExtRR
			*ExtVR1, ExtVR2, ExtVR4, ExtVR8
			*ExtVRI, ExtVRC
			*CopyRR, CopyVR1, CopyVR2, CopyVR4, CopyVR8
			*CopyVRI, CopyVRC
			*CopySRR, CopySVR1, CopySVR2, CopySVR4, CopySVR8
			*CopySVRI, CopySVRC,
			*Qua
		   The ones marked with '*' can cause GC.
		4. Some of the repetition-allocation routines does not check whether
		   the repetition should be allocated in LVRA or not.
		   Instead the garbage collector used to have a check, so that
		   objects that actually belonged in LVRA were moved there
	           when encountered during IOAGc.
		   This movement is no longer done: If the cell refering the
		   repetition is in a stackobject, the repetition created in
		   LVRA will point back to the cell in the stack object after
		   the operation. This is certainly not the intension: the LVRA object
		   should point back to the one and only true reference to the object.
		   This is a GENERAL error, that may occur in non-switch65
		   systems, if a *slice* of a value repetition of more than 256
		   elements are created, or if a return value from C is created
		   using CopyCT, and the range of this repetition is > 256.
		   Probably not a real problem, but I would rather copy the
		   few repetitions of this type in IOA a couple of times
		   than create false references to the LVRA repetitions.
		   TODO: NewR in BetaRun.bet should check for LVRA alloc.

		Current status:
		===============
		I am currently testing with
			BETART="ioa=16:checkheap:stopatillegal"

		- tst fails with assumption failed in a callback situation (tstcproc)
		  must be examined, but is probably not vital at the moment.
		- matrixMult fails with a cryptic not-yet-thought-about problem:
		when a new thread is created, thr_create is called with the component
		to attach (as main in the new thread). This is a reference into one 
		of the current heaps. The thr_create call then returns, and the thread
                continues. At some point the thread-library determines
                that it is time to actually start the new thread and then calls AttTC
                with the component-reference as argument. Then AttTC creates a new TSD
                and a default stackobject. AT THIS TIME the new thread is ready to
                participate in GC's, and the other threads are aware of it. BUT IF one
                of the other threads trigger a GC in the time between the thr_create
                and the completion of AttTC in the new thread, the component reference
                argument to AttTC will NOT be updated by GC!
		We do not currently know how to handle this situation without
		introducing potential deadlocks!

OLM: 9/8/97:	Fixed problem with passing 'many' reals to external routine 
		on sgi.

OLM: 10/8/97:	Fixed 'many' reals to externals for ppcmac.

PA: 11/8/97:	Fixed the problem mentioned in "PA: 4+5+6/8/97" concerning 
		attTC getting a component reference, that may be illegal due to
		GC in existing threads.
		The solution is to make attToThread allocate the TSD for the
		about-to-be-born thread, and to place the component to attach
		in this TSD struct. Then the component will be updated during
		GC's, since no GC's can occur before the new thread is actually
		up and running (since all threads, that have a TSD must sign in
		for GC before it will occur).
		Involves changes in AttBC, AttTC in BetaRun.bet and in
		attToThread and create_TSD in betarun.

PA: 12/8/97:	BetaRun.bet changes:
		--------------------
		Added consistency checks in AlloI1 + AlloI2.

		Runtime system changes:
		-----------------------
		Fixed assembler wrappers for yet afew runtime routines, which
		MUST ensure that %i0, %i1, %o0 are updated during GC.
		The list of routines still missing in BetaRun.bet 
		(i.e. still in C runtime system) are:
			HandleIndexErr
			*ExtRR
			*ExtVR1, ExtVR2, ExtVR4, ExtVR8
			*ExtVRI, ExtVRC
			*CopyRR, CopyVR1, CopyVR2, CopyVR4, CopyVR8
			*CopyVRI, CopyVRC
			*CopySRR, CopySVR1, CopySVR2, CopySVR4, CopySVR8
			*CopySVRI, CopySVRC,
			*Qua
			*AlloDO
                        *CopyCT
                        *CopyT
                        CpkVT, CpkSVT
		The ones marked with '*' can cause GC.

PA+MG: 13/8/97:	Fixed BeginLabel in INTELBmachine and NTImachine to use a
		data register instead of a address register.

PA: 13/8/97:	SPARCmachine:
		Fixed SaveReg and RestoreReg for switch 65: Should not use
		machinestack.

OLM: 14/8/97:	Merged some of Henrik Roens dynamic compilation changes:
		All except DYN.

PA: 14/8/97:	1. SPARCmachine:
		Eliminated all tests for common.sun4.
		2. gen1body:storeorigin:
		Temporary hack for ChkRA in storing of origin.
		See comment in the file!
	>>>	OLM: please check!
		3. asmlink.bet:
		Prevented printing of 'Linking' for ppcmac jobfile.

PA: 15/8/97:	PPCmachine.bet:DefineMainLabel1:
		Changed
			GPR6 -> MFLR;
		    and (GPR5,GPR_SP,40) -> ADDI -> mstate.b.emit;
		to
			GPR6 -> MFLR -> mstate.b.emit;
		    and (GPR5,GPR_SP,0x40) -> ADDI -> mstate.b.emit;
		in function HandleIndexError (:-)
		beta.dump after index error now works.

OLM: 16/8/97:	Fixed problem with creating directories (on Mac) '..ppcmac/';
		Fixed 'beta --help'

PA: 20/8/97:	NTI*asmlink:
		Fixed ChangeDirectory to change drive too.

PA: 20/8/97:	Changes in machine.bet, machinebody.bet, all XXXmachine:
		Added pattern openDbgInf in machine.bet and moved 
		manipulation of '..db' extension from XXXmachines to
		the two slots openDbgInf and saveDbgInf in machinebody.
		Changed '..db' extension to be '.db' because the
		'..db' extension confuses instaler program on NTI.

PA: 20/8/97:	Temporarily disabled generation of .db files for 
		ppcmac (saveDbgInf commented out in PPCmachine), since
		they are not yet used.

PA: 20/8/97:	Removed inclusion of machinebody in SPARCmachine,
		MIPSmachine, PPCmachine.
		No longer needed after .db file generation reorganization

HR: 20/8/97:	Fixed bug in CHECKER/initterm_dynamic.bet because of hard
		coded string '~beta/basiclib/v1.5/betaenv'. Only relevant
		when using dynamic compilation

PA: 21/8/97:	Removed switch[64] specific code from BetaRun.bet.
		Now only tests for switch[65] in this file.
		Should be done in rest of compiler too.

PA: 21/8/97:	BetaRun.bet:
		Error fixed in AlloS: %i1 (V-entry argument) destroyed
		if call_psusp_GC was called.

PA: 21/8/97:	DOC/preemption.html:
		Added stuff about current MT status.
		Document is far from complete, however.

HR: 20/8/97	Made some trace statements in searchbody.bet and
		initterm_dynamic.bet . These should be removed as soon as
		testing is over.

HR: 21/8/97	Made small change in initterm.bet. Moved
		origin->sysForm.xOrigin into normal ie. non-dynamic
		compilation branch of the if

OLM: 21/8/97:	Bug fix for  real in (if x // 3 then if)

PA+MG: 25/8/97:	switch 65 bugfixes:
		Generation of GC in each allocation in BetaRun.bet.
		Revealed several errors:
		    1.	MkTO did not save %i1 and %o1 during GC
		    2.	AlloS did not save %o0 during GC
		    3.	ObjS did not save %i1 and %o1 during GC
		    4.	First object in heap never survived GC(!)
		    5.	Large return-offsets (>4095) were not handled
			by SaveReturn:Descriptor and Return:Descriptor.
		tst now runs until tstcproc with this very efficient
		consistency check enabled!

PA+MG: 26/8/97: Betarun.bet:
		-----------
		findProto documented (!) and fixed to handle large 
		offsets.
		CopyCPP documented (!) and changed:
		  1. Handles NULL pointers
		  2. Uses delay slot in callback entry
		  3. Checks for CBFA overflow.
		  4. Flushes instruction cache after codegen

		SPARCmachine.bet:
		-----------------
 OLM: CHECK>>>	ExternalEntry:descriptor fixed to clear %i0 before 
		calling V-entry.

PA: 26/8/97:	NTI(B)asmlink:
		Fixed Resource:Descriptor to make creation
		of "sdk" directory work.
		Previously the code managed to create the 'nti'
		directory, but failed to create the 'ms'/'bor'
		directory.

HR: 27/8/97:	Put comments around trace messages in CHECKER files:
		initterm.bet searchbody.bet initterm_dynamic.bet

HR: 27/8/97:	Added compilerfacade.bet and treelib.bet to DYN
		Modified linkObject.bet nameTable.bet 
		external/labelnametable.c

HR: 27/8/97:	Added test directory to DYN and file textcompiler.bet 
		in test.
		Some of the files in DYN should be moved there, but this
		requires discussion.

PA: 27/8/97:	switch65 bugfixes:
		SPARCmachine.bet 
		Added save of current object across C-calls, to ensure 
		that it is correct also in case of GC's during callbacks
		from the C-funktion.
		Needed to add slot externalEntrySaveStack in 
		ExternalReturn (filled by fragment in BetaRun.bet) to 
		make the above work, otherwise problem with tstcproc:

                  M29TSTCPROC
                    pushref %i0
                    packStackOff
		    _docallBack
		      _foo
                        unPackStackOff
                        M8TSTCPROC
                          M2BETAENV
                            M1PUT
                              pushref %i0
                              packStackOff
                              _write
			      unPackStackOff
			      popref %i0 (1)
                            ...
                          ...
                        ...
                        (2)
                      ...
                    unPackStackOff (3)
                    popref %i0 (4)
		
		The popRef at (1) causes the activeStack to be 
		inconsistent with the actual stackpointers. This in turn
		caused the unPackStackOff at (3) to restore *wrong* 
		pointers from the activeStack, causing the %i0 popped 
		at (4) to be wrong.
		The solution was to add a packStackOff in _foo at (2),
		which also makes sence, since we are here leaving BETA
		going back into the C-world.

		STATUS: tst now runs until tstgeneralrep even with GC
		in *every* possible place it can happen (controlled
		by setting do_unconditional_gc to true in BetaRun.bet
		and in betarun/C/define.h) 6615 IOAGc's (:-)(:-)(:-)(:-)

OLM: 27/8/97:	Switch 65: fixed problem with RToff=0 for tstbreakbody, etc.

OLM: 30/8/97:	Switch 65: fixed RToff=0 for tstmainpbody.
		
OLM: 1/9/97:	Bug fix for SGI: beta -o Xfoo foo

PA: 1/9/97:	Switch 65:
		BetaRun.bet:
		Implemented general AlloC, which uses findProto to
		disassemble the V-entry in order to find size of 
		component.
		gen1body.bet:
		No need to call special AlloBC anymore. The general
		AlloC is called instead.

		The routines ltS, gtS, geS, leS are temporarily given up
		in BetaRun.bet. The ones i C betarun are used.
		tst now runs until tstgeneralrep with NO errors.
		However, if do_unconditional_gc is defined, there
		is still a problem in tstvarptn. Should be easy to
		fix.

PA: 1/9/97:	Fragmented GENERATOR/RUN/BetaRun.bet.
		There is now a corresponding NoBetaRun.bet, which can be 
		used instead of BetaRun.bet (in BODY in SPARCmachine).
		NoBetaRun.bet has no support for switch 65.
		A stripped compiler linked using NoBetaRun.bet is
		approximately 150K less than a stripped compiler
		linked with BetaRun.bet (and will thus use 150K more 
		memory when launched).

PA: 2/9/97:	Fragmented GENERATOR/RUN/BetaRun.bet even more.
		Created files
		    AllocateComponent.bet
		    AllocateItem.bet
		    AllocateRepetition.bet
		    AllocateStackObject.bet
		    AttachSuspend.bet
		    Callback.bet
		    ExitObjects.bet
		    MakeTextObject.bet
		    PerformGC.bet
		    Structure.bet
		    SPARCmachinebody.bet
		inspired of the file name conventions in C betarun.

PA: 2/9/97:	Switch 65:
		Fixed problem with the one '!' in tstvarptn
		mentioned in "PA: 1/9/97". Only changes in C betarun.
		TST now runs until tstgeneralrep with no errors
		even with do_unconditional_gc.

PA: 3/9/97:	Switch 65:

		Many fixes in C betarun (assembler wrappers and 
		addition of CallAlloC wrapper for calling the BETA
		AlloC from C.
		Also in C betarun AOAtoIOAInsert was fixed: The old
		version could call AOAtoIOAReAlloc, which in turn could
		call AOAtoIOAInsert, getting blocked on the aoatoioa_lock
		semaphore.

		TST now works (including do_unconditional_gc).
		However, one error was corrected in PerformGC.bet:
		When returning from GC, the activeComponent (%g1)
		must be restored from TSD, since %g1 is clearly destroyed
		by C. This error only showed up in case of GC in AlloSO
		and if NOT using switch 13 (switch 13 calls various
		consistency check routines, and always restores %g1 after-
		wards).

PA: 8/9/97:	Added description of sgi registers in DOC/SGI.html.
		The comment in the start of MIPSmachine did not tell 
		the whole story!

PA: 8/9/97:	machine.bet+machinebody.bet:
		Fragmented code from "entrypoints" in machine.bet
		into machinebody.bet.
		Changed hashfunction to avoid multiple collisions.
		Old algorithm (value*100+ch)-value meant that in
		practice only the last 5 characters in an entrypoint
		name were significant, since ch*(100**5) will be larger
		than 32 bits for most ascii characters.
		Added comment on intended use to jsrT, jmpT, jmpTlong.

PA: 8/9/97:	gen2body.bet:
		In SpecialInitDesc:descriptor, now jmpTlong is used
		in case the entry point is not local.
  OLM >>>	What about the G-parts - is it the same problem?

PA: 8/9/97:	INTELmstate.bet+INTELBmachine.bet:
		Changes needed to make compile-time resolving of calls
		to local entry points possible. This is needed for SDK=gnu on
		NTI.
		Added four utilitypatterns (emitCallLocal, emitCallExtern,
		emitJmpLocal, emitJmpExtern) to mstate. These are used
		from INTELBmachine.

		A mechanism much like the resolving of LocalLabs is
		added to "entrypoints" (defined in machine.bet) via SLOTS.
		No new SLOTS needed.
		In short the pattern entryPoints.getAddr returns the address
		of an entrypoint if it is known or 0 if not known.
		In the latter case the usesite is remembered, and when 
		entryPoints.addDef is later called, the various use sites are
		patched up with the now known address of the entry point.
		This mechanism could easily be lifted into machine.bet with
		only the patching part being in MD fragments.
		It will generate less relocation entries for the linker
		to handle (SGI and PPCMAC would probably benefit from this).

		The implementation caused about 10% less relocation symbols
		to be generated for linux TST.
		Also this mechanism allowed me to optimize short local
		jumps to use jmp_short instruction.

		A particularly annoying problem was discovered during
		implementation of this mechanism: EntryPoints is a hashtable.
		The following construct

		T[]->entryPoints.find
                       (# 
                          notFound::(# do E[]->entrypoints.insert #)
                       #)

		can make the hashtable become inconsistent if T[] is later
		reused for another text. USE T.COPY IN THESE CASES!!!

PA: 8/9/97:	INTELmstate.bet
		In mstate.b.mark the following code is present:
		(if type
		 // entryDefMark then
                 (* FIXME:
                  * addDef is called in CODEmachine for all entry points 
                  * T117FOO, M117FOO, etc.
                  * For labels BETA_code1 addDef is NOT
                  * called - i.e. we must call here.
                  *)
                 (T[],not inCode)->entryPoints.addDef->epElm[markTop][]

		In order to avoid too many calls of addDef, I tried to change 
		this to the following:
		
		(if type
		 // entryDefMark then
                 T.copy-> entrypoints.find
                 (# notfound::
                      (# 
                      do (E.T[],not inCode)
			   ->entryPoints.addDef->epElm[markTop][]
                      #)
                 #);

   OLM >>>	However, this causes all entrypoints in the betadata file
		to become undefined at link time. WHY???

MG: 9/9/97:	Changed entrypoints.hashfuction to use common.honeyM.
		Results in much fewer collisions on eg. guienv_unixbody

MG+PA: 9/9/97:	Fixed ".s.db" files in SNAKEmachine.
		Name fixed, but also commented out generation, since
		.db files are currently not used on hpux9pa.

MG+PA: 10/9/97:	MT:
		Changes in C runtime system regarding slice allocation
		solved problem with 'manythreads 20' giving deadlock.

PA: 11/9/97:	Switch 65:
		Clearing of stack object for components that
		terminate. Should remove memory leak, where a terminated 
		component in AOA and its stack object (forced to stay 
		in IOA) is unbreakable cycle.

PA: 11/9/97:	Switch 65:
		Added parameter SaveOrigin to GENIOAAlloc, which makes
		it save %o0 in TSD during GC if true.
		Previously %o0 was always saved during GC, which could
		cause problems if, e.g. a C-function had been previously 
		called.
		
OLM: 14/9/97:	Bug fix (mainly for SGI and PPCMAC): in (foo).bar callReg
		for bar was allocated and undefined during evaluation of foo,
		which confused GC.

OLM: 14/9/97:	Added exception catch for .realOpen in translate_controlbody;
		There seems to be superflous exceptions is realOpen?

OLM: 15/9/97:	Bug fix; mkEntryPoint ... And various clean-up

OLM: 15/9/97:	Bug fix for bug fix introduced by previous bug fix:-)

OLM: 17/9/97:	Added -32 to SGI ld directive to be able to link on 
		Octane (SGI)

OLM: 23/9/97:	Added 'none->AST.theCatcher' for realOpen exception (14/9/97)

PA: 26/9/97:	Added preliminary interface for *reading* ELF files in
		GENERATOR/ELF/elfread.

PA: 28/9/97:	More work on GENERATOR/ELF/elfread:
		Added getSectionName, and split getRelEnt and scanRelEnts
		into getDataRelEnt, scanDataRelEnts, getTextRelEnt and 
		scanTextRelEnts, and likewise for Rela.
		Implemented rest of the fragments. getSectionName and 
		rel/rela stuff is not yet tested!

OLM: 28/09/97:	Added ELF/TEST and moved alle ELF test programs to TEST.

OLM: 28/09/97:	COM related changes.

PA: 29/9/97:	More work on GENERATOR/ELF:
		1. Fixed errors in elf.bet: ELF32_R_TYPE, ELF32_R_INFO.
		2. Fixed error in elfreadbody: getSymEnt returned same entry
		   every time called (actualy 4'th entry always).
		3. Get/Scan of Rel/Rela stuff now tests for type of section.
		4. Added rel_type_astext in elfread.bet, and made
		   (machine specific) bodies for this.
		5. Fixed scansymbols and readelffile so that they now
		   work on linux as well as sparc.
		   It ought also to work on sgi (code has been made), but
		   is does NOT! Due to the hard coded section numbers.

PA: 29/9/97:	Even more work on GENERATOR/ELF:
		Removed some of the hardcoded section numbers in 
		elfreadbody. The (new) test program nmcommand can read
		an executable file as well as an object file, and display
		the output almost as the 'nm -hpv ...' used in debugger and
		dynlink. There are differences, though - most visible
		is that nmcommand report many symbols twice, since they are 
		both in DYNSYM and SYMTAB for an executable. And nmcommand
		does not sort output.
		The pattern getSymEnt as well as all the Rel/Rela stuff
		still need to be fixed for hardcoded section index constants.
		The test program scansymbols now works on SGI too.
		readelffile will not work on SGI yet because of the hardcoded
		section numbers.

PA: 30/9/97:	Fixed most remaining elfread problems:
		Now no section indices are hardcoded - all are found
		from the section header table.
		Test programs scansymbols, nmcommand and readelffile
		now runs on sparc, linux and sgi.
		All work correctly except that nmcommand gives identification
		'P' (processor specific) for most entries for a SGI-generated
		executable file.
		A suggestion for improvements are described in start of
		elfread.bet (speed improvements).

OLM: 30/9/97:	Implemented first version of making COM objects in BETA.
		Status: 
		1. A C-implemented COM object can be imported to BETA
		2. A BETA-implemented COM object can be exported to C
	        3. 1 works for sparc and linux; 2 only for sparc
		But still a long way to go before a production prototype!

PA+MG: 30/9/97:	Fixes in asmlink.bet and NTIBasmlink.bet to support
		nti_gnu job files.
		Should be transparent to other platforms.

HR: 1+2/10	Reorganised compilerfacade.bet and fragmented it. Therefore
		compilerfacadeBody.bet was added to DYN.
		I also updated all test programs to reflect the new
		interface of compilerfacade.bet and its intended use.
		Documentation is part of compilerfacade.bet		

OLM: 7/10/97:	Mainly COM stuff. Eliminated machine: toXres which was only
	        in use for SPARC. Now dataRegA is intended to be the register
		where return values to C (and other external languages) is
		passed. toXres is still in machine to avoid removing the
		slots from all Xmachine.bet. 

		For COM status see http://www.daimi.aau.dk/~olm/DOC/COM.html
		
OLM: 10/10/97:  Reversed elimination of toXres since SGI is using it. And
		PPCMAC probably also. Should however be easy to eliminate 
		in the same way as was done for SUN4S.

OLM: 21/10/97: 	Bug fix in genOrgAdr (baseAdr.copy needed) to fix recListDemo
		problem in r4.1c
		Also fixed so-called gnu branch!

OLM: 22/10/97:	One more alias fix: evbody: baseAdr[] -> baserAdr.copy
		Also fixed so-called gnu branch!

