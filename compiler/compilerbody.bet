ORIGIN 'compiler';
INCLUDE '~beta/basiclib/mbs_version';
INCLUDE '~beta/newmps/grammarinit';

---compiler_init:doPart---
do InitBetaTarget;
   
   (if Mjolner[] = NONE then 'Mjolner'->mjolner[] if);
   
   (*BETAastIF;
   &BETAastIF.treeLevel[] -> beta[];*)
   
   BETAastIF.astlevelinit;
   &BETAastIF.beta[] -> beta[];
   (*** beta.init; ***)
   
   (# name: ^Text;
      current: ^Text;
      grammarSwitch: @boolean;
   do '~beta/grammars/beta/beta' -> name[];
      (for inx: NoOfArguments - 1 repeat
           inx + 1 -> arguments -> current[];
           (if grammarSwitch then
               current[] -> name[];
               false -> grammarSwitch;
            else
               '--grammar' -> current.equalNCS -> grammarSwitch;
           if);
      for);
      (name[],'beta',comp.bugStream[])
        -> beta.betagrammarInit; 
   #);
   true -> comp.init;
   
   (keyBoard[],BETAastIF[],comp[]) -> getNextArgument.init;          
   
   (if comp.verboseLevel <= comp.verboseLevel.actions then
       Mjolner[] -> comp.infostream.puttext;
       ' BETA Compiler: ' -> comp.infostream.puttext;
       (mbs_version).desc -> comp.infostream.puttext;
       '(' -> comp.infostream.puttext;
       comp.compilerversion -> comp.infostream.puttext;
       (if true then
           '/' -> comp.infostream.puttext;           
        else
           ' - Runtime System: '->comp.infostream.puttext;
       if);
       (# BR: ^text
       do comp.betarunVersion -> BR[];
          (5,BR.length-1) 
            -> BR.sub 
            -> comp.infostream.puttext;
       #);
       (*'\nTarget machine platform: ' -> comp.infostream.puttext;*)
       ')' -> comp.infostream.put;
       ' - ' -> comp.infostream.puttext;           
       comp.targetMachineText[] -> comp.infostream.puttext;
       comp.infostream.newline
   if);
   INNER init
