ORIGIN 'tstenv'
---lib:attributes---
tstvirt2:
(#  a1: @char; foo: @ (# b: @char #);
    A: (# do a1->put; foo.b->put; INNER #);
    W: (# V: < A do INNER #);
    WW: W(# c2: @char;
	    V::< (# c1: @char do 'c'->put #); X: @V 
	do X 
        #);
    B: (# C: (# W2: W(# do INNER #);
		D: (# W3: W2(#  V::< (# do 'f'->put #) do V #) do W3 #)
		do D
		#)
	do C
	#);

    T: (# P: (#  V: < F do 'g'->ch1; 'h'->ch2; V #);
          F: (# do ch1->put; ch2->put; INNER #);
          ch2: @char
       #);
    ch1,ch3: @char;
    R: ^T;
    QQQ:
     (# P: (# q3: @ char do inner; 's'->c6 #);
        c6: @char;
        T: (# A: (# q1: @ char; f: ^D;  do &A[]->f[]; inner; 'q'->c4 #);
              c4,c5: @char;
              D:<A;  
              X1: (#  B: (# q2: @ char; g: @ D do inner ; 'r'->c5 #);
	              X2: (# V:<A ; W:<B; U:<P do V; W; U; Inner #)
                  do inner
                  #);
              B1: (# c1: @ char
                  DO (# c2: @ char
	             do X1(# c3: @ char
		          do (# 
         		     do (#
			        do X2(# V::<(# q3: @char 
					    do 'k'->f.q1->put; 'n'->c1 #);
			                W::<(# q4: @char 
					    do 'l'->g.q1->put; 'o'->c2 #);
				        U::<(# q5: @char 
					    do 'm'->q3->put; 'p'->c3 #)
			              do c1->put; c2->put; c3->put; c4->put
	     #)#)#)#)#)#)
           do '!'->c4->c5; B1; c5->put
           #)
     do '!'->c6; T; c6->put
     #);
   madsn:
     (# theA: @
          (# B: (# C:(# V:< charValue  
                     do ch->put; V->put; inner; ch->put 
          #)#)#);
        theB: @theA.B(##);
        theC: @theB.C(# V::< (# do 'u'->value #) do  'v'->ch  #);
        ch: @integer
     do 't'->ch;
        theC
     #);
   final:
     (# PO: (# TTT:< (# #) do inner#);
        qqq: (# P: PO
                  (# aaa: (# V:<object; i,j: @integer; #);
                     bbb: aaa (# x,y: @integer;  V::TTT #);
                     TTT::(# t: @text enter t exit t #);
                     b: @bbb;
                     t: ^TTT
                  do &b.V[]->t[]; 'w'->t;
                     t.t->puttext;
                     'xy'->&b.v->puttext
                  #)
             do p
             #)
     do qqq
     #)

do 'a'->a1; 'b'->foo.b; WW;
   'd'->a1; 'e'->foo.b; B;
   &T[]->R[]; 'j'->ch3;
   R.P(# V::< (*R.F*)(# do 'i'->put; ch3->put #) #);
   QQQ;
   madsn;  
   final;
   'z0123456789'->putText
#)


 
