origin '../tstenv';
INCLUDE 'tstdumplib';
-- program: descriptor --
(# a: @|z(# pp: @p(# x:^object do x #); (* RefNoneErr: Reference is none *)
         do pp
         #);
do a
#)

(* stack layout at dump time:
 * 
 *   |    main            |
 *   |____________________|
 *   |                    |
 *   |    M1BETAENV       |
 *   |____________________|
 *   |                    |
 *   |    M1PROGRAM       |
 *   |____________________|
 *   |                    |
 *   |    Att             |
 *   |____________________|
 *   |                    |
 *   |    M3TSTDUMPLIB    |
 *   |____________________|
 *   |                    |
 *   |    M2PROGRAM       |
 *   |____________________|
 *   |                    |
 *   |    M1TSTDUMPLIB    |
 *   |____________________|
 *   |                    |
 *   |    M3PROGRAM       |
 *   |____________________|
 * 
 *)

(* Correct dump (including INNER chain):

  item <pp#>p# in ~beta/betarun/v2.8/sgi/TST/tstdump/tstdump02
    -- a#z# in ~beta/betarun/v2.8/sgi/TST/tstdump/tstdump02
  item pp#<p#> in ~beta/betarun/v2.8/sgi/TST/tstdump/tstdumplib
    -- BETAENV-~ in ~beta/betarun/v2.8/sgi/TST/tstenv
  comp <a#>z# in ~beta/betarun/v2.8/sgi/TST/tstdump/tstdump02
    -- PROGRAM-~ in ~beta/betarun/v2.8/sgi/TST/tstdump/tstdump02
  comp a#<z#> in ~beta/betarun/v2.8/sgi/TST/tstdump/tstdumplib
    -- BETAENV-~ in ~beta/betarun/v2.8/sgi/TST/tstenv

  item <PROGRAM-~> in ~beta/betarun/v2.8/sgi/TST/tstdump/tstdump02
    -- BETAENV-~ in ~beta/betarun/v2.8/sgi/TST/tstenv
  basic component in ~beta/betarun/v2.8/sgi/TST/tstenv

 *)
