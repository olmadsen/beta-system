ORIGIN 'tstenv';
--PROGRAM: descriptor--
(# attToThread: external
     (# comp: @integer;
        tid: @integer;
     enter comp
     exit tid
     #);
   ta,tb,tc,td,te: @integer;
   thread: (# t:@Integer; 
           do L: (# 
                 do (for 1000000 repeat 
                         1->t;
                    for);
                    INNER thread;
                    restart L
                 #)
           #);
   a: @|thread(# do 'a'->put #);
   b: @|thread(# do 'b'->put #);
   c: @|thread(# do 'c'->put #);
   d: @|thread(# do 'd'->put #);
   e: @|thread(# do 'e'->put #);
   
do @@a -> attToThread -> ta;
   @@b -> attToThread -> tb;
   @@c -> attToThread -> tc;
   (* FIXME: Problems with destroy_TSD with more than three threads... *)
   (* @@d -> attToThread -> td;
      @@e -> attToThread -> te;
   *)
#)
