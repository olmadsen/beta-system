ORIGIN '~beta/basiclib/betaenv';
INCLUDE '~beta/sysutils/objinterface';
--PROGRAM: descriptor--
(# try:
     (# print:
          (# do 'Hello, I am a Try!' -> putline; #);
     do INNER
     #);
   
   throw:
     (# proto: @integer;
        obj: @integer;
        theTry: ^try;
        find_activation: external
          (# proto, startObj, theObj: @integer;
          enter (proto, startObj)
          exit theObj
          #);
     do try## -> getProtoTypeForStruc -> proto;
        (proto, 0 (*@@myTry*)) -> find_activation -> obj;
        (if obj<>0 then
            obj -> addressToObject -> theTry[];
            theTry.print;
         else
            'No try block found' -> putline;
        if);
     #);
   
do try
   (# foo: (# do INNER #);
      bar: foo(# do INNER #);
   do bar(# do throw #);
   #);
#)
