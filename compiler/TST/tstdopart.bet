ORIGIN 'tstenv';    
BODY 'tstdopartbody'
--LIB:attributes--
tstDoPart:
  (# x,y: @char;
     A: (# q,w: @char;
           f1: (# a,b: @char
               enter(a,b) <<SLOT f1: dopart>>
               exit b
               #);         
           f2: (# a,b: @char
               enter(a,b) <<SLOT f2: doPart>>
               exit b
               #);
           f3s: (# Vput:<(# ch:@char enter ch do ch->put; inner #);
                do INNER
                #);
           f3: f3s(# a,b: @char;
                     Vput::<(# do #);
                     append: (# T1: ^f3 enter T1[] <<SLOT append:doPart>> #);
                     scanall: 
                       (# ch: @char   
                       do (for i:1 repeat a->ch; INNER for)
                       #);
                  enter(a,b) <<SLOT f3: doPart>>
                  exit b
                  #);
           f4: (# a,b: @char
               enter(a,b) <<SLOT f4: doPart>>
               exit b
               #);               
        #);
     f5: (# <<SLOT f5:doPart>> #);
     f6: f5(# do '0'->put #);
     f7: (# <<SLOT f7:doPart>> #); 
     f8: f7(# do '1'->put #);
     f9: (# <<SLOT f9:doPart>> #);
     f10: f9(# do '2'->put #);
     f11: (# <<SLOT f11:doPart>> #); (* M18*)
     f12: f11(# <<SLOT f12:doPart>>#); (*M19*)
     f13: f12(#do '3'->put #);
     
     
     H: @A;
     c1: @char;
  do 'a'->x; 'b'->H.q; ('c','d')->H.f1->c1; c1->put; (* a-e *)
     'f'->y; 'g'->H.w; ('h','i')->H.f2->c1; c1->put; (* f-m *)
     'n'->x; 'o'->H.q; ('p','q')->H.f3->c1; c1->put; (* n-r *)
     's'->y; 't'->H.w; ('u','v')->H.f4->c1; c1->put; (* s-z *)
     f6; f8; f10; f13;
     '456789'->puttext
  #)

