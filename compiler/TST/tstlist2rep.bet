ORIGIN 'tstenv' ;
INCLUDE 'tstlib'
---lib:attributes---
tstlist2rep:
  (# stream: 
       (# putt:
            (# ch: @char
            enter ch
            do ch -> put
            #)
       #);
     screen: @stream;
     
     R: [3] @ integer;
     PutR:
       (# base: @char
       enter base
       do (for i: R.range repeat
               R[i] + base - 1 -> put
          for);
       #);
     
     a,b: @integer;
     foo:
       (# s: ^stream; L: [1] @integer; ch: @char
       enter(s[],L,ch)
       do (for i:l.range repeat
               L[i] -> S.putt;
          for);
          ch -> put;
       #);
     bar:
       (# c: [1] @char
       enter c
       do (for i:c.range repeat c[i] -> put for);
       #);
     ch: @char;
     F: [1] @real;
     PutF:
       (# N: @integer
       do (for i: F.range repeat
               (if F[i] 
                // 1.1 then 't' -> put
                // 2.2 then 'u' -> put
                // 3.3 then 'v' -> put
                // 4.4 then 'w' -> put
                // 5.5 then 'x' -> put
                // 55 then 'y' -> put
                // 66 then 'z' -> put
                // 77 then '0' -> put
                else
                   (if (F[i], 3.3) -> eqR then
                       'v' -> put
                    else
                       '!'->put
          if)if)for);
       #);
     X: @real;
     L: [10] ^T;
     L1,L2: ^T;
     T: (# x,y: @integer 
        do xx + 1 -> xx; xx+1111 -> x; xx+2222 -> y 
        exit this(t)[]
        #);
     xx: @integer;
     PutL:
       (#
       do '\nPutL:range:'->puttext; L.range -> putint; 
          (for i: L.range repeat 
               ' '->put; L[i].x -> putint; 
               ' '->put; L[i].y -> putint; 
          for);
          newline;
       #);

     S: [1] ^text;
     T1,t2: @text; t3: ^text;
     tstMore:
       (# T,S: @text
            (# pos: @integer;
               get:
                 (# ch: @char
                 do T[pos+1->pos] -> ch
                 exit ch
                 #);
               getint:
                 (# n: @integer; ch: @char
                 do L: (if (get->ch) <= ' ' then restart L if);
                    L: (if ('0'<= ch) and (ch <= '9') then
                           n*10 + ch - '0' -> n;
                           get -> ch;
                           restart L
                       if)
                 exit n
                 #); 
            #);
          a1,a2,a3: @integer;
          R: [1] @char
       do 97 -> S;
          S[] -> puttext2;

          '98  99  100  101 102 103 104 105' -> T; 
          0 -> T.pos;
          
          T.getint -> S; 
          S[] -> puttext2;
          
          
          T.getint->a1;  T.getint->a2;  T.getInt->a3;
          (# x: @char 
          do (a1,a2,a3) -> S;
          #);
          S[]->puttext2;

          
          T.getint->a1;  T.getint->a2;  T.getInt->a3;
          (a1,a2,a3) -> R;  
          (for i: R.range repeat R[i]->put for);
       #);
     tstwithObj:
       (# putInt16Array: 
            (# Dimensions: [0]@integer;
               R: ^text;
            enter(Dimensions, R[])
            do (for i: dimensions.range repeat 
                    dimensions[i] -> put
               for);

            #); 
          ccc: @char;
          foo: (# do ccc+1 -> ccc exit ccc #)
       do 'h'-> ccc;
          ((foo,foo), &text[]) -> putInt16Array 
       #)
  do 2->a; 3 -> b;      
     (1,a,b) -> R;
     'a' -> PutR;   
     'd' -> a;
     (screen[],(a,'d'-2+b,'f','g','h'),'i') -> foo;

     ('j','k','l','m','n') -> bar;  
     
     'o'-'a'+1 -> a;
     a -> R;
     'a' -> PutR; 

     'p'-'a'+1 -> R;
     'a' -> PutR; 
     
     a + 2 -> R; 'a' -> PutR;   
     'r' -> bar;
     's'-> ch;
     ch -> bar;
     1.1 -> F; PutF;  
     2.2 -> X; 
     X -> F; PutF; 
     x + 1.1 -> F; PutF;
     (4.4,5.5) -> F; PutF;    (* To be fixed *)
     77 -> a;  
     (55,66,a) -> F; PutF;      (* To be fixed *) 
     (8.8,9.9) -> R; '1'-7 -> PutR;    (* OK *)
     
     (screen[],'3'+0,'4') -> foo; (* OBS!   (screen[],'3','4') -> foo;
                                   * won't work since '3' generates a
                                   * txtCstVal::asgToRepAdr, which does not work
                                   *)
     
     '5'->fill;
     newL;
     tstMore;
     tstWithObj;
     
     'k' -> fill;
     (* to be fixed: *)

     (* &T -> L; PutL; *)
     
     (*
      &T -> L1[]; &T -> L2[];
      (&T,L1[],L2[]) -> L; putL; 
      'Hello ' -> T1;  
      'World ' -> T2; 
      T1[] -> T3[];
      T1[] -> S;
      
      (T1[],'beautiful ',T2[]) -> S;
      *)
     (* errors:
      X -> bar;
      (X,1.1) -> bar
      *)
  #)




