ORIGIN 'tstenv';        
INCLUDE 'tstlib'
---lib:attributes---
TstRep:
  (# R: [26] @char;     
     S: [10] @char;  
     R1,R2: [10] @char;  (* AlloVR1 *)
     R3,R4: [10] @int16; (* AlloVR2 *)
     R5,R6: [10] @int32; (* AlloVR4 *)
     R7,R8: [10] @real;  (* AlloVR8 *)
     T1,T2: @ Stext;
     
     addZ: (# i: @integer enter i do i+'0'->i exit i #);
     Stext: 
       (# R: [1] @ Char; len: @integer
       enter (# enter R do R.range->len #)
       exit R[1:len]
       #);
     computedRange:
       (# R: [size] @integer;  
          R2: [extraSize] ^ text; 
          size:< (# v: @integer do INNER exit v #);
          extraSize:<
            (# V: @integer
            do 100 -> V; inner; 
            exit V->foo 
            #);
          foo: 
            (# V,value: @integer   
            enter V    
            do V + 20 -> value; 
               (for i: R.range repeat i -> R[i] for);
               '3'->put
            exit value
            #)
       do INNER; 
          (if R[5] = 105 then '4'->put else '!'->put if);
          (if R2[130].T.range  = 2 then '5'->put else '!'->put if);
       #);
  do (for i: 26 repeat 'a'-1+i->R[i] for);
     (for i: 26 repeat R[i]->put for);
     (for i: s.range repeat i->addZ->S[i] for);
     (for i: s.range repeat S[i]-1->R[i] for);     
     (for i: s.range repeat R[i]->put for); 
     newl;
     'abcdefghijklmnopqrst'->R; R->S; S->putText;   
     '!@#$uv$%^'->R1; (* CopyVR1 *)
     R1[5:6]->R2; (* CopySVR1, range 2 *)
     R2->puttext; 
     1000->R1.new; (* NewVR1, range 1000 *)
     'w'->put;
     (for i: 1000 repeat '!'->R1[i] for);
     'x'->R1[100];
     R1[91:990]->R2; (* CopySVR1, range=900 *)
     R2[10:10]->puttext;
     1000->R3.new; (* NewVR2, range 1000 *)
     'y'->put;
     (for i: 1000 repeat '!'->R3[i] for);
     'z'->R3[100];
     R3[91:990]->R4; (* CopySVR2, range=900 *)
     R4[10:10]->R3; R3[1]->put;
     1000->R5.new; (* NewVR4, range 1000 *)
     '0'->put;
     (for i: 1000 repeat '!'->R5[i] for);
     '1'->R5[100];
     R5[91:990]->R6; (* CopySVR4, range=900 *)
     R6[10:10]->R5; R5[1]->put;
     1000->R7.new; (* NewVR8, range 1000 *)
     '2'->put;
     (for i: 1000 repeat -1.0->R7[i] for);
     8.0->R7[100];
     R7[91:990]->R8; (* CopySVR8, range=900 *)
     R8[10:10]->R7;
     (if R7[1]=8.0 then
         '3'->put;
      else
         '!'->put;
     if);
     '45678!@#'->T1; 
     T1->T2; 
     T2.len-3->T2.len;  
     T2->T1; T1->puttext; '9'->puttext; 
     newl;
     5->R.new; 
     (for i: 26 repeat
          (if (i>R.range)//true then R.range->R.extend if);
          'a'-1+i->R[i];
     for);  
     (if (R.range>26)//true then 26-R.range -> R.extend if);
     (for i: R.range repeat R[i]->put for); 
     (# Getname: (# T1: @Stext do '012'->T1 exit T1 #); 
        name: @Stext   
     do getname -> name;
        name->puttext
     #);
     computedRange
     (# size::(#do 10->V #);
        extraSize::< (#do V+10 -> V #);
        x: @integer
     do 105->R[5];
        &text[] -> R2[130][]; 
        (# x: @char do 'go'->R2[130]; #);
     #);
    '6789'->puttext;
  #)




 
