ORIGIN 'tstenv';   
INCLUDE 'tstlib'
---lib:attributes---
TstRep:
  (# R: [26] @char; 
     S: [10] @char;
     R1,R2: [10] @char;
     T1,T2: @ Stext;
     
     addZ: (# i: @integer enter i do i+'0'->i exit i #);
     Stext:
       (# R: [1] @ Char; len: @integer
       enter (# enter R do R.range->len #)
       exit R[1:len]
       #);
     computedRange:
       (# (*R: [size] @integer;*)
          R2: [extraSize] ^ text;
          size:< (# v: @integer do INNER exit v #);
          extraSize:<
            (# V: @integer
            do 100 -> V; inner;
            exit V->foo
            #);
          foo:
            (# V,value: @integer  
            enter V 
            do V + 20 -> value;
               (for i: R.range repeat i -> R[i] for);
               '3'->put
            exit value
            #)
       do INNER;
               (*(if R[5] = 105 then '4'->put else '!'->put if);*)
          (if R2[130].T.range  = 2 then '5'->put else '!'->put if);
       #);
  do (for i: 26 repeat 'a'-1+i->R[i] for);
     (for i: 26 repeat R[i]->put for);
     (for i: s.range repeat i->addZ->S[i] for);
     (for i: s.range repeat S[i]-1->R[i] for);    
     (for i: s.range repeat R[i]->put for);
     newl;
     'abcdefghijklmnopqrst'->R; R->S; S->putText;
     '!@#$uvwxyz$%^'->R1; R1[5:10]->R2; R2->puttext;  
     '012345678!@#'->T1; 
     T1->T2; T2.len-3->T2.len; 
     T2->T1; T1->puttext; '9'->puttext;
     newl;
     5->R.new;
     (for i: 26 repeat
          (if (i>R.range)//true then R.range->R.extend if);
          'a'-1+i->R[i];
     for);  
     (if (R.range>26)//true then 26-R.range -> R.extend if);
     (for i: R.range repeat R[i]->put for); 
     (# Getname: (# T1: @Stext do '012'->T1 exit T1 #);
        name: @Stext
     do getname -> name;
        name->puttext
     #);           
     computedRange
     (# size::(#do 10->V #);
        extraSize::< (#do V+10 -> V #);
        x: @integer
     do extrasize->x;
        (*105->R[5] ;*) &text[] -> R2[130][]; 'go'->R2[130] 
     #);
     '6789'->puttext;
  #)


