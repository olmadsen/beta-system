ORIGIN 'tstenv';
INCLUDE 'tstlib'
---lib:attributes---
Automat:
  (# status: [3] @char;
     Statusud: @
       (# 
       do (for i: 3 repeat
               origin.status[i]->put
          for)
       #)
  do (for i: 3 repeat
          'n' + i -> status[i]
     for);
     StatusUd
  #);

tstOrigin:
  (# A: 
       (#  P: 
            (# BB: B
                 (# ch: @char
                 enter ch
                 do ('de',ch)->this(BB).origin.fisk
                 #);
               fisk: 
                 (# T: ^text; ch: @char enter(T[],ch) 
                 do t[]->putText2; ch->put; (*newline*)
                 #)
            do (if first then
                   this(P).origin[] -> R[];
                   origin[] -> R2[];
                   'a'->origin.foo; 
                   'b'->this(P).origin.foo;
                   'c'->this(p).origin.origin.bar;
                   'f' -> BB
                else
                   'n'->put
               if);
            #);
          R,R2: ^ object;
          S: ^A;
          foo: 
            (# ch: @char 
            enter ch 
            do (*'Hello world:'->putText; *)
               ch->put;
               (*newline;*)
               (if first then origin## -> o##
                else NONE -> o##
               if)
            #)  
       do P; 
          (if first then
              R[]->S[]; 'g'->S.foo; R2[]->S[]; 'h'->S.foo
          if);
       #);
     B: (#  do INNER #);
     xxx: ^_struc;
     bar: 
       (# ch: @char 
       enter ch 
       do (*'Here is bar:'->puttext;*) ch->put; (*newline *)
       #);

     o: ##object;
     foo: (# <<SLOT foo:dopart>> #);
     snorf: (# <<SLOT snorf:doPart>> #);
     t1,t2: @text;
     c1,c2: @char;
     first: @boolean
  do true -> first;
     A;
     (* 'Hello '->t1;*)
     'ij'->t1;
     foo;
     (*'world:'->t2;*)
     'kl' -> t2; 
     'm' -> c2;
     snorf;
     
     false -> first;
     o;
     automat;
     'r'->fill
  #)   

---foo:dopart---
do origin.t1 -> puttext;
   (for i: 2 repeat for); 
   'k' -> c1;
---snorf:dopart---
do origin.t2 -> puttext;
   origin.c2 -> put; 
   (*newline*)
   
