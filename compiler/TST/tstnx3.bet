ORIGIN 'tstenv' ;   
(*LIBRARY 'tstnx'*)
---LIB:attributes---
TstNX3:
   (# A: @ (# exit(R[i],R[j]) #);
      B: @ (# enter(R[k],R[l]) #);
      C: @ (# do exit(S[i],S[j]) #);
      D: @ (# enter(S[k],S[l]) do #);

      R: [10] @ char;      i,j,k,l: @integer;
      S: [11] ^ T; T: (# ch: @char enter ch do exit ch #);

      Q: (# V:< object do &V[]->W #); 
      W: (# E: ^object enter E[] do 'e'->put; E #);
      E1: (# do 'g'->put #); E2: (# do 'h'->put #); 
      E3: (# r1,r2: ^Object enter (r1[],r2[]) do r1; r2 #);

      F: (# Q: (# q1,q2: @char enter(q1,q2) do q1->put; q2->put #);
	    X: @Q; a,b: @char
	 enter(a,X,b,Q) do a->put; b->put 
         #); 
      TTT: (# ch: @char;
             set: (# enter ch do #)
           enter set 
           exit ch
           #);
      NTA: (# q1,q2: @TTT enter (q1,q2) do q1->put; q2->put #); 

      QQQ: (# aaa: (# a,b,c: @char
                    enter((a,b,c)->bbb->(a,b)) exit(a,b) 
		    #);
	      bbb: (# x,y,z: @char 
	            enter(x,y,z) do x->put; y->put; z->put; 't'->z; 'u'->y
         	    exit (z,y)
	 	    #);
	      ccc: (# ddd: 
		       (# i,j,k: @integer 
		       enter(i,j,k) do i->put; j->put; k->put; 'y'->w #)
		    enter ddd
		    do 
		    #);
	      q,w: @char  ;
	      zzz: (# z1,z2,z3: @char;
	              set: (# enter(z1,z2,z3) do #)
     	           enter set do INNER #);
	      zzz1: zzz(# do exit(z1,z2,z3)#); 
	      zzz2: zzz(# get: (#exit(z1,z2,z3)#) do exit get #);
	      zzz3: (# x1,x2,x3: @char;
		       putt: (#enter(x1,x2,x3)do #);
		       out: @ (#do exit(x1,x2,x3)#)
	            enter putt exit out #);
	      c1,c2,c3: @char
	      
	   do ('q','r','s')->aaa->(q,w); q->put; w->put;
              ('v','w','x')->ccc; w->put;
              ('z','0','1')->zzz1->zzz2->zzz3->(c1,c2,c3);
              c1->put; c2->put; c3->put
	   #)
   do 1->i; 2->j; 3->k; 4->l; 'a'->R[1]; 'b'->R[2];
      (for i:4 repeat &T[]->S[i][] for); 'c'->S[1]; 'd'->S[2];  
      (#do A->B ; C->D #);
      R[3]->put; R[4]->put; S[3]->put; S[4]->put;
      Q(# V::<(#do 'f'->put #) #);
      (&E1[],&E2[])->&E3;
      (# a1,a2,a3,a4,a5,a6: @char
      do 'i'->a1; 'j'->a2; 'k'->a3; 'l'->a4; 'm'->a5; 'n'->a6;
         (# q1: @char do(# q2: @char do  (a5,(a1,a2),a6,(a3,a4))->F #)#)
      #);
      ('o','p')->NTA;
      QQQ;
      '23456789'->putText
   #)

 
