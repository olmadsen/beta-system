ORIGIN 'tstenv'; 
include 'tstlib';


----LIB:attributes---
TstRelOp:
  (# x,y: @integer; b: @boolean; ch,c1,c2: @char;
     qqq: (# do exit X #);
     putCh: @(# do (if b then ch+1->put else ch->put if)#);;
     tstRelLog:
       (#
          IfNum: 
            (# T: ^text; n: @integer; boo: @boolean; ch: @char
            enter T[]
            do true->boo; 
               (for i: T.T.range repeat
                    T.T[i]->ch;
                    n+1->n;
                    (if ((ch<'0') or ('9'<ch)) (* is not a digit*)
                        and
                        ((n>1) or
                        not ((ch='-') or (ch='+'))) (* and not the sign *)
                        then false->boo
               if)for)
            exit boo
            #);
          T: ^text
       do (if '123'->IfNum then 'p'->put else error if);
          (if '-123'->IfNum then 'q'->put else error if);
          (if '12x3'->IfNum then error else 'r'->put if);
          (if '12-3'->IfNum then error else 's'->put if);
          (if 'abe'->IfNum then error else 't'->put if);
          
       #) ;
     ItemRelExp:  
       (# T,ext: [4] @char; c1,c2,c: @char;
          lowcase: @
            (# c: @char
            enter c
            do
            exit c
            #);
       do 'aXcd' -> T; 
          '.bet' -> ext;
          (for i: 4 repeat 
               T[i] -> c1; ext[i] -> c2;
               (* newline; c1 -> put; c2 -> put; ' ' -> put;
                c1-> lowCase -> put; c2-> lowCase -> put;
                *)
               (if (c1-> lowCase) <> (c2 -> lowCase) then
                  't' + i -> put
                else    
                   error
               if);
          for)
       #);
 
  do 'a'->ch; 
     333->x; 1011->y; (x=y)->b; putCh; (* 'a' *) 
     333->y; (x=y)->b; putCh; (* 'b' *)
     ch+2->ch;
     (x=111)->b; putCh; (* 'c' *)
     (x=333)->b; putCh; (* 'd' *)
     ch+2->ch;
     111->y; (x<y)->b; putCh; (* 'e' *)
     555->y; (x<y)->b; putCh; (* 'f' *) 
     (x=y) and (y=x)->b; (b,false,'g')->chkBool;
     (# dum:@char do (if ((x=x) and (y=y))// true then 'h'->put else error if); #);
     (if true 
      // (x=y) and (y=x) then '?'->put 
      // (x<>y) and (y<>x) then 'i'->put
      // (x+y) = (y-x) then '?'->put
      // (x-y) = (y+x) then '?'->put
      else error   
     if);

     999->X; (X=QQQ,true,'j')->chkBool; (QQQ=X,true,'k')->chkBool;
     ((x-14)<QQQ,true,'l')->chkBool; (QQQ>(x-15),true,'m')->chkBool;

     
     65->c1; 255->c2;
     (if (c1 < c2) // true then 'n'->put else error if);
     (for i: 255 repeat
          i-1->c1;
          (if c1<c2 // true then else error if);
          (if c2>c1 // true then else error if);
          i->c1;
          (if c1<=c2 // true then else error if);
          (if c2>=c1 // true then 'o'->ch else error if);
     for);
     ch->put; 
     tstRelLog;
     ItemRelExp;
     'yz0123456789'->puttext
  #)


