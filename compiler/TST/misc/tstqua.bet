ORIGIN 'tstenv';
BETARUN sun4 '~beta/betarun/v2.5/sun4/betarun.qua'
---program:descriptor--
(# vehicle: (# licenseNo: @integer #);
   Bus: Vehicle(# noOfPas: @integer #);
   Truck: Vehicle(# #);
   TouristBus: Bus(# #);
   
   aVeh: ^vehicle;
   aBus: ^bus;
   foo:
     (# T:<vehicle; R: ^T
     enter R[]
     do (if boo//false then
            &T[]->R[]; aVeh[]->R[];
            'OK4\n'->puttext;
            true->boo
        if)
     #);
   boo: @boolean;
   F1: ##vehicle; F2: ##bus;
   bar:
     (# Q: (# V:< object do &V[]->W #);
        W: (# E: ^object enter E[] do 'e'->put; E #);
        ttt: (# do INNER #)
     do Q(# V::<(#do 'f'->put #) #);
     #);
   kuk:
     (# T: (# do INNER #);
        TX: T(# do 'g'->put; INNER #);
        D: (# V:<TX; F: ##T; R: ^T do V##->F##; &F[]->R[]; R; inner #);
        DD: D(# V::<(#do 'h'->put #) 
             do (if V## <= T## //true then
                    'OK'->puttext else 'Non OK'->puttext if)
             #);
     do DD
     #)

do
   &Bus[]-> aBus[];
   aBus[]->aVeh[];
   aVeh[]->aBus[];
   'OK1\n'->puttext;
   
   &TouristBus[]-> aBus[];
   aBus[]->aVeh[];
   aVeh[]->aBus[];
   'OK2\n'->puttext;
    
   &Truck[]->aVeh[];
   aVeh[]->aBus[]; 	
   'NON OK1:\n'->puttext;
   
   aBus[]->foo;		
   'OK3\n'->puttext;   
   aVeh[]->foo;
   'OK5\n'->puttext;

   &Truck[] ->aVeh[];
   aVeh[]-> foo(# T::<Bus #);
   'NON OK2:\n'->puttext;
   
   &truck[]->foo;
   'OK6\n'->puttext;

   &truck[]->foo(# T::<Bus #);
   'NON OK3\n'->puttext;

   bus##->F1##;
   F1##->F2##;
   
   bar;
   kuk;   
#)
