ORIGIN '~beta/basiclib/v1.6/betaenv';
BUILD sun4s 'account.o' 'account.c' '\$CC -g -c -o $0 $1';
---lib:attributes---
(* An example of a COM object written in BETA;
 * it can currently NOT be acompiled, linked and run.
 * A new descriptor kind (comKind) should be introduced;
 * in chkdescbody:chkcproc:checkForVirtuals, it should
 * be checd if the virtual has a do-part, in which case
 * it is a com object implemented in BETA otherwise
 * it is imported to BETA. Perhaps we should have
 * externalComKind and comKind?
 *)
Account: external
  (# init:<
       (# name: [1] @char; initialAmount,balance: @integer
       enter(name,initialAmount)
       do name -> this(Account).name; 
          initialAmount -> balance;
       exit balance
       #);
     deposit:< 
       (# amount,balance: @integer 
       enter amount
       do balance + amount -> balance
       exit balance
       #);   
     withdraw:< 
       (# amount,id,balance: @integer  
       enter amount
       do balance - amount -> balance 
       exit balance  
       #);
     name: @text;
     balance: @integer;
  #);     
PutAccount: external(# R: ^Account enter R[] #);

--program:descriptor---
(* This is a BETA program using a simulated MS-OLE-object *)
(# 
   R: ^Account;   
do &Account[] -> R[];
   ('Karl Pedersen',5000) -> R.init;
   R[] -> PutAccount
#) 


   
