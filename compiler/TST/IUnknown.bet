ORIGIN 'tstenv'   
---lib:attributes---
IUnknown: COM   
  (# Query: 
       (# IfId: @integer; I: ^IUnknown  
       enter IfId 
       do 'Query interface: ('->puttext; INNER ; ')\n'->puttext
       exit I[] 
       #);
     QueryInterface:< Query;
     AddRef:< (# do refCount + 1 -> refCount; INNER #);
     Release:< (# do refCount - 1 -> refCount; INNER #); 
     refCount: @integer
  #);

IUnknown2: COM   
  (# Query: 
       (# theIID: ^IID;  
          ppv: @ (*RefToComRef2; *) Integer;
          ppvObj: ^IUnknown2;
          returnPPV:
            (#
            do ' - ppv adr: ' -> puttext;
               (%getLongAt (@@ppvObj)) -> putint;
               (%getLongAt (@@ppvObj)) %putLongAt (ppv);
            #);
          H: @integer;
       enter(theIID[],ppv)
       do '(QueryInterface: '->puttext;  
          theIID.id1 -> putint; ' '-> put;
          theIID.id2 -> putint; ' '-> put;
          theIID.id3 -> putint; ' '-> put;
          theIID.id4 -> putint; ' '-> put;
          INNER ; 
          returnPPV;
          ')\n'->puttext
       exit H 
       #);
     QueryInterface:< Query;
     AddRef:< (# do refCount + 1 -> refCount; INNER #);
     Release:< (# do refCount - 1 -> refCount; INNER #);
     refCount: @integer
  #);
IID: data
  (# id1,id2,id3,id4: @integer (* not the right format *)
  #);





