ORIGIN 'tstenv'      
---LIB:attributes---
TstBlock:
  (# a,b,c: @char;

     T: (# d,e: @char;
           P: (# f,g: @char;
                 YT:
		   (#
		   do a->put; b->put; c->put; d->put; e->put; f->put; g->put
	           #);
              do 'f'->f; 'g'->g; YT
              #);
        do 'd'->d; 'e'->e;
           P;
        #);

     x: @T;
     y: @x.P;
     z: @y.YT;

     W: @
       (# d: @char;
          V: @
            (# e: @char
            do 's'->e;
               (#
               do a->put; b->put; c->put; d->put; e->put; 
                  
            #)#);
       do 'o'->a; 'p'->b; 'q'->c; 'r'->d; V;
       #);
     Q: (# ch: @char;
           scan:
             (# c: @char
             do (if ch//'v' then  else 't'-1->ch if);
                L:
                  (for i: 100 repeat
                       ch+1->ch->c; 
                       (if i < 10 then INNER else '!'->put; leave L if)
                  for)
        #)#);
     aq: @Q;
     S,R: ^text;
     tryMkTO:
       (#
       do '0123'->S[];  S->putText; 
          '456789'->S[]->R[]; R->puttext     
       #)
     
  do 'a'->a; 'b'->b; 'c'->c; 
     T;
     'h'->a; 'i'->b; 'j'->c;
     
     'k'->x.d; 'l'->x.e; 'm'->y.f; 'n'->y.g;
     z;
     W;
     L:
       aq.scan
       (#
       do c->put;
          (if c  
           //'v' then restart L
           //'z' then leave L
       if)#);

     tryMkTO

  #)
