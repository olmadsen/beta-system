ORIGIN 'tstenv' ;            
INCLUDE 'tstlib';
LIBRARY 'tstnx3'  
---LIB:attributes--- 
TstNx:        
   (# 
      A: (# a,b: @char
         enter(a,b)             
	 do a->put; b->put;
         exit(b,a)
         #);        
      A1: @ (# a,b: @char   
            enter(a,b)
	    do 'c'->b; 'd'->a;
            exit(b,a)
            #);
      T: (# a,b: @char;
            X,Y: @ (# x,y: @char enter(x,y) do  exit x #)
         enter(a,X,b,(Y.x,Y.y))
         do a->put; X.x->put; X.y->put; b->put; Y.x->put; Y.y->put
         exit(a,b,Y)
         #);
      Q: (# a,b: @char do x->a; x+1->b; x+3->x exit(a,b)#);
      q1,q2: @Q;
      x,y: @char;
      as: @A;
      WWW: (# enter as #);

      NXrep:
      (# T: (# R: [10]@char;
	       j,k: @integer
            enter(R[i],R[i+5])
            do R[i]->put; R[i+5]->put; 
	       (for i: R.range repeat 'u'+i->R[i] for);
	       2->i; 3->j; 3->k
            exit(R[i],R[j],R[k+1])
            #);

         i: @integer; a,b,c,d,e: @char
      do  2->i;
          ('u','v')->T->(c,d,e); 
           c->put; d->put; e->put; 
      #);

      XXX:
      (# XT: (# X: @ (# i,j: @char
                    enter(i,j) do i->put; j->put
                    #);

	        a,b: @char
            enter(a,X,b)
            do a->put;  b->put; 'e'->a; 'f'->b
            exit(a,b)#);
 
         XS: @(# a,b: @char;
                W: @(# do exit('g','h') #);
            enter(a,b)
            do a->put; b->put; 'i'->a
            exit(a,W)
            #);

          x: @char;
          XQ: @(# a,b: @char enter(a,b) do a->put; b->put #); 
      do
         ('c',('a','b'),'d')->XT->XS->(x,XQ); x->put;
	 'jklmnopqrstuvwxyz0123456789'->putText
      #)
   do (* ('q','w')->WWW; *)
      ('a','b')->A;
      A1->(x,y); x->put; y->put;
      ('e','f')->A->(x,y);
      (if x//'f' then 'g'->put else '!'->put if);
      (if y//'e' then 'h'->put else '!'->put if);
      ('i',('j','k'),'l',('m','n'))->T;
      'p'->x;
      ('o',q1,'r',q2)->T; 
      NXrep; 'z0123456789'->putText;
      newl;
      XXX
   #)
