origin '~beta/guienv/guienv';
INCLUDE 'sequencer'
---program:descriptor---
(# G: @guienv
     (# w: @Sequencewindow
          (# open::
               (#
               do seq.scan
                  (# whenClass::
                       (# 
                       do current[] -> showCall
                       #);
                     whenReturn::
                       (# 
                       do current[] -> showReturn
                       #);
                  #)

               #)
          #)
     do w.open
     #);
   mark:  (* not used anymore *)
     (# obj: ^object; objAdr: @integer
     do (*this(mark)[] -> seq.call;*)
        (* this(mark)[] -> obj[];
         %getLongAt (@@obj) -> objAdr;
         'Adr: ' -> puttext; objAdr -> putint; newline;
         objAdr -> traceCall*)
        
        inner;
        (*this(mark)[] -> seq.return*)
        (* this(mark)[] -> obj[];
         %getLongAt (@@obj) -> objAdr;
         'Return: ' -> puttext; objAdr -> putint; newline;
         objAdr -> traceReturn;*)
        
     #);
   
   (********************** test program **************************)
   main:   
     (# R: ^myClass;
        S: ^yourClass; 
        T: ^hisClass;
        myClass:
          (# foo: (# do S.hest #);
             bar: (# do #)
          do
          #);
        yourClass:
          (# hest: (# do fisk #);
             fisk: (# do R.bar; T.snif #)
          #);
        hisClass:
          (# snif: (# do #);
          #);
     do this(main)[] -> G.w.seq.init;
        true -> G.W.Seq.trace;
        &myClass[] -> R[];
        &yourClass[] -> S[];
        &hisClass[]->T[];
        R.foo;
     #);
do main;
   false -> G.w.Seq.trace;
   G.w.seq.display;
   G
#)
