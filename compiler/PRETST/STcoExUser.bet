ORIGIN 'minienv';
BUILD pre
      'pre/STcoEx.prc'
      'STcoEx.som'
      'pre-st -o $0 $1';

(* Example of a BETA coroutine used from a Smalltalk class 
 * The Smalltalk class is in file: STcoEx.som
 *)
---lib:attributes---
SMTcoEx: externalclass
  (# init: 
       (# G: ^ generator 
       enter G[]
       #);
     run: (# #)
  do 'STcoEx' -> location
  #);

generator:
  (# theGenerator: @ |  
       (# value: @integer 
       do 1 -> value;
          (for i: 6 repeat 
               suspend;
               value + 2 -> value;
          for)
       exit value
       #);
     
     attach: 
       (# val: @integer
       do thegenerator -> val
       exit val
       #)
  #)
---program:descriptor---
(# STco: ^SMTcoEx;
   G: @ generator;
do &SMTcoEx[] -> STco[];
   G[] -> stCO.init;
   STco.run;
   out.newline
#)

          
