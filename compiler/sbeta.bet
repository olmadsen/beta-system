ORIGIN  'compiler';
INCLUDE '~beta/basiclib/systemenv';
INCLUDE '~beta/grammars/beta/betacfl';
BODY 'SYNTHESIZER/synthesizer';
BODY 'GENERATOR/BYTECODE/bytecodebackend';
BODY 'GENERATOR/BYTECODE/bytecodetarget'

--lib:attributes--
hostIsWindows: booleanValue
  (# 
  do ('nti'->((1,3)->(machine_type).sub).equal) -> value;
  #);
-----program: descriptor---
systemEnv
(# IC: @JvmInteractiveCompiler;
   
   JvmInteractiveCompiler: InteractiveCompiler
     (# ActivateCompiler::
          (* Force regeneration of rootfragment, assuming it has program slot *)
          (# objdir: @directory
               (# delfile: @deletefile
                    (# nosuch::(# do true->continue #);
                       error::(# do true->continue #);
                    #)
               #);
             e: @diskentry;
          do 'jvm' -> objdir.name;
             rootfragment[] -> e.path;
             (if objdir.entry.exists then
                 '.dep' -> (e.path.name.prefix).append -> objdir.delfile;
                 'program.dep' -> objdir.delfile;
             if);
          #);
     #);
   
do true -> IC.comp.trans.common.switch[120];
   true -> IC.comp.trans.common.switch[121];
   true -> IC.comp.trans.common.switch[122];
   true -> IC.comp.trans.common.switch[129];
   true -> IC.comp.trans.common.switch[182];
   true -> IC.comp.trans.common.switch[324];
   true -> IC.comp.trans.common.switch[14]; (* NO refNone check *)
   (if hostIsWindows then
       (* Supress noise in compiler distributed *)
       true -> IC.comp.trans.common.switch[188];
   if);
   'jvm' -> IC.comp.targetMachine;
   IC
#)
