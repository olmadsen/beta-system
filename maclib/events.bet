ORIGIN 'mactypes';
-- Lib: Attributes --
(* Toolbox event *)
everyEvent: (# exit - 1 #);
NullEvent: (# exit 0 #);
mousedown: (# exit 1 #);
mouseUp: (# exit 2 #);
keydown: (# exit 3 #);
keyUp: (# exit 4 #);
autoKey: (# exit 5 #);
updateEvt: (# exit 6 #);
diskEvt: (# exit 7 #);
activateEvt: (# exit 8 #);
networkEvt: (# exit 10 #);
driverEvt: (# exit 11 #);
app1Evt: (# exit 12 #);
app2Evt: (# exit 13 #);
app3Evt: (# exit 14 #);
app4Evt: (# exit 15 #);
osEvt: (# exit 15 #);
kHighLevelEvent: (# exit 23 #);

cmdKeyMask: (# exit 256 #);
shiftKeyMask: (# exit 512 #);
capsLockMask: (# exit 1024 #);
optionKeyMask: (# exit 2048 #);
controlKeyMask: (# exit 4096 #);

resumeMask: (# exit 1 #);
clipboardMask: (# exit 2 #);

activateMask: (# exit 1 #);
buttonMask: (# exit 128 #);

EventRecord: Data
	(#  what: @int16;
		 message_hi: @int16u;
		 message_lo: @int16u;
		 when_hi: @int16u;
		 when_lo: @int16u;
		 where_v: @int16;
		 where_h: @int16;
		 modifiers: @int16u;
	#);
	


EventInterface: COM
	(# event: @EventRecord;
		what:
			(# exit event.what #);
		message:
			(# exit (event.message_hi %sll 16) %bor event.message_lo #);
		keyCode:
			(# exit event.message_lo %srl 8 #);
		charCode:
			(# exit (event.message_lo %band 0xFF) #);
		when:
			(# exit (event.when_hi %sll 16) %bor event.when_lo #);
		where:
			(# exit (event.where_v %sll 16) %bor event.where_h #);
		wherePT: (# exit (event.where_h, event.where_v) #);
		modifiers:
			(# exit event.modifiers #);
		app4Selector:
			(# exit (event.message_hi %srl 8) #);
		childDiedStatus:
			(# exit (event.message_hi %band 0xFF) #);
			
		resume:
			(# exit (event.message_lo %band resumeMask) = resumeMask #);
		scrapDataHasChanged:
			(# exit (event.message_lo %band clipBoardMask) = clipBoardMask #);
		
		activeFlag: (# exit (event.modifiers %band activateMask) = activateMask #);
		btnState: (# exit (event.modifiers %band buttonMask) = buttonMask #);
		
		cmdKey: (# exit (event.modifiers %band cmdKeyMask) = cmdKeyMask #);
		shiftKey: (# exit (event.modifiers %band shiftKeyMask) = shiftKeyMask #);
		alphaLock: (# exit (event.modifiers %band capsLockMask) = capsLockMask #);
		optionKey: (# exit (event.modifiers %band optionKeyMask) = optionKeyMask #);
		controlKey: (# exit (event.modifiers %band controlKeyMask) = controlKeyMask #);
	#);
  
  
KeyMap: CStruct (# byteSize::< (# do 16->Value;  #);  #);
GetNextEvent: External
  (# eventMask: @ShortInt; theEvent: ^EventRecord; result: @Boolean; 
  enter (eventMask,theEvent[])
  do '$A970'->PascalTrap; 
  exit result
  #);
WaitNextEvent: External
  (# eventMask: @int16; theEvent: ^EventRecord; sleep,mouseRgn: @Integer; result: @Boolean; 
  enter (eventMask,theEvent[],sleep,mouseRgn)
  do '$A860'->PascalTrap; 
  exit result
  #);
EventAvail: External
  (# eventMask: @ShortInt; theEvent: ^EventRecord; result: @Boolean; 
  enter (eventMask,theEvent[])
  do '$A971'->PascalTrap; 
  #);
GetMouse: External (# mouseLoc: ^QPoint enter mouseLoc[] do '$A972'->PascalTrap;  #);
Button: External (# res: @Boolean;  do '$A974'->PascalTrap;  exit res #);
StillDown: External (# res: @Boolean;  do '$A973'->PascalTrap;  exit res #);
WaitMouseUp: External (# res: @Boolean;  do '$A977'->PascalTrap;  exit res #);
GetKeys: External (# theKeys: ^KeyMap enter theKeys do '$A976'->PascalTrap;  #);
TickCount: External (# value: @Integer do '$A975'->PascalTrap;  exit value #);
GetDblTime: External (# value: @Integer do '{$2EB8,$02F0}'->PascalTrap;  exit value #);
GetCaretTime: External (# value: @Integer do '{$2EB8,$02F4}'->PascalTrap;  exit value #);
(* OS event *)
FlushEvents: External
  (# whichMask,stopMask: @ShortInt; 
  enter (whichMask,stopMask)
  do '{$201F,$A032}'->PascalTrap; 
  #);
GetEvQHdr: External (# QHdrPtr: @Integer;  do CallPascal;  exit QHdrPtr #);
GetOSEvent: External
  (# mask: @ShortInt; theEvent: ^EventRecord; result: @Boolean; 
  enter (mask,theEvent[])
  do CallPascal; 
  exit result
  #);
OSEventAvail: External
  (# mask: @ShortInt; theEvent: ^EventRecord; result: @Boolean; 
  enter (mask,theEvent[])
  do CallPascal; 
  exit result
  #);
PostEvent: External
  (# eventNum: @ShortInt; eventMsg: @Integer; OSErr: @ShortInt; 
  enter (eventNum,eventMsg)
  do CallPascal; 
  exit OSErr
  #);
PPostEvent: External
  (# eventNum: @ShortInt; eventMsg,ptr: @Integer; OSErr: @ShortInt
  enter (eventNum,eventMsg,ptr)
  do CallPascal; 
  exit OSErr
  #);
SetEventMask: External
  (# theMask: @ShortInt;  enter theMask do '{$31DF,$0144}'->PascalTrap;  #);
  

