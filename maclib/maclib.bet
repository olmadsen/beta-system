ORIGIN '~beta/basiclib/betaenv';

LINKOPT macosx '-framework carbon';

BUILD macosx  '$$/maclibglue.o' 'external/maclibglue.c' '$CC -D$$ -c -o $0 $1'


-- LIB: Attributes --

 

(*
 *  Core Foundation
 *)

(** File Manager **)

FSRef: Data
  (# a0, a1, a2, a3, a4, a5, a6, a7, a8, a9: @int32u;
     b0, b1, b2, b3, b4, b5, b6, b7, b8, b9: @int32u;
  #);
MaxPathLength: (# exit 1024 #);

FSRefMakePath: external
  (# fs: ^FSRef;
     pathptr: @int32u;
     size: @int32u;
  enter (fs[], pathptr, size)
  #);

(** CFType **)

CFRelease: external
  (# cfref: @int32u;
  enter cfref
  #);

 (** CFBundle **)

CFBundleGetMainBundle: external
  (# bundleref: @int32u;
  exit bundleref
  #);
CFBundleCopyBundleURL: external
  (# bundleref: @int32u;
     urlref: @int32u;
  enter bundleref
  exit urlref
  #);
CFBundleCopyResourceURL: external
  (# bundleref: @int32u;
     name: @int32u;
     type: @int32;
     subDirName: @int32u;
     urlref: @int32u;
  enter (bundleref, name, type, subDirName)
  exit urlref
  #);

(** CFURL **)

CFURLGetString: external
  (# urlref: @int32u;
     stringref: @int32u;
  enter urlref
  exit stringref
  #);
CFURLGetFSRef: external
  (# urlref: @int32u;
     fs: ^FSRef;
     success: @boolean;
  enter (urlref, fs[])
  exit success
  #);

(** CFString **)

kCFStringEncodingMacRoman: (# exit 0 #);
kCFStringEncodingWindowsLatin1: (# exit 0x0500 #);
kCFStringEncodingISOLatin1: (# exit 0x0201 #);
kCFStringEncodingNextStepLatin: (# exit 0x0B01 #);
kCFStringEncodingASCII: (# exit 0x0600 #);
kCFStringEncodingUnicode: (# exit 0x0100 #);
kCFStringEncodingUTF8: (# exit 0x08000100 #);
kCFStringEncodingNonLossyASCII: (# exit 0x0BFF #);


CFStringCreateWithCString: external
  (# alloc: @int32u;
     str: [1] @char;
     encoding: @int32u;
     stringref: @int32u;
  enter (alloc, str, encoding)
  exit stringref
  #);

CFStringGetLength: external
  (# stringref: @int32u;
     length: @int32u;
  enter stringref
  exit length
  #);
CFStringGetCString: external
  (# stringref: @int32u;
     buffer: @int32u;
     size: @int32u;
     encoding: @int32;
     result: @boolean;
  enter (stringref, buffer, size, encoding)
  exit result
  #);

(*
 * QuickDraw
 *)

QRect: Data
  (# top: @int16;
     left: @int16;
     bottom: @int16;
     right: @int16;
  #);

EraseRect: external
  (# r: ^QRect;
  enter r[]
  #);

CopyBits: external
  (# src: @int32u;
     dst: @int32u;
     srcRect: ^QRect;
     dstRect: ^QRect;
     mode: @int16;
     maskRgn: @int32u;
  enter (src, dst, srcRect[], dstRect[], mode, maskRgn)
  #);

SetGWorld: external
  (# port: @int32u;
     device: @int32u;
  enter (port, device)
  #);
GetPortBounds: external
  (# port: @int32u;
     bounds: ^QRect;
  enter (port, bounds[])
  #);
GetPortPixMap: external
  (# port: @int32u;
     pixmap: @int32u;
  enter port
  exit pixmap
  #);
GetPixBaseAddr: external
  (# pixmap: @int32u;
     base: @int32u;
  enter pixmap
  exit base
  #);
GetPixRowBytes: external
  (# pixmap: @int32u;
     rowbytes: @int32u;
  enter pixmap
  exit rowbytes
  #);



QDBeginCGContext: external
  (# port: @int32u;
     context: @int32u;
     status: @int32;
  enter (port, context)
  exit status
  #);
QDEndCGContext: external
  (# port: @int32u;
     context: @int32u;
     status: @int32;
  enter (port, context)
  exit status
  #);


(*
 * Windows
 *)

  kAlertWindowClass: (# exit 1 #);
  kMovableAlertWindowClass: (# exit 2 #);
  kModalWindowClass: (# exit 3 #);
  kMovableModalWindowClass: (# exit 4 #);
  kFloatingWindowClass: (# exit 5 #);
  kDocumentWindowClass: (# exit 6 #);
  kUtilityWindowClass: (# exit 8 #);
  kHelpWindowClass: (# exit 10 #);
  kSheetWindowClass: (# exit 11 #);
  kToolbarWindowClass: (# exit 12 #);
  kPlainWindowClass: (# exit 13 #);
  kOverlayWindowClass: (# exit 14 #);
  kSheetAlertWindowClass: (# exit 15 #);
  kAltPlainWindowClass: (# exit 16 #);
  kSimpleWindowClass: (# exit 18 #);
  kDrawerWindowClass: (# exit 20 #);
  kAllWindowClasses: (# exit 0xFFFFFFFF #);
  
  
  
  kWindowNoAttributes: (# exit 0 #);
  kWindowCloseBoxAttribute: (# exit 2x1 #);
  kWindowHorizontalZoomAttribute: (# exit 2x10 #);
  kWindowVerticalZoomAttribute: (# exit 2x100 #);
  kWindowFullZoomAttribute: (# exit (kWindowVerticalZoomAttribute + kWindowHorizontalZoomAttribute) #);
  kWindowCollapseBoxAttribute: (# exit 2x1000 #);
  kWindowResizableAttribute: (# exit 2x10000 #);
  kWindowSideTitlebarAttribute: (# exit 2x100000 #);
  kWindowToolbarButtonAttribute: (# exit 2x1000000 #);
  kWindowMetalAttribute: (# exit 2x100000000 #);
  kWindowDoesNotCycleAttribute: (# exit 2x1000000000000000 #);
  kWindowNoUpdatesAttribute: (# exit 2x10000000000000000 #);
  kWindowNoActivatesAttribute: (# exit 2x100000000000000000 #);
  kWindowOpaqueForEventsAttribute: (# exit 2x1000000000000000000 #);
  kWindowCompositingAttribute: (# exit 2x10000000000000000000 #);
  kWindowNoShadowAttribute: (# exit 2x1000000000000000000000 #);
  kWindowHideOnSuspendAttribute: (# exit 2x1000000000000000000000000 #);
  kWindowAsyncDragAttribute: (# exit 2x100000000000000000000000 #);
  kWindowStandardHandlerAttribute: (# exit 2x10000000000000000000000000 #);
  kWindowHideOnFullScreenAttribute: (# exit 2x100000000000000000000000000 #);
  kWindowInWindowMenuAttribute: (# exit 2x1000000000000000000000000000 #);
  kWindowLiveResizeAttribute: (# exit 2x10000000000000000000000000000 #);
  kWindowIgnoreClicksAttribute: (# exit 2x100000000000000000000000000000 #);
  kWindowNoConstrainAttribute: (# exit 2x10000000000000000000000000000000 #);
  kWindowStandardDocumentAttributes: 
     (# exit kWindowCloseBoxAttribute + kWindowFullZoomAttribute + kWindowCollapseBoxAttribute + kWindowResizableAttribute #);
  kWindowStandardFloatingAttributes: (# exit kWindowCloseBoxAttribute + kWindowCollapseBoxAttribute #);
  


CreateNewWindow: external
  (# windowclass: @int32u;
     attributes: @int32u;
     bounds: ^QRect;
     outwindow: @int32u; (* WindowRef *outwindow *)
     status: @int32;
  enter (windowclass, attributes, bounds[], outwindow)
  exit status
  #);

GetWindowPort: external
  (# windowref: @int32u;
     port: @int32u;
  enter windowref
  exit port
  #);
ShowWindow: external
  (# windowref: @int32u;
  enter windowref
  #);
GetWindowEventTarget: external
  (# windowref: @int32u;
     target: @int32u
  enter windowref
  exit target
  #);

(*
 * Eventhandling
 *)

kEventClassWindow: (# exit 0x77696E64 #);

kEventWindowUpdate: (# exit 1 #);
kEventWindowDrawContent: (# exit 2 #);
kEventWindowClose: (# exit 72 #);

EventTypeSpec: Data
  (# eventClass: @int32u;
     eventType: @int32u;
  #);

CarbonEventHandler: external
  (# nexthandler: @int32u;
     eventref: @int32u;
     userdata: @int32u;
  enter (nexthandler, eventref, userdata)
  do cExternalEntry;
     INNER;
  #);

InstallEventHandler: external
  (# target: @int32u;
     handler: ##CarbonEventHandler;
     numTypes: @int32u;
     typeList: ^EventTypeSpec; (* EventTypeSpec*  typeList *)
     userdata: @int32u;
     handlerref: @int32u; (* EventHandlerRef*      handlerRef *)
     status: @int32;
  enter (target, handler##, numTypes, typeList[], userdata, handlerref)
  exit status
  #);

RunApplicationEventLoop: external
  (#
  #);

(*
 * ATS
 *)


kATSFontContextUnspecified: (# exit 0 #);
kATSFontContextGlobal: (# exit 1 #);
kATSFontContextLocal: (# exit 2 #);

(***
kATSOptionFlagsDefault = kNilOptions,
   kATSOptionFlagsComposeFontPostScriptName = 1 << 0,
   kATSOptionFlagsUseDataForkAsResourceFork = 1 << 8,
   kATSOptionFlagsUseResourceFork = 2 << 8,
kATSOptionFlagsUseDataFork = 3 << 8
 ***)

ATSFontFamilyIteratorCreate: external
  (# context: @int32u;
     filter: @int32u;
     refcon: @int32u;
     options: @int32u;
     iterator: @int32u; (*** ATSFontFamilyIterator *iterator ***)
     status: @int32;
  enter (context, filter, refcon, options, iterator)
  exit status
  #);
ATSFontFamilyIteratorNext: external
  (# iterator: @int32u;
     family: @int32u;
     status: @int32; (*** ATSFontFamilyRef *family ***)
  enter (iterator, family)
  exit status
  #);
ATSFontFamilyGetName: external
  (# family: @int32u;
     options: @integer;
     name: @int32u; (*** CFStringRef *name ***)
     status: @int32;
  enter (family, options, name)
  exit status
  #);



ATSFontIteratorCreate: external
  (# context: @int32u;
     filter: @int32u;
     refcon: @int32u;
     options: @int32u;
     iterator: @int32u; (*** ATSFontIterator *iterator ***)
     status: @int32;
  enter (context, filter, refcon, options, iterator)
  exit status
  #);
ATSFontIteratorNext: external
  (# iterator: @int32u;
     font: @int32u; (*** ATSFontRef *font ***)
     status: @int32u;
  enter (iterator, font)
  exit status
  #);
ATSFontGetName: external
  (# font: @int32u;
     options: @int32u;
     name: @int32u; 
     status: @int32; (*** CFStringRef *name ***)
  enter (font, options, name)
  exit status
  #);
ATSFontGetPostScriptName: external
  (# font: @int32u;
     options: @int32u;
     name: @int32u; 
     status: @int32; (*** CFStringRef *name ***)
  enter (font, options, name)
  exit status
  #);


(*
 * Core Graphics
 *)


kCGEncodingFontSpecific: (# exit 0 #);
kCGEncodingMacRoman: (# exit 1 #);


CGContextSelectFont: external
  (# context: @int32u;
     name: [1] @char;
     size: @real32;
     encoding: @int32;
  enter (context, name, size, encoding)
  #);
CGContextShowTextAtPoint: external
  (# context: @int32u;
     x, y: @real32;
     bytes: @int32u;
     length: @int32u;
  enter (context, x, y, bytes, length)
  #);

kCGTextFill: (# exit 0 #);
kCGTextStroke: (# exit 1 #);
kCGTextFillStroke: (# exit 2 #);
kCGTextInvisible: (# exit 3 #);
kCGTextFillClip: (# exit 4 #);
kCGTextStrokeClip: (# exit 5 #);
kCGTextFillStrokeClip: (# exit 6 #);
kCGTextClip: (# exit 7 #);

CGContextSetTextDrawingMode: external
  (# context: @int32u;
     mode: @int32;
  enter (context, mode)
  #);

CGContextSetRGBFillColor: external
  (# context: @int32u;
     red, green, blue, alpha: @real;
  enter (context, red, green, blue, alpha)
  #);
CGContextSetRGBStrokeColor: external
  (# context: @int32u;
     red, green, blue, alpha: @real;
  enter (context, red, green, blue, alpha)
  #);
CGContextFlush: external
  (# context: @int32u;
  enter context
  #);
