ORIGIN '../sets';
INCLUDE 'tstenv'
--- program: descriptor ---
tstenv
(# tests::< (# do 'abcdefghijklmnop'->value #);
   
   intMultiSet: multiSet
     (# element::< integerObject #);
   intMultiSet1, intMultiSet2: @intMultiSet; intMultiSet3: ^intMultiSet;
   i: [10]^integerObject;
   
do (for int:10 repeat &integerObject[]->i[int][]; int->i[int] for);
   intMultiSet1.init;
   intMultiSet2.init;
   &intMultiSet[]->intMultiSet3[]; intMultiSet3.init;
   
   ('a','1,2,3,4,')
     ->tst(# do
             (for int:4 repeat
                  int->putint; ','->put;
                  i[int][]->intMultiSet1.insert
             for)
          #);
   
   ('b','4,3,2,1,')
     ->tst(# do
             intMultiSet1.scan(# do current->putint; ','->put #)
          #);
   
   ('c','4,5,6,7,')
     ->tst(# do
             (for int:4 repeat 
                  int+3->putint; ','->put;
                  i[int+3][]->intMultiSet2.insert
             for)
          #);
   
   ('d','7,6,5,4,')
     ->tst(# do
             intMultiSet2.scan(# do current->putint; ','->put #)
          #);
   
   ('e','7,8,9,10,')
     ->tst(# do
             (for int:4 repeat 
                  int+6->putint; ','->put;
                  i[int+6][]->intMultiSet3.insert
             for)
          #);
   
   ('f','10,9,8,7,')
     ->tst(# do
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('g','7,6,5,4,')
     ->tst(# do
             intMultiSet2.copy->intMultiSet3[];
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('h','6,5,4,')
     ->tst(# do
             i[7][]->intMultiSet3.delete;
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);

   ('i','6,5,')
     ->tst(# do
             i[4][]->intMultiSet3.delete;
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);
  
   ('j','1,2,3,4,7,6,5,4,')
     ->tst(# do
             intMultiSet2.copy->intMultiSet3[];
             intMultiSet1[]->intMultiSet3.union->intMultiSet3[];
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('k','7,6,5,')
     ->tst(# do
             intMultiSet2.copy->intMultiSet3[];
             intMultiSet1[]->intMultiSet3.diff->intMultiSet3[];
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('l','4,')
     ->tst(# do
             intMultiSet2.copy->intMultiSet3[];
             intMultiSet1[]->intMultiSet3.sect->intMultiSet3[];
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('m','1,2,3,7,6,5,4,')
     ->tst(# do
             intMultiSet2.copy->intMultiSet3[];
             intMultiSet1[]->intMultiSet3.symDiff->intMultiSet3[];
             intMultiSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('n','4')
     ->tst(# do
             intMultiSet3.find(# predicate ::<
                                   (# do (current=4)->value #)
      	                      do current->putint
      	                      #)
          #);
   
   ('o','yes')
     ->tst(# do
             (if i[4][]->intMultiSet3.has//true
                 then 'yes'->puttext
              else 'no'->puttext
             if)
          #);
   
   ('p','no')
     ->tst(# do
             (if i[10][]->intMultiSet3.has//true
                 then 'yes'->puttext
              else 'no'->puttext
             if)
          #)
#)
