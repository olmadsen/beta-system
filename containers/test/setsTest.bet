ORIGIN '../sets';
INCLUDE 'tstenv'
--- program: descriptor ---
tstenv
(# tests::< (# do 'abcdefghijklmnopqrst'->value #);
   
   intSet: set
     (# element::< integerObject #);
   intSet1, intSet2: @intSet; intSet3: ^intSet;
   i: [10]^integerObject;
   
do (for int:10 repeat &integerObject[]->i[int][]; int->i[int] for);
   intSet1.init;
   intSet2.init;
   &intSet[]->intSet3[]; intSet3.init;
    
   ('a','-1')
     ->tst(# do
             intSet1.capacity->putInt
          #);
   
   ('b','1,2,3,4,')
     ->tst(# do
             (for int:4 repeat
                  int->putint; ','->put;
                  i[int][]->intSet1.insert
             for)
          #);

   ('c','4')
     ->tst(# do
             intSet1.size->putInt
          #);
   
   ('d','4,3,2,1,')
     ->tst(# do
             intSet1.scan(# do current->putint; ','->put #)
          #);

   ('e','-1')
     ->tst(# do
             intSet2.capacity->putInt
          #);
   
   ('f','4,5,6,7,')
     ->tst(# do
             (for int:4 repeat 
                  int+3->putint; ','->put;
                  i[int+3][]->intSet2.insert
             for)
          #);
 
   ('g','4')
     ->tst(# do
             intSet2.size->putInt
          #);
   
   ('h','7,6,5,4,')
     ->tst(# do
             intSet2.scan(# do current->putint; ','->put #)
          #);
  
   ('i','-1')
     ->tst(# do
             intSet3.capacity->putInt
          #);
   
   ('j','1,2,3,4,5,6,7,8,9,10,')
     ->tst(# do
             (for int:10 repeat 
                  int->putint; ','->put;
                  i[int][]->intSet3.insert
             for)
          #);
   
   ('k','10')
     ->tst(# do
             intSet3.size->putInt
          #);
   
   ('l','10,9,8,7,6,5,4,3,2,1,')
     ->tst(# do
             intSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('m','4,3,2,1,')
     ->tst(# do
             intSet1.copy->intSet3[];
             intSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('n','1,2,3,7,6,5,4,')
     ->tst(# do
             intSet2.copy->intSet3[]; intSet1[]->intSet3.union->intSet3[];
             intSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('o','7,6,5,')
     ->tst(# do
             intSet2.copy->intSet3[]; intSet1[]->intSet3.diff->intSet3[];
             intSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('p','4,')
     ->tst(# do
             intSet2.copy->intSet3[]; intSet1[]->intSet3.sect->intSet3[];
             intSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('q','1,2,3,7,6,5,')
     ->tst(# do
             intSet2.copy->intSet3[]; intSet1[]->intSet3.symDiff->intSet3[];
             intSet3.scan(# do current->putint; ','->put #)
          #);
   
   ('r','7')
     ->tst(# do
             intSet3.find(# predicate ::<
                              (# do (current=7)->value #)
      	                 do current->putint
      	                 #)
          #);
   
   ('s','yes')
     ->tst(# do
             (if i[7][]->intSet3.has//true
                 then 'yes'->puttext
              else 'no'->puttext
             if)
          #);
   
   ('t','no')
     ->tst(# do
             (if i[10][]->intSet3.has//true
                 then 'yes'->puttext
              else 'no'->puttext
             if)
          #);
#)
