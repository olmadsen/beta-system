ORIGIN '../recList';
INCLUDE 'tstenv'
--- program: descriptor ---
tstenv
(# tests::< (# do 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOP'->value #);
   
   intList: recList(# element::< integerObject #);
   intList1, intList2: @intList; intList3: ^intList;
   listPosition: ^intList3.theCellType;
   i: [10]^integerObject; io: ^integerObject;
   recPrint:
     (* pattern for displaying a recursive intList *)
     (# lst: ^intList 
     enter lst[] 
     do lst.iterate
        (# do current.when
           (# sublist::< (# do '('->put; lst[]->recPrint; ')'->put #);
              elm::< (# do elm[]->io[];io->putint; ','->put #)
           #)
        #);
     #);
   recPrintFrom:
     (* pattern for displaying a recursive intList *)
     (# lst: ^intList; position: ^intList2.theCellType;; 
     enter (lst[], position[]) 
     do position[]->lst.iterateFrom
        (# do current.when
           (# sublist::< (# do '('->put; lst[]->recPrint; ')'->put #);
              elm::< (# do elm[]->io[];io->putint; ','->put #)
           #)
        #);
     #);
   recPrintReverse:
     (* pattern for displaying a recursive intList *)
     (# lst: ^intList 
     enter lst[] 
     do lst.iterateReverse
        (# do current.when
           (# sublist::< (# do '('->put; lst[]->recPrintReverse; ')'->put #);
              elm::< (# do elm[]->io[];io->putint; ','->put #)
           #)
        #);
     #);
   recPrintReverseFrom:
     (* pattern for displaying a recursive intList *)
     (# lst: ^intList; position: ^intList2.theCellType;
     enter (lst[], position[]) 
     do position[]->lst.iterateReverseFrom
        (# do current.when
           (# sublist::< (# do '('->put; lst[]->recPrintReverse; ')'->put #);
              elm::< (# do elm[]->io[];io->putint; ','->put #)
           #)
        #);
     #);
   
do (for int:10 repeat &integerObject[]->i[int][]; int->i[int] for);
   intList1.init;
   intList2.init;
   &intList[]->intList3[]; intList3.init;
   
   ('a','1,2,3,4,')
     ->tst(# do
             (for int:4 repeat
                  int->putint; ','->put;
                  i[int][]->intList1.prepend
             for)
          #);
   
   ('b','4,3,2,1,')
     ->tst(# do
             intList1.scan(# do current->putint; ','->put #)
          #);
   
   ('c','4,5,6,7,')
     ->tst(# do
             (for int:4 repeat 
                  int+3->putint; ','->put;
                  i[int+3][]->intList2.append
             for)
          #);
   
   ('d','4,5,6,7,')
     ->tst(# do
             intList2.scan(# do current->putint; ','->put #)
          #);
   
   (*testing static scanning *)
   (# sc: @intList2.scan(# do current->putint; ','->put #);
      sr: @intList2.scanReverse(# do current->putint; ','->put #);
      scf: @intList2.scanFrom(# do current->putint; ','->put #);
      srf: @intList2.scanReverseFrom(# do current->putint; ','->put #);
      lp5, lp8: ^intList2.theCellType
   do ('e','4,5,6,7,')->tst(# do sc #);
      
      ('f','4,5,6,7,')->tst(# do sc #);
      
      ('g','7,8,9,10,')->tst(# do
                      (for int:4 repeat 
                           int+6->putint; ','->put;
                           i[int+6][]->intList2.prepend
                      for)
                   #);
      
      ('h','10,9,8,7,4,5,6,7,')->tst(# do sc #);
      
      i[5][]->intList2.at->lp5[];
      i[8][]->intList2.at->lp8[];
      
      ('i','5,6,7,')->tst(# do lp5[]->scf #);
      
      ('j','5,6,7,')->tst(# do lp5[]->scf #);
      
      ('k','8,7,4,5,6,7,')->tst(# do lp8[]->scf #);
      
      ('l','7,6,5,4,7,8,9,10,')->tst(# do sr #);
      
      ('m','7,6,5,4,7,8,9,10,')->tst(# do sr #);
      
      ('n','5,4,7,8,9,10,')->tst(# do lp5[]->srf #);
      
      ('o','5,4,7,8,9,10,')->tst(# do lp5[]->srf #);
      
      ('p','8,9,10,')->tst(# do lp8[]->srf #);
   #);   
   
   ('q','7,8,9,10,')
     ->tst(# do
             (for int:4 repeat 
                  int+6->putint; ','->put;
                  i[int+6][]->intList3.prepend
             for)
          #);
   
   ('r','10,9,8,7,')
     ->tst(# do
             intList3.scan(# do current->putint; ','->put #)
          #);
   
   ('s','10,9,8,7,(4,3,2,1,)')
     ->tst(# do
             (intList1[],NONE)->intList3.insertSublistBefore;
             intList3[]->recPrint
          #);
   
   ('t','10,9,8,7,(4,3,2,1,)(4,3,2,1,)')
     ->tst(# do
             i[7][]->intList3.at->listPosition[];
             (intList1[],listPosition[])->intList3.insertSublistAfter;
             intList3[]->recPrint
          #);
   
   ('u','10,9,8,7,(4,3,2,1,)(4,3,2,1,)1,')
     ->tst(# do
             i[1][]->intList3.append;
             intList3[]->recPrint
          #);
   
   ('v','10,9,8,7,4,5,6,7,(10,9,8,7,(4,3,2,1,)(4,3,2,1,)1,)')
     ->tst(# do
             (intList3[],NONE)->intList2.insertSublistBefore;
             intList2[]->recPrint
          #);
   
   ('w','10,9,8,7,4,5,6,7,(10,9,8,7,(4,3,2,1,)(4,3,2,1,)1,)10,')
     ->tst(# do
             i[10][]->intList2.append;
             intList2[]->recPrint
          #);
   
   ('x','10,9,8,7,4,5,7,(10,9,8,7,(4,3,2,1,)(4,3,2,1,)1,)10,')
     ->tst(# do
             i[6][]->intList2.at->intList2.delete;
             intList2[]->recPrint
          #);
   
   ('y','10,9,8,7,4,5,7,10,9,8,7,4,3,2,1,4,3,2,1,1,10,')
     ->tst(# do
             intList2.scan(# do current->putint; ','->put #)
          #);
   
   ('z','10,10,9,8,7,4,3,2,1,4,3,2,1,1,7,5,4,7,8,9,10,')
     ->tst(# do
             intList2.scanReverse(# do current->putint; ','->put #)
          #);
   
   ('A','7,4,3,2,1,4,3,2,1,1,')
     ->tst(# do
             listPosition[]->intList2.scanFrom(# do current->putint; ','->put #)
          #);
   
   ('B','7,8,9,10,')
     ->tst(# do
             listPosition[]->intList2.scanReversefrom(# do current->putint; ','->put #)
          #);
   
   ('C','10,9,8,7,4,5,7,(10,9,8,7,(4,3,2,1,)(4,3,2,1,)1,)10,')
     ->tst(# do
             intList2[]->recPrint
          #);
   
   ('D','7,(4,3,2,1,)(4,3,2,1,)1,')
     ->tst(# do
             (intList2, listPosition[])->recPrintFrom
          #);
   
   ('E','10,(1,(1,2,3,4,)(1,2,3,4,)7,8,9,10,)7,5,4,7,8,9,10,')
     ->tst(# do
             intList2[]->recPrintReverse
          #);
   
   ('F','7,8,9,10,')
     ->tst(# do
             (intList2, listPosition[])->recPrintReverseFrom
          #);
   
   ('G','10')
     ->tst(# do
             intList2.last->listPosition[];
             listPosition.when(# elm::<(# do elm[]->io[]; io->putint #) #)
          #);
   
   ('H','10,9,8,7,4,5,7,')
     ->tst(# do
             intList2.preample->intList3[];
             intList3[]->recPrint
          #);
   
   ('I','10,9,8,7,4,5,7,')
     ->tst(# do
             intList3.scan(# do current->putint; ','->put #)
          #);
   
   ('J','10,9,8,4,5,')
     ->tst(# do
             intList3.scan(# do (if current//7 then current[]->intList3.at->intList3.delete
                                 else current->putint; ','->put
                                if) 
                          #)
          #);
   
   ('K','5,4,8,9,10,')
     ->tst(# do
             intList3.scanReverse(# do current->putint; ','->put #)
          #);
   
   ('L','5,4,8,9,10,')
     ->tst(# do
             intList3.scanReverse(# do (if current//7 then current[]->intList3.at->intList3.delete
                                        else current->putint; ','->put
                                       if) 
                                 #)
          #);
   
   intList2->intList3;
   
   ('M','10,9,8,7,4,5,7,10,')
     ->tst(# do
             intList3[]->recPrint
          #);
   
   ('N','10,9,8,4,5,10,')
     ->tst(# do
             intList3.iterate
             (# do current.when(# elm::<
                                    (# do
                                       (if elm//7 then current[]->intList3.delete
                                        else elm->putint; ','->put
                                       if) 
                                    #);
                                  sublist::< (# do '('->put; lst[]->recPrint; ')'->put #)
                               #)
             #)
          #);

   intList2->intList3;
   
   ('O','10,7,5,4,7,8,9,10,')
     ->tst(# do
             intList3[]->recPrintreverse
          #);
   
   ('P','10,5,4,8,9,10,')
     ->tst(# do
             intList3.iterateReverse
             (# do current.when(# elm::<
                                    (# do
                                       (if elm//7 then current[]->intList3.delete
                                        else elm->putint; ','->put
                                       if) 
                                    #);
                                  sublist::< (# do '('->put; lst[]->recPrintReverse; ')'->put #)
                               #)
             #)
          #);
   
   (*********** OUTPUT ***************
    * intList1.prepend: 1,2,3,4,
    * intList1.elements: 4,3,2,1,
    * intList2.append: 4,5,6,7,
    * intList2.elements: 4,5,6,7,
    * intList3.prepend: 7,8,9,10,
    * intList3.elements: 10,9,8,7,
    * 
    * intList1.copy->intList3[]: 4,3,2,1,
    * intList1[]->intList2.concatenate->intList3[]: 4,5,6,7,4,3,2,1,
    * 
    * intList3.find(# predicate ::< (# "elm=7" #) #): 7
    * 7->intList3.has: yes
    * 10->intList3.has: no
    * 
    * intList3.locate(# "element>5" #): 6
    * (10,7)->intList3.insertBefore; (10,7)->intList3.insertAfter: 4,5,6,10,7,10,4,3,2
    * ,1,
    * 7->intList3.deleteBefore: 4,5,6,7,10,4,3,2,1,
    * 7->intList3.deleteAfter: 4,5,6,7,4,3,2,1,
    * 
    * intList3.head: 4
    * intList3.tail->intList3[]: 5,6,7,4,3,2,1,
    * 
    * (intList1[],NONE)->intList3.insertSublistBefore: 5,6,7,4,3,2,1,(4,3,2,1,)
    * (intList1[],7)->intList3.insertSublistAfter: 5,6,7,(4,3,2,1,)4,3,2,1,(4,3,2,1,)
    * 1->intList3.append: 5,6,7,(4,3,2,1,)4,3,2,1,(4,3,2,1,)1,
    * (intList3[],NONE)->intList2.insertSublistBefore: 4,5,6,7,(5,6,7,(4,3,2,1,)4,3,2,
    * 1,(4,3,2,1,)1,)
    * 10->intList2.append: 4,5,6,7,(5,6,7,(4,3,2,1,)4,3,2,1,(4,3,2,1,)1,)10,
    * 6->intList2.at->intList2.delete: 4,5,7,(5,6,7,(4,3,2,1,)4,3,2,1,(4,3,2,1,)1,)10,
    * intList2.scan: 4,5,7,5,6,7,4,3,2,1,4,3,2,1,4,3,2,1,1,10,
    * intList2.scanReverse: 10,1,1,2,3,4,1,2,3,4,1,2,3,4,7,6,5,7,5,4,
    * intList2.last: 10
    * intList2.preample: 4,5,7,5,6,7,4,3,2,1,4,3,2,1,4,3,2,1,1,
    ******************************)
#)
