ORIGIN '../list';
INCLUDE 'tstenv'
--- program: descriptor ----
tstenv
(# tests::< (# do 'abcdefghijklmno'->value #);
   
   preLst, posLst: ^lst;
   lst: list(# element::< integerObject;
               emptyContainerError::<
                 (# do 'empty handled globally'->puttext; true->continue #) #);
   ls: @lst; pos: ^ls.theCellType;
   a: ^integerObject;
do ls.init;
   
   &integerObject[]->a[]; 2 -> a; a[] -> ls.append;
   &integerObject[]->a[]; 43 -> a; a[] -> ls.append->pos[];
   &integerObject[]->a[]; 4 -> a; a[] -> ls.append;

   ('a','2,43,4,')
     ->tst(# do
             ls.scan(# do current->putint; ','->put #)
          #);
   
   ('b','43,4,')
     ->tst(# do
             pos[]->ls.scanFrom(# do current->putint; ','->put #)
          #);

   pos[] -> ls.splitBefore -> (preLst[],posLst[]);
   
   ('c','2,')
     ->tst(# do
             preLst.scan(# do current->putint; ','->put #)
          #);
   
   ('d','43,4,')
     ->tst(# do
             posLst.scan(# do current->putint; ','->put #)
          #);

   pos[] -> ls.splitAfter -> (preLst[],posLst[]);
   
   ('e','2,43,')
     ->tst(# do
             preLst.scan(# do current->putint; ','->put #)
          #);
   
   ('f','4,')
     ->tst(# do
             posLst.scan(# do current->putint; ','->put #)
          #);

   NONE -> ls.splitBefore -> (preLst[],posLst[]);
   
   ('g','2,43,4,')
     ->tst(# do
             preLst.scan(# do current->putint; ','->put #)
          #);
   
   ('h','')
     ->tst(# do
             posLst.scan(# do current->putint; ','->put #)
          #);

   NONE -> ls.splitAfter -> (preLst[],posLst[]);
   
   ('i','')
     ->tst(# do
             preLst.scan(# do current->putint; ','->put #)
          #);
   
   ('j','2,43,4,')
     ->tst(# do
             posLst.scan(# do current->putint; ','->put #)
          #);

   pos[]->ls.deleteBefore;
   
   ('k','43,4,')
     ->tst(# do
             ls.scan(# do current->putint; ','->put #)
          #);

   pos[]->ls.deleteAfter;
   
   ('l','43,')
     ->tst(# do
             ls.scan(# do current->putint; ','->put #);
          #);

   ('m','')
     ->tst(# do
             pos[]->ls.delete
          #);
   
   ('n','empty handled locally')
     ->tst(# do
             pos[]->ls.delete(# empty::< (# do 'empty handled locally'->puttext; true->continue #) #)
          #);
   
   ('o','empty handled globally')
     ->tst(# do
             pos[]->ls.delete
          #)
#)
