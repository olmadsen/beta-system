ORIGIN '../collection';
(*
 * COPYRIGHT
 *	 Copyright (C) Mjolner Informatics, 1992-94
 *	 All rights reserved.
 *)

--- collectionUnionDopart: dopart ---
do theOther.scan(# do current[]->insert #); INNER

--- collectionDiffDopart: dopart ---
do theOther.scan
   (# where::< (# do (current[]->this(collection).has)->value #)
   do current[]->this(collection).delete
   #);
   INNER

--- collectionSectDopart: dopart ---
do scan
   (# 
   do (if not (current[]->theOther.has) then
          current[]->this(collection).delete
      if)
   #);
   INNER

--- collectionSymDiffDopart: dopart ---
do copy->tmp1[];
   theOther[]->union;
   theOther[]->tmp1.sect->diff;
   INNER
