ORIGIN 'serializeBody';
(* This body handles writing of serialized objects 
 * on big-endian machines.
 *)

-- serializeWriteSimpleBody: doPart --
do poff.simpleCount -> i;
   i + 1 -> rep.makeSpace;
   i ->  rep.cheapPut;
   (for inx: i repeat
        poff.simpleVals[inx] -> getInxLong -> rep.cheapPut;
   for);
   

-- serializeSaveRepetition:dopart --
do (if refType
    //ValRepPTValue then
       (* 'ValRep' -> screen.putLine;  *)
       high*4 -> bsize;
    //ByteRepPTValue then
       (* 'ByteRep' -> screen.putLine;  *)
       high -> bsize;
    //WordRepPTValue then
       (* 'WordRep' -> screen.putLine; *)
       high*2 -> bsize;
    //DoubleRepPTValue then
       (* 'DoubleRep' -> screen.putLine; *)
       high*8 -> bsize;
   if);
   (bsize + 3) div 4 -> lsize;
   lsize + 3 -> rep.makeSpace;
   refType -> rep.cheapPutLong; (* ProtoType value. *)
   low -> rep.cheapPutLong;
   high -> rep.cheapPutLong;
   (@@rep.r[rep.pos], (byteinx -> getInxLong) + 16, bsize) 
     -> memcpy;
   lsize + rep.pos -> rep.pos;
   
