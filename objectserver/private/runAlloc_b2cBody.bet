ORIGIN '../runAlloc';
(* 
 * $RCSfile: runAlloc_b2cBody.bet,v $ $Revision: 1.2 $ $Date: 1996-06-04 14:36:55 $
 *
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1992-94
 *       All rights reserved.
 *)

INCLUDE '~beta/sysutils/v1.5/objinterface';
--- lib:attributes ---

AlloVR1: external
  (# obj,offset,range: @Integer;
  enter (obj,offset,range)
  #);
AlloVR2: external
  (# obj,offset,range: @Integer;
  enter (obj,offset,range)
  #);
AlloVR4: external
  (# obj,offset,range: @Integer;
  enter (obj,offset,range)
  #);
AlloVR8: external
  (# obj,offset,range: @Integer;
  enter (obj,offset,range)
  #);
AlloRR: external
  (# obj,offset,range: @Integer;
  enter (obj,offset,range)
  #);
AlloS: external
  (# origin, proto: @Integer;
     structAdr: @Integer;
  enter (origin,proto)
  exit structAdr
  #);
AlloH: external
  (# proto: @Integer;
     objAdr,origin: @Integer;
  enter (origin,proto)
  exit objAdr
  #);

--- allocByteRepBody:dopart ---
do (@@ori -> tos'%adrGetLong', offset, high) -> AlloVR1;
--- allocWordRepBody:dopart ---
do (@@ori -> tos'%adrGetLong', offset, high) -> AlloVR2;
--- allocValRepBody:dopart ---
do (@@ori -> tos'%adrGetLong', offset, high) -> AlloVR4;
--- allocDoubleRepBody:dopart ---
do (@@ori -> tos'%adrGetLong', offset, high) -> AlloVR8;
--- allocRefRepBody:dopart ---
do (@@ori -> tos'%adrGetLong', offset, high) -> AlloRR;
   
--- allocStructureBody:dopart ---
do 
   (@@iOrigin -> tos'%adrGetLong', iProto) -> AlloS -> structAdr;
   (@@obj -> tos'%adrGetLong') + offset -> fieldAdr;
   (fieldAdr, structAdr) -> assignRef;
   
--- allocHeapBody:dopart ---
do (0,proto) -> AlloH -> objAdr;
   (@@o, objAdr) -> assignRef;
