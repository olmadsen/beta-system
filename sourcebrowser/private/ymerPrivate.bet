ORIGIN '../ymer';
INCLUDE 'mpsGrammarUtil'
        'sourcebrowserbody';
-- ymerBrowserPrivate: Descriptor --
(#
   history: @list
     (#
        element:: 
          (#
             theProject: ^browser.projects.project;
             theGroup: ^browser.projects.group;
             theForm: ^MPS.ast.fragmentForm;
             
          #)
     #);
   cfe: (* current form editor *)
     ^browser.sbprivate.down.fragmentView.contents.codeViewerType;
   geList: @list (* group editors active in this browser *)
     (#
        element::  (# ge: ^editorEnv.groupEditor #);
        findOrCreateGroupEditor:
          (#
             fg: ^MPS.ast.fragmentGroup;
             ge: ^editorEnv.groupEditor;
             newElm: ^element;
             
          enter fg[]
          do
             find
               (#
                  predicate::  (#  do current.ge.fg[] = fg[]->value #);
                  notFound:: 
                    (# 
                    do
                       &element[]->newElm[];
                       (browser[],fg[])->edenv.createGroupEditor->newElm.ge[]
                         ->ge[];
                       newElm[]->append
                    #)
               do current.ge[]->ge[]
               #);
             
          exit ge[]
          #);
        closeGroups:
          (# okToClose: @boolean; 
          do
             true->okToClose;
             l: iterate
               (# 
               do
                  (if current.elm.ge.closeGroup->okToClose then
                      current[]->delete
                   else
                      leave l
                  if)
               #)
          exit okToClose
          #);
        closeGroup:
          (# fg: ^MPS.ast.fragmentGroup; 
          enter fg[]
          do
             locate
               (#
                  predicate::  (#  do current.elm.ge.fg[] = fg[]->value #); 
               do position.elm.ge.closeGroup; position[]->delete
               #)
          #)
     #);
   CVlist: @list
     (#
        element::  (# ff: ^mps.AST.fragmentForm; cVW: ^ymerLocalWindow #);
        
     #);
   
#)  

-- ymerPrivate: Descriptor --
(#
   workspaceCount: @integer;
   helpDocuments: @list (# element::  (# title,path: ^text #) #);
   grammarTable: @mps.AST.newGrammarTable;
   
#)  

