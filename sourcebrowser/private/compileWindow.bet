ORIGIN '../ymer';

INCLUDE 'executeWindow';
INCLUDE 'compilerPreferences';

(* -- compilePrivate: Descriptor --
 * (# recWindow: ^repeatingCompileWindow;
 *    preferenceDialog: @compilerPrefDialog;
 *    repeating: @boolean;
 * do preferenceDialog.open
 * #)  
 *)
--- fragmentBrowserLib: attributes ---
compileWindow: executeWindow
  (#
     executeStartMsg::  (#  do 'Compilation start'->value #);
     executeRestartMsg::  (#  do 'Recompilation start'->value #);
     executeAbortMsg::  (#  do 'Compilation ABORT'->value #);
     executeEndMsg::  (#  do 'Compilation terminated'->value #);
     repeatLabel::  (#  do 'Recompile'->value #);
     doExecute:: 
       (# 
       do
          switches[]->programInputPipe.writeend.puttext;
          ' '->programInputPipe.writeend.puttext;
          files[]->programInputPipe.writeend.puttext;
          programInputPipe.writeend.newline;
          programInputPipe.private.writech.flush;
          
       #);
     doRepeat::< 
       (# 
       do
          INNER ;
          switches[]->programInputPipe.writeend.puttext;
          ' '->programInputPipe.writeend.puttext;
          files[]->programInputPipe.writeend.puttext;
          programInputPipe.writeend.newline;
          programInputPipe.private.writech.flush;
          
       #);
     files,switches: ^text
  #);
singleCompileWindow: compileWindow
  (# doRepeat::  (#  do setupNewProcess #);  #);
repeatingCompileWindow: compileWindow
  (#
     open::  (#  do '--repeat'->arguments.append #);
     onAbort::<  (#  do (*none ->cPrivate.recWindow[]*) #);
  #);
