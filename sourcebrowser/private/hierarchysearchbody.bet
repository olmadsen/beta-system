ORIGIN 'hierarchy';
-- HIRfindFGAndSelect: DoPart --
do
   items.scan
     (# pe: ^propertyelement; hf: ^hirfolder; 
     do
        (if current## <= propertyElement## then
            current[]->pe[];
            (if fgname[]->pe.location.equal then
                true->found; (*current.select*) current[]->grp[]
            if)
         else
            (if current## <= hirfolder## then
                current[]->hf[]; fgname[]->hf.findFgandSelect->(found,grp[])
            if)
        if)
     #)  

-- temporaryProjectSavePrjFileAs: DoPart --
do
   l:
     (# prjFile: @file; 
     do
        (if fileName[] = none then
            fileCreationDialog
              (# 
              do
                 'Save \''->title[];
                 THIS(item).label[]->title.append;
                 '\' as'->title.append
              #)->filename[];
            (if filename[] = none then leave l if);
            '.pjt'->filename.append
        if);
        filename[]->prjfile.name;
        prjfile.openWrite;
        items.scan
          (# grp: ^group
          do
             current[]->grp[];
             'group#\'%s\' \'%s\'\n'
               ->prjfile.putformat
                 (#  do grp.label[]->s; grp.location[]->fragmentForename->s #)
          #);
        prjFile.close
     #)  

