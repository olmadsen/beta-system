ORIGIN '../ymer';

INCLUDE '~beta/basiclib/v1.5/file';
INCLUDE '~beta/basiclib/v1.5/directory';
(*
 * COPYRIGHT
 *   Copyright Mjolner Informatics, 1995-96
 *   All rights reserved.
 *)

--- ymerApplicationLib: attributes ---

fragmentDefaultName:
  (# f: @file
  enter f.name
  exit f.entry.path.name.prefix
  #);
fileAvailable:
  (# f: @file; avail: @boolean; t: ^text;
  enter f.name
  do (if true
      // not f.entry.exists then
         'File: '->t[];
         f.name->t.puttext;
         '\ndoes not exist'->t.puttext;
         (NONE, t[],'Not available')->alertUser
      // not f.entry.readable then
         'No read permissions to the file:\n     '->t[];
         f.name->t.puttext;
         (NONE, t[],'Not available')->alertUser
      else true->avail
     if);
  exit avail  
  #);
fileExists: 
  (# f: @file
  enter f.name
  exit f.entry.exists
  #);
fileReadable: 
  (# f: @file
  enter f.name
  exit f.entry.readable 
  #);
isFile:
  (# f: @file
  enter f.name
  exit f.entry.isFile
  #);
isDirectory:
  (# f: @file
  enter f.name
  exit f.entry.isDirectory
  #);
isRoot:
  (# f: @file
  enter f.name
  exit (mps.AST.astfileExtension->(f.entry.path.name.suffix).equal)
     or ('.bet'->(f.entry.path.name.suffix).equal)
     or ((mps.AST.astfileExtension->(f.name).append)->fileExists)
  #);
isProject:
  (# f: @file
  enter f.name
  exit '.prj'->(f.entry.path.name.suffix).equal
  #);
