ORIGIN '~beta/basiclib/basicsystemenv';
INCLUDE '~beta/guienv/guienvsystemenv'
        '../ymer'
        'sourcebrowserinterface' '~beta/sysutils/errorscreen'
        'mytxtmenu';
BODY '~beta/editor/private/nouser';
(*
 * COPYRIGHT
 *   Copyright Mjolner Informatics, 1995-96
 *   All rights reserved.
 *)
-- program: Descriptor --
(#
   stderr:@errorscreen;
   obj:@booleanObject;
   thesystemenv: @|systemenv
     (# setWindowEnv::  (#  do gui[]->theWindowEnv[] #); 
     do gui[]->ymer.init;
        stderr[]->screen[];
        myCallBack[]->ymer.newBrowserCallBack[];
        &myfilemenuacc[]->ymer.fileMenuActionList.append; 
        setupMenus;
        '/users/gram/beta/r5.2/sourcebrowser.jlk/demo/simpleYmer.bet: Line 20'->screen.putline;
        ymer.newbrowser;
        '/users/gram/beta/r5.2/sourcebrowser.jlk/demo/simpleYmer.bet: Line 22'->screen.putline;
     #);
   gui: @guienv;
   ymerBrowser: ^ymerBrowserInterface;
   myCallBack:@gui.BrowserCallBack
     (# 
     do browserInt[]->ymerBrowser[];
        &ymer.mycall[]->ymerCallBack[]
     #);
   ymer: @ymerEnv
     (#
        editMode:: readonlyMode;
        mycall: sourceBrowserInterface
          (#
             getFragmentGroup:: 
               (# 
               do name[]->mps.fragmentGroupTable.getFragmentGroup->fg[]
               #);
             selectFragmentGroup::
               (# do fgName[]->ymerBrowser.selectFragmentGroup #);
          #)
     #);
   (* ViewMenu *)
   SetUpMenus:
     (# 
     do &gui.MenubarAppendMenuAction
        (# viewMenu:theBrowser.ymerBrowser.codeEditorViewMenu
             (# browser:^gui.ymerbrowserwindow;
                formEditorExists::
                  (# do(* browser.browser.cfe->cfe[]*)
                  #);
             #);
           txtMenu:theBrowser.ymerBrowser.txtmenu
             (# browser:^gui.ymerbrowserwindow;
                getcte::
                  (# do browser.browser.cte[]->cte[];
                  #);
             #); 
           vm:^viewMenu;
           tm:^txtMenu;
        do &viewMenu[]->vm[];
           vm.open; vm[]->themenubar.append;
           theBrowser.ymerBrowser[]->vm.browser[];
           
           &txtMenu[]->tm[];
           theBrowser.ymerBrowser[]->tm.browser[];
           tm.open; tm[]->themenubar.append;
        #)[]->ymer.menuActionList.append
     #);

   (* just example, put in filemenu *)
   myfilemenuacc: gui.menuAppendItemAction
     (# myitem: ^fmenuitem;
        fmenuitem:themenu.menuitem
          (# open::(# do 'fgc'->name; #);
             eventhandler::
               (# onSelect::(# do 'fgc'->screen.putline#);
               #);
          #);
     do &fmenuitem[]->myitem[]; myitem.open; myitem[]->themenu.append; 
     #);
   
do
   'Mjolner Source Browser - version '->puttext;
   ymer.ymerVersion->putline;
   thesystemenv;
   
#)  

