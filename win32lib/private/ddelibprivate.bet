ORIGIN '../ddelib';
(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1994-95
 *       All rights reserved.
 *)

-- INCLUDE '~beta/containers/v1.6/list'

-- ddelibLib: attributes --
writeMsg2Console:
  (# t: ^text;
  enter t[]
  do (* (if t[]<>none then t[] -> screen.putLine;  if); *)
  #);

(**  DDEML support **)
ddemlMsgInfo:
  (# uType,uFmt,hconv,hsz1,hsz2,hdata,dwData1,dwData2: @integer;
     next: ^ddemlMsgInfo;
  #);
currentDdemlMsgInfo:
  (#
  enter private.currentDdemlMsgInfo[]
  exit private.currentDdemlMsgInfo[]
  #);
pushDdemlMsgInfo:
  (# info: ^ddemlMsgInfo;
  enter info[]
  do currentDdemlMsgInfo -> info.next[];
     info[] -> currentDdemlMsgInfo;
  #);
popDdemlMsgInfo:
  (# info: ^ddemlMsgInfo;
  do currentDdemlMsgInfo -> info[];
     (if info[]<>none then
         info.next[] -> currentDdemlMsgInfo;
     if);
  #);


stdDdeCallbackToInt: external
  (# func: ##standardDdemlCallback;
     int: @integer;
  enter func##
  do 'copyinput'->callC
  exit int
  #);
standardDdemlCallback: external
  (# uType,uFmt,hconv,hsz1,hsz2,hdata,dwData1,dwData2: @integer;
     result: @integer;
  enter (uType,uFmt,hconv,hsz1,hsz2,hdata,dwData1,dwData2)
  do StdExternalEntry;
     <<SLOT UIENVstandardDdemlCallback: descriptor>>;
  exit result
  #);
uienvAppName:
  (#
  enter private.uienvAppName
  exit private.uienvAppName
  #);
uienvHAppName:
  (#
  enter private.uienvHAppName
  exit private.uienvHAppName
  #);
hSysTopic:
  (#
  enter private.hSysTopic
  exit private.hSysTopic
  #);
hFormat:
  (#
  enter private.hFormat
  exit private.hFormat
  #);
hConvList:
  (#
  enter private.hConvList
  exit private.hConvList
  #);
hConv:
  (#
  enter private.hConv
  exit private.hConv
  #);
uienvIdInst:
  (#
  enter private.uienvIdInst
  exit private.uienvIdInst
  #);
standardDdemlCallbackAddress:
  (#
  enter private.standardDdemlCallbackAddress
  exit private.standardDdemlCallbackAddress
  #);

-- ddelibPrivateImpl: descriptor --
(# uienvIdInst: @integer; (* application instance identifier, use for ddeml *)
   standardDdemlCallbackAddress: @integer; (* address of dde callback func *)
   uienvAppName: @text;
   uienvHAppName: @integer;
   hSysTopic: @integer;
   hFormat: @integer;
   hConvList: @integer;
   hConv: @integer;
   currentDdemlMsgInfo: ^ddemlMsgInfo;
   ddeServers: @list
     (# element::< integerObject;
        add: 
         (# topic: @integer; topicObject: ^integerObject;
         enter topic
         do
         #);
        remove: 
         (# topic: @integer; topicObject: ^integerObject;
         enter topic
         do
         #);
     #);
#)

