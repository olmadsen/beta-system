ORIGIN '../ntfile';
BUILD nti '$$/ntfileInt.obj' 'external/ntfileInt.c' 'betacc $0 $1';

INCLUDE '~beta/basiclib/private/file_ntbody';

-- LIB: attributes --
getEntryAccessTime: External
  (# path: [1]@char;
     time: @integer;
  enter path
  exit time (* -1 => error *)
  #);
getEntryCreationTime: External
  (# path: [1]@char;
     time: @integer;
  enter path
  exit time (* -1 => error *)
  #);

NTchmodfile: External
  (# path: [1]@Char;
     mode,res: @Integer;
  enter (path,mode)
     do '_chmod' -> callC
  exit res
  #);

-- NtEntryAccessTime: dopart -- 
do (if (private.path -> getEntryAccessTime -> time) = -1 then error if)

-- NtEntryCreationTime: dopart -- 
do (if (private.path -> getEntryCreationTime -> time) = -1 then error if)

-- NtEntryreadOnly: dopart --
   (* #define _S_IREAD	0000400 	/* read permission, owner */
    * #define _S_IWRITE	0000200 	/* write permission, owner */
    *)
do (if readOnly then
       (if ((private.path, 08x0000400) -> NTchmodfile) = -1 then error if)
    else
       (if ((private.path, 08x0000200) -> NTchmodfile) = -1 then error if)
   if)
       
       

