ORIGIN '~beta/basiclib/v1.6/external';
(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1994-95
 *       All rights reserved.
 *)

[[
-- CStructLib: Attributes --


-- Lib: Attributes --

malloc: external
  (# in,out: @integer;
  enter in
  exit out
  #);
free: external
  (# in: @integer;
  enter in
  #);

(* IntegerRef: 
  (# int: @integer;
     value: (# exit int #); 
     shortValue: (# exit int -> TOS'%GetShort[0]' #);
  exit @@int
  #);

longInt : cstruct
(# 
  byteSize ::< (# do 4 -> value #);

loWord : short(# pos::< (# do 2 -> value #)#);
hiWord : short(# pos::< (# do 0 -> value #)#);
enter R[1]
exit R[1]
#);


charRef : cstruct
(#  byteSize ::< (# do 2 -> value #)
enter (# val : @integer enter val do (0,val) -> putShort #)
exit 0 -> getShort
#);

shortRef : cstruct
(#  byteSize ::< (# do 2 -> value #)
enter (# val : @integer enter val do (0,val) -> putShort #)
exit 0 -> getShort
#);

byteRef : cstruct
(# byteSize ::< (# do 1 -> value #)
enter (# val : @integer enter val do (0,val) -> putByte #)
exit 0 -> getByte
#);

 *)

ShortRef: cStruct
  (# bytesize::< (# do 4 -> value #);
     w: short(# #); 
  enter w
  exit w
  #);

LongRef: cStruct
  (# bytesize::< (# do 4 -> value #);
  enter r[1]
  exit r[1]
  #);
putPoint:
  (# h,v: @integer;
  enter (h,v)
  do '(' -> put;
     h -> putInt;
     ',' -> put;
     v -> putInt;
     ')' -> put;
  #);

putRectangle:
  (# top, left, bottom, right: @integer;
  enter ((top, left), (bottom, right))
  do '( ' -> putText;
     (top, left) -> putPoint; ' , ' -> putText;
     (bottom, right) -> putPoint; ' )' -> putLine;
  #);

--]]
