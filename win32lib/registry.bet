ORIGIN 'ntitypes';
BODY 'private/registrybody';

(****************************************************
 *       registry.bet                               
 * 
 * Read values from the NT registry.
 ****************************************************)
-- lib: attributes --

HKEY_CLASSES_ROOT:     (# exit 16x80000000 #);
HKEY_CURRENT_USER:     (# exit 16x80000001 #);
HKEY_LOCAL_MACHINE:    (# exit 16x80000002 #);
HKEY_USERS:            (# exit 16x80000003 #);
HKEY_PERFORMANCE_DATA: (# exit 16x80000004 #);

readFromRegistry:
  (# private: @<<SLOT ReadFromRegistryPriv:descriptor>>;
     
     subKeyName: ^Text; 
     HKEY_val: @Integer;
     valueName, value: ^Text;      
     
     NoSuchKey:< (# do INNER #); (* Exceptions *)
     NoSuchValue:< (# do INNER #);
     otherError:< (# do INNER #);

  enter (HKEY_val, subKeyName[], valueName[])
  do private;
  exit value[]
  #);
