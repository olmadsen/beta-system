ORIGIN 'nameTable';
LIB_DEF 'address_to_name_table' '../../lib';
BODY 'private/address_to_name_body';
--LIB: attributes--
address_to_name_table:
  (# (* FIXME: move private substance to body file *)
     handle: @integer;
     startLabelRead:<Object;
     doneLabelRead:<Object;
     execfilename:<
       (# name: ^text;
       do INNER
       exit name[]
       #);
     labels: [initialCapacity] ^Text;
     values: [initialCapacity] @Integer;
     initialCapacity: (# exit 6000 #);
     count: @Integer;
     max: @Integer;
     initialized: @Boolean;
     nmforked: @Boolean;
     process_offset: @integer;
     forknm:<
       (* Calls INNER when tables have been read *)
       (# 
       do <<SLOT address_to_name_forknm:descriptor>>;
       #);
     get_process_offset:
       (* Only relevant on nti *)
       (# main_physical: @integer
       enter main_physical
       <<SLOT address_to_name_get_process_offset:dopart>>
       #);
     readFromExecutable:
       (* Reads the code labels of the executable into this table. *)
       <<SLOT address_to_name_read:descriptor>>;
     findNearestLabel:
       (# adr: @Integer;
          label: ^Text;
          value: @Integer;
          find: @
            <<SLOT address_to_name_find:descriptor>>;
       enter adr
       do find;
       exit (label[],value)
       #);
     
  #)
