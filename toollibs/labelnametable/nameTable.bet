ORIGIN '~beta/basiclib/betaenv';
BODY 'private/nametablebody';

(* External interface to C functions which enables start of a UNIX-like
 * 'nm' process for reading symbols from an executable or an object file.
 * Used by the BETA abstractions in the other files in this directory.
 *)

-- LIB: Attributes --
initReadNameTable: external
  (* Forks an nm process and sets up a pipe from which addresses and
   * labels may be read using "nextAddress" and "nextLabel". 
   *)
  (# execFileName: [1] @Char;
     allsymbols: @boolean;
     handle: @integer;
  enter (execFileName, allsymbols)
  exit handle
  #);
freeNameTable: external 
  (# handle: @integer;
  enter handle
  #);
nextAddress: external 
  (* exits 0 if no more code labels are available. *)
  (# address: @Integer; 
     handle: @integer;
  enter handle
  exit address
  #);
nextLabel: external 
  (# label: [1] @Char;
     handle: @integer;
  enter handle
  exit label
  #);
