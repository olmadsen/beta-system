ORIGIN '~beta/basiclib/betaenv';
LIB_DEF 'fileExtensions' '../../lib';
BODY 'private/fileExtensionsBody';
--- lib: attributes ---
fileExtension: (* abstract superptn. *)
  (# ext: ^text do INNER exit ext[] #);
betFileExtension: fileExtension
  (# do '.bet'->ext[] #); (* Never changes ;) *)
betBackupFileExtension: fileExtension
  (# do '.bet~'->ext[] #);
astFileExtension: fileExtension (* '.ast/.astL' *)
  (# <<SLOT astFileExtension:dopart>> #);
astBackupFileExtension: fileExtension (* '.ast~/.astL~' *)
  (# <<SLOT astBackupFileExtension:dopart>> #);
astAutoSaveFileExtension: fileExtension (* '.ast#/.astL#' *)
  (# <<SLOT astAutoSaveFileExtension:dopart>> #);
asmFileExtension: fileExtension (* '..s'/'.asm' *)
  (# <<SLOT asmFileExtension:dopart>> #);
objFileExtension: fileExtension (* '.o'/'.obj' *)
  (# <<SLOT objFileExtension:dopart>> #);
jobFileExtension: fileExtension (* '..job'/'.job'/'.bat' *)
  (# <<SLOT jobFileExtension:dopart>> #);
dbFileExtension:  fileExtension (* '.db' *)
  (# <<SLOT dbFileExtension:dopart>> #);
staticLibFileExtension: fileExtension (* '.a'/'.lib' *)
  (# <<SLOT staticLibFileExtension:dopart>> #);
dynamicLibFileExtension: fileExtension (* '.so'/'.dll'/'.sl' *)
  (# <<SLOT dynamicLibFileExtension:dopart>> #);
exeFileExtension: fileExtension (* ''/'.exe' *)
  (# <<SLOT exeFileExtension:dopart>> #);
batFileExtension: fileExtension (* ''/'.bat' *)
  (# <<SLOT batFileExtension:dopart>> #);
dumpFileExtension: fileExtension (* '.dump' *)
  (# <<SLOT dumpFileExtension:dopart>> #);
parserFileExtension: fileExtension (* '.btab'/.btabL' *)
  (* exits the filename extension for parser table files on the particular
   * architecture (the extension differs e.g. for big- and little endian
   * architectures).
   *)
  (# <<SLOT parserFileExtension:dopart>> #);
ppFileExtension: fileExtension (* '.ptab'/.ptabL' *)
  (* exits the filename extension for pretty-printer table files on the
   * particular architecture (the extension differs e.g. for big- and
   * little endian architectures).
   *)
  (# <<SLOT ppFileExtension:dopart>> #);

codeDir: fileExtension
  (* 'sun4s'/'hpux9pa'/'sgi'/'linux'/'mac'/.../'nti/ms','nti/bor'/nti/gnu' *)
  (# <<SLOT codeDirFileExtension:dopart>> #);

--- textLib: attributes ---
hasExtension: booleanValue
  (# ext: ^text;
  enter ext[]
  <<SLOT hasExtension: dopart>>
  #);

doExtension: 
  (# ext: ^text;
  enter ext[]
  do INNER
  exit THIS(Text)[]
  #);

appendExtension: doExtension
  (* appends extension iff not already present *)
  (# <<SLOT appendExtension: dopart>> #);

stripExtension: doExtension
  (* removes extension iff present *)
  (# <<SLOT stripExtension: dopart>> #);
