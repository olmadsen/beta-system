ORIGIN '../fileExtensions';
INCLUDE '~beta/sysutils/v1.6/envstring';
MDBODY
  sun4s 'fileExtensions_unixbody.bet'
  hpux9pa 'fileExtensions_hppabody.bet'
  sgi 'fileExtensions_unixbody.bet'
  linux 'fileExtensions_linuxbody.bet'
  mac 'fileExtensions_macbody.bet'
  macppc 'fileExtensions_macbody.bet'
  nti 'fileExtensions_ntibody.bet';

--- checkExtension: dopart ---
do (if ext.lgth<=lgth then
       ext.makeLC;
       check:
	 (# i: @integer
	 do loop:
	      (if i<ext.lgth then
		  (if (T[lgth-i]->ascii.lowcase)<>ext.T[ext.lgth-i] then
		      false->value;
		      leave check
		  if);
		  i+1->i; restart loop
	      if);
	    true->value;
	 #)
   if);
   INNER checkExtension

--- appendExtension: dopart ---
do (if not value then ext[]->append if)

--- stripExtension: dopart ---
do (if value then
       (* remove trailing extension *)
       lgth-ext.lgth->lgth;
       (if pos>lgth then lgth->pos if);
   if)
