ORIGIN '../fileExtensions';
LIB_ITEM 'fileExtensions';
INCLUDE '~beta/sysutils/envstring';
MDBODY sun4s 'fileExtensions_unixbody.bet'
       macosx 'fileExtensions_unixbody.bet'
       sgi 'fileExtensions_unixbody.bet'
       hpux9pa 'fileExtensions_hppabody.bet'
       linux 'fileExtensions_linuxbody.bet'
       x86sol 'fileExtensions_x86solbody.bet'
       nti 'fileExtensions_ntibody.bet'
       jvm 'fileExtensions_jvmbody.bet'
       clr 'fileExtensions_clrbody.bet'
       ppcmac 'fileExtensions_macbody.bet';

--- hasExtension: dopart ---
do (if ext.lgth <= lgth then
       (* OLM 16/7/98: removed 'ext.makeLC' since 
        * its converted 'astL' into 'astl'. 
        * Instead 'lowCase' is used explict on 'ext'
        * as it originally was for 'T'
        *)
       check:
	 (# i: @integer
	 do loop:
	      (if i < ext.lgth then
		  (if (T[lgth-i]->ascii.lowcase) 
                      <> (ext.T[ext.lgth-i]->ascii.lowCase) then
		      false->value;
		      leave check
		  if);
		  i+1->i; restart loop
	      if);
	    true->value;
	 #);
   if);

--- appendExtension: dopart ---
do (if not (ext[]->hasExtension) then
       ext[]->append
   if)

--- stripExtension: dopart ---
do (if ext[]->hasExtension then
       (* remove trailing extension *)
       lgth-ext.lgth->lgth;
       (if pos>lgth then lgth->pos if);
   if)
