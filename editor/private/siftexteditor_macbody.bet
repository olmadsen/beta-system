ORIGIN 'siftexteditorbody' ;
INCLUDE '~beta/guienv/private/macintosh/fields_macbody';
(*
 * COPYRIGHT
 *   Copyright (C) Aarhus University
 *   All rights reserved.
 *)
-- sifTexteditorContentsLib: Attributes --
setTextColor:
  (# red,green,blue: @integer; 
  enter (red,green,blue)
  do
       (# newStyle: @textStyleRec; 
       do
          assertOpen;
          (if THIS(textField).textFieldHandle <> 0 then
          (* 0xFFFF is the maxumum value for red, green and blue component *)
              red->newStyle.tsColor_red;
              green->newStyle.tsColor_green;
              blue->newStyle.tsColor_blue;
              focusTextField
                (# 
                do
                   (doColor,newStyle[],TRUE,THIS(textField).textFieldHandle)
                     ->TESetStyle;
                   
                #);
              
          if);
          
       #);
     
  #);
  

-- siftexteditorSetBindings: Descriptor --
(#  do  #)  

-- siftexteditorCharWidthType: Descriptor --
(# sz: @Point; count,sum: @Integer; ch: @Char
do
   thisOp:
     (# 
     do
        (if ts[]
         // none then
            contents.defaultStyle->ts[];
            (if ts[]
             // none then
                (if sifViewer.switch[14] then 'ts is none'->putLine if);
                INNER charWidthType;
                (if ts[]
                 // none then
                    (if sifViewer.switch[14] then
                        'ts is none, value is set to 80'->putLine
                    if);
                    80->value;
                    leave thisOp (*not good: standardTextStyle[]->ts[]; *)
                if);
                
            if);
            
        if);
        'a'->ch;
        loop:
        (if ch <= 'z' then
            (ch->ts.widthOfChar)+sum->sum;
            (if sifViewer.switch[14] then
                '<'->put;
                ch->put;
                '> '->putText;
                ch->ts.widthOfChar->putInt;
                newLine
            if);
            (ch->ascii.upcase->ts.widthOfChar)+sum->sum;
            (if sifViewer.switch[14] then
                '<'->put;
                ch->ascii.upcase->put;
                '> '->putText;
                ch->ascii.upcase->ts.widthOfChar->putInt;
                newLine
            if);
            count+2->count;
            ch+1->ch;
            restart loop;
            
        if);
        '0'->ch;
        loop:
        (if ch <= '9' then
            (ch->ts.widthOfChar)+sum->sum;
            (if sifViewer.switch[14] then
                '<'->put;
                ch->put;
                '> '->putText;
                ch->ts.widthOfChar->putInt;
                newLine
            if);
            count+1->count;
            ch+1->ch;
            restart loop;
            
        if);
        viewsize.h div (sum div count)->value
     #)
#)  

-- siftexteditorUpdate: Descriptor --
(#  do  #)  

-- siftexteditorSetTexteditStyle: DoPart --
do (0x8000,0,0x8000)->setTextColor;   

-- siftexteditorSetTextStyle: DoPart --
do
     (#
        red: (#  exit (65280,0,0) #);
        green: (#  exit (0,65280,0) #);
        blue: (#  exit (0,0,65280) #)
     do
        (if style
         // 1 (* textedit *) then
            (0x8000,0,0x8000)->setTextColor
         // 2 (* semantic errors *) then
            red->setTextColor
         // 3 (* search hits *) then
            blue->setTextColor
         else
            green->setTextColor
        if);
        
     #)  

-- siftexteditorResetTexteditStyle: DoPart --
do (0,0,0)->setTextColor;   

-- siftexteditorFormat: DoPart --
do   

-- siftexteditorAllowFormat: DoPart --
do   

-- siftexteditorPrint: DoPart --
do 'Print is currently not implemented on mac'->putLine  

