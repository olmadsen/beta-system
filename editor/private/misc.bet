ORIGIN '../codeeditor';
(*
 * COPYRIGHT
 * Copyright Mjolner Informatics, 1986-96
 * All rights reserved.
 *)

-- getSynCatNoBody: Descriptor --
(# nontNode: ^astInterface.unExpanded
do
   trace
     (#  do 'getSynCatNo'->str[] #);
   (if
   ((node.kind = mps.kinds.unexpanded) or (node.kind = mps.kinds.optional))
    then
       node[]->nontNode[]; nontNode.nonterminalSymbol->synCatNo
   else
       node.symbol->synCatNo
   if)
#)  

-- setSynCatNoBody: Descriptor --
(# cons: ^mg.constructor; consList: ^mg.consElemList; sonIndex: @integer; 
do
   trace
     (#  do 'setSynCatNo'->str[] #);
   synCatNo->Prodlist.get->cons[];
   cons.getConsElemList->consList[];
   0->sonIndex;
   mg.synName
     -> (* nonterminals *) consList.suffixWalkForProd
       (#
          nontNode: ^astInterface.unexpanded;
          theAttribute: @integer;
          (* due to the compiler *)
          
       do (* son is now right hand side nonterminal *)
          1+sonIndex->sonIndex->programNode.get->nontNode[];
          1->current.getAttribute->theAttribute;
          theAttribute->nontNode.nonterminalSymbol;
          
       #);
   
#)  

-- findSynNameAttBody: Descriptor --
(# 
do
   trace
     (#  do 'findSynNameAtt'->str[] #);
   loop:
   mg.synName
     ->production.suffixWalkForProd
       (#  do 1->current.getAttribute->synCatNo; leave loop;  #);
   
#)  


