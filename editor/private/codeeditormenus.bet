ORIGIN '../codeeditor';
-- editMenuOpen: DoPart --
do
   ('Undo','z')->iUndo.newkey;
   ('Redo','y')->iRedo.newkey;
   newSeparator;
   ('Cut','x')->iCut.newkey;
   ('Copy','c')->iCopy.newKey;
   ('Paste','v')->iPaste.newKey;
   'Clear'->iClear.new;
   newSeparator;
   ('Textedit','t')->iTextEdit.newKey;
   (if useExternalTextEditor then
       ('External Textedit','e')->iExternalTextEdit.newKey
   if);
   'Revert Textedit'->iRevertTextEdit.new;
   'Show Textedit commands'->iShowTextEditCommands.new;
   newSeparator;
   ('Insert Before','u')->iInsertBefore.newKey;
   ('Insert After','a')->iInsertAfter.newKey;
   newSeparator;
   ('Remove Optionals','n')->iRemoveOptionals.newKey;
   ('Show Optionals','l')->iShowOptionals.newKey;
   newSeparator;
   ('Open Subeditor','j')->iSubeditor.newKey;
   newSeparator;
   'Form Write Protection'->iSetIsReadOnly.new;
   'Edit'->name;
   INNER  

-- editMenuiExternalTextEditOnStatus: DoPart --
do
   false->value;
   (if formEditorExists then
       (if cfe.isReadOnly then
           (* 'Write protected'->writeStatus *)
        else
           (if useExternalTexteditor then (* ''->writeStatus; *) true->value if)
       if)
   if)  

-- editMenuiExternalTextEditOnSelect: DoPart --
do 'External textediting'->writestatus; cfe.doExternalTextEdit; ''->writestatus  

-- viewMenuFollowSLOTLinkonSelect: DoPart --
do
   cfe.doCommand
     (# 
     do
        (if cfe.thisGroupEditor[] <> none then
            cfe.frag[]->cfe.thisGroupEditor.searchSLOT->node[];
            (if node[] <> none then
            (*node[]->cfe.edenv.ymerCallback.findAndSelect*)
                (node[],node[],false)->cfe.selectNodeInFormEditor
            if);
            
        if)
     #)  

-- viewMenuOpen: DoPart --
do
   ('Abstract (Dbl-Clk)')->iAbstract.new;
   'Astract Recursively'->iAbstractRecursively.new;
   ('Overview','o')->iOverview.newkey;
   ('Detail (Dbl-Clk)','d')->iDetail.newkey;
   'Detail Recursively'->iDetailRecursively.new;
   newSeparator;
   ('Search...','s')->iSearch.newKey;
   ('Replace...','r')->iReplace.newKey;
   (if BETAsif then
       newSeparator;
       'Follow Semantic Link (Dbl-Clk)'->iFollowSemanticLink.new;
       'Follow Link To Fragment (Dbl-Clk)'->iFollowSLOTLink.new;
       'Follow Link To SLOT'->iFollowFragmentLink.new
   if);
   newSeparator;
   ('Zoom In','1')->iZoomIn.newKey;
   ('Zoom Out','2')->iZoomOut.newKey;
   ('Zoom To Full Editor','3')->iZoomFullEditor.newKey;
   newSeparator;
   ('Reprettyprint','p')->iReprettyprint.newKey;
   'Format...'->iFormat.new;
   'Adaptive prettyprinting'->iAdaptivePrettyprinting.new;
   'Show AST Dump'->iShowAstCS.new;
   'View'->name;
   INNER  

-- SLOTsMenuSetImplFragOnStatus: DoPart --
do allowCommand->value  

-- SLOTsMenuUnsetImplFragOnStatus: DoPart --
do allowCommand->value  

-- SLOTsMenuSetSLOTnamePrefixOnStatus: DoPart --
do allowCommand->value  

-- SLOTsMenuUnsetSLOTnamePrefixOnStatus: DoPart --
do allowCommand->value  

-- SLOTsMenuHideImplOnStatus: DoPart --
do allowCommand->value  

-- SLOTsMenuOpen: DoPart --
do
   'Make DoPart SLOT...'->iMakeDoPartSlot.new;
   'Make Descriptor SLOT...'->iMakeDescriptorSlot.new;
   'Make Attributes SLOT...'->iMakeAttributesSlot.new;
   newSeparator;
   'Set Current as Implementation File'->iSetImplementationFragment.new;
   'Unset Implementation File'->iUnsetImplementationFragment.new;
   'Set SLOT Name Prefix...'->iSetSLOTNamePrefix.new;
   'Unset SLOT Name Prefix'->iUnsetSLOTNamePrefix.new;
   'Hide Implementation...'->iHideImpl.new;
   (* newSeparator;
    'Paste Fragment Form'->iPasteFragmentForm.new;
    'Fill SLOT...'->iFillSlot.new;
    'Fill All SLOTs'->iFillAllSlots.new;*)
   'SLOTs'->name;
   INNER  

-- editMenuCutOnStatus: DoPart --
do allowTextAndStructure->value  

-- editMenuCutOnSelect: DoPart --
do cfe.doCut;   

-- editMenuCopyOnStatus: DoPart --
do formEditorExists->value  

-- editMenuCopyOnSelect: DoPart --
do cfe.doCopy  

-- editMenuPasteOnStatus: DoPart --
do
   (if formeditorExists then
       (if not cfe.texteditMode then
           cfe.askPastePermission->value
        else
           true->value
       if)
    else
       false->value
   if)  

-- editMenuPasteOnSelect: DoPart --
do cfe.doPaste  

-- editMenuAllowCommand: DoPart --
do
   (if formEditorExists then
       not cfe.texteditMode and not cfe.isReadOnly->value
   if)  

-- editMenuUndoOnStatus: DoPart --
do (if allowCommand then cfe.askUndoPermission->value else false->value if)  

-- editMenuUndoOnSelect: DoPart --
do cfe.doUndo  

-- editMenuRedoOnStatus: DoPart --
do (if allowCommand then cfe.askRedoPermission->value else false->value if)  

-- editMenuRedoOnSelect: DoPart --
do cfe.doRedo  

-- editMenuClearOnStatus: DoPart --
do allowCommand->value  

-- editMenuClearOnSelect: DoPart --
do cfe.doClear;   

-- editMenuTextEditOnStatus: DoPart --
do
   (if formEditorExists then
       (* (if cfe.isReadOnly then
           'Write protected'->writeStatus
        else
           ''->writeStatus
       if) *)
   if);
   (if formEditorExists and not cfe.isReadOnly then
       (if cfe.askTextEditMode then
           'Parse Text'->THIS(item).name
        else
           'Edit Text'->THIS(item).name
       if);
       true->value
    else
       false->value
   if)  

-- editMenuTexteditOnSelect: DoPart --
do
   (if cfe.askTextEditMode then
     cfe.doParseText; ''->writestatus
    else
       cfe.doTextEdit; 'Textediting Mode'->writestatus
   if);
     

-- editMenuRevertTexteditOnStatus: DoPart --
do
   (if formEditorExists and not cfe.isReadOnly then
       cfe.askTextEditMode->value
    else
       false->value
   if)  

-- editMenuRevertTexteditOnSelect: DoPart --
do cfe.doRevertTextEdit; ''->writestatus  

-- popupMenuFollowSLOTLinkonSelect: DoPart --
do
   cfe.doCommand
     (# 
     do
        (if cfe.thisGroupEditor[] <> none then
            cfe.frag[]->cfe.thisGroupEditor.searchSLOT->node[];
            (if node[] <> none then
            (*node[]->cfe.edenv.ymerCallback.findAndSelect*)
                (node[],node[],false)->cfe.selectNodeInFormEditor
            if);
            
        if)
     #)  

-- popupMenuOpenSeparateOnSelect: DoPart --
do (cfe.editorRoot[],cfe.editorRoot[],true)->cfe.selectNodeInFormEditor  

-- popupMenuCutOnStatus: DoPart --
do allowTextAndStructure->value  

-- popupMenuCutOnSelect: DoPart --
do cfe.doCut;   

-- popupMenuCopyOnStatus: DoPart --
do formEditorExists->value  

-- popupMenuCopyOnSelect: DoPart --
do cfe.doCopy  

-- popupMenuPasteOnStatus: DoPart --
do
   (if formeditorExists then
       (if not cfe.texteditMode then
           cfe.askPastePermission->value
        else
           true->value
       if)
    else
       false->value
   if)  

-- popupMenuPasteOnSelect: DoPart --
do cfe.doPaste  

-- popupMenuOpen: DoPart --
do
   ('Back','b')->iBack.newKey;
   ('Forward','f')->iForward.newKey;
   (if BETAsif then
       newSeparator;
       'Follow Semantic Link (Dbl-Clk)'->iFollowSemanticLink.new;
       'Follow Link To Fragment (Dbl-Clk)'->iFollowSLOTLink.new;
       'Follow Link To SLOT'->iFollowFragmentLink.new
   if);
   newSeparator;
   'Open Separate Editor'->iOpenSeparate.new;
   ('Open Subeditor','j')->iSubeditor.newKey;
   newSeparator;
   ('Cut','x')->iCut.newkey;
   ('Copy','c')->iCopy.newKey;
   ('Paste','v')->iPaste.newKey;
   newSeparator;
   ('Reprettyprint','p')->iReprettyprint.newKey;
   INNER  

-- codeeditorPopUpMenuBackOnStatus: DoPart --
do (allowCommand and (cfe.cs.node[]->cfe.edenv.history.BackPossible))->value  

-- codeeditorPopUpMenuBackOnSelect: DoPart --
do
   cfe.edenv.history.protect
     (# node: ^astInterface.ast
     do
     (* cfe.cs.node[]->cfe.edenv.history.back
      ->cfe.edenv.ymerCallBack.findAndSelect*)
        cfe.cs.node[]->cfe.edenv.history.back->node[];
        (if node[] <> none then
            (node.frag.root[],node[],false)->cfe.selectNodeInFormEditor
        if)
     #)  

-- codeeditorPopUpMenuForwardOnStatus: DoPart --
do (allowCommand and (cfe.cs.node[]->cfe.edenv.history.forwardPossible))->value  

-- codeeditorPopUpMenuForwardOnSelect: DoPart --
do
   cfe.edenv.history.protect
     (# node: ^astInterface.ast
     do
     (* cfe.cs.node[]->cfe.edenv.history.forward
      ->cfe.edenv.ymerCallBack.findAndSelect*)
        cfe.cs.node[]->cfe.edenv.history.forward->node[];
        (if node[] <> none then
            (node.frag.root[],node[],false)->cfe.selectNodeInFormEditor
        if)
     #)  

-- codeeditorFormatOnStatus: DoPart --
do
   allowCommand->value;
   (if formEditorExists then
       cfe.theSiftexteditor.contents.AllowFormat->value
   if);
     

-- codeeditorFormatOnSelect: DoPart --
do cfe.theSifTexteditor.contents.format;   

