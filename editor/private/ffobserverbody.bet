ORIGIN '../codeeditor';
-- ffObserverPrivate: Descriptor --
(#
   updateList:
     (# listNode: ^astInterface.expanded; containsLastElement: @boolean
     enter (listNode[],containsLastElement)
     do (* (editorRoot[] ,- 1)->astView.pp.present;*)
        (if containsLastElement then
            (if listNode[]->editorRoot.equal then
                doReprettyprint
             else
                (if listNode.father <> none then
                    (listNode.father,listNode.father)->astView.pp.update
                 else
                    doReprettyprint
                if)
            if)
         else
            (listNode[],listNode[])->astView.pp.update
        if)
     #)
#)  

-- ffObserverOnAstReplaced: DoPart --
do
   (if true (*switch[7]*) then
       '***** onAstReplaced     '->putText;
       (frag.father).name->putText;
       '-'->put;
       frag.name->putText;
       ': '->putText;
       ffObserver.no->putInt;
       newLine
   if);
   (if theSifTextEditor[] <> none (* the editor is visible *) then
       (if oldAST[]->editorRoot.equal then
           (if switch[7] then 'oldAST[] = editorRoot[]'->putLine if);
           newAST[]->editorRoot[];
           (if theSifTexteditor[] <> none then
               newAST[]->theSifTExteditor.editorRoot[]
           if)
       if);
       (if (newAst[],editorRoot[])->isNodeInTree then
       (* newAST is in the subtree of this editor *)
           (if switch[7] then
               'newAST is in the subtree of this editor'->putLine
           if);
           (oldAst[],newAst[])->astView.pp.update;
           
        else
           (if (editorRoot[],oldAST[])->isNodeInTree then
           (* the subtree in this editor is in oldAST, which means that *)
           (* this editor is obsolete and must be closed *)
               (if switch[7] then
                   'This editor is obsolete and must be closed '->putLine
               if);
               (THIS(codeeditor).theSifTextEditor.theWindow).close;
               
           if)
       if)
   if)  

-- ffObserverOnAstReplacedSequence: DoPart --
do   

-- ffObserverOnListElementInserted: DoPart --
do
   (if true (*switch[7]*) then
       '***** onListElementInserted     '->putText;
       (frag.father).name->putText;
       '-'->put;
       frag.name->putText;
       ': '->putText;
       ffObserver.no->putInt;
       newLine
   if);
   (if theSifTextEditor[] <> none (* the editor is visible *) then
       (if (node[],editorRoot[])->isNodeInTree then
           (node[],false)->private.updateList
       if)
   if)  

-- ffObserverOnListElementsDeleted: DoPart --
do   

-- ffObserverOnListElementsReplaced: DoPart --
do INNER  

