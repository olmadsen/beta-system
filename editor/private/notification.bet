ORIGIN '../codeeditor';
INCLUDE '~beta/pretty/v4.9.1/pplib';
(*
 COPYRIGHT
 Copyright Mjolner Informatics, 1986-94
 All rights reserved.
 *)
-- notificationNewFragment: Descriptor --
(#  do (editorRoot[],- 1)->astViEw.pp.present;  #)  

-- notificationAstReplaced: Descriptor --
(# (*exp: ^astInterface.expanded*) 
do
   (if switch[7] then 'astReplacedEvent'->screen.putLine if);
   INNER astReplacedEvent;
   (if byMe then
       'astReplacedEvent byMe'->putLine;
       (if oldAST[] = editorRoot[] then
             'oldAST[] = editorRoot[]'->putLine;
               newAST[]->editorRoot[]
       if);
       (oldAst[],newAst[])->astView.pp.update;
       (THIS(codeeditor)[],oldAst[],newAst[])->ffh.anASTreplacedEvent
    else
       'astReplacedEvent not byMe'->putLine;
       (if oldAST[] = editorRoot[] then
           'oldAST[] = editorRoot[]'->putLine;
           newAST[]->editorRoot[]
       if);
       (if (newAst[],editorRoot[])->isNodeInTree then
           (* newAST is in the subtree of this editor *)
           'newAST is in the subtree of this editor'->putLine;
           (oldAst[],newAst[])->astView.pp.update;
        else
           (if (editorRoot[],oldAST[])->isNodeInTree then
               (* the subtree in this editor is in oldAST, which means that *)
               (* this editor is obsolete and must be closed *)
               'This editor is obsolete and must be closed '->putLine;
               THIS(codeeditor)[]->edenv.ffHandler.unsubscribe;
               (THIS(codeeditor).theSifTextEditor.theWindow).close;
               (* there should be a close operation on a codeeditor,
                * that does the closing of the window if necessary
                * and the unsubscribing
                *)
               
           if)
       if)
   if)
#)  

-- notificationAstReplacedSequence: Descriptor --
(# 
do
   (if switch[7] then 'astReplacedSequencdEvent'->screen.putLine if);
   INNER astReplacedSequenceEvent;
   (rootOfSequence[],rootOfSequence[])->astView.pp.update;
   
#)  

-- notificationListElementInserted: Descriptor --
(# 
do
   (if switch[7] then 'listElementInsertedEvent'->screen.putLine if);
   INNER listElementInsertedEvent;
   (fatherNode[],position,0,1)->astView.pp.updateList;
   (if switch[7] then '(# doReprettyPrint'->putLine;  if);
   (editorRoot[],- 1)->astView.pp.present;
   
#)  

-- notificationListElementsDeleted: Descriptor --
(# 
do
   (if switch[7] then 'listElementDeletedEvent'->screen.putLine if);
   INNER listElementsDeletedEvent;
   (listNode[],position,length,0)->astView.pp.updateList;
   (if switch[7] then '(# doReprettyPrint'->putLine;  if);
   (editorRoot[],- 1)->astView.pp.present;
   
#)  

-- notificationListElementsReplaced: Descriptor --
(# 
do
   (if switch[7] then 'listElementsReplacedEvent'->screen.putLIne if);
   INNER listElementsReplacedEvent;
   (listNode[],position,length,newLength)->astView.pp.updateList;
   (if switch[7] then '(# doReprettyPrint'->putLine;  if);
   (editorRoot[],- 1)->astView.pp.present;
   
#)  

-- notificationFocusChanged: Descriptor --
(#  do updateExpandMenu; updateEditMenu; INNER focusChangedEvent #)  

