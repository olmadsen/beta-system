ORIGIN '~beta/editor/codeeditor';
INCLUDE '~beta/mps/grammarinit'
        'mylangcfl';
-- userOnOpenCodeeditor: Descriptor --
(# 
do
   edenv.uep.mylangCFL[]->up.mylangCFL[];
   up.userPopUPmenu.open;
   frag[]->up.ffObserver.ff[];
   up.ffObserver[]->edenv.ffSubjectHandler.attach
#)  

-- userPrivate: Descriptor --
(#
   mylangCFL: ^astInterface.mylang;
   userPopUpMenu: @mysimplemenu
     (#
        iUserCommand: @item
          (#
             onStatus::  (#  do true->value #);
             onSelect::  (#  do 'user command'->putLine #)
          #);
        open::  (#  do iUserCommand.new #)
     #);
   ffObserverType:< sifFragmentFormObserver
     (#
        onRefresh::<  (#  do 'user onRefresh'->putLine #);
        onFocusChanged::<  (#  do 'user onFocusChanged'->putLine #);
        onAstReplaced::<  (#  do 'user onAstReplaced'->putLine #);
        onAstReplacedSequence::< 
          (#  do 'user onAstReplacedSequence'->putLine #);
        onListElementInserted::< 
          (#  do 'user onListElmentInserted'->putLine #);
        onListElementsDeleted::< 
          (#  do 'user onListElementDeleted'->putLine #);
        onListElementsReplaced::< 
          (#  do 'user onListElementsReplaced'->putLine #)
     #);
   ffObserver: @ffObserverType;
   ifInWhile:
     (#
        fatherNode: ^astInterface.expanded;
        anAST: ^astInterface.ast;
        sonNo: @integer;
        aWhile: ^mylangCFL.while;
        theStatementList: ^mylangCFL.statementList;
        anIff: ^mylangCFL.iff;
        unexp: ^astinterface.unexpanded
     do
        'ifInWhile'->putLine;
        cs.node.father->fatherNode[];
        cs.node.sonNo->sonNo;
        (mylangCFL.while,frag[])->mylangCFL.newAST->aWhile[];
        (sonNo,aWhile[])->fatherNode.put;
        cs.node[]->anIff[];
        (mylangCFL.statementList,frag[])->mylangCFL.newAST->theStatementList[];
        (2,theStatementList[])->aWhile.put;
        (1,anIff[])->theStatementList.insert;
        aWhile.getCondition->unexp[];
        10 (* exp *) ->unexp.nonterminalSymbol;
        (true,anIff[],aWhile[])->astReplacedEvent;
        (true,(aWhile[],1,0,0))->focusChangedEvent
     #)
#)  

-- userOnOpenGroupeditor: Descriptor --
(# 
do fg[]->ugp.fgObserver.fg[]; ugp.fgObserver[]->fgSubjectHandler.attach
#)  

-- userGroupEditorPrivate: Descriptor --
(#
   fgObserverType:< sifFragmentGroupObserver
     (#
        onNameChanged::<  (#  do 'user onNameChanged'->putLine #);
        onFragmentInserted::<  (#  do 'user onFragmentInserted'->putLine #);
        onFragmentDeleted::<  (#  do 'user onFragmentDeleted'->putLine #);
        onPropertiesChanged::< 
          (#  do 'user onPropertiesChanged'->putLine #);
        onGroupSaved::<  (#  do 'user onGroupSaved'->putLine #);
        onGroupAutoSaved::<  (#  do 'user onGroupAutoSaved'->putLine #);
        onGroupChecked::<  (#  do 'user onGroupChecked'->putLine #);
        onGroupLocked::<  (#  do 'user onGroupLoced'->putLine #);
        onGroupUnlocked::<  (#  do 'user onGroupUnLocked'->putLine #);
        onBeforeGroupClose::<  (#  do 'user onBeforeGroupClose'->putLine #);
        onGroupClosed::<  (#  do 'user onGroupClosed'->putLine #);
        onRefresh::<  (#  do 'user onRefresh'->putLine #)
     #);
   fgObserver: @fgObserverType
#)  

-- userEditorenvPrivate: Descriptor --
(#
   global: @integer;
   mylangCFL: ^astInterface.mylang;
   userGrammarInit:
     (# 
     do
        &mps.mylang[]->mylangCFL[];
        ('~beta/grammars/mylang/mylang','mylang',screen[])
          ->mylangCFL.grammarInit
            (#
               MPSerror::  (#  do (failure,msg[])->stop #);
               noParserAvailable::  (#  do (failure,msg[])->stop #)
            #)
     #)
do 
#)  

-- usernotificationOnDoubleClick: Descriptor --
(#  do 'doubleClick'->putLine #)  

-- usernotificationOnPopUpButton: Descriptor --
(# 
do
   (if not cs.isUnexpanded then
       true->doneInInner;
       (1,pos,theSifTextEditor.contents[])->up.userPopupMenu.popUp
   if)
#)  

