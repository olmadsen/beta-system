ORIGIN '~beta/opengl/glut';
INCLUDE '~beta/sysutils/cstring';

-- LIB: Attributes --

GLUTSurface:
  (# windowID: @integer;
     reshape: reshapeFunc
       (#
       do (0, 0, w, h) -> glViewport;
          (w, h) -> onUpdateCooordinateSystem;
       #);
     display: displayFunc
       (#
       do onDisplay;
          glutSwapBuffers;
       #);
     run:
       (#
       do glutMainLoop;
       #);
     init:<
       (# argc: @integer;
          argv: @cstring;
          
       do 1 -> argc;
          'main'  -> argv.set;
          (@@argc, @@argv.charptr) -> glutInit;
          GLUT_RGBA %bor GLUT_DOUBLE -> glutInitDisplayMode;
          'main' -> glutCreateWindow -> windowID;
          (640, 480) -> glutReshapeWindow;
          display## -> glutDisplayFunc;
          reshape## -> glutReshapeFunc;
          INNER;
       #);
     onDisplay:<
       (#
       do INNER;
       #);
     onUpdateCooordinateSystem:<
       (# width, height: @integer;
       enter (width, height)
       do INNER;
       #);
  #);
