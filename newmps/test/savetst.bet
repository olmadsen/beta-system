ORIGIN '../astlevel';
INCLUDE '../betacfl';
INCLUDE '../grammarinit';
INCLUDE '~beta/persistentstore/persistentstore';

-- program: descriptor --
(#
   mps: ^astInterface;
   beta: ^astInterface.beta;
   
   group: ^astInterface.fragmentGroup;
   name: ^text;
   ps: @PersistentStore;
do &astInterface[] -> mps[];
   mps.astLevelInit;
   &MPS.beta[] -> beta[];
   ('~beta/grammars/beta/beta','beta',screen[]) -> beta.betagrammarInit
	   (#
		  MPSerror::
			(# do (failure,msg[])->stop #);
		  noParserAvailable:: 
			(# do (failure,msg[])->stop #)
	   #); 
   ps.init;
   'aststore' -> PS.create;
   (mps[], 'aststore') -> PS.put;
   
   'parse: ' -> puttext;
   getLine -> name[];
   (name[], screen[]) -> mps.top.open -> group[];
	
   (if group[] <> NONE then
      group.setupOrigin;
	  'origin: ' -> puttext;
	  (group.origin).fullname -> putline;
   else
   	  'failed to parse!' -> putline;
   if);
   
   PS.close;

#)

