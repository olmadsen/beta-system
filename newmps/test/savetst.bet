ORIGIN '../astlevel';
INCLUDE '../betacfl';
INCLUDE '../grammarinit';
INCLUDE '~beta/persistentstore/persistentstore';

-- program: descriptor --
(#
   mps: @astInterface;
   beta: @mps.beta;
   
   group: ^astInterface.fragmentGroup;
   name: ^text;
   ps: @PersistentStore;
do ps.init;
   'oranges' -> PS.create;
   mps.astLevelInit;
   ('~beta/grammars/beta/beta','beta',screen[]) -> beta.betagrammarInit
	   (#
		  MPSerror::
			(# do (failure,msg[])->stop #);
		  noParserAvailable:: 
			(# do (failure,msg[])->stop #)
	   #); 
   
   'parse: ' -> puttext;
   getLine -> name[];
   (name[], screen[]) -> mps.top.open -> group[];
	
   (if group[] <> NONE then
      group.setupOrigin;
	  'origin: ' -> puttext;
	  (group.origin).fullname -> putline;
	 
	  (group[], 'top') -> PS.put;
	  PS.checkPoint;
	  PS.close;
   else
   	  'failed to parse!' -> putline;
   if);

#)

