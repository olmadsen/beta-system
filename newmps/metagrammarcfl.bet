ORIGIN '~beta/newmps/astlevel';
LIB_DEF 'mpsmetagrammarcfl' '../lib';
--astInterfaceLib: attributes--

metagrammar: TreeLevel
  (# <<SLOT metagrammarAttributes:attributes>>;
     AGrammar: cons
       (# getGrammarName: getson1(# #);
          putGrammarName: putson1(# #);
          getOptionOp: getson2(# #);
          putOptionOp: putson2(# #);
          getProductionList: getson3(# #);
          putProductionList: putson3(# #);
          getAttributeOp: getson4(# #);
          putAttributeOp: putson4(# #);
          <<SLOT AGrammarAttributes:attributes>> 
       exit 1
       #);
     GrammarName: cons
       (# getNameDecl: getson1(# #);
          putNameDecl: putson1(# #);
       exit 2
       #);
     ProductionList: list
       (# soncat::< Prod;
       exit 3
       #);
     Prod: cons
       (# <<SLOT ProdAttributes:attributes>> #);
     LeftSide: cons
       (# getSynDeclName: getson1(# #);
          putSynDeclName: putson1(# #);
          theSuperValue: @integer;
          theAttributeSize: @integer;
          <<SLOT LeftSideAttributes:attributes>> 
       exit 5
       #);
     Alternation: Prod
       (# getLeftSide: getson1(# #);
          putLeftSide: putson1(# #);
          getSynCatList: getson2(# #);
          putSynCatList: putson2(# #);
       exit 6
       #);
     SynCatList: list
       (# soncat::< SynCat;
       exit 7
       #);
     Constructor: Prod
       (# getLeftSide: getson1(# #);
          putLeftSide: putson1(# #);
          getConsElemList: getson2(# #);
          putConsElemList: putson2(# #);
       exit 8
       #);
     ConsElemList: list
       (# soncat::< ConsElem;
       exit 9
       #);
     ConsElem: cons
       (# <<SLOT ConsElemAttributes:attributes>> #);
     TaggedSyn: ConsElem
       (# getTagName: getson1(# #);
          putTagName: putson1(# #);
          getSynName: getson2(# #);
          putSynName: putson2(# #);
          <<SLOT TaggedSynAttributes:attributes>> 
       exit 11
       #);
     SynCat: ConsElem
       (# getSynName: getson1(# #);
          putSynName: putson1(# #);
          <<SLOT SynCatAttributes:attributes>> 
       exit 12
       #);
     ErrorSpec: ConsElem
       (# exit 13 #);
     Lst: Prod
       (# #);
     ListOne: Lst
       (# getLeftSide: getson1(# #);
          putLeftSide: putson1(# #);
          getSynCat: getson2(# #);
          putSynCat: putson2(# #);
          getTermOp: getson3(# #);
          putTermOp: putson3(# #);
       exit 15
       #);
     ListZero: Lst
       (# getLeftSide: getson1(# #);
          putLeftSide: putson1(# #);
          getSynCat: getson2(# #);
          putSynCat: putson2(# #);
          getTermOp: getson3(# #);
          putTermOp: putson3(# #);
       exit 16
       #);
     Opt: Prod
       (# getLeftSide: getson1(# #);
          putLeftSide: putson1(# #);
          getSynCat: getson2(# #);
          putSynCat: putson2(# #);
       exit 18
       #);
     Dummy: Prod
       (# getLeftSide: getson1(# #);
          putLeftSide: putson1(# #);
          getSynCat: getson2(# #);
          putSynCat: putson2(# #);
       exit 19
       #);
     SynName: cons
       (# getNameAppl: getson1(# #);
          putNameAppl: putson1(# #);
          theDclRef: @integer;
          <<SLOT SynNameAttributes:attributes>> 
       exit 20
       #);
     TagName: cons
       (# getNameDecl: getson1(# #);
          putNameDecl: putson1(# #);
       exit 21
       #);
     SynDeclName: cons
       (# getNameDecl: getson1(# #);
          putNameDecl: putson1(# #);
       exit 22
       #);
     Term: ConsElem
       (# getString: getson1(# #);
          putString: putson1(# #);
          <<SLOT TermAttributes:attributes>> 
       exit 23
       #);
     OptionPart: cons
       (# getoptionList: getson1(# #);
          putoptionList: putson1(# #);
       exit 25
       #);
     optionList: list
       (# soncat::< optionElement;
       exit 26
       #);
     optionElement: cons
       (# getoptionName: getson1(# #);
          putoptionName: putson1(# #);
          getoptionSpecification: getson2(# #);
          putoptionSpecification: putson2(# #);
       exit 27
       #);
     optionSpecification: cons
       (# #);
     optionSpecLst: optionSpecification
       (# getoptionSpecList: getson1(# #);
          putoptionSpecList: putson1(# #);
       exit 29
       #);
     optionSpecList: list
       (# soncat::< singleOption;
       exit 30
       #);
     singleOption: optionSpecification
       (# #);
     optionName: singleOption
       (# getNameAppl: getson1(# #);
          putNameAppl: putson1(# #);
       exit 32
       #);
     optionConst: singleOption
       (# getConst: getson1(# #);
          putConst: putson1(# #);
       exit 33
       #);
     optionString: singleOption
       (# getString: getson1(# #);
          putString: putson1(# #);
       exit 34
       #);
     AttributePart: cons
       (# getattriblist: getson1(# #);
          putattriblist: putson1(# #);
       exit 36
       #);
     AttribList: list
       (# soncat::< Attrib;
       exit 37
       #);
     Attrib: cons
       (# getSynCat: getson1(# #);
          putSynCat: putson1(# #);
          getNoOfAttributes: getson2(# #);
          putNoOfAttributes: putson2(# #);
       exit 38
       #);
     NoOfAttributes: cons
       (# getconst: getson1(# #);
          putconst: putson1(# #);
       exit 39
       #);
     errorProd: Prod
       (# exit 40 #);
     optionError: singleOption
       (# exit 41 #);

     grammarIdentification::<
       (# do 'metagrammar' -> theGrammarName #);
     version::<
       (# do 5 -> value #);
     suffix::<
       (# do '.gram' -> theSuffix #);
     maxproductions::<
       (# do 41 -> value #);

     init::<
       (# <<SLOT InitBody:dopart>> #);
  #); 
--InitBody:dopart--
do
   1 -> kindArray[1]; 0 -> roomArray[1]; 4 -> sonArray[1]; 
   AGrammar## -> genRefArray[1]##;
   1 -> kindArray[2]; 0 -> roomArray[2]; 1 -> sonArray[2]; 
   GrammarName## -> genRefArray[2]##;
   1 -> kindArray[3]; 0 -> roomArray[3]; 0 -> sonArray[3]; 
   ProductionList## -> genRefArray[3]##;
   2 -> kindArray[4]; 2 -> roomArray[4]; 0 -> sonArray[4]; 
   unExpanded## -> genRefArray[4]##;
   1 -> kindArray[5]; 2 -> roomArray[5]; 1 -> sonArray[5]; 
   LeftSide## -> genRefArray[5]##;
   1 -> kindArray[6]; 0 -> roomArray[6]; 2 -> sonArray[6]; 
   Alternation## -> genRefArray[6]##;
   1 -> kindArray[7]; 0 -> roomArray[7]; 0 -> sonArray[7]; 
   SynCatList## -> genRefArray[7]##;
   1 -> kindArray[8]; 0 -> roomArray[8]; 2 -> sonArray[8]; 
   Constructor## -> genRefArray[8]##;
   1 -> kindArray[9]; 0 -> roomArray[9]; 0 -> sonArray[9]; 
   ConsElemList## -> genRefArray[9]##;
   2 -> kindArray[10]; 2 -> roomArray[10]; 0 -> sonArray[10]; 
   unExpanded## -> genRefArray[10]##;
   1 -> kindArray[11]; 0 -> roomArray[11]; 2 -> sonArray[11]; 
   TaggedSyn## -> genRefArray[11]##;
   1 -> kindArray[12]; 0 -> roomArray[12]; 1 -> sonArray[12]; 
   SynCat## -> genRefArray[12]##;
   1 -> kindArray[13]; 0 -> roomArray[13]; 0 -> sonArray[13]; 
   ErrorSpec## -> genRefArray[13]##;
   2 -> kindArray[14]; 2 -> roomArray[14]; 0 -> sonArray[14]; 
   unExpanded## -> genRefArray[14]##;
   1 -> kindArray[15]; 0 -> roomArray[15]; 3 -> sonArray[15]; 
   ListOne## -> genRefArray[15]##;
   1 -> kindArray[16]; 0 -> roomArray[16]; 3 -> sonArray[16]; 
   ListZero## -> genRefArray[16]##;
   3 -> kindArray[17]; 2 -> roomArray[17]; 0 -> sonArray[17]; 
   Optional## -> genRefArray[17]##;
   1 -> kindArray[18]; 0 -> roomArray[18]; 2 -> sonArray[18]; 
   Opt## -> genRefArray[18]##;
   1 -> kindArray[19]; 0 -> roomArray[19]; 2 -> sonArray[19]; 
   Dummy## -> genRefArray[19]##;
   1 -> kindArray[20]; 2 -> roomArray[20]; 1 -> sonArray[20]; 
   SynName## -> genRefArray[20]##;
   1 -> kindArray[21]; 0 -> roomArray[21]; 1 -> sonArray[21]; 
   TagName## -> genRefArray[21]##;
   1 -> kindArray[22]; 0 -> roomArray[22]; 1 -> sonArray[22]; 
   SynDeclName## -> genRefArray[22]##;
   1 -> kindArray[23]; 0 -> roomArray[23]; 1 -> sonArray[23]; 
   Term## -> genRefArray[23]##;
   3 -> kindArray[24]; 2 -> roomArray[24]; 0 -> sonArray[24]; 
   Optional## -> genRefArray[24]##;
   1 -> kindArray[25]; 0 -> roomArray[25]; 1 -> sonArray[25]; 
   OptionPart## -> genRefArray[25]##;
   1 -> kindArray[26]; 0 -> roomArray[26]; 0 -> sonArray[26]; 
   optionList## -> genRefArray[26]##;
   1 -> kindArray[27]; 0 -> roomArray[27]; 2 -> sonArray[27]; 
   optionElement## -> genRefArray[27]##;
   2 -> kindArray[28]; 2 -> roomArray[28]; 0 -> sonArray[28]; 
   unExpanded## -> genRefArray[28]##;
   1 -> kindArray[29]; 0 -> roomArray[29]; 1 -> sonArray[29]; 
   optionSpecLst## -> genRefArray[29]##;
   1 -> kindArray[30]; 0 -> roomArray[30]; 0 -> sonArray[30]; 
   optionSpecList## -> genRefArray[30]##;
   2 -> kindArray[31]; 2 -> roomArray[31]; 0 -> sonArray[31]; 
   unExpanded## -> genRefArray[31]##;
   1 -> kindArray[32]; 0 -> roomArray[32]; 1 -> sonArray[32]; 
   optionName## -> genRefArray[32]##;
   1 -> kindArray[33]; 0 -> roomArray[33]; 1 -> sonArray[33]; 
   optionConst## -> genRefArray[33]##;
   1 -> kindArray[34]; 0 -> roomArray[34]; 1 -> sonArray[34]; 
   optionString## -> genRefArray[34]##;
   3 -> kindArray[35]; 2 -> roomArray[35]; 0 -> sonArray[35]; 
   Optional## -> genRefArray[35]##;
   1 -> kindArray[36]; 0 -> roomArray[36]; 1 -> sonArray[36]; 
   AttributePart## -> genRefArray[36]##;
   1 -> kindArray[37]; 0 -> roomArray[37]; 0 -> sonArray[37]; 
   AttribList## -> genRefArray[37]##;
   1 -> kindArray[38]; 0 -> roomArray[38]; 2 -> sonArray[38]; 
   Attrib## -> genRefArray[38]##;
   1 -> kindArray[39]; 0 -> roomArray[39]; 1 -> sonArray[39]; 
   NoOfAttributes## -> genRefArray[39]##;
   1 -> kindArray[40]; 0 -> roomArray[40]; 1 -> sonArray[40]; 
   errorProd## -> genRefArray[40]##;
   1 -> kindArray[41]; 0 -> roomArray[41]; 1 -> sonArray[41]; 
   optionError## -> genRefArray[41]##;
