ORIGIN '~beta/basiclib/v1.6/basicsystemenv';
INCLUDE 'coroutinespawner';
INCLUDE 'sleepshort';


--- systemlib:attributes ---

systemenvspawner: coroutinespawner
  (# shortsleep: @shortsleeper;
     spawnimpl::
       (# s: @|system (# do thespawn #);
       do s[]->fork;
       #);
     pause:: (# do systemenvpause #);
     sleep:: (# do ticks->shortsleep.sleep #);
     kill:: (# do systemenvkill #);
     semaphore::
       (# sem: @systemenvsemaphore;
          V:: (# do sem.V #);
          P:: (# do sem.P #);
       #);
     init:
       (# 
       do shortsleep.init;
       #);
  #);

systemenvpause: (# do pause #);
systemenvsleep: (# enter sleep #);
systemenvkill: (# do theActive[]->kill #);
systemenvsemaphore: semaphore (# #);


   
