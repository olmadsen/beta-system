psbrowser README: Created January 5, 1995 by S|ren Brandt
=========================================================

Revised February 22, 1996 (sbrandt), and August 27, 1996 (jlk)

This README describes the functionality of the psbrowser; an object
browser able to browse the objects in persistent object stores. Apart
from describing the psbrowser functionality, the most important demand
on this README was that it be written in a minimal amount of
time. Please accept this fact when reading the text below.

Using the psbrowser executable:
===============================

The psbrowser is an application built on top of the BETA objectbrowser
library (~beta/objectbrowser/v2.1). Thus, most of the interface
described below is actually that of a standard objectbrowser built on
top of that library.

The psbrowser is specialized to browse objects found in a persistent
store (~beta/persistentstore/v1.5). As opposed to previous versions of
the browser, this version is able to browse objects whose code is not
linked into the browser executable. This is done by interpreting the
saved format of the objects without actually instantiating these
objects in the browser process. It is a very minor task to create a
version of this browser able to browse the objects of an
oodb. However, this has not been done.

It is not possible to browse stores created on architectures with an
endian different from that of the machine runnning the psbrowser
(e.g. between Intel on the one hand and either Motorola, HP-PA,
SGI-MIPS or SPARC on the other hand).

However, it is a requirement that the persistent store is created,
using the socalled 'full name patch'.  You enable this patch by
including:

	INCLUDE '~beta/objectbrowser/v2.1/psbrowser/psfullnamepatch';

in the program generating the persistent store, and execute:

   	persistentstore_fullnamepatch;

_before_ the persistent store is created (see e.g. demo/gb.bet for an
example).  See the section "Full Name Patch" later for more details on
this patch.

Installing and executing the psbrowser:
=======================================

The psbrowser is a standalone executable that may be executed
by typing "psbrowser" at the command prompt. A "psbrowser" script has been 
created in "~beta/bin". The current (prototype) version of the psbrowser 
does not accept any command-line parameters.

The executable can be found in 
 
    ~beta/objectbrowser/v2.1/psbrowser/($MACHINETYPE)psbrowser

BITMAPS: A number of icons are used by the psbrowser. These icons are 
loaded from X11 bitmap (.xbm) files located in the ~beta/bitmap directory. 
Thus, when running psbrowser, the directory ($BETALIB)/bitmap should exist 
and must contain the files 'PersistentStoreIcon.xbm' and 'ObjectViewIcon.xbm'.

Having launched the psbrowser, your next move is to open a persistent store.
Do so by selecting "Open..." from the "File" menu. In the resulting dialog, 
enter the name of the persistent store and click the "Ok" button. A nested 
rootlist listing the names of the persistent roots will appear. The name of 
the rootlist window corresponds to the name of the persistent store. It is
allowed to open multiple persistent stores at a time.

To open a window showing a persistent root object, double-click the name
of that root in the rootlist. An ObjectView showing the root object will
appear.

Demo programs:
==============

In the demo directory, you will find the example programs "gb.bet" and
"daimi.bet". These programs may be used to generate an example
persistent store named "Enterprise". Run gb followed by daimi to
create the store.

Objectbrowser interface:
========================

The remaining part of this README describes the generic objectbrowser
interface. Large parts of this interface is shared with the valhalla
debugger, and with the embeddable version of the objectbrowser. The
latter version is able to browse the objects living inside the
application process itself. See

     '~beta/objectbrowser/v2.1/windowedbrowser'
 and 
     '~beta/objectbrowser/v2.1/demo/browser' 

for the toplevel interface and an example application of the embeddable 
browser.

Generic Window layout:
======================

Views are nested inside the browser main window. Each view has a header 
consisting of an iconify button, a name field and a resize button. 

Clicking the name field puts the view on top of all other views. Clicking
and dragging the name field moves the view around.

Each view has an associated menu that is popped up by clicking the right
mouse-button in the name field of the view. The contents of that menu 
depends on whether the view is the rootlist or an object view. However,
in both cases the menu contains "close" and "iconify". "close" closes the
view. "iconify" iconifies the view. An icon is reopened by double-clicking 
or by selecting "Deiconify" in the menu popped up by clicking the right
mouse-button on the icon.

By pressing the iconify button in the upper left corner, the view is 
iconified. This corresponds to selecting "iconify" in the name field
popup menu.

The view may be resized by placing the mouse cursor on the border of the
view (the cursor changes to a cross), and then click-and-drag to resize.

Browsing objects:
=================

The object browser uses abstract presentation of the objects presented. This
means that nested partobjects are initially shown contracted, i.e. as three
dots. By double-clicking a line of the object view ending in '...', the
hidden details will be shown. By double-clicking the same line again, the
details are hidden.

Each line in the objectview corresponds to some attribute of the object.
Simple attributes (@Char, @Integer, ...) cannot be further detailed, whereas
other kinds of attributes can. Default when double-clicking some attribute
is as follows:

  1. Dynamic references: A new object view is opened on the referred object.
     If some view on that object is already open, visual feedback (wriggling
     and highligthing) will signal this fact. The same behaviour goes for 
     origin references as well. However, origin references are by default
     invisible.

  2. Static references: If the attribute is contracted, double-clicking
     shows an extra level of detail in the same window. Otherwise the 
     attribute is contracted.

  3. Repetition references: If the repetition is contracted, double-clicking
     unfolds the repetition by showing a line for each index in the 
     repetition. Otherwise the repetition is contracted.

  4. Pattern references: Currently a more detailed view on pattern references
     is not implemented.

ObjectView menu's:
==================

In addition to the menu items described above, an ObjectView has a number of
additional items in the name field popup menu, i.e. the menu popped up by
clicking the right mouse-button in the name field of an ObjectView. 
These are described in turn below:

  1. Fit to contents: Tries to resize the ObjectView to a reasonable size.

  2. Show attribute: This nested menu is a list of object attributes that 
     are not currently visible. By default this list includes the origin 
     attributes. By selecting an entry in this menu, the corresponding 
     attribute is made visible. It may later be re-hidden as explained below.

  3. Fast Browse Mode: Default when double-clicking dynamic references is to 
     open a new ObjectView showing the object referred. By selecting 
     "Fast Browse Mode", the default is changed into showing the object 
     referred in the same window, replacing the previous contents. This 
     allows for fast browsing without opening unnecessary ObjectViews.
     Default may be reset by choosing "Fast Browse Mode" again.

  4. Go Back: The browser maintains a stack of objects visited during 
     Fast Browse Mode. By selecting "Go Back", the previous object on
     that stack in reshown in the current window.

When clicking the right mouse-button inside an ObjectView, a sligthly
different menu than the name field menu pops up. The entries of this
menu, the "ObjectState menu" are as follows:

   1. Open Separate: Default when double-clicking static references is
      to detail the corresponding attribute in the current window. 
      Alternatively one may single-click the static attribute and then
      select "Open Separate". This opens a new ObjectView on the part
      object.

   2. Open inline: If a static reference attribute is double-clicked in order
      to detail the view, and another ObjectView on that part object is already
      open, the existing ObjectView is highlighted, and the attribute *not*
      detailed. If one wants to detail in the current window anyway, one may
      either close the existing ObjectView, or single-click to select the 
      attribute and then choose "Open inline" from the ObjectState popup menu.

   3. Contract attribute: Has the same effect as double-clicking a complex
      attribute that is already detailed. I.e., the attribute is contracted.

   4. Hide Attribute: By single-clicking an attribute in the ObjectView and
      then selecting "Hide Attribute", the attribute is hidden. Note that
      "contracted" and "hidden" is not the same thing. Contraction replaces
      a complex attribute by a single line ending with '...'. Hiding an 
      attribute means moving it completely out of sight.

   5. Show Attribute: This entry corresponds to the menu entry with the same 
      name in the name field popup menu. However, instead of showing a list of
      hidden attributes for the main object, a list of attributes hidden
      in the currently selected complex attribute is shown. I.e., to 
      show a hidden attribute of a nested part object, single-click that
      part-object and then choose "Show Attribute" from the ObjectState
      popup menu.

Closing multiple views:
=======================

By dragging a rectangle in the part of the browser window containing the 
ObjectViews and then choosing "Close" in the "Edit" menu of the browser
main window (Shortcut: Ctrl-W), a number of views may be closed in a single 
operation. If a rootlist is closed, the persistent store itself and all 
ObjectViews showing objects from that store are closed along.

Bugs and inconveniences:
========================

Bugs due to guienv:

  - When a complex attribute has been detailed, the scrolllist implementing
    the view enters an "auto-scroll" mode. Click some attribute to switch
    off this mode.


Full Name Patch:
================

In order for the psbrowser to be able to browse a persistent
store, the group names saved in the persistent store must
use the full path names.

However, to make it easier to move persistent stores between
different file systems, default in persistentstore/v1.5 is to 
use group names that have been stripped for path information.

A program may change this default by calling persistentstore_fullnamepatch
before accessing it's first persistent store. 

BEWARE that all programs accessing a given persistent store
should either use persistentstore_fullnamepatch or not 
use persistentstore_fullnamepatch.

A persistent store created by a program using persistentstore_fullnamepatch
will not work in a program that does not. And vice versa.
