ORIGIN '../options';
INCLUDE '~beta/containers/v1.4/hashTable';

--- optionDBsetBooleanOption:dopart ---
do name.makeUC;
   (# elm: ^optionDBprivate.booloptions.element;
   do
      (if (name[]->optionDBprivate.booloptions.lookup->elm[]) <> NONE then
          value->elm.value;
       else
          (name[],value)->optionDBprivate.booloptions.put;
      if);
   #)
   
--- optionDBgetBooleanOption:dopart ---
do name.makeUC;
   (# elm: ^optionDBprivate.booloptions.element;
   do
      (if (name[]->optionDBprivate.booloptions.lookup->elm[]) <> NONE then
          elm.value->found;
       else
          notfound;
      if);
   #)
   
--- optionDBsetTextOption:dopart ---
do
   
--- optionDBgetTextOption:dopart ---
do
   
--- optionDBsetIntegerOption:dopart ---
do
   
--- optionDBgetIntegerOption:dopart ---
do
   
--- optionDBinit:dopart ---
do optionDBprivate.booloptions.init;
   
--- optionDBprivate: descriptor ---
(# TextHashTable: hashTable
     (# element::< (# name: ^Text #);
        hashfunction:: (# do e.name.scanAll (# do ch*26+value -> value #)#);
        lookup:
          (# e: @element;
          enter e.name[]
          exit e[]->hashfunction->findIndexed
             (# predicate:: (# do e.name[]->current.name.equal->value #)
             #)
          #);
        put:<
          (# new: ^element; name: ^Text;
          enter name[]   
          do &element[]->new[];
             name[]->new.name[];
             INNER;
             new[]->insert
          #);
     #);
   
   booloptions: @TextHashTable 
     (# element:: (# value: @Boolean #);
        put::
          (# value: @Boolean;
          enter value
          do value->new.value
          #);
     #);
   
#)
   
