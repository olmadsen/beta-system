ORIGIN 'mpsinterface';
(* Nedenstaaende er stjaalet fra ~beta/editor/v5.0.1/cv.bet med passende
 * rettelser. Operationen tilbydes vel paa et tidspunkt som et
 * standard interface af Elmer (?) *)
-- mpsinterfacelib: Attributes --
betaGrammarInit:
  (#
     theMetaGrammar: ^AST.treelevel;
     grammarWithPath,help: ^text;
     gg: ^AST.fragmentGroup;
     bobsfile: @file
  do
     &AST.metaGrammar[]->theMetaGrammar[]->AST.grammarTable.meta[];
     theMetaGrammar.init;
     '~beta/grammars/metagram/v4.4/metagrammar'->grammarWithPath[];
     (grammarWithPath[],screen[])->AST.top.open->gg[];
     (if gg[]
      // none then
         'Could not open: '->screen.putText;
         grammarWithPath[]->putLine;
         (failure,'')->stop;
         
     if);
     ('meta',screen[])->gg.open->gg[];
     (if gg[]
      // none then
         'Could not open: '->screen.putText;
         '-meta'->(grammarWithPath.copy).Append->screen.putLine;
         (failure,'')->stop;
         
      else
         ('metagrammar',screen[])->gg.open->theMetaGrammar.grammarAst[];
         (if theMetaGrammar.grammarAst[]
          // none then
             'No grammarAst for '->screen.putText;
             grammarWithPath[]->screen.putLine;
             (failure,'')->stop;
             
         if);
         
     if);
     '~beta/grammars/beta/v2.4/beta'->grammarWithPath[];
     (grammarWithPath[],screen[])->AST.top.open->gg[];
     (if gg[]
      // none then
         'Could not open: '->screen.putText;
         grammarWithPath[]->putLine;
         (failure,'')->stop;
         
     if);
     ('meta',screen[])->gg.open->gg[];
     (if gg[]
      // none then
         'Could not open: '->screen.putText;
         '-meta'->(grammarWithPath.copy).Append->screen.putLine;
         (failure,'')->stop;
         
      else
         ('beta',screen[])->gg.open->BETACFL.grammarAst[];
         (if BETACFL.grammarAst[]
          // none then
             'No grammarAst for '->screen.putText;
             grammarWithPath[]->screen.putLine;
             (failure,'')->stop;
             
         if);
         
     if);
     
  #);
  

