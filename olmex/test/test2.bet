ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'test3';
---program:descriptor---
(#
do
#)
---lib:attributes---
foo:
  (# bar: @
       (# snorf: @ 
            (# X: @integer;
               R:  ^foo;
               run: (# do 'A'->put #)
            #)
       #)
  #);
remoteEx:
  (# RRR: @foo; S:  ^foo;
  do 17 -> RRR.bar.snorf.X;
     RRR.bar.snorf.run;
     none -> RRR.bar.snorf.R[];
     RRR.bar.snorf.R[] -> S[]
  #);
StrucRefEx:
  (# P: ##foo; B: @Boolean
  do foo## -> P##
     foo## = p## -> B;
  #);
BreakExX:
  (# V: @integer;     
     LccPtn: 
       (# i: @integer 
       do 'Y' -> put;
          (if (i + 1 -> i) > 2 then 
              '!'-> put; 
              leave LccPtn; 
              '+'->put
           else
              'Y' + i -> put;
              restart LccPtn
          if);
          '?'->put;
       #);
     i: @integer 
  do 'S' -> put;
     L:
       (if V = 'T' then
           'U' -> V;
           leave L
        else
           'T' -> put;
           'T' -> V;
           restart L
       if);
     V -> put; (* 'U' *)
     Lzzz:
       (#
       do 'V' -> put;
          (if V = 'U' then
              (#
              do 'W'->put;
               leave Lzzz
       #)if)#);
     'X'->put;
     '<'->put;
     LccPtn;
     '>'->put;
     LccLab: 
       (#
       do 'y' -> put;
          (if (i + 1 -> i) > 2 then 
              '!'-> put; 
              leave LccLab; 
              '+'->put
           else
              'y' + i -> put;
              restart LccLab
          if);
          '?'->put;
       #);
     'Q'->put;
     CycleLab: cycle
       (# n: @integer 
       do (if (n + 1 -> n) > 4 then 
              '%'->put;
              leave CycleLab 
           else
              'a' + n - 1 -> put 
          if);
          '/'->put
       #)
  #);
BreakEx:
  (# BreakPTN:
       (# i: @integer
       do V -> put;
          (if (i + 1 -> i) > 3 then
              'n' -> V -> put;
              leave BreakPtn
           else
              'j' + i -> V;
              restart BreakPTN
          if)
       #);
     V: @char
  do 'a'-> put;
     L1: 
       (if V = 'c' then
           leave L1
        else
           'b' -> V;
           V -> put;
           'c' -> V;
           restart L1
       if);
     V -> put; (* 'c' *)
     'd' -> V;
     L2: 
       (#
       do V -> put;
          (if V = 'e' then
              'f' -> V;
              leave L2
           else
              'e' -> V;
              restart L2
       if)#);
     V -> put; (* 'f' *)
     L3:
       cycle
       (# n: @integer
       do (if (n + 1 -> n) > 3 then
              leave L3
           else
              'f' + n  -> put; (* 'g' - 'i' *)
       if)#);
     'j' -> V;
     BreakPtn;
  #)
