Changes log for ~beta/mps (The Metaprogramming System)
======================================================

===============================================================================
		Changes since v4.9
===============================================================================

Changed the definition of fg.isRealOpen to handle all possible
situations, where the fg is either not opened, og not real opened
(semi-open).

Corrected error in catching errors in top.open.

Corrected version number i ygdrasilVersion

Updated to basiclib/v1.5.

===============================================================================
		Changes since v4.8
===============================================================================

This release have mostly been modified to fix bugs and raise the efficiency of
the MPS operations.

astlevel.bet
============

One new operation have been added: namedClose.  namedClose can be used to close
a fragment, even in the case where you do not have any BETA reference to the
framgent but only know the name of the fragment.

The operation: indexToNode have been augmented with three exception patterns:
grammarGenArrayError, noSymbol and indexOutOfRange.  These exceptions are
raised in responce to the various errors taht can arise when trying to convert
an ast index to an ast reference.

Three net attributes have been added: astFileExtension, ppFileExtension, and
parserFileExtension.  These operations return the file name extensions to be
expected for the three different file types.

===============================================================================
		Changes since v4.7
===============================================================================

astlevel.bet
============

All scanning operations in astlevel (scan, suffixwalk, etc.) have been changed
to conform to the standard naming convention for scanning operations, namely
that the current element during the scan is called 'current'.  In the pre-v4.8
versions of mps, these variables were called thisElm, thisFragment, thisGroup,
or similar.

A virtual: astOverflow is introduced in ast.copy.  It is invoked if the
internal representation of the AST overflow's.

A new attribute: isOpen is introduced in the fragment pattern.  It returns
true, if the fragment have been opened (and not closed yet).

A new attribute: alreadyOpen is introduced in the fragmentGroup pattern.  It
returns true if the local fragment is already open in this fragment group.

A test for empty localPath is inserted in fragmentGroup.open to avoid errors
later in the processing of fragmentGroup.open.

Fragment.bind is changed such that it automatically tryes to setupOrigin, if
origin is not set previous to the invocation of bind, and the fragment is not
found in this fragment.

FragmentGroup.setupOrigin have been moved up the inheritance hierarchy to
fragment.setupOrigin.

In fragmentGroup.open, it is ensured, that parsing is not done when the file
name contain the grammar file-extension (e.g. .bet for BETA source files such
as xx.bet) - except naturally is the .group-file is older that the source file.

In fragmentGroup.fragmentList.open, it is ensured that the name of
fragmentforms is checked non-case-sensitible.

In fragmentGroup.fragmentList.open, the diskRepresentation is now checked, if
the fragment have been closed since last open.  This is done in order to ensure
that changes made by other tools are reflected now.

In general, many places in the files, tests for read or write access have been
inserted to ensure that no runtime errors should occur due to access problems
to files and directories.

In fragmentForm.indexToNode several runtime test have been inserted to avoid
'nasty' runtime errors due to invalid index'es.

treelevel.init now initializes the genRefArray structure such that 'nasty'
errors does not later occur in indexToNode.

defaultGrammarFinder is a new attribute of astIntergace.  It is a virtual
defining the defauld grammar finder installed during initialization of
astInterface.  Further binding this virtual will install your preferred grammar
finder.

GrammarMissing have been augmented with a few attributes to allow for
registrering grammars and for getting access to the fragmentForm containing the
registered grammars.  Registrering of grammars is now automated through
astLevelInit.

The two changes above imply, that you use one of three possible ways to install
grammars:
	(1) create MPS using:
		ast: @astInterface(# defaultGrammarFinder::< findgrammar #)
	    This is the preferred method for v4.8 and later of MPS.
	(2) or the equivalent:
		astInterface
		  (# defaultGrammarFinder::< findgrammar
                  ...
                  #)
	(3) create MPS the 'old' way:
		ast: @astInterface;
	   and then later install your grammarFinder:
		&findgrammar[]->grammarMissing[];
	   and then register the grammars explicitly:
		grammarMissing.registerGrammars;
	   This is available for 'backward compability' with pre-v4.8 usages of
	   MPS.

An options mechanism have been introduced to control the various workings of
MPS.  Currently only one option is defined (more may be added in the futures).
The optione mechanism is in the form of a new attribute: options, on the
astInterface pattern.  Herein one optin is currently defined: forceParse.  If
	true->options.forceParse 
is executed, MPS will force parsing of all fragments being opened hereafter
(that is, fragments not already opened at that time).

findgrammar.bet
===============

notFound is turned into an exception, not a notification.

A new exception: noRegisteredGrammars is introduced to make it possible to
catch problems with no grammars registered.  If no grammars are registered, MPS
has no way to understand the files to be parsed or loaded.

Two new attriibutes are introduced: grammarsPATH and metaGrammarFile.
   grammarPATH is used to specify the location of the grammars files
(containing the list of valid grammars).  By default, this is initialized to
seek for grammars in current directory, ./.MBSgrammars, ~/.MBSgrammars, and the
standard configuration file from the Mjolner BETA System.
   metaGrammarFile is used to specify the location of the meta-grammar file
(containing the grammar definition grammar).

fragmentgroupparser.bet
=======================

The syntax of fragment groups have been relaxed slightly, since the surrounding
[[ and --]] are made optional, if the fragment group is the only group in the
fragment file.

property.bet
============

The interface to most operations in this fragment have been changed such that
the interface uses text-references instead of text-values.
