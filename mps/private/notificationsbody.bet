ORIGIN '../notifications';
LIB_ITEM 'mps';
INCLUDE 'astPrivate';
-- handleGetHandle: DoPart --
do &handleType[]->h[]; h[]->private.handles.append  

-- handleIgnoreHandle: DoPart --
do h[]->private.handles.at->private.handles.delete  

-- handleActivateHandle: DoPart --
do (if not (h[]->private.handles.has) then h[]->private.handles.append if)  

-- handleSignal: DoPart --
do
   start;
   private.handles.scan (* abstract superpattern *)
     (#
        where:: 
          (# 
          do
             THIS(signal).where and not ((fg[],ff[],node[])->current.ignore)
               ->value
          #);
        
     do current[]->THIS(signal).current[]; INNER signal
     #)  

-- fgPrivate: Descriptor --
(# groupSubject: @subject (# observerType:: fragmentGroupObserver #); 
#)  

-- notificationsFragmentGroupAttachObserver: DoPart --
do theObserver[]->private.groupSubject.attach;   

-- notificationsFragmentGroupDetachObserver: DoPart --
do theObserver[]->private.groupSubject.detach  

-- fragmentGroupSubjectNotify: DoPart --
do
   before;
   private.groupSubject.notify
     (#  do current[]->THIS(notify).current[]; INNER notify #);
   after  
   
-- fragmentGroupSubjectNotifyAs:DoPart --
do before;
   private.groupSubject.observers.scan
     (# 
	 do (if current## <= type## then
	 		current[]->THIS(notifyAs).current[];
			inner notifyAs;
	     if);
	 #);
   after;
   
-- ffPrivate: Descriptor --
(#
   fragSubject: @subject (# observerType:: fragmentFormObserver #);
#)  

-- notificationsFragmentFormAttachObserver: DoPart --
do o[] -> private.fragSubject.attach;

-- notificationsFragmentFormDetachObserver: DoPart --
do o[]->private.fragSubject.detach  


-- fragmentFormSubjectNotify: DoPart --
do
   before;
   private.fragSubject.notify
     (#  do current[]->THIS(notify).current[]; INNER notify #);
   after  


-- fragmentFormSubjectNotifyAs:DoPart --
do before;
   private.fragSubject.observers.scan
     (# 
	 do (if current## <= type## then
	 		current[]->THIS(notifyAs).current[];
			inner notifyAs;
	     if);
	 #);
   after;
