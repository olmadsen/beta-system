ORIGIN '~beta/basiclib/systemenv';
INCLUDE '~beta/process/processmanager';
--PROGRAM: descriptor--

(* This program demonstrates how to kill a process that you have started.
 * To run it, you must also compile 'waitforkill'.
 *)

systemenv
(# child: @Process;
do 'waitforkill' -> child.init;
   'killchild: Starting waitforkill' -> putLine;
   child.start;
   3 -> sleep;
   (if child.stillRunning then
   'killchild: waitforkill is still running, killing it...' -> putLine;
       child.stop;
       L:(if child.stillRunning then
             'killchild: waitforkill is still running' -> screen.putLine;
             0.1 -> sleep;
             restart L
         if);
    else
       'killchild: waitforkill died before my kill.' -> putLine;
   if);
   child.awaitStopped; (* To prevent it from becoming zombie *)
   'killchild: done.' -> putLine;
#)
