ORIGIN '~beta/process/activate';
--- program:descriptor ---
systemEnv
(# first, other: ^Text;
   (*
    * The examples here fail rather inelegantly if the programs called
    * don't exist.
    * 
    * You must C-compile reader.c and slowwriter.c before running this demo.
    *)
do 'This will not work if you do not have . in your path!' -> screen.putline;
   'output of "slowwriter":'->screen.putLine;
   ('slowwriter', '-') -> execReadText -> first[];
   'heres the output' -> putline;
   first[]->screen.putText;
   'there it was' -> putline;

   'output of "slowwriter -s":'->screen.putLine;
   ('slowwriter', '-s') -> execReadText -> first[];
   'heres the output' -> putline;
   first[]->screen.putText;
   'there it was' -> putline;
   
   'output of "slowwriter -n":'->screen.putLine;
   ('slowwriter', '-n') -> execReadText -> first[];
   'heres the output' -> putline;
   first[]->screen.putText;
   'there it was' -> putline;

   'output of "slowwriter -e" goes direct to screen:'->screen.putLine;
   ('slowwriter', '-e') -> execReadText -> first[];
   'heres the output' -> putline;
   first[]->screen.putText;
   'there it was' -> putline;

   'output of "slowwriter -e" lets pick it up:'->screen.putLine;
   ('slowwriter', '-e') -> execReadErrText -> first[];
   'heres the output' -> putline;
   first[]->screen.putText;
   'there it was' -> putline;

   'output of "slowwriter -b" lets pick up both stdout and stderr:'->screen.putLine;
   ('slowwriter', '-b') -> execReadBothText -> first[];
   'heres the output' -> putline;
   first[]->screen.putText;
   'there it was' -> putline;

   'Now lets let slowwriter write to a file:'->screen.putline;
   ('slowwriter', '-', 'slowwriter.out') -> execWriteFile;

   'Now lets read that back through reader:'->screen.putline;
   ('reader', '-', 'slowwriter.out') -> execReadTextAndPipeFileIn -> first[];
   'heres the output' -> putline;
   first[]->screen.putText;
   'there it was' -> putline;
   
   'Writing this output to reader, NOT reading the output:'->screen.putLine;
   ('reader', '-') -> execWrite
   (# 
   do first[]->input.putText;
   #);

   'Writing this output to reader -w, NOT reading the output:'->screen.putLine;
   ('reader', '-w') -> execWrite
   (# 
   do first[]->input.putText;
   #);

   'Writing this output to reader, reading the output:'->screen.putLine;
   ('reader', '-', first[]) -> execReadWriteText -> screen.putLine;
   'done.'->screen.putLine;
   
   screen.newLine;
#)
