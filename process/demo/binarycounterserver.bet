ORIGIN '~beta/basiclib/v1.6/systemenv';
INCLUDE '~beta/process/v1.6/binarygenerator';

--- program:descriptor ---
systemEnv
(# 
   counter: IntegerObject
     (# 
     do value+1 -> value
     #);
   
   port: (# exit 7899 #);
   
   binaryGen: @SocketGenerator;
   clientSock: ^BinarySocket;
   aCounter: @counter;
   
   
do port -> binaryGen.bind;   (* The port chosen for this service. *)
   cycle
   (# 
   do waitForever -> binaryGen.getBinaryConnection -> clientSock[];
      (waitForever, aCounter) -> clientSock.putInt;
      clientSock.close;
   #);
   binaryGen.close;
#)
   
   
