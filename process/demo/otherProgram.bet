ORIGIN '~beta/basiclib/systemenv';
INCLUDE '~beta/process/processmanager';
INCLUDE '~beta/process/streamsocket';

--- program:descriptor ---
systemEnv
(#	
   outSocket: @StreamSocket;
   aText: ^Text;
   no: @Integer;
do 'OtherProgram: launched' -> putline;
   5123 -> outSocket.port;
   'localhost' -> outSocket.host;
   doConnect: outSocket.connect
     (# error::< 
          (#
          do no+1->no; '.' -> screen.put;
             (if no<=10 then restart doConnect if);
          #);
     #);
   'otherProgram: connection established' -> putline;
   outSocket.GetLine->aText[]; (* get a text via the socket *)
   'otherProgram received: ' -> screen.puttext;
   aText[] -> screen.putline;
   outSocket.close;	(* close down the socket *)
#)
