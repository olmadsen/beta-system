ORIGIN '~beta/basiclib/v1.6/systemenv';
INCLUDE '~beta/process/v1.6/commpipe';
INCLUDE '~beta/process/v1.6/processmanager';
--- program:descriptor ---
systemEnv
(# 
   execRead:
     (# name, args: ^text;
        output: ^stream;
        child: @process;
        channel: @pipe;
     enter (name[], args[])
     do
        (* initialize (an object to manage) the child process *)
        name[] -> child.init;
        args[] -> child.argument.append; 

        (* setup communication channel to retrieve output from child *)
        channel.init;
        channel.writeEnd[] -> child.redirectToChannel;
        channel.readEnd[] -> output[];
   
        (* run the child process *)
        child.start;
   
        INNER;
        channel.readEnd.close;
     #);
do 
   ('/bin/ls','-la') ->
   execRead
   (# 
   do loop:
        (# 
        do (if not output.eos then
               output.getline -> screen.putline; 
               restart loop
           if);
        #);
   #);
#)
