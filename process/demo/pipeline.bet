ORIGIN '~beta/basiclib/systemenv';
INCLUDE '~beta/process/processmanager';

--- program:descriptor ---
systemEnv
(#
   producer: @process;
   consumer: @process;
do 
   'Creating producer' -> screen.putline;
   'producer' -> producer.init;
   'Creating consumer' -> screen.putline;
   'consumer' -> consumer.init;
   'Piping: producer | consumer' -> screen.putline;
   producer[] -> consumer.connectInPipe; 
   'items' -> producer.argument.putarg;
   'Starting \'producer items\'' -> screen.putline;
   producer.start;
   'Starting \'consumer\'' -> screen.putline;
   consumer.start;
   
   'Wait for \'consumer\' to complete' -> screen.putline;
   (* Do not stop THIS process until the consumer has consumed it all *)
   consumer.awaitStopped;
   'done.' -> screen.putline;
#)
