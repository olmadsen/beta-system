ORIGIN '~beta/basiclib/basicsystemenv';
LIB_DEF 'processpipe' '../lib';

(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics 1995-97
 *       All rights reserved.
 *)

MDBODY default  'private/commpipe_unix'
       ppcmac   'private/commpipe_mac'
       nti      'private/commpipe_nt'
       jvm      'private/commpipe_jvm'
       clr       'private/commpipe_clr';
INCLUDE 'private/sysFdStream';


--- systemlib:attributes ---
propagateException: (# msg: ^Text enter msg[] do INNER #);

pipe:
  (# <<SLOT pipelib:attributes>>;

     
     (* OPERATIONS *)
     init:<
       (# error:< propagateException
            (# do INNER; msg -> pipeError #);
       <<SLOT PipeInit:dopart>>
       #);
     
     close:< (# <<SLOT PipeClose:dopart>> #);
     
     pipeException: Exception
       (#
       enter msg
       do (if not msg.empty then msg.newline if);
          INNER;
       #);
     
     pipeError:< PipeException;

     
     (* ATTRIBUTES *)
     readEnd: ^fdStream;
     writeEnd: ^fdStream;

     private: @<<SLOT PipePrivate:descriptor>>;
#);
