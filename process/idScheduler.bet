ORIGIN '~beta/basiclib/v1.5/basicsystemenv';
BODY 'private/idSchedulerBody';

(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1994
 *       All rights reserved.
 *)

--- systemlib:attributes ---

idSchedElement:
  (#
     suspend_sem: @semaphore;
     id: @integer;
  #);

idScheduler:
  (#
     isElement:< idSchedElement;
     prefix:
       (# id: @integer;
          elm: ^isElement;
       enter id
       do INNER
       #);     

     (* operations *)
     init:<
       (#
       do <<SLOT idSchedulerInit:descriptor>>
       #);
     id_suspend: prefix
       (# dopart: @<<SLOT idSchedulerSuspend:descriptor>>;
       do dopart; INNER;
       #);
     id_resume: prefix
       (# found:< object;
          not_found:< object;
          dopart: @<<SLOT idSchedulerResume:descriptor>>;
       do dopart
       #);

     (* private *)
     private: @<<SLOT idSchedulerPrivate:descriptor>>
  #);

idTimeoutScheduler: idScheduler
  (#
     (* operations *)
     init::<
       (#
       do <<SLOT idTimeoutSchedulerInit:descriptor>>
       #);
     id_timeoutSuspend: prefix
       (# timeoutValue: @integer;
          retry:< BooleanValue;
          onSuccess:< object;
          onTimeout:< object;
          dopart: @<<SLOT idTimeoutSchedulerTOSuspend:descriptor>>;
       enter timeoutValue
       do dopart
       #);

     (* private *)
     private2: @<<SLOT idTimeoutSchedulerPrivate:descriptor>>;
  #);
