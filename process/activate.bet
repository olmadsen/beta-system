ORIGIN '~beta/basiclib/systemenv';
BODY 'private/activatebody';

(* activate.bet:
 *   Simple subprocess IO redirection abstractions, 
 *   using the basic methods available in Process.
 *   Works on both windows and Unix.
 *   See process/demo/activeDemo for examples of use.
 *)

--systemLib: attributes--

exec:
  (* Abstract superpattern for the patterns below. Do not use directly *)
  (# name: ^text (* Name/path of process to execute *);
     args: ^text (* Arguments to the process *);
  enter (name[], args[])
  do INNER
  #);

execReadAndPipeFileIn: exec
  (* Execute process "name" with arguments "args" with input
   * redirection from file "filename".
   * Standard output from "name" is delivered to the stream "output"
   *)
  (# output: ^stream;
     filename: ^Text;
  enter filename[]
  <<SLOT execReadAndPipeFileIn:dopart>>
  #);

execRead: exec
  (* 
   *   
   *)
  (# output: ^stream;
  <<SLOT execRead:dopart>>
  #);

execReadStderr: exec
  (* 
   *   
   *)
  (# output: ^stream;
  <<SLOT execReadStderr:dopart>>
  #);

execReadBoth: exec
  (* 
   *   
   *)
  (# output: ^stream;
  <<SLOT execReadBoth:dopart>>
  #);

execReadWrite: execRead
  (* 
   *   
   *)
  (# input: ^stream;
  <<SLOT execReadWrite:dopart>>
  #);

execWrite: exec
  (* 
   *   
   *)
  (# input: ^stream
  <<SLOT execWrite:dopart>>
  #);

execWriteFile: exec
  (* 
   *   
   *)
  (# filename: ^Text;
  enter filename[]
  <<SLOT execWriteFile:dopart>>
  #);

execReadText: exec
  (* 
   *   
   *)
  (# output: ^stream;
     T: ^Text;
  <<SLOT execReadText: dopart>>
  exit T[]
  #);

execReadTextAndPipeFileIn: exec
  (* 
   *   
   *)
  (# output: ^stream;
     filename: ^text;
     T: ^Text;
  enter filename[]
  <<SLOT execReadTextAndPipeFileIn: dopart>>
  exit T[]
  #);

execReadErrText: exec
  (* 
   *   
   *)
  (# output: ^stream;
     T: ^Text;
  <<SLOT execReadErrText: dopart>>
  exit T[]
  #);

execReadBothText: exec
  (* 
   *   
   *)
  (# output: ^stream;
     T: ^Text;
  <<SLOT execReadBothText: dopart>>
  exit T[]
  #);

execReadWriteText: Exec
  (* 
   *   
   *)
  (# input: ^stream;
     output: ^stream;
     T: ^Text;
  enter T[]
  <<SLOT execReadWriteText: dopart>>
  exit T[]
  #);
