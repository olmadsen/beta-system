ORIGIN '~beta/basiclib/systemenv';
INCLUDE '../smtpstream';
INCLUDE '~beta/basiclib/formatio';
--- program: descriptor ---
systemenv
(# smtp: @smtpstream; no,j: @integer; msg: ^text;
do 'daimi.au.dk'->smtp.server;
   
   '-----HELO result:'->screen.putline;
   'jlk.solmarkvej.dk'->smtp.hello->screen.putline;

   '-----VRFY result:'->screen.putline;
   'jlk'->smtp.verify->screen.putline;

   '-----EXPN result:'->screen.putline;
   'cavi'->smtp.expand(# do groupmember[]->screen.putline #);
   
   '-----HELP result:'->screen.putline;
   smtp.help->screen.puttext;
   
   '-----HELP VRFY result:'->screen.putline;
   'VRFY'->smtp.help->screen.putline;
   
   '-----NOOP:'->screen.putline;
   smtp.noop;
   
   '-----SEND FROM:'->screen.putline;
   '<jlk@daimi.au.dk>'->smtp.mail;
   '<jlk@mjolner.dk>'->smtp.recipient;
   
   'Subject: Test af SMTP protokol impl. i BETA\n'->msg[];
   msg.newline;
   'Hej alle,'->msg.putline;
   msg.newline;
   'Dette er en test mail, der (hvis det virker) er et eksempel'->msg.putline;
   'på, at mit lille hobby-projekt, nemlig at implementere et'->msg.putline;
   'interface til SMTP protokollen (i form af et smtpStream'->msg.putline;
   'pattern), nu virker !!!!'->msg.putline;
   msg.newline;
   'Jeg kan samtidigt sige, at jeg også har en fungerende NNTP'->msg.putline;
   'protokol i form af et nntpStream pattern'->msg.putline;
   msg.newline;
   'Denne besked er skabt i et BETA program, og sendt derfra via'->msg.putline;
   'denne smtpStream implementation'->msg.putline;
   msg.newline;
   '--- jlk'->msg.putline;
   
   msg[]->smtp.data;
   
   '-----QUIT:'->screen.putline;
   smtp.quit;
#)
