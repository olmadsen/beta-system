ORIGIN '~beta/basiclib/systemenv';
INCLUDE '~beta/process/protocols/smtpstream';
INCLUDE '~beta/basiclib/formatio';
--- program: descriptor ---
systemenv
(# smtp: @smtpstream; no,j: @integer; msg: ^text;
do 'server: '->screen.puttext;
   getline->smtp.server;
   
   '-----HELO result:'->screen.putline;
   'jlk.solmarkvej.dk'->smtp.hello->screen.putline;

   '-----VRFY result:'->screen.putline;
   'jlk'->smtp.verify->screen.putline;

   '-----EXPN result:'->screen.putline;
   'cavi'->smtp.expand(# do groupmember[]->screen.putline #);
   
   '-----HELP result:'->screen.putline;
   smtp.help->screen.puttext;
   
   '-----HELP VRFY result:'->screen.putline;
   'VRFY'->smtp.help->screen.putline;
   
   '-----NOOP:'->screen.putline;
   smtp.noop;
   
   '-----SEND FROM:'->screen.putline;
   '<jlk@mjolner.dk>'->smtp.mail;
   '<jlk@daimi.au.dk>'->smtp.recipient;
   
   'Subject: Test af SMTP protokol impl. i BETA\n'
   '\n'
   'Hej alle,\n'
   '\n'
   'Dette er en test mail, der (hvis det virker) er et eksempel\n'
   'på, at mit lille hobby-projekt, nemlig at implementere et\n'
   'interface til SMTP protokollen (i form af et smtpStream\n'
   'pattern), nu virker !!!!\n'
   '\n'
   'Jeg kan samtidigt sige, at jeg også har en fungerende NNTP\n'
   'protokol i form af et nntpStream pattern\n'
   '\n'
   'Denne besked er skabt i et BETA program, og sendt derfra via\n'
   'denne smtpStream implementation\n'
   '\n'
   '--- jlk\n'->msg[];
   
   msg[]->smtp.data;

   
   '-----QUIT:'->screen.putline;
   smtp.quit;
#)
