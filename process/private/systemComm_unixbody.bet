ORIGIN '../systemComm';
BODY 'pipe_unixbody'
     'ssocket_unixbody'
     'bsocket_unixbody'
     'sockgen_unixbody';
MAKE default 'external/sockets.make';

(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1992,93,94
 *       All rights reserved.
 *)

INCLUDE '~beta/sysutils/v1.5/iostate';
INCLUDE '~beta/basiclib/v1.5/timehandler';
INCLUDE 'socketsInt';

--- lib:attributes ---

(* 'rec_' for Returns Error Code are used to intercept 
 * exeception handling in fdStream (readChannel/writeChannel)
 * to set an error-code and return without aborting the
 * program. Then it's possible to handle the errors at this
 * level. The error codes are:
 *)
rec_noErr:      (# exit 0 #);
rec_accessErr:  (# exit 1 #);
rec_nospaceErr: (# exit 2 #);
rec_readErr:    (# exit 3 #);
rec_writeErr:   (# exit 4 #);
rec_eosErr:     (# exit 5 #);
rec_otherErr:   (# exit 6 #);

(* The number 127.0.0.1 by convention means 'this host'.
 * We have to intercept this IP number, because it makes no
 * sense to transmit it across the network. Thus, we need
 * this constant value to discover it. 
 *)
localHost_IP_number: (# exit 2130706433 #);

(* 'unexpected' aborts program with heavy message *)

unexpected_error: exception
  (#
  do
     'Unexpected error condition.\nPlease contact support@mjolner.dk\n'
       -> msg.append;
  #);
