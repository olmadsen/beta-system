ORIGIN '../processmanager';

(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1992-95
 *       All rights reserved.
 *)

MDBODY nti     'processmanager_nt'
       mac     'processmanager_mac'
       ppcmac  'processmanager_mac'
       default 'processmanager_unix';

--- lib:attributes ---

(* The arguments to a process are encoded into a text. The 
 * arguments are separated by "argDecodeSeparator" in the 
 * resulting text. 
 *)
argDecodeSeparator: (# exit 1 #);

--- putArg:dopart ---
do
   T[] -> argument.puttext;
   argDecodeSeparator -> argument.put;


--- ProcessScanArguments:dopart ---
do
   current.clear;
   argument.scanAll 
   (# 
   do (if ch//argDecodeSeparator then
          INNER ScanArguments;
          current.clear;
       else
          ch -> current.put;
      if);
   #);


--- ProcessInit:dopart ---
do
   argument.argument.clear;
   INNER;


--- ProcessStart:dopart ---
do
   (if stillRunning 
    // false then 
       <<SLOT ProcessStartMDBody:descriptor>>;
       onStart;
    // true then 'start: two current' -> twoCurrent;
   if);
   INNER;


--- ProcessStop:dopart ---
do
   <<SLOT ProcessStopMDBody:descriptor>>;
   wait: (if stillRunning // true then restart wait if);
   onStop;
   INNER;

   
--- ProcessManagerException:dopart ---
do	
   'ProcessManager exception. Error id: '-> msg.puttext;
   <<SLOT ProcessManagerExceptionMDBody:descriptor>>;
   msg.newline;
   message[] -> msg.puttext;
   INNER;
