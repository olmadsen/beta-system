ORIGIN '../json';

-- program: descriptor --
(# json: @JsonEnv;
   employee: @json.JsonMap;
   address: @json.JsonMap;
   employment1: @json.JsonMap;
   employment2: @json.JsonMap;
   employments: @json.JsonList;
   emails: @json.JsonList;
   email1: @json.JsonText;
   email2: @json.JsonText;
   input: ^Text;
   js: ^json.JsonObject;
do 
   ('firstName', 'Mike') -> employee.associateText;
   ('lastName', 'Lassen') ->employee.associateText;
   ('employeeNumber', 1345) -> employee.associateInteger;
   ('city', 'Copenhagen') -> address.associateText;
   ('street', 'Oxford Have') -> address.associateText;
   ('zip', NONE) -> address.associateText;
   ('address', address[]) -> employee.associate;
   ('department', 'IT') -> employment1.associateText;
   ('title', 'Developer') -> employment1.associateText;
   ('active', false) -> employment1.associateBoolean;
   employment1[] -> employments.append;
   ('department', 'HR') -> employment2.associateText;
   ('title', 'Consultant') -> employment2.associateText;
   ('active', true) -> employment2.associateBoolean;
   employment2[] -> employments.append;
   ('employements', employments[]) -> employee.associate;
   'mila.it@cbs.dk' -> emails.appendText;
   'mike.lassen@gmail.com' -> emails.appendText;
   ('emails', emails[]) -> employee.associate;
   employee[] -> json.toText -> input[];
   'Constructed: ' -> putLine;
   input[] -> putLine;
   newLine;

   
   input[] -> json.fromText -> js[];
   'Parsed: ' -> putLine;
   js[] -> json.toText -> putLine;
#)

