ORIGIN '../STL'
---program:descriptor---
(# L: @ List
     (# elm:: text;
        greater::
          (#
          do V[] -> W.greater -> value
          #)
     #);
   Marianne,Kirsten,Johanna,Lis: ^text;
   T: ^text;
   
   sort: 
     (# A: ^container; swapped: @boolean
     enter A[]
     do false -> swapped;
        ((A.begin).next,A.end) -> A.scan
        (#
        do (if ((currentIT.pred).val,current[]) -> A.greater then
               (currentIt.pred,currentIt[]) -> A.swap;
               True -> swapped
           if)
        #);
        (if swapped then restart sort if)
     #)
do 'Marianne' -> Marianne[] -> L.insert;
   'Kirsten' -> Kirsten[] -> L.insert;
   'Johanna' -> Johanna[] -> L.insert;
   'Lis' -> Lis[] -> L.insert;
   
   '*** Unsorted: ' -> putline;
   L.scan(#do current[] -> putline #);
   L[] -> sort;
   '\n*** Sorted: ' -> putline;
   L.scan(#do current[] -> putline #);
#)

