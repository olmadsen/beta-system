origin '~beta/mps/v5.2/astlevel'; 
include '../dependency';
include '../scanNonCompiled'
(************************************************
 * test program showing how to use 
 *      dependency.bet
 * to compute extent and doamin of a fragment.
 * Usage
 *       testdep                  computes extent abd domain for testdep
 *       testdep foo              computes extent and domain for foo
 *)
---program:descriptor---
(# AST: @ astinterface;
   D: @AST.dependencyGraph;
   FileName: ^text;
do AST.astLevelInit;
   (*(ast.trace.onParse,true)->ast.trace.set;
   (ast.trace.fragmentOpen,true)->ast.trace.set;
    (ast.trace.topOpen,true)->ast.trace.set;*)
   D.Init;
   'sun4s'->D.targetDirectory;
   'sun4s'->D.targetMachine;
   D.xverboselevel.actions -> D.xverboselevel;
   
   (if noOfArguments > 1 then
       2 -> arguments -> Filename[]
    else 'testdep'->Filename[]
   if);
   
   'Extent for : ' -> puttext; FileName[] -> putline;
   FileName[] -> D.scanExtent
   (# 
   do '\t in extent: '->puttext; current.fullname->putline 
   #);
   
   'Domain for : ' -> puttext; FileName[] -> putline;
   FileName[] -> D.scanDomain
   (# 
   do '\t in domain: '->puttext; current.fullname->putline
   #);
   
   'Noncompiled for : ' -> puttext; FileName[] -> putline;
   FileName[] -> D.scanNonCompiled
   (# translate:: 
        (#do '\t must be compiled: '->puttext; current.fullname->putline #)
   #);
#)
    
