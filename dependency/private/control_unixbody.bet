ORIGIN 'controlbody'
--- ControlMDInit: descriptor ---
(# do (*false->BinaryCodeGen *) #)

--getmodtimebody: descriptor --
(# statBuf: [20] @integer;
   permBuf: [9] @integer;
   entryStatus: External 
     (#
        (* The BETA version of stat.  This version is more portable than
         * using a BETA cStruc because this way, the definition of the C-struct
         * stat is not hardcoded into Beta but instead translated into a suitable
         * repetition of integers.
         *)
        path: [1]@char;
        statBuffer: @integer; 
        (* The start addr. of an int-rep of 20 integers denoting
         * the file status of the entry with path. 
         *)
        protectionBuffer: @integer; 
        (* The start address of an int-rep of 9 integers denoting
         * the protection bits of the entry with path.
         *) 
        follow: @boolean; (* Follow links ? *)
        status: @integer; (* -1 => error *)
     enter(path,statBuffer,protectionBuffer, follow)
     exit status
     #);
   f: @file;
do
   (if switch[393] then
       t[]->f.name;
       (if f.entry.exists  then f.entry.modTime->m else -1->m if);
    else
       (if ((t,@@statBuf[1],@@permBuf[1], true) -> entryStatus)<0
         then -1 -> m;
        else statbuf[17] -> m
       if)
   if);
#)
