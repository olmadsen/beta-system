ORIGIN 'diagramattributes';
-- NonTerminalDoubleClick: DescriptorForm --
(# t: @Text; dummy: ^text; dummyDetailPage: ^OADPage
do
(*  'Nonterminal doubleclick'->screen.putline;
 false->indicateSelection;
 (if switch[1] // true then 'NonterminalNode: doubleclick'->putline if);
 (if detailPage
 // none then [* make the decompose page *]
 (if gppProp.DetailedOnSamePage
 // false then
 &OADPage[]->detailPage;
 detailPage->dummyDetailPage[];
 dummyDetailPage.new;
 [* changes page automatically *]
 titleNode.theText.get->t;
 t->dummyDetailPage.PageTitle;
 else
 CurrentPage->detailPage;
 [* make detailPage the same page as
 * parentNode
 *]
 if)
 else
 detailPage->CurrentPage; [* just select the page *]
 if);
 (if currentDecomposDiagram
 // none then
 'creating PatternNonTerminalDiagram'->screen.putline;
 [*gppProp.DetailedStyle -> theText.style;*]
 [* make the diagram *]
 detailPage->dummyDetailPage[];
 &dummyDetailPage.PatternNonTerminalDiagram[]->currentDecomposDiagram;
 syncatname->dummy[];
 (unExp,dummy,Rectangle)->(currentDecomposDiagram).new;
 theFragmentNode->(currentDecomposDiagram).theFragmentNode;
 THIS(NonTerminalNode)[]->(currentDecomposDiagram).theParentNode;
 else
 [* Select and make the decomposition of this node visible *]
 (currentDecomposDiagram).titleNode[]->CurrentObject <<@1192:MainPart>>;
 if); *)
#)  

-- NonTerminalNodeInit: DescriptorForm --
(#
   x,y,w,h: @Integer;
   innerBox: ^IB;
   IB: RectNode
     (#
        onSelect::< 
          (#
          do
             THIS(NonTerminalNode)[]->currentobject;
             (if switch[1]
              // true then 'innerBox on select: changing selection'->putline;
             if)
          #);
     #);
do
   UDPrivate.UDNonTerminalNode->UserDataInit;
   unExp.Init;
   synCatName.Init;
   synCatno.Init;
   9->theText.size;
   (if not initialisingSaved then
       false->moveable;
       false->BorderVisible;
       titleNode[]->CreateRegion;
       &IB[]->innerBox[];
       geometry->(x,y,w,h);
       (x,y,w,h-4)->innerBox.new;
       1->innerBox.LineType;
       false->innerBox.moveable;
       false->innerBox.selectable;
       THIS(NonTerminalNode)[]->innerBox.createRegion
   if);
   (*ESS false -> sizeable;*)
   (* dashed *)
   (*ESS false -> innerBox.sizeable;*)
#)  

-- NonTerminalNodeDisplay: DescriptorForm --
(# help: ^Text
do
   (unExp).nonterminalSymbol->synCatNo;

   (unExp).index->astIndex;
   (if switch[1] then 
       'NonTerminalNodeDisplay: '->putText;
       astIndex->putInt; '->astIndex'->putLine
   if);
   synCatNo->betaGram.symbolToName->synCatName;
   (*map no to name*)
   (if switch[1]
    // true then
       'Display NonTerminal: '->screen.puttext;
       synCatNo->screen.putint;
       synCatName->screen.putline;
   if);
   '<<'->help[];
   synCatName->help.putText;
   '>>'->help.putText;
   help->t;
   (pos.x+(gppProp.width+1) div 2,pos.y+(gppProp.height+1) div 2,gppProp.width,
    gppProp.height,defaultshape)->new;
#)  

