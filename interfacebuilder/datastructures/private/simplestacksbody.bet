ORIGIN '../simplestacks';

-- intStackEmpty: doPart --
do storage.top = 0 -> value;

-- intStackTop: doPart --
do storage.data[storage.top] -> value;

-- intStackPush: doPart --
do (if storage.top = storage.data.range then
       storage.data.range -> storage.data.extend;
   if);
   storage.top + 1 -> storage.top;
   value -> storage.data[storage.top];

-- intStackPop: doPart --
do (if storage.top <> 0 then
       storage.top - 1 -> storage.top;
   if);

-- intStackStorage: descriptor --
(# top: @integer;
   data: [initialCapacity] @integer;
#)

-- boolStackEmpty: doPart --
do storage.top = 0 -> value;

-- boolStackTop: doPart --
do storage.data[storage.top] -> value;

-- boolStackPush: doPart --
do (if storage.top = storage.data.range then
       storage.data.range -> storage.data.extend;
   if);
   storage.top + 1 -> storage.top;
   value -> storage.data[storage.top];

-- boolStackPop: doPart --
do (if storage.top <> 0 then
       storage.top - 1 -> storage.top;
   if);

-- boolStackStorage: descriptor --
(# top: @integer;
   data: [initialCapacity] @boolean;
#)

