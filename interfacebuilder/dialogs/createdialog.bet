ORIGIN '~beta/guienv/v1.6/guienv';
INCLUDE '~beta/guienv/v1.6/controls';
INCLUDE 'textlist';

-- guienvLib: Attributes --
createDialog: window
  (#  run:
       (# defaultName: ^text;
          classes: ^textList;
          groups: ^textList;
       enter (defaultName[], classes[], groups[])
       do open;
          defaultName[] -> nameFld.contents;
          nameFld[] -> target;
          classes[] -> superOptBtn.strings;
          1 -> superOptBtn.currentItem;
          groups[] -> groupsOptBtn.strings;
          1 -> groupsOptBtn.currentItem;
          showModal;
       #);
          
          
     onCancel:< (# do INNER #);
     onOK:< 
       (# groupName: ^text;
          name: ^text;
          superName: ^text;
       do nameFld.contents -> name[];
          superOptBtn.currentString -> superName[];
          groupsOptBtn.currentString -> groupName[];
          INNER
       #);
     
     open::<
       (# 
       do hide;
          'Create' -> title;
          (318,174)->size;
          nameLab.open;
          nameFld.open;
          superOptBtn.open;
          sep.open;
          okBtn.open;
          cancelBtn.open;
          groupsOptBtn.open;
          INNER
       #);
     
     choiseButton: optionButton
       (# strings:
            (# theStrings: ^textList;
               theMenu: ^menu;
            enter theStrings[]
            do &menu[] -> theMenu[];
               theMenu.open;
               theStrings.scan
               (# anItem: ^menu.menuItem;
               do &theMenu.menuItem[] -> anItem[];
                  anItem.open;
                  current[] -> anItem.name;
                  anItem[] -> theMenu.append;
               #);
               theMenu[] -> popupMenu;
            #);
          currentString:
            (# string: ^text;
               theItem: ^menu.menuItem;
            do currentItem -> (popupMenu).getMenuItemByNumber -> theItem[];
               theItem.name -> string[];
            exit string[]
            #);
       #);
     
     nameLab: @staticText
       (#
          open::< 
            (# 
            do
               (13,13)->position;
               (34,16)->size;
               true->bindLeft;
               false->bindRight;
               true->bindTop;
               false->bindBottom;
               'Name:'->label
            #)
       #);
     nameFld: @editText
       (#
          open::< 
            (# 
            do
               (57,13)->position;
               (243,22)->size;
               true->bindLeft;
               true->bindTop;
               false->bindBottom;
               
            #)
       #);
     superOptBtn: @choiseButton
       (#
          open::< 
            (# 
            do
               (13,47)->position;
               true->bindLeft;
               false->bindRight;
               true->bindTop;
               false->bindBottom;
               'Super pattern:'->label;
               (170,35)->size;
               
            #)
       #);
     sep: @separator
       (#
          open::< 
            (# 
            do
               (5,123)->position;
               (301,7)->size;
               true->bindLeft;
               false->bindRight;
               true->bindTop;
               false->bindBottom
            #)
       #);
     okBtn: @pushButton
       (#
          eventHandler::  (# onMouseUp::  (#  do onOk;  #);  #);
          open::< 
            (# 
            do
               (221,140)->position;
               (60,20)->size;
               true->bindLeft;
               false->bindRight;
               true->bindTop;
               false->bindBottom;
               'OK'->label;
               
            #)
       #);
     cancelBtn: @pushButton
       (#
          eventHandler::  (# onMouseUp::  (#  do onCancel;  #);  #);
          open::< 
            (# 
            do
               (151,140)->position;
               (60,20)->size;
               true->bindLeft;
               false->bindRight;
               true->bindTop;
               false->bindBottom;
               'Cancel'->label
            #)
       #);
     
     groupsOptBtn: @choiseButton
       (#
          open::<
            (# 
            do
               5->border.style;
               false->border.visible;
               'FragmentGroup:'->label;
               (170,35)->size;
               (13,81)->position;
               
            #)
       #)
  #)  

