ORIGIN '../createclassdialog';
INCLUDE '../integerfield';

-- createClassDialogPrivate: Descriptor --
(# names: ^textList;
   
   staticText2: @staticText
     (#
        open::<
          (# 
          do
             (4,12)-> position;
             (34,16)-> (*$ 0*) size;
             true->  bindLeft;
             false->  bindRight;
             true->  bindTop;
             false->  bindBottom;
             'Name:'->  label
          #)
     #);
   nameFld: @editText
     (# open::<
          (# 
          do (43,6)->  position;
             (250,29)->  size;
             true->  bindLeft;
             true->  bindRight;
             true->  bindTop;
             false->  bindBottom;
          #)
     #);
   superOptBtn: @optionButton
     (#
        open::<
          (# 
          do
             (4,47)->  position;
             true->  bindLeft;
             false->  bindRight;
             true->  bindTop;
             false->  bindBottom;
             'Super pattern:'->  label;
             (200,35)->  size;
          #)
     #);
   separator5: @separator
     (#
        open::<
          (# 
          do
             (3,100)->  position;
             (293,7)->  size;
             true->  bindLeft;
             false->  bindRight;
             true->  bindTop;
             false->  bindBottom
          #)
     #);
   pushButton6: @pushButton
     (# eventHandler::
          (# onMouseUp::
               (#
               do onOk;
               #);
          #);
        open::<
          (# 
          do
             (227,113)->  position;
             (60,20)->  size;
             true->  bindLeft;
             false->  bindRight;
             true->  bindTop;
             false->  bindBottom;
             'OK'->  label;
             pushButton6[] -> defaultButton;
          #)
     #);
   pushButton7: @pushButton
     (# eventHandler::
          (# onMouseUp::
               (#
               do onCancel;
               #);
          #);
        open::<
          (# 
          do
             (157,113)->  position;
             (60,20)->  size;
             true->  bindLeft;
             false->  bindRight;
             true->  bindTop;
             false->  bindBottom;
             'Cancel'->  label
          #)
     #)
#)  

-- createClassDialogOpen: DoPart --
do 'Create' -> Title;
   (299,136)->  size; 
   private.staticText2.open;
   private.nameFld.open;
   private.superOptBtn.open;
   private.separator5.open;
   private.pushButton6.open;
   private.pushButton7.open;
   private.nameFld[] -> target;
   INNER;
   centerOnScreen;
   
-- createClassDialogClassNames: doPart --
do (# theMenu: ^menu;
   do names[] -> private.names[];
      &menu[] -> theMenu[];
      theMenu.open;
      names.scan
      (# theItem: ^menu.menuItem;
      do &theMenu.menuItem[] -> theItem[];
         theItem.open;
         theItem[] -> theMenu.append;
         current[] -> theItem.name;
      #);
      theMenu[] -> private.superOptBtn.popupMenu;
   #);

-- createClassDialogSetClassName: doPart --
do exception
   (# 
   do 'createClassDialogSetClassName is not implemented' -> msg;
   #);

-- createClassDialogGetClassName: doPart --
do private.superOptBtn.currentItem -> private.names.get -> value[];

-- createClassDialogSetName: doPart --
do value[] -> private.nameFld.contents;

-- createClassDialogGetName: doPart --
do private.nameFld.contents -> value[];
   
-- userCreateClassDoPart: doPart --
do (# theCreateClassDialog: @createClassDialog
        (# onOk::
             (# theName: ^text;
                theClassName: ^text;
             do name -> theName[];
                className -> theClassName[];
                theCreateClassDialog.close;
                (theName[], theClassName[]) -> createClass;
             #);
           onCancel::
             (# 
             do theCreateClassDialog.close;
             #);
           open::
             (# 
             do defaultName[] -> name;
                this(userCreateClass).classNames[] -> classNames;
                hide;
             #);
        #);
   do theCreateClassDialog.open;
      theCreateClassDialog.showModal;
   #);
