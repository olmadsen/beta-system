ORIGIN '../libeditor';
INCLUDE '../patterneditor';

-- libEditorLib: attributes --
clear:
  (# 
  do none -> private.theAttributesEditor.theAttributes;
  #);
updateView:
  (# theAttributesForm: ^astInterface.beta.attributesForm;
     theAttributes: ^astInterface.beta.attributes;
  do clear;
     (if private.theFragment[] <> none then
         private.theFragment.root[] -> theAttributesForm[];
         theAttributesForm.getAttributes -> theAttributes[];
         theAttributes[] -> private.theAttributesEditor.theAttributes;
     if);
  #);

-- LibEditorEnterTheFragment: doPart --
do value[] -> private.theFragment[];
   updateView;
   
-- LibEditorExitTheFragment: doPart --
do private.theFragment[] -> value[];
   
   
-- LibEditorOpen: doPart --
do (this(libEditor)[], none) -> private.theAttributesEditor.open;
   (if initialFragment[] <> none then
       initialFragment[] -> theFragment;
   if);
   inner;

-- LibEditorPrivate: descriptor --
(# theFragment: ^astInterface.fragmentForm;
   
   theAttributesEditor: @attributesEditor
     (# 
        open::
          (# width, height: @integer;
          do this(libEditor).size -> (width, height);
             ((0, 0), ((width), (height))) -> frame;
             true -> bindBottom -> bindRight;
          #);
        attributeSelected::
          (# 
          do (theAttribute[], doubleClick) -> this(libEditor).attributeSelected;
          #);
        reportParseErrors::
          (# 
          do errors[] -> this(libEditor).reportParseErrors;
          #);
     #);
#)

-- LibEditorAttributeUpdated: doPart --
do theAttribute[] -> private.theAttributesEditor.attributeUpdated;
   
-- LibEditorinteractiveCreateAttribute: doPart --
do private.theAttributesEditor.interactiveCreateAttribute;
