ORIGIN '../getfilebody';

INCLUDE '~beta/unixlib/unixinterface';
INCLUDE '~beta/basiclib/file';
INCLUDE '~beta/sysutils/cstring';

-- GUIENVgetFile: doPart --
do (# theFileBrowserWindow: @fileBrowserWindow
        (# fileBrowserType::
             (# filter::
                  (# anEntry: @diskEntry;
                     itsExt: ^text;
                  do (if ext[] = none then
                         true -> value;
                      else
                         name[] -> anEntry.path;
                         anEntry.path.name.extension -> itsExt[];
                         ext[] -> itsExt.equal -> value;
                     if);
                  #);
                fileSelected::
                  (# 
                  do name.copy -> this(getFile).name[];
                     theFileBrowserWindow.close;
                  #);
                userCancel::
                  (#
                  do theFileBrowserWindow.close;
                  #);
             #);
           open::
             (# cStr: @cString;
             do 'File browser' -> title;
                getCurrentDir -> theFileBrowser.theDirectory;
                hide;
             #);
        #);
   do 
      theFileBrowserWindow.open;
      theFileBrowserWindow.showModal;
   #);
