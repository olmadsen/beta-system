ORIGIN '~beta/guienv/guienv';
INCLUDE '~beta/guienv/graphics';

BODY 'private/tableviewbody';

-- windowLib: attributes --

tableView: canvas
  (# <<SLOT tableViewLib: attributes>>;
     
     tableItemType:< tableItem;
     
     column: interfaceObject
       (# <<SLOT columnLib: attributes>>;
          title:
            (# value: ^text;
            enter (# enter value[] <<SLOT columnSetTitle: doPart>> #)
            exit (# <<SLOT columnGetTitle: doPart>> exit value[] #)
            #);
          width:
            (# value: @integer;
            enter (# enter value <<SLOT columnSetWidth: doPart>> #)
            exit (# <<SLOT columnGetWidth: doPart>> exit value #)
            #);
          less:< booleanValue
            (# left, right: ^tableItemType;
               leftData, rightData: ^text;
               doneInInner: @boolean;
            enter (left[], right[])
            <<SLOT columnLess: doPart>>
            #);
          open::<
            (# <<SLOT columnOpen: doPart>> #);
          close::<
            (# <<SLOT columnClose: doPart>> #);
          eventHandler::<
            (# drawTitleEvent: event
                 (# g: ^graphics;
                    bounds: ^rectangle;
                 enter (g[], bounds[])
                 do INNER;
                 #);
               onDrawTitle:< drawTitleEvent;
               drawItemEvent: event
                 (# g: ^graphics;
                    bounds: ^rectangle;
                    theTableItem: ^tableItemType;
                    data: ^text;
                 enter (g[], bounds[], theTableItem[], data[])
                 do INNER;
                 #);
               onDrawItem:< drawItemEvent;
            #);
          private: @<<SLOT columnPrivate: descriptor>>;
       #);
     appendColumn:
       (# theColumn: ^column;
       enter theColumn[]
       <<SLOT tableViewAppendColumn: doPart>>
       #);
     insertColumn:
       (# theColumn: ^column;
          after: ^column;
       enter (theColumn[], after[])
       <<SLOT tableViewInsertColumn: doPart>>
       #);
     deleteColumn:
       (# theColumn: ^column;
       enter theColumn[]
       <<SLOT tableViewDeleteColumn: doPart>>
       #);
     
     mainColumnType:< column
       (# eventHandler::<
            (# 
               onDrawTitle::<
                 (# <<SLOT mainColumnTypeOnDrawTitle: doPart>> #);
               onDrawItem::<
                 (# <<SLOT mainColumnTypeOnDrawItem: doPart>> #);
               
            #);
       #);
     mainColumn: @mainColumnType;
     
     alignLeft: (# exit 1 #);
     alignRight: (# exit 2 #);
     
     simpleColumn: column
       (# <<SLOT simpleColumnnLib: attributes>>;
          alignment:
            (# value: @integer;
            enter (# enter value <<SLOT simpleColumnSetAlignment: doPart>> #)
            exit (# <<SLOT simpleColumnGetAlignment: doPart>> exit value #)
            #);
          open::<
            (# <<SLOT simpleColumnOpen: doPart>> #);
          close::<
            (# <<SLOT simpleColumnClose: doPart>> #);
          eventHandler::<
            (# onDrawTitle::<
                 (# <<SLOT simpleColumnOnDrawTitle: doPart>> #);
               onDrawItem::<
                 (# <<SLOT simpleColumnOnDrawItem: doPart>> #);
            #);
          private: @<<SLOT simpleColumnPrivate: descriptor>>;
       #);
     
     tableItem: interfaceObject
       (# <<SLOT tableItemLib: attributes>>;
          mainText:
            (# value: ^text;
            enter (# enter value[] <<SLOT tableItemSetMainText: doPart>> #)
            exit (# <<SLOT tableItemGetMainText: doPart>> exit value[] #)
            #);
          icon:
            (# theIcon: ^pixmap;
            enter (# enter theIcon[] <<SLOT tableItemSetIcon: doPart>> #)
            exit (# <<SLOT tableItemGetIcon: doPart>> exit theIcon[] #)
            #);
          setColumnText:
            (# theColumn: ^column;
               value: ^text;
            enter (theColumn[], value[])
            <<SLOT tableItemSetColumnText: doPart>>
            #);
          getColumnText:
            (# theColumn: ^column;
               value: ^text;
            enter theColumn[]
            <<SLOT tableItemGetColumnText: doPart>>
            exit value[]
            #);
          textIndent:
            (# value: @integer;
            enter (# enter value <<SLOT tableItemSetTextIndent: doPart>> #)
            exit (# <<SLOT tableItemGetTextIndent: doPart>> exit value #)
            #);
          iconIndent:
            (# value: @integer;
            enter (# enter value <<SLOT tableItemSetIconIndent: doPart>> #)
            exit (# <<SLOT tableItemGetIconIndent: doPart>> exit value #)
            #);
          expander:
            (# value: @boolean;
            enter (# enter value <<SLOT tableItemSetExpander: doPart>> #)
            exit (# <<SLOT tableItemGetExpander: doPart>> exit value #)
            #);
          selected: booleanValue
            (# <<SLOT tableItemSelected: doPart>> #);
          eventHandler::<
            (# selectEvent: event
                 (# do INNER; #);
               onSelect:< 
                 selectEvent;
               deSelectEvent: event
                 (# do INNER #);
               onDeSelect:< 
                 deSelectEvent;
               expandEvent: event
                 (# do INNER #);
               onExpand:< 
                 expandEvent;
               colapseEvent: event
                 (# do INNER; #);
               onColapse:< 
                 colapseEvent;
            #);
          open::<
            (# <<SLOT tableItemOpen: doPart>> #);
          close::<
            (# <<SLOT tableItemClose: doPart>> #);
          private: @<<SLOT tableItemPrivate: descriptor>>;
       #);
     
     append:
       (# theTableItem: ^tableItemType;
       enter theTableItem[]
       <<SLOT tableViewAppend: doPart>>
       #);
     prepend:
       (# theTableItem: ^tableItemType;
       enter theTableItem[]
       <<SLOT tableViewPrepend: doPart>>
       #);
     insert:
       (# theTableItem: ^tableItemType;
          after: ^tableItemType;
       enter (theTableItem[], after[])
       <<SLOT tableViewInsert: doPart>>
       #);
     
     scan:
       (# current: ^tableItemType;
       <<SLOT tableViewScan: doPart>>
       #);
     
     selection: @
       (# set:
            (# theTableItem: ^tableItemType;
            enter theTableItem[]
            <<SLOT tableViewSelectionSet: doPart>>
            #);
          add:
            (# theTableItem: ^tableItemType;
            enter theTableItem[]
            <<SLOT tableViewSelectionAdd: doPart>>
            #);
          remove:
            (# theTableItem: ^tableItemType;
            enter theTableItem[]
            <<SLOT tableViewSelectionRemove: doPart>>
            #);
          clear:
            (# <<SLOT tableViewSelectionClear: doPart>> #);
          scan:
            (# current: ^tableItemType;
            <<SLOT tableViewSelectionScan: doPart>>
            #);
       #);
     
     
     theScroll:
       (# x, y: @integer;
       enter (# enter (x, y) <<SLOT tableViewSetTheScroll: doPart>> #)
       exit (# <<SLOT tableViewGetTheScroll: doPart>> exit (x, y) #)
       #);
     scroll:
       (# dX, dY: @integer;
       enter (dX, dY)
       <<SLOT tableViewScroll: doPart>>
       #);
     maxScroll:
       (# maxX, maxY: @integer;
       <<SLOT tableViewMaxScroll: doPart>>
       exit (maxX, maxY)
       #);
     
     sortByColumn:
       (# theColumn: ^column;
       enter (# enter theColumn[] <<SLOT tableViewSetSortByColumn: doPart>> #)
       exit (# <<SLOT tableViewGetSortByColumn: doPart>> exit theColumn[] #)
       #);
     
     open::<
       (# <<SLOT tableViewOpen: doPart>> #);
     close::<
       (# <<SLOT tableViewClose: doPart>> #);
     eventHandler::<
       (# onFrameChanged::<
            (# <<SLOT tableViewOnFrameChanged: doPart>> #);
       #);
     private: @<<SLOT tableViewPrivate: descriptor>>;
  #);

