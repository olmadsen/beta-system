ORIGIN '~beta/guienv/v1.6/controls';
INCLUDE '~beta/guienv/v1.6/graphics';
-- windowLib: Attributes --
caption: staticText
  (#
     eventHandler::< 
       (# onLabelChanged::<  (#  do fitToContents; INNER ;  #);  #);
     
  #);
downArrow: control
  (#
     arrowHeight:
       (# 
       enter
         (# value: @integer
         enter value
         do
            (if value <> theArrowHeight then value->theArrowHeight; update if)
         #)
       exit theArrowHeight
       #);
     popupMenu: (#  enter thePopupMenu[] exit thePopupMenu[] #);
     open::< 
       (#
          defaultMenu: @menu
            (#
               horse: @menuItem
                 (#
                    open:: 
                      (#  do 'Horse'->name; THIS(menuItem)[]->append #)
                 #);
               cow: @menuItem
                 (# open::  (#  do 'Cow'->name; THIS(menuItem)[]->append #)
                 #);
               pig: @menuItem
                 (# open::  (#  do 'Pig'->name; THIS(menuItem)[]->append #)
                 #);
               open::  (#  do horse.open; cow.open; pig.open #)
            #)
       do
          5->theArrowHeight; defaultMenu.open; defaultMenu[]->popupMenu; INNER
       #);
     eventHandler::< 
       (#
          onRefresh::< 
            (# 
            do
               graphics
                 (# x,y: @integer; width,height: @integer
                 do
                    size->(width,height);
                    width div 2->x;
                    (height-arrowHeight) div 2+arrowHeight->y;
                    (0,arrowHeight-1)
                      ->forto
                        (#  do ((x-inx,y-inx),(x+inx,y-inx))->drawLine #)
                 #);
               INNER
            #);
          onMouseDown::< 
            (# 
            do
               (if popupMenu <> none then
                   (0,localposition,THIS(downArrow)[])->(popupmenu).popup
               if)
            #)
       #);
     theArrowHeight: @integer;
     thePopupMenu: ^menu
  #);
groupRadioButton: radioButton
  (#
     unToggleOthers:
       (# 
       do
          father.scan
            (# 
            do
               (if current[] <> THIS(groupRadioButton)[] then
                   (if current## <= groupRadioButton## then
                       current[]
                         ->qua
                           (# as:: groupRadioButton
                           do false->thisObj.state
                           #)
                   if)
               if)
            #)
       #);
     eventHandler::< 
       (#
          onStateChanged::< 
            (#  do (if state then unToggleOthers if); INNER #)
       #)
  #);
  

