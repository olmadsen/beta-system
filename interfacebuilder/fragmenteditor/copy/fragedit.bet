ORIGIN '~beta/interfacebuilder/v1.0/editorenv/editorenv';
BODY 'frageditBody';

INCLUDE '~beta/guienv/v1.3.1/stddialogs';
INCLUDE '~beta/guienv/v1.3.1/controls';
INCLUDE '~beta/guienv/v1.3.1/fields';


-- editorEnvLib: attributes --

FragmentEditorWindow: Window
  (# theFragmentGroup: ^MPS.FragmentGroup;
     button: pushbutton
       (#
          command:< Object;
          eventHandler::<
            (#  onMouseUp::<
                 (# 
                 do command;
                 #);
          #);
          open::<
            (# 
            do (60,20) -> size;
             inner;
            #);
       #);
     TargetFlag: @boolean;
     ChangedFlag: @boolean;
     State:<(# value: @boolean;
            enter value
            do 
               (if value<>ChangedFlag then
                   value->ChangedFlag;
                   (if ChangedFlag then
                       ParseButton.enable;
                       RevertButton.enable;
                    else
                       ParseButton.disable;
                       RevertButton.disable;
                   if);
               if);
            #);
     
     OpenButton: @button
       (# command::< (# do <<SLOT FragmentEditorOpenButtonCommand: Descriptor>>;#);
           open ::< (# do <<SLOT FragmentEditorOpenButtonOpen: Descriptor>>;#);
       #);
     RevertButton: @button
       (# command::< (# do <<SLOT FragmentEditorRevertButtonCommand: Descriptor>>;#);
          open::<(# do <<SLOT FragmentEditorRevertButtonOpen: Descriptor>>;#);
          
       #);
     ParseButton: @button
       (# command::< (# do <<SLOT FragmentEditorParseButtonCommand: Descriptor>>;#);
          open::<(# do <<SLOT FragmentEditorParseButtonOpen: Descriptor>>;#);
       #);
     Properties: @TextEditor
       (# 
          changed: @boolean;
          count: @integer;
          
          open::<(# do <<SLOT FragmentEditorPropertiesOpen: Descriptor>>;#);
          init:<(# proplist:^PropertyList;
                enter proplist[]
                do <<SLOT FragmentEditorPropertiesInit: Descriptor>>;
                #);
          prettyPrint:<(# do <<SLOT FragmentEditorPropertiesPrettyPrint: Descriptor>>;
                       #);
          Parse:<(# do <<SLOT FragmentEditorPropertiesParse: Descriptor>>;
                       #);
          TextContents: (# st:^styledText;
                        enter (#   
                              enter st[]
                              do 
                                 0->count;
                                 false->Changed->State;
                                 st[]->theTextField.contents;
                              #)
                        exit (# do theTextField.contents->st[];
                             exit st[]
                             #)
                        #);
          SaveContents: ^styledText;
          theTextField: ^TextField;
          contentsType::<
            (#
               eventHandler::< (#
                                  onMouseDown::<(# do <<SLOT FragmentEditorPropertiescTeHonMouseDown: Descriptor>>;#);
                                  onTextChanged::<(# do <<SLOT FragmentEditorPropertiescTeHonTextChanged: Descriptor>>;#);
                               #);
            #);
       #);
     Fragments: @TextEditor
       (# 
          count: @integer;
          changed: @boolean;
          
          open::<(# do <<SLOT FragmentEditorFragmentsOpen: Descriptor>>;#);
          init:<(# fg: ^MPS.FragmentGroup;
                enter fg[]
                do <<SLOT FragmentEditorFragmentsInit: Descriptor>>;
                #);
          prettyPrint:<(# do <<SLOT FragmentEditorFragmentsprettyPrint: Descriptor>>;
                       #);
          parse:<(# do <<SLOT FragmentEditorFragmentsParse: Descriptor>>;
                       #);
          
          textContents: (# st:^styledText;
                        enter (#   
                              enter st[]
                              do                                  
                                 0->count;
                                 false->Changed->State;
                                 st[]->theTextField.contents;
                              #)
                        exit (# do theTextField.contents->st[];
                             exit st[]
                             #)
                        #);
          SaveContents: ^styledText;
          theTextField: ^TextField;
          contentsType::<
            (#
               eventHandler::< (#
                                  onMouseDown::<(# do <<SLOT FragmentEditorFragmentscTeHonMouseDown: Descriptor>>;#);
                                  onTextChanged::<(# do <<SLOT FragmentEditorFragmentscTeHonTextChanged: Descriptor>>;#);
                               #);
            #);
       #);
     
     open::<(# do <<SLOT FragmentEditorOpen: Descriptor>>;
            #);
  #);
















