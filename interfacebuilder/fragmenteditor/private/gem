  (if (ch->t.equal) then   
                                              (if start then
                                                   currentpos->endpos;
                                                else
                                                   true->start;
                                                   currentpos->startpos;
                                               if);
                                               ch->put;
                                        		   if);
	                		                           currentpos+1->currentpos;                           (*
                                                      
                           (startpos+1,endpos-1)->selection;
                           selection.contents->fragname[];*)
cursorpos, currentpos, startpos, endpos: @Integer;
                       start: @boolean;
                       groupname:^text;
                       ch : @char;
                    do 
                       Changed->State;
                       
                       (if (Selection.start = Selection.end) then
                           selection.start->cursorpos;
                          
                           cursorpos->currentpos;
                           'currentpos:'->putline;
                           currentpos->putint;
                           &text[]->groupname[];
                           
                           L:
                             (# (* go to the left until ' or ; is found*)
                             do 
                                
                                (if (currentpos < 0) then 'currentpos is now negativ' -> putline; leave L; if);
                                currentpos->getChar->ch;
                                (if ch 
                                 // '''' (* find groupname *)
                                    then 'yes 1'->putline;
                                    currentpos+1->currentpos->startpos;
                                     L2:
                                      (# (* go to the right until ' or ; is found*)
                                      do 
                                         (if (currentpos > length) then 'currentpos is now greater then lenght' -> putline; 
                                             leave L; 
                                         if);
                                         currentpos->getChar->ch;
                                         (if ch 
                                          // '''' (* find groupname *)
                                             then 'groupname found'->putline;
                                             currentpos->endpos;
                                             (startpos,endpos)->selection;
                                             selection.contents->groupname[];
                                             'goupname:'->putline;
                                             selection.contents->putline;
                                             (* groupname[]->OpenNewGroup; *)
                                             leave L;
                                          // ';' 
                                             then
                                             '; found not the right place'->putline;
                                             leave L;
                                          else 
                                             currentpos+1->currentpos;
                                             restart L2;
                                         if);
                                      #);
                                 // ';' 
                                    then
                                    '; found not the right place'->putline;
                                    leave L;
                                 else 
                                    currentpos-1->currentpos;
                                    restart L;
                                if);
                             #);
                       if);


(*
--FragmentEditorFragmentsParse: Descriptor --
(# TextToParse: ^text;
   parseOK: @boolean;
   line: ^text;
   regexpr:^text;
do    
   TextContents -> TextToParse[];
   TextToParse.reset;
   true->parseOK;
   '[a-zA-z][a-zA-Z0-9_]*[ \t]*:[ \t]*\\(Descriptor\\|Attributes\\|DoPart\\)'->regexpr[];
   *)

   (*
   L:
     (# 
     do (if (TextToParse.eos) then
            leave L;
         else
            TextToParse.getline->line[];
            line[]->putline;
            (if line.length // 0 then restart L; if);
            0->line.pos;
            regexpr[] ->line.regexp_match
            (# noMatch::< (#do '\t no match'->putline; 
                             false->parseOK #)
            #);
            restart L;
        if)
     #);
   
   TextToParse.getline->line[];
   line[]->putline;
   (if parseOK then
       ' parse ok \n'->putline;
    else
       ' parse not ok \n'->putline;
   if);
#)



--FragmentEditorFragmentscTeHonMouseDown : Descriptor --
(# do 
#) 


--FragmentEditorFragmentscTeHonTextChanged: Descriptor --
(# do 
   count + 1 ->count;
   'text changed ' -> putText;
   count -> putInt;
   newLine;
   (if (count > 1) then 
       true->Changed->State;
   if);
#) 
*)