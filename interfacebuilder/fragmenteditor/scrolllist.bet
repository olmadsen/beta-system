ORIGIN '~beta/guienv/v1.2/guienv'
[[
-- Include '~beta/guienv/v1.2/scrolllists'
-- INCLUDE '~beta/basiclib/v1.4/regexp'
-- program: descriptor --
guienv
(# theWindow: @window
     (# menubarType::<
          (# fileMenu: @menu
               (# testItem1: @menuitem
                    (# eventHandler::<
                         (# onSelect::<
                              (#
                              do theTextScrollList.install;
                              #);
                         #);
                       open::<
                         (# 
                         do 'Add items' -> name;
                         #);
                    #);
                  testItem2: @menuitem
                    (# eventHandler::<
                         (# onSelect::<
                              (# 
                              do 'I' -> testItem1.key;
                                 theTextScrollList.numberOfItems -> putInt;
                                 newLine;
                              #);
                         #);
                       open::<
                         (# 
                         do 'Get' -> name;
                         #);
                    #);
                  testItem3: @menuitem
                    (# eventHandler::<
                         (#  onSelect::<
                              (# 
                              do 
                                 'Hello' -> putLine;
                              #);
                         #);
                       open::<
                         (# 
                         do 'Show selection' -> name;
                         #);
                    #);
                  quitItem: @menuitem
                    (# eventHandler::<
                         (# onSelect::<
                              (# 
                              do Terminate;
                              #);
                         #);
                       open::<
                         (# 
                         do 'Quit' -> name;
                         #);
                    #);
                  open::<
                    (# 
                    do 'File' -> name;
                       testItem1.open;
                       testItem1[] -> append;
                       testItem2.open;
                       testItem2[] -> append;
                       testItem3.open;
                       testItem3[] -> append;
                       quitItem.open;
                       quitItem[] -> append;
                    #);
               #);
             open::<
               (# 
               do fileMenu.open;
                  fileMenu[] -> append;
               #);
          #);
        theTextScrollList: @textScrollList
          (# selectText:^text;
             eventHandler::<
               (# onMouseUp::<
                    (# 
                    do 'Mouseup' -> putLine;
                       Selection.last->putint;
                    #);
                  onMouseDown::<
                    (# regexpr:^text;
                       matchok: @boolean;
                    do '[a-zA-Z][a-zA-Z0-9_]*[ \t]*:'->regexpr[];
                         'Mousedown' -> putLine;
                      
                       (if doubleClick//true then
                           Selection.first -> getText -> selectText[] -> putLine;
                           0->selectText.pos;
                           
                           regexpr[]->selecttext.regexp_match
                           (# 
                              nomatch::< (#
                                         do '\t no match' ->putline;
                                            false->matchok;
                                         #);
                           do
                              true->posToMatchEnd;
                              'match:'->putline;
                              ((0->regs.start)+1,(0->regs.end)-1)->selecttext.sub->putline;
                           #);
                           true->matchok;
                           'DoPart'->regexpr[];
                              
                           regexpr[]->selecttext.regexp_search
                           (# 
                              nomatch::< (#
                                         do '\t no match' ->putline;
                                            false->matchok;
                                         #);
                           #);
                           (if matchok // false then
                               'Attrributes'->regexpr[];
                              
                               regexpr[]->selecttext.regexp_match
                               (# 
                                  nomatch::< (#
                                             do '\t no match' ->putline;
                                                false->matchok;
                                             #);
                               #); 
                           if);
                           (if matchok // false then
                               'Descriptor'->regexpr[];
                              
                               regexpr[]->selecttext.regexp_match
                               (# 
                                  nomatch::< (#
                                             do '\t no match' ->putline;
                                                false->matchok;
                                             #);
                               #); 
                           if);
                       if);
                    #);
                  onKeyDown::<
                    (# 
                    do 'keydown' -> putLine;
                    #);
               #);
             install:
               (# 
               do  5 -> append;
                  (1,'AbrahamLincoln : DoPart') -> setText;
                  (2,'AbrahamLincwsoln : Attributes') -> setText;
                  (3,'Abraham Lincoln 3') -> setText;
                  (4,'Abraham Lincoln 4') -> setText;
                  (5,'Abraham Lincoln 5') -> setText;
               #);
             open::<
               (# v: @point;
               do (* install;*)
                  (5,5) -> position;
                  theWindow.size -> v;
                  (10,10) -> v.subtract;
                  v -> size;
                  true -> bindBottom;
                  true -> bindRight;
                  true -> border.visible;
                  
               #);
          #);
        eventHandler::<
          (# 
             onActivate::<
               (# 
               do 'Activate' -> putLine;
               #);
             onDeactivate::<
               (# 
               do 'Deactivate' -> putLine;
               #);
          #);
        open::<
          (# 
          do (400,400) -> size;
             theTextScrollList.open;
             theTextScrollList[] -> target;
          #);
     #);
do theWindow.open;
   
#)
--]]
