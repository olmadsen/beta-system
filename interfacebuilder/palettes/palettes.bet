ORIGIN '~beta/guienv/v1.3.1/guienv';
BODY 'private/palettesbody'

-- INCLUDE '~beta/guienv/v1.3.1/stddialogs'
-- INCLUDE '~beta/guienv/v1.3.1/controls'
-- INCLUDE '~beta/guienv/v1.3.1/fields'
-- INCLUDE '~beta/guienv/v1.3.1/figureitems'


-- windowLib: attributes --

paletteEnv:
  (# <<SLOT paletteEnvLib: attributes>>;
     
     itemSelected:<
       (# name: ^text;
          type: @integer;
       enter (name[], type)
       do inner;
       #);
     
     palette: canvas
       (# <<SLOT paletteLib: attributes>>;
          title:
            (# theTitle: ^text;
            enter (# enter theTitle[] <<SLOT paletteEnvPaletteSetTitle: doPart>> #)
            exit (# <<SLOT paletteEnvPaletteGetTitle: doPart>> exit theTitle[] #)
            #);
          addEntry:<
            (# type: @integer;
            enter type
            do inner;
            #);
          open::<
            (# <<SLOT paletteEnvPaletteOpen: doPart>> #);
          private: @<<SLOT paletteEnvPalettePrivate: descriptor>>;
       #);
     textPalette: palette
       (# <<SLOT textPaletteLib: attributes>>;
          addEntry::<
            (# name: ^text;
            enter name[]
            <<SLOT paletteEnvTextPaletteAddEntry: doPart>>
            #);
          open::<
            (# <<SLOT paletteEnvTextPaletteOpen: doPart>> #);
          private: @<<SLOT paletteEnvTextPalettePrivate: descriptor>>;
       #);
     iconPalette: palette
       (# <<SLOT iconPaletteLib: attributes>>;
          numberOfCols:< integerValue
            (#
            do 1 -> value;
               inner;
            #);
          addEntry::<
            (# name: ^text;
               rasterName: ^text;
            enter (name[], rasterName[])
            <<SLOT paletteEnviconPaletteAddEntry: doPart>>
            #);
          open::<
            (# <<SLOT paletteEnviconPaletteOpen: doPart>> #);
          private: @<<SLOT paletteEnviconPalettePrivate: descriptor>>;
       #);
     paletteMenu: menu
       (# <<SLOT paletteMenuLib: attributes>>;
          paletteType:< palette;
          thePalette: ^paletteType;
          toggleItem: menuItem
            (# eventHandler::<
                 (# onSelect::<
                      (# <<SLOT paletteEnvToggleItemOnSelect: doPart>> #);
                 #);
            #);
          paletteMenuItem: menuItem
            (# type: @integer;
               eventHandler::<
                 (#  onSelect::<
                      (#  <<SLOT paletteEnvPaletteMenuItemOnSelect: doPart>> #);
                 #);
               init:<
                 (# theName: ^text;
                 enter (type, theName[])
                 <<SLOT paletteEnvpaletteMenuItemInit: doPart>>
                 #);
            #);
          open::<
            (# <<SLOT paletteEnvPaletteMenuOpen: doPart>> #);
          private: @<<SLOT paletteEnvPaletteMenuPrivate: descriptor>>;
       #);
     
     controlsPalette: iconPalette
       (# open ::< (# do <<SLOT ControlsPaletteOpen: Descriptor>>;#);
          close ::< (# do <<SLOT ControlsPaletteClose: Descriptor>> #);
          Private: @<<SLOT ControlsPalettePrivate: Descriptor>>;
       #);
     controlsMenu: paletteMenu
       (# paletteType::< controlsPalette;
          open::<
            (# <<SLOT paletteEnvControlsMenuOpen: doPart>> #);
       #);
     
     figureitemsPalette: iconPalette
       (# numberOfCols::< (# do 2 -> value #);
          open ::< (# do <<SLOT FigureitemsPaletteOpen: Descriptor>>;#);
          close ::< (# do <<SLOT FigureitemsPaletteClose: Descriptor>>;#);
          Private: @<<SLOT FigureitemsPalettePrivate: Descriptor>>;
       #);
     figureItemsMenu: paletteMenu
       (# paletteType::< figureitemsPalette;
          open::<
            (# <<SLOT paletteEnvFigureItemsMenuOpen: doPart>> #);
       #);
     viewsPalette: textPalette
       (# open ::< (# do <<SLOT ViewsPaletteOpen: Descriptor>>;#);
          close ::< (# do <<SLOT ViewsPaletteClose: Descriptor>>;#);
          Private: @<<SLOT ViewsPalettePrivate: Descriptor>>;
       #);
     viewsMenu: paletteMenu
       (#  paletteType::< ViewsPalette;
          open::<
            (# <<SLOT paletteEnvViewsMenuOpen: doPart>> #);
       #);
     mainMenu: @menu
       (# subMenuItem: menuItem
            (# paletteMenuType:< paletteMenu;
               thePaletteMenu: ^paletteMenuType;
               init:<
                 (# <<SLOT paletteEnvMainMenuSubMenuItemInit: doPart>> #);
            #);
          open::<
            (# <<SLOT paletteEnvMainMenuOpen: doPart>> #);
          private: @<<SLOT paletteEnvMainMenuPrivate: descriptor>>;
       #);

     init:< 
       (# 
       do 2->NextCanvasPosition.set;
          inner;
       #);
     
     NextCanvasPosition:@
       (# pos: @Integer;
          set: (#  i: @Integer;
               enter i
               do i->pos;
               #);
       exit pos
       #);
     Deminish: 
       (# Height: @Integer;
       enter Height
       do <<SLOT PaletteWindowDeminish: Descriptor>>
       #);
     
     Grow: 
       (# Height: @Integer;
       enter Height
       do <<SLOT PaletteWindowGrow: Descriptor>>
       #);
  #);
   
