ORIGIN '~beta/basiclib/betaenv';
INCLUDE '../atom/atom';
BODY 'private/parametersbody';
LIB_DEF 'frigg_param' '../../lib';

-- lib: Attributes --


interfaceObjectType: (# exit 1 #);
windowitemType: (# exit 2 #);
separatorType: (# exit 3 #);
canvasType: (# exit 4 #);
abstractScrollerType: (# exit 5 #);
scrollerType: (# exit 6 #);
textEditorType: (# exit 7 #);
controlType: (# exit 8 #);
buttonType: (# exit 9 #);
pushButtonType: (# exit 10 #);
iconButtonType: (# exit 11 #);
optionButtonType: (# exit 12 #);
staticTextType: (# exit 13 #);
toggleButtonType: (# exit 14 #);
radioButtonType: (# exit 15 #);
checkBoxType: (# exit 16 #);
scrollbarType: (# exit 17 #);
editTextType: (# exit 18 #);
textFieldType: (# exit 19 #);
scrollListType: (# exit 20 #);
textScrollListType: (# exit 21 #);
windowType: (# exit 22 #);
menuType: (# exit 23 #);
menubarType: (# exit 24 #);
menuitemType: (# exit 25 #);
dynamicMenuitemType: (# exit 26 #);
verScrollbarType: (# exit 27 #);
verSeparatorType: (# exit 28 #);
rectType: (# exit 29 #);


parameters:
  (#
     <<SLOT parametersLib:Attributes>>;
     data: ^tableAtom;
     init:
       (# 
       <<SLOT parametersInit:DoPart>>
       #);
     type:
       (#
          value:
            @integer;
          
       enter (#  enter value <<SLOT parametersEnterType:DoPart>> #)
       exit
         (# 
         <<SLOT parametersExitType:DoPart>>
         exit value
         #)
       #);
     getBool:
       (# key: ^text; value: @boolean; 
       enter key[]
       <<SLOT parametersGetBool:DoPart>>
       exit value
       #);
     setBool:
       (# key: ^text; value: @boolean; 
       enter (key[],value)
       <<SLOT parametersSetBool:DoPart>>
       #);
     getInt:
       (# key: ^text; value: @integer; 
       enter key[]
       <<SLOT parametersGetInt:DoPart>>
       exit value
       #);
     setInt:
       (# key: ^text; value: @integer; 
       enter (key[],value)
       <<SLOT parametersSetInt:DoPart>>
       #);
     getText:
       (# key: ^text; value: ^text; 
       enter key[]
       <<SLOT parametersGetText:DoPart>>
       exit value[]
       #);
     setText:
       (# key: ^text; value: ^text; 
       enter (key[],value[])
       <<SLOT parametersSetText:DoPart>>
       #);
     copy:
       (# theCopy: ^parameters; 
       <<SLOT parametersCopy:DoPart>>
       exit theCopy[]
       #);
     set:
       (# theCopy: ^parameters; 
       enter theCopy[]
       <<SLOT parametersSet:DoPart>>
       #);
     find:
       (# key: ^text; value: ^atom
       enter key[]
       do key[]->data.lookup->value[]
       exit value[]
       #);
     define:
       (# key: ^text; value: ^atom
       enter (key[], value[])
       do (key[], value[]) -> data.define;
       #);
     
  #);
parameterStore:
  (#
     <<SLOT parameterStoreLib:Attributes>>;
     shortName:
       (# value: ^text; 
       <<SLOT parameterStoreShortName:DoPart>>
       exit value[]
       #);
     load:
       (#
          fileName: ^text;
          error:< (# msg: ^text;  enter msg[] do INNER ;  #);
          
       enter fileName[]
       <<SLOT parameterStoreLoad:DoPart>>
       #);
     create:
       (# fileName: ^text; 
       enter fileName[]
       <<SLOT parameterStoreCreate:DoPart>>
       #);
     save: (#  <<SLOT parameterStoreSave:DoPart>> #);
     autoSave:
       (# 
       <<SLOT paramterStoreAutoSave:DoPart>>
       #);
     deleteAutoSave: (#  <<SLOT parameterStoreDeleteAutoSave:DoPart>> #);
     get:
       (#
          ID: @integer;
          params: ^parameters;
          
       enter ID
       <<SLOT parameterStoreGet:DoPart>>
       exit params[]
       #);
     new:
       (# type: @integer; params: ^parameters; 
       enter type
       <<SLOT parameterStoreNew:DoPart>>
       exit params[]
       #);
     private:
       @<<SLOT parameterStorePrivate:Descriptor>>
  #);
  

-- parametersLib: Attributes --
position:
  (# x,y: @integer; 
  enter (#  enter (x,y) do ('x',x)->setInt; ('y',y)->setInt;  #)
  exit (#  do 'x'->getInt->x; 'y'->getInt->y;  exit (x,y) #)
  #);
size:
  (# width,height: @integer; 
  enter
    (# 
    enter (width,height)
    do ('width',width)->setInt; ('height',height)->setInt; 
    #)
  exit
    (# 
    do 'width'->getInt->width; 'height'->getInt->height; 
    exit (width,height)
    #)
  #);
bindLeft:
  (# value: @boolean; 
  enter (#  enter value do ('bindLeft',value)->setBool #)
  exit (#  do 'bindLeft'->getBool->value exit value #)
  #);
bindRight:
  (# value: @boolean; 
  enter (#  enter value do ('bindRight',value)->setBool #)
  exit (#  do 'bindRight'->getBool->value exit value #)
  #);
bindTop:
  (# value: @boolean; 
  enter (#  enter value do ('bindTop',value)->setBool #)
  exit (#  do 'bindTop'->getBool->value exit value #)
  #);
bindBottom:
  (# value: @boolean; 
  enter (#  enter value do ('bindBottom',value)->setBool #)
  exit (#  do 'bindBottom'->getBool->value exit value #)
  #);
visible:
  (# value: @boolean; 
  enter (#  enter value do ('visible',value)->setBool #)
  exit (#  do 'visible'->getBool->value exit value #)
  #);
hilite:
  (# value: @boolean; 
  enter (#  enter value do ('hilite',value)->setBool #)
  exit (#  do 'hilite'->getBool->value exit value #)
  #);
enabled:
  (# value: @boolean; 
  enter (#  enter value do ('enabled',value)->setBool #)
  exit (#  do 'enabled'->getBool->value exit value #)
  #);
borderStyle:
  (# value: @integer; 
  enter (#  enter value do ('border.style',value)->setInt #)
  exit (#  do 'border.style'->getInt->value exit value #)
  #);
borderVisible:
  (# value: @boolean; 
  enter (#  enter value do ('border.visible',value)->setBool #)
  exit (#  do 'border.visible'->getBool->value exit value #)
  #);
style:
  (# value: @integer; 
  enter (#  enter value do ('style',value)->setInt #)
  exit (#  do 'style'->getInt->value exit value #)
  #);
vertical:
  (# value: @boolean; 
  enter (#  enter value do ('vertical',value)->setBool #)
  exit (#  do 'vertical'->getBool->value exit value #)
  #);
label:
  (# value: ^text; 
  enter (#  enter value[] do ('label',value[])->setText #)
  exit (#  do 'label'->getText->value[] exit value[] #)
  #);
state:
  (# value: @boolean; 
  enter (#  enter value do ('state',value)->setBool #)
  exit (#  do 'state'->getBool->value exit value #)
  #);
scrollAmount:
  (# value: @integer; 
  enter (#  enter value do ('scrollAmount',value)->setInt #)
  exit (#  do 'scrollAmount'->getInt->value exit value #)
  #);
pageScrollAmount:
  (# value: @integer; 
  enter (#  enter value do ('pageScrollAmount',value)->setInt #)
  exit (#  do 'pageScrollAmount'->getInt->value exit value #)
  #);
maxValue:
  (# value: @integer; 
  enter (#  enter value do ('maxValue',value)->setInt #)
  exit (#  do 'maxValue'->getInt->value exit value #)
  #);
value:
  (# value: @integer; 
  enter (#  enter value do ('value',value)->setInt #)
  exit (#  do 'value'->getInt->value exit value #)
  #);
leftMargin:
  (# value: @integer; 
  enter (#  enter value do ('leftMargin',value)->setInt #)
  exit (#  do 'leftMargin'->getInt->value exit value #)
  #);
rightMargin:
  (# value: @integer; 
  enter (#  enter value do ('rightMargin',value)->setInt #)
  exit (#  do 'rightMargin'->getInt->value exit value #)
  #);
pixmapRead:
  (# value: ^text; 
  enter (#  enter value[] do ('thePixmap.read',value[])->setText #)
  exit (#  do 'thePixmap.read'->getText->value[] exit value[] #)
  #);
iconName:
  (# value: ^text; 
  enter (#  enter value[] do ('iconName',value[])->setText #)
  exit (#  do 'iconName'->getText->value[] exit value[] #)
  #);
showLabel:
  (# value: @boolean; 
  enter (#  enter value do ('showLabel',value)->setBool #)
  exit (#  do 'showLabel'->getBool->value exit value #)
  #);
title:
  (# value: ^text; 
  enter (#  enter value[] do ('title',value[])->setText #)
  exit (#  do 'title'->getText->value[] exit value[] #)
  #);
backgroundColor:
  (# red,green,blue: @integer; 
  enter
    (# 
    enter (red,green,blue)
    do ('red',red)->setInt; ('green',green)->setInt; ('blue',blue)->setInt; 
    #)
  exit
    (# 
    do 'red'->getInt->red; 'green'->getInt->green; 'blue'->getInt->blue; 
    exit (red,green,blue)
    #)
  #);
  

