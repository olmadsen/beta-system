ORIGIN '~beta/guienv/v1.6/guienv';
BODY 'private/asteditorbody';
INCLUDE '../prettyprinter/prettyprinter';
INCLUDE '../fragmenthandler/fragmenthandler';

-- guienvLib: attributes --

astEditorEnv:
  (# <<SLOT astEditorEnvLib: attributes>>;
     
     showParseErrors:<
       (# msg: ^text;
       enter msg[]
       do inner;
       #);
     
     pretty: ^astInterface.prettyPrinter;
     MPS: ^astInterface;
     theFragServer: ^fragmentServer;
     
     init:<
       (# 
       enter (theFragServer[], MPS[], pretty[])
       <<SLOT astEditorEnvInit: doPart>> 
       #);
     
     find:
       (# node: ^astInterface.AST;
          editor: ^astEditor;
       enter node[]
       <<SLOT astEditorEnvFind: doPart>>
       exit editor[]
       #);

     astEditor: window
       (* An editor allowing the user to 
        * edit an ast.
        *)
       (# <<SLOT astEditorLib: attributes>>;
          (* astControl: @astController
           *             (# 
           *                onChanged::<
           *                  (# <<SLOT AstEditorAstControlChanged: doPart>> #);
           *                onReplaced::<
           *                  (# <<SLOT AstEditorAstControlReplaced: doPart>> #);
           *                onDeleted::<
           *                  (# <<SLOT AstEditorAstControlDeleted: doPart>>  #);
           *                onAncestorReplaced::<
           *                  (# <<SLOT AstEditorAstControlAncestorReplaced: doPart>> #);
           *             #);
           *)
          node: ^astInterface.AST;
          readOnly: @boolean;
          obsolete:
            (# <<SLOT AstEditorObsolete: doPart>> #);
          dirty:
            (# value: @boolean;
            enter (# enter value <<SLOT EditorEnvAstEditorEnterDirty: doPart>> #)
            exit (# <<SLOT EditorEnvAstEditorExitDirty: doPart>> exit value #)
            #);
          parse:
            (# OK: @boolean;
            <<SLOT EditorEnvAstEditorParse: doPart>> 
            exit OK
            #);
          init:<
            (#
            enter node[]
            <<SLOT IBastEditorInit: doPart>>
            #);
          open::<
            (# 
            <<SLOT IBastEditorOpen: doPart>>
            #);
          eventHandler::<
            (# onAboutToClose::<
                 (# <<SLOT AstEditorEventHandlerOnBoutToClose: doPart>> #);
            #);
          close::<
            (# <<SLOT EditorEnvAstEditorClose: doPart>> #);
          private: @<<SLOT IBastEditorPrivate: descriptor>>;
       #); (* End of astEditor *)
     
     private: @<<SLOT astEditorEnvPrivate: descriptor>>;
  #);
