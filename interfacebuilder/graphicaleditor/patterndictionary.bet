ORIGIN '~beta/guienv/private/datastructures/sequence';
LIB_DEF 'frigg_patdict' '../../lib';

-- lib: attributes --

patternDictionary: sequence
  (# define:
       (# name: ^text;
          pat: ##object;
       enter (name[], pat##)
       do (name[], pat##) -> &element -> append;
       #);
     lookup:
       (# name: ^text;
          pat: ##object;
       enter name[]
       do search: scan
          (# 
          do (if name[] -> current.name.equalNCS then
                 current.pat## -> pat##;
                 leave search;
             if);
          #);
       exit pat##
       #);
     element::
       (# name: ^text;
          pat: ##object;
       enter (name[], pat##)
       exit THIS(element)[]
       #);
  #);
