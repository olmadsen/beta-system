ORIGIN 'graphicaleditorprivate';
LIB_ITEM 'frigg_graph';

-- graphicalEditorLib: Attributes --

abstractSelection:
  (#  do ('Custom',(selection.first).node[])->abstractNode;  #);
  

-- graphicalEditorFileMenu: Descriptor --
graphicalEditorMenu
  (#
     closeItem: @menuItem
       (#
          eventHandler:: 
            (#
               onStatus::  (#  do true->value;  #);
               onSelect:: 
                 (# 
                 do
                    (if THIS(graphicalEditor).theEventHandler.onAboutToClose
                     then
                        THIS(graphicalEditor).close; 
                    if);
                    
                 #);
               
            #);
          open::  (#  do 'Close'->name; 'w'->key; closeItem[]->append;  #);
          
       #);
     runItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onStatus::  (#  do true->value;  #);
               onSelect:: 
                 (# P: ##object; 
                 do
                    ((node.frag.father).fullName,THIS(guienv)[])
                      ->com.evaluateFile->P##;
                    (if P## <> none then
                        (if P## <= window## then P##->executeWindow if)
                    if);
                    
                 #);
               
            #);
          open::  (#  do 'Run'->name; ('r',true,true,false)->specialkey;  #);
          
       #);
     runInsideItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onStatus::  (#  do true->value;  #);
               onSelect:: 
                 (# P: ##object; 
                 do
                    ((node.frag.father).fullName,THIS(graphicalEditor)[])
                      ->com.evaluateFile->P##;
                    (if P## <> none then
                        (if P## <= window## then P##->executeWindow if)
                    if);
                    
                 #);
               
            #);
          open::  (#  do 'Run Inside Frigg'->name;  #);
          
       #);
     runCanvasItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onStatus::  (#  do true->value;  #);
               onSelect:: 
                 (# P: ##object; 
                 do
                    ((node.frag.father).fullName,THIS(graphicalEditor)[])
                      ->com.evaluateFile->P##;
                    (if P## <> none then
                        (if P## <= canvas## then P##->executeCanvas if)
                    if);
                    
                 #);
               
            #);
          open::  (#  do 'Run Canvas'->name;  #);
          
       #);
     saveItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onStatus::  (#  do true->value;  #);
               onSelect::  (#  do save;  #);
               
            #);
          open::  (#  do 'Save'->name; 's'->key;  #);
          
       #);
     open:: 
       (# 
       do
          'File'->name;
          saveItem.open;
          closeItem.open;
          (if com.dynamicCompilationAvailable then
              runItem.open; addSeparator; 
          if);
          
       #);
     
  #)  

-- graphicalEditorEditMenu: Descriptor --
graphicalEditorMenu
(# spk: @specialkeys;
   undoItem: @graphicalEditorItem
     (#
        eventHandler:: 
            (#
               onSelect::  (#  do undo;  #);
               onStatus:: 
                 (# t: ^text; 
                 do
                    (if canUndo then
                        'Undo '->t[];
                        undoText->t.append;
                        t[]->name;
                        true->value;
                        
                     else
                        'Undo'->name; false->value; 
                    if);
                    
                 #);
               
            #);
          open::  (#  do 'Undo'->name; 'Z'->key;  #);
          
       #);
     redoItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do redo;  #);
               onStatus:: 
                 (# t: ^text; 
                 do
                    (if canRedo then
                        'Redo '->t[];
                        redoText->t.append;
                        t[]->name;
                        true->value;
                        
                     else
                        'Redo'->name; false->value; 
                    if);
                    
                 #);
               
            #);
          open::  (#  do 'Redo'->name; 'y'->key;  #);
          
       #);
     cutItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.doCut;  #);
               onStatus::  (#  do not selection.empty->value;  #);
               
            #);
          open::  (#  do 'Cut'->name; 'X'->key;  #);
          
       #);
     copyItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.doCopy;  #);
               onStatus::  (#  do not selection.empty->value;  #);
               
            #);
          open::  (#  do 'Copy'->name; 'C'->key;  #);
          
       #);
     pasteItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do paste;  #);
               onStatus::  (#  do canPaste->value;  #);
               
            #);
          open::  (#  do 'Paste'->name; 'V'->key;  #);
          
       #);
     deleteItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.deleteAll;  #);
               onStatus::  (#  do not selection.empty->value;  #);
               
            #);
          open::  (#  do 'Delete'->name;  #);
          
       #);
     gridItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do changeGrid;  #);
               onStatus::  (#  do true->value;  #);
               
            #);
          open::  (#  do 'Grid...'->name;  #);
          
       #);
     findItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  #);
               onStatus::  (#  do false->value;  #);
               
            #);
          open::  (#  do 'Find...'->name;  #);
          
       #);
     findAgainItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  #);
               onStatus::  (#  do false->value;  #);
               
            #);
          open::  (#  do 'Find again'->name;  #);
          
       #);
     openSubEditorItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.openSubEditor;  #);
               onStatus::  (#  do selection.size >= 1->value;  #);
               
            #);
          open::  (#  do 'Show Source Code'->name; (spk.RIGHT,false,false,true)->specialkey;  #);
          
       #);
     inspectItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onStatus::  (#  do true->value;  #);
               onSelect::  (#  do thePropertyInspector.activate #);
               
            #);
          open::  (#  do 'Object Inspector'->name;   #);
          
       #);
     objectFitToContents: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.fitToContents;  #);
               onStatus::  (#  do not selection.empty->value;  #);
               
            #);
          open::  (#  do 'Fit to contents'->name;  #);
          
       #);
     abstractItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onStatus::  (#  do not selection.empty->value;  #);
               onSelect::  (#  do abstractSelection;  #);
               
            #);
          open::  (#  do 'Abstract'->name;  #);
          
       #);
     open:: 
       (# 
       do
          'Edit'->name;
          undoItem.open;
          redoItem.open;
          addSeparator;
          cutItem.open;
          copyItem.open;
          pasteItem.open;
          deleteItem.open;
          addSeparator;
          gridItem.open;
          addSeparator;
          openSubEditorItem.open;
          addSeparator;
          inspectItem.open;
          objectFitToContents.open;
          
       #);
     
  #)  

-- graphicalEditorAlignMenu: Descriptor --
graphicalEditorMenu
  (#
     alignLeftItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.alignLeft;  #);
               onStatus::  (#  do selection.size > 1->value;  #);
               
            #);
          open::  (#  do 'Left side'->name;  #);
          
       #);
     alignRightItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.alignRight;  #);
               onStatus::  (#  do selection.size > 1->value;  #);
               
            #);
          open::  (#  do 'Right side'->name;  #);
          
       #);
     alignTopItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.alignTop;  #);
               onStatus::  (#  do selection.size > 1->value;  #);
               
            #);
          open::  (#  do 'Top edge'->name;  #);
          
       #);
     alignBottomItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.alignBottom;  #);
               onStatus::  (#  do selection.size > 1->value;  #);
               
            #);
          open::  (#  do 'Bottom edge'->name;  #);
          
       #);
     alignHorCenterItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.alignHorCenter;  #);
               onStatus::  (#  do selection.size > 1->value;  #);
               
            #);
          open::  (#  do 'Vertical center'->name;  #);
          
       #);
     alignVerCenterItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.alignVerCenter;  #);
               onStatus::  (#  do selection.size > 1->value;  #);
               
            #);
          open::  (#  do 'Horizontal center'->name;  #);
          
       #);
     showSpacingDialogItem: @graphicalEditorItem
       (#
          eventHandler:: 
            (#
               onSelect::  (#  do selection.showSpacingDialog;  #);
               onStatus::  (#  do selection.size > 1->value;  #);
               
            #);
          open::  (#  do 'Spacing...'->name;  #);
          
       #);
     open:: 
       (# 
       do
          'Align'->name;
          alignLeftItem.open;
          alignRightItem.open;
          alignTopItem.open;
          alignBottomItem.open;
          alignHorCenterItem.open;
          alignVerCenterItem.open;
          addSeparator;
          showSpacingDialogItem.open;
          
       #);
     
  #)  

-- InterfaceBuilderGraphicalEditorWindowMenubarOpen: DoPart --
do
   THIS(graphicalEditor).private.theFileMenu.open;
   THIS(graphicalEditor).private.theFileMenu[]->append;
   THIS(graphicalEditor).private.theEditMenu.open;
   THIS(graphicalEditor).private.theEditMenu[]->append;
   THIS(graphicalEditor).private.theAlignMenu.open;
   THIS(graphicalEditor).private.theAlignMenu[]->append;
     

