ORIGIN '../graphicaleditor';
INCLUDE '../standardeditors'
        '../../guienvstuff/loadbitmap'
        '../../code/generate'
        '../../code/match';
-- factoryInstantiate: DoPart --
do
     (# inst: ^instantiator; theName: ^text; 
     do
        name.copy->theName[];
        theName.makeLC;
        theName[]->insts.lookup->inst[];
        (if inst[] <> none then
            theGraphicalEditor[]->inst->theWindowItemEditor[]; 
        if);
        
     #);
     

-- factoryLookup: DoPart --
do name[]->insts.lookup->theInstantiator[]  

-- factoryDefined: DoPart --
do
     (# theName: ^text; 
     do
        name.copy->theName[];
        theName.makeLC;
        (theName[]->insts.lookup) <> none ->value;
        
     #)  

-- instantiatorLib: Attributes --
makeScripts:
  (# scripts: ^scriptList
  do &scriptList[]->scripts[]; scripts.init; INNER
  exit scripts[]
  #);
makeInterfaceObjectScripts: makeScripts
  (# 
  do
     'onMouseUp'->scripts.append;
     'onMouseDown'->scripts.append;
     'onKeyDown'->scripts.append;
     'onRefresh'->scripts.append;
     'onActivate'->scripts.append;
     'onDeactivate'->scripts.append;
     INNER
  #);
makeWindowScripts: makeInterfaceObjectScripts
  (#  do 'onAboutToClose'->scripts.append; INNER #);
makeWindowItemScripts: makeInterfaceObjectScripts
  (# 
  do
     'onFrameChanged'->scripts.append;
     'onFatherFrameChanged'->scripts.append;
     'onEnableTarget'->scripts.append;
     'onDisableTarget'->scripts.append;
     'onHiliteChanged'->scripts.append;
     'onVisibleChanged'->scripts.append;
     'onEnableChanged'->scripts.append;
     INNER
  #);
makeCanvasScripts: makeWindowItemScripts
  (#  do 'onChildFrameChanged'->scripts.append; INNER #)  

-- factoryInit: DoPart --
do
   insts.init;
   ;
   (none ,'windowitem',&instantiator
      (# editorType:: theGraphicalEditor.windowItemEditor #)[],none ,none ,100,
   20)->insert;
   ('canvas'->loadbitmap,'canvas',&instantiator
   (#
      init:: (#  do makeCanvasScripts->scripts[] #);
      editorType:: theGraphicalEditor.canvasEditor;
   #)[],none ,'Standard',200,150)->insert;
   
   ('separatorh'->loadbitmap,'separator',&instantiator
   (# editorType:: theGraphicalEditor.separatorEditor #)[],none ,'Standard',
    100,4)->insert;
   ('separatorv'->loadbitmap,'separator-vertical',&instantiator
      (# editorType:: theGraphicalEditor.verSeparatorEditor #)[],none ,
    'Standard',4,100)->insert;
   ('scroller'->loadbitmap,'scroller',&instantiator
      (# editorType:: theGraphicalEditor.scrollerEditor #)[],
    '~beta/guienv/v1.6/fields','Standard',200,200)->insert;
   ('texteditor'->loadbitmap,'texteditor',&instantiator
      (# editorType:: theGraphicalEditor.textEditorEditor #)[],
    '~beta/guienv/v1.6/fields','Standard',200,200)->insert;
   ('textfield'->loadbitmap,'textfield',&instantiator
      (# editorType:: theGraphicalEditor.textFieldEditor #)[],
    '~beta/guienv/v1.6/fields','Standard',200,200)->insert;
   ('button'->loadbitmap,'pushbutton',&instantiator
      (# editorType:: theGraphicalEditor.pushButtonEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',60,20)->insert;
   ('iconbutton'->loadbitmap,'iconbutton',&instantiator
      (# editorType:: theGraphicalEditor.iconButtonEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',40,40)->insert;
   ('optionbutton'->loadbitmap,'optionbutton',&instantiator
      (# editorType:: theGraphicalEditor.optionButtonEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',150,40)->insert;
   ('radiobutton'->loadbitmap,'radiobutton',&instantiator
      (# editorType:: theGraphicalEditor.radioButtonEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',60,16)->insert;
   ('checkbox'->loadbitmap,'checkbox',&instantiator
      (# editorType:: theGraphicalEditor.checkBoxEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',60,16)->insert;
   ('scrollbar'->loadbitmap,'scrollbar',&instantiator
      (# editorType:: theGraphicalEditor.scrollbarEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',100,16)->insert;
   ('scrollbarv'->loadbitmap,'scrollbar-vertical',&instantiator
      (# editorType:: theGraphicalEditor.verScrollbarEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',16,100)->insert;
   ('edittext'->loadbitmap,'edittext',&instantiator
      (# editorType:: theGraphicalEditor.editTextEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',200,22)->insert;
   ('statictext'->loadbitmap,'statictext',&instantiator
      (# editorType:: theGraphicalEditor.staticTextEditor #)[],
    '~beta/guienv/v1.6/controls','Standard',60,16)->insert;
   ('scrolllist'->loadbitmap,'textscrolllist',&instantiator
      (# editorType:: theGraphicalEditor.textScrollListEditor #)[],
    '~beta/guienv/v1.6/scrolllists','Standard',150,200)->insert;
   (none ,'window',&instantiator
      (#
         init::  (#  do makeWindowScripts->scripts[] #);
         editorType:: theGraphicalEditor.windowEditor
      #)[],none ,none ,300,200)->insert;
   ;
   ('canvas'->loadbitmap,'windowitem',&instantiator
      (# editorType:: theGraphicalEditor.windowItemEditor #)[],none ,'Abstract',
    100,50)->insert;
     

-- instantiatorCopyName: DoPart --
do
     (# type: ##instantiator
     do
        THIS(instantiator)##->type##;
        &type[]->copy[];
        newName[]->copy.name[];
        none ->copy.path[];
        scripts[]->copy.scripts[];
        icon[]->copy.icon[];
        width->copy.width;
        height->copy.height
     #)  

-- instantiatorScanAttributes: DoPart --
do
     (#
        theAttributes: ^astInterface.beta.attributes;
        partObjectProto: ^astInterface.AST
     do
        5->trace (#  do 'instantiator.scanAttributes'->xT #);
        (if node[] <> none then
            node[]->betaGram.getAttributes->theAttributes[];
            (if theAttributes[] <> none then
                5->trace (#  do 'has attributes'->xT #);
                (makeFragmentForm,
                 '<<nameDcl>>: @ <<prefix>> (# <<attributes>> #)',
                 betaGram.simpleDecl)->parseText->partObjectProto[];
                theAttributes.newScan
                  (# 
                  do
                     5->trace (#  do '.'->xT #);
                     (if (mps[],current[],partObjectProto[])->match then
                         5->trace (#  do 'does match'->xT #);
                         current[]->whenPartObject
                     if)
                  #)
            if)
        if)
     #)  

-- instantiatorInit: DoPart --
do makeWindowItemScripts->scripts[]; INNER  

