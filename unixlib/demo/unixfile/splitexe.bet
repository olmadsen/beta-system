ORIGIN '~beta/unixlib/v1.5/unixfile';
---- PROGRAM: descriptor ----

(* A simple example of using UnixFile: The file 'input' is read word by word,
 * and each word is printed on the output file specified on the command line.
 * This output file has been opened with OpenExeWrite, mening that the resulting
 * file will be executable.
 * After this, the output file is opened again, this time with OpenExeAppend,
 * meaning that the output file will be executable after the line of text
 * has been appended to it.
 *)

(# inFile, outFile: @ unixfile;
do (if noOfArguments <> 2 //true then
       'Usage: ' -> puttext; 1->arguments->puttext; ' out-file' -> putline;
       stop;
   if);
   2 -> arguments -> outFile.name;
   outFile.OpenExeWrite;
   
   'input' -> inFile.name;
   inFile.OpenRead;
   
   readFile: 
     (# 
     do (if inFile.eos
         // false then 
            inFile.getAtom -> outFile.putText;
            outFile.newLine;
            restart readFile
         // true then
            leave readFile
        if)
     #);
   inFile.close;
   outFile.close;
   
   (* Now we'll append a little too *)
   outfile.OpenExeAppend;
   'This is one line appended' -> outfile.puttext;
   outfile.newline;
#)
