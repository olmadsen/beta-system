ORIGIN '~beta/basiclib/v1.6/directory';
BODY 'private/unixdirectory_body';

(* idx=2 *)
INCLUDE 'unixfile';
---- LIB: attributes ----

unixdirectory: directory
  (* BETA interface to disk files in UNIX *)
  (#
     <<SLOT UnixDirectoryLib: attributes>>;
     
     EntryDesc::< UnixEntry;
     
     (* idx+ *)
     findEntry: dirFindEntry
       (#
          foundDesc::< UnixEntry;
          foundFile::< UnixFile;
          foundDir::< UnixDirectory;
          (* idx+ *)     
          select: dirselect
            (# whenSocket:<       (# do INNER #);
               whenSymboliclink:< (# do INNER #);
               whenCharSpecial:<  (# do INNER #);
               whenBlockSpecial:< (# do INNER #);
       
               selectImpl::< (* private *)
                 (# <<SLOT UnixDirFindDispatch:dopart>> #)
            #);
          do INNER
       #);
     (* idx- *)
     scanEntries: dirScanEntries
       (#
          foundDesc::< UnixEntry;
          foundFile::< UnixFile;
          foundDir::< UnixDirectory;
          (* idx+ *)
          select: dirselect
            (# whenSocket:<       (# do INNER #);
               whenSymboliclink:< (# do INNER #);
               whenCharSpecial:<  (# do INNER #);
               whenBlockSpecial:< (# do INNER #);
          
               selectImpl::< (* private *)
                 (# <<SLOT UnixDirScanDispatch:dopart>> #)
            #);
       do INNER
       #);
     (* idx- *) (* idx- *)   
  #)


(* Instead of scanEntries and findEntry being virtual (i.e. virtual
 * prefixes):
 *)
---- DirectoryLib: attributes ----
dirFindEntry: findEntry(# do INNER #);
dirScanEntries: scanEntries(# do INNER #);

---- DirFindLib: attributes ----
dirSelect: select(##);

---- DirScanLib: attributes ----
dirSelect: select(##);
