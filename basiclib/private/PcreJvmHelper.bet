ORIGIN '~beta/basiclib/betaenv';
INCLUDE '~beta/javalib/java/lang/String';

BUILD jvm '$(BETALIB)/javalib/jvm/$(objdir)/$(DYNPREFIX)PcreJvmHelper.$(DYNEXTENSION)' 'external/PcreJvmHelper.c' 'jvm/beta_PcreJvmHelper.h' 'external/pcre_beta.c' 'external/pcre/maketables.c' 'external/pcre/get.c' 'external/pcre/study.c' 'external/pcre/pcre.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h' 'betacc -G -v -I . -I external -I jvm -I "$(JAVAHOME)/include" -I "$(JAVAHOME)/include/$(JNIDIR)" $0 $1';

BUILD jvm 'jvm/beta_PcreJvmHelper.h' 'jvm/beta/PcreJvmHelper.class' 'javah -jni -d jvm -classpath jvm beta.PcreJvmHelper';

BUILD jvm 'jvm/beta/PcreJvmHelper.class' 'PcreJvmHelper.java' 'javac -classpath jvm -d jvm $1';

INCLUDE '~beta/javalib/java/lang/String';

--LIB: attributes--

PcreJvmHelper: ExternalClass
  (# 
     (* static methods *)
     initialize: static_proc
       (# result: [3]@integer; (* compiled_regexp, extra, subpatterns *)
          exp: ^String;
          options: @integer;
       enter (exp[],options)
       exit result[]
       #);
     
     exec: static_proc
       (# result, _code, extra, length, startoffset, options, ovecsize: @int32;
          subject: ^String;
          ovector: [0]@int32;
       enter (_code, extra, subject[], length, startoffset, options, ovector[], ovecsize)
       exit result
       #);
     
  do 'beta/PcreJvmHelper' -> classname;
  #);
