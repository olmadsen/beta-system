ORIGIN '~beta/basiclib/betaenv';
INCLUDE '~beta/dotnetlib/System/String';

BUILD clr 'clr/PcreDLL.dll' 'external/PcreDLL.c' 'external/PcreDLL.def' 'cl -nologo -Fe$0 -Zi -LD $1 -link -DEF:$2';
BUILD clr 'clr/PcreClrWrapper.dll' 'PcreClrWrapper.cs' 'csc -nologo -debug:full -t:library -out:$0 $1';

--LIB: attributes--

PcreClrWrapper: ExternalClass
  (# 
     (* static methods *)
     compile: static_proc
       (# pattern: ^String;
          options, tableptr, result: @int32;
       enter (pattern[], options, tableptr)
       exit result
       #);

     locale_compile: static_proc
       (# pattern: ^String;
          options, tableptr, result: @int32;
       enter (pattern[], options)
       exit result
       #);

     study: static_proc
       (# result, _code, options: @int32;
       enter (_code, options)
       exit result
       #);
     
     full_info: static_proc
       (# results: [2]@int32 (* where, returnvalue *);
          _code, extra, what: @int32;
       enter (_code, extra, what)
       exit results[]
       #);
     
     pcre_exec: static_proc
       (# result, _code, extra, length, startoffset, options, ovecsize: @int32;
          subject: ^String;
          ovector: [0]@int32;
       enter (_code, extra, subject[], length, startoffset, options, ovector[], ovecsize)
       exit result
       #);
     
     last_error: static_proc
       (# result: ^String
       exit result[]
       #);
     
     last_error_offset: static_proc
       (# result: @int32;
       exit result
       #);
     
  do '[PcreClrWrapper]PcreClrWrapper'->classname;
  #);

