ORIGIN '../betaenvold'

--betaenvTextCopyAppend: descriptor--
(# i:@integer;
do &text[]->T1[];
   T[1:lgth] -> T1;
   (if T2[] <> NONE 
    // true then
       T2.length -> T1.T.extend;
       T2.scanAll(# do ch->T1.T[(i+1->i)+lgth] #);
       T1.T.range -> T1.lgth -> T1.pos;
   if)
#)

--betaenvTextCopyPrepend: descriptor--
(# i: @integer;
   range: @integer;
do &text[]->T1[];
   (if T2[] // NONE then T -> T1;
    else
       T2.lgth+lgth -> range;
       (if range>T1.lgth // true then range -> T1.T.new if);
       (* copy T2 to T1 *)
       (for i: T2.lgth repeat T2.T[i]->T1.T[i] for);
       (* copy this(text) to T1 *)
       0 -> i;
       scanAll(# do ch->T1.T[(i+1->i)+T2.lgth] #);
       range -> T1.lgth;
       range -> T1.pos;
   if)
#)

--betaenvTextFindCh:dopart--
do (for i: lgth repeat
        (if T[i->inx] // ch then INNER FindCh if)
   for)
