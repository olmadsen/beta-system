ORIGIN '../file';
MDBODY mac     'file_macbody'
       ppc     'file_macbody'
       ppcmac  'file_macbody'
       nti     'file_ntbody'
       default 'file_unixbody'
(*
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1986-96
 *       All rights reserved.
 * 
 * This fragment group contains the machine independent
 * implementation parts of files
 *)

--DiskEntryModtimeException: dopart--
do 'Examination/setting of disk entry modtime failed.\n' -> msg.append; INNER

--DiskEntryExistsException: dopart--
do 'Test for disk entry existence failed.\n' -> msg.append;  INNER

--DiskEntryTouchException: dopart--
do 'Touch of disk entry failed.\n' -> msg.append; INNER

--DiskEntryRenameException: dopart--
do 'Rename of disk entry failed.\n' -> msg.append; INNER


-- FileLib: attributes --
     
FileNameMsg: 
  (# m: ^Text 
  enter m[]
  do 'File exception for ''' -> m.putText; 
     name -> m.putText; ''''->m.put; M.newline
  #);

DoOpen: 
  (# name: ^text;
     mode: @integer; (* The constant used by open system call.   *)
     exe: @boolean;  (* If file is created, whether to give exe perm. *)
     op: @<<SLOT FileDoOpen: descriptor>>
  enter(name[],mode,exe)
  do INNER; op
  #);

---- FileException: dopart ----
do (if m[]<>NONE then m[]->msg.putLine if);
   msg[] -> FileNameMsg;
   INNER;

---- FileOpenException: dopart----
do 'Cannot open file'->msg.putLine; INNER;

---- FileAccessException: dopart----
do 'Insufficient access privilegies'->msg.putLine; INNER;

---- FileWriteException: dopart----
do 'Write block error'->msg.putLine; INNER;

---- FileReadException: dopart----
do 'Read block error'->msg.putLine; INNER;

---- FileEOSException: dopart----
do msg[]->fileNameMsg; INNER;

---- FileNoSuchException: dopart----
do 'No such file'->msg.putLine; INNER;

---- FileExistsException: dopart----
do 'File exists'->msg.putLine; INNER;

---- FileDiskFullException: dopart----
do 'File system is full'->msg.putLine; INNER;

---- FileReadName: dopart ----
do Keyboard.getatom -> entry.path
