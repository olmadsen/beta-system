ORIGIN '../repstream';
LIB_ITEM 'repstream';
(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1984-96
 *       All rights reserved.
 *
 *)

--- RepStreamgetTextBody:descriptor ---
(# l: @Integer;
do
   &text[] -> t[];
   getInt -> l;
   (# x: [l]@char
   do (for i: l repeat 
           top*4+i-1 -> r.%getByte -> x[i] 
           (* Above line tos_converted from: (r,top*4+i-1) -> TOS'%inxGetByte' -> x[i] *)
      for);
      top+(l-1) div 4+1 -> top;
      x -> t
   #);
#)

--- RepStreamputTextBody: descriptor ---
(# l: @Integer;
do
   (if t[]=NONE then 0 -> l else t.length -> l if);
   l -> putInt;
   (if (top+(l-1) div 4+1 >=r.range)
       then 1000+top+(l-1) div 4+1 -> extend
   if);
   (for i: l repeat 
        (t.t[i], top*4+i-1) -> r.%putByte 
        (* Above line tos_converted from: (r,top*4+i-1,t.t[i]) -> TOS'%inxPutByte' *)
   for);
   top+(l-1) div 4+1 -> top;
#)
