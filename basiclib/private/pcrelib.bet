ORIGIN '../betaenv';
INCLUDE '../external'; 
INCLUDE '~beta/sysutils/cstring.bet';
BUILD nti     '$$/pcre_beta.obj' 'external/pcre_beta.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
              'betacc -D STATIC $0 $1'
      nti     '$$/maketables.obj' 'external/pcre/maketables.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
              'betacc -D STATIC $0 $1'
      nti     '$$/get.obj' 'external/pcre/get.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
              'betacc -D STATIC $0 $1'
      nti     '$$/study.obj' 'external/pcre/study.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
              'betacc -D STATIC $0 $1'
      nti     '$$/pcre.obj' 'external/pcre/pcre.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
              'betacc -D STATIC $0 $1'
      ppcmac  ':$$:pcre_beta.obj' ':external:pcre_beta.c' ':external:pcre:internal.h' ':external:pcre:pcreposix.h' ':external:pcre:pcre.h' ':external:pcre:config.h'
	      'MrC -ansi relaxed -D MAC -D __STDC__ -I :external:pcre: -shared_lib_export on -o $0 $1'
      ppcmac  ':$$:maketables.obj' ':external:pcre:maketables.c' ':external:pcre:internal.h' ':external:pcre:pcreposix.h' ':external:pcre:pcre.h' ':external:pcre:config.h'
	      'MrC -D MAC -D __STDC__ -proto strict -shared_lib_export on -o $0 $1'
      ppcmac  ':$$:get.obj' ':external:pcre:get.c' ':external:pcre:internal.h' ':external:pcre:pcreposix.h' ':external:pcre:pcre.h' ':external:pcre:config.h'
	      'MrC -D MAC -D __STDC__ -proto strict -shared_lib_export on -o $0 $1'
      ppcmac  ':$$:study.obj' ':external:pcre:study.c' ':external:pcre:internal.h' ':external:pcre:pcreposix.h' ':external:pcre:pcre.h' ':external:pcre:config.h'
	      'MrC -D MAC -D __STDC__ -proto strict -shared_lib_export on -o $0 $1'
      ppcmac  ':$$:pcre.obj' ':external:pcre:pcre.c' ':external:pcre:internal.h' ':external:pcre:pcreposix.h' ':external:pcre:pcre.h' ':external:pcre:config.h'
	      'MrC -D MAC -D __STDC__ -proto strict -shared_lib_export on -o $0 $1'
      default '$$/pcre_beta.o' 'external/pcre_beta.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
	      '$CC -c -o $0 $1'
      default '$$/maketables.o' 'external/pcre/maketables.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
	      '$CC -c -o $0 $1'
      default '$$/get.o' 'external/pcre/get.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
	      '$CC -c -o $0 $1'
      default '$$/study.o' 'external/pcre/study.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
	      '$CC -c -o $0 $1'
      default '$$/pcre.o' 'external/pcre/pcre.c' 'external/pcre/internal.h' 'external/pcre/pcreposix.h' 'external/pcre/pcre.h' 'external/pcre/config.h'
	      '$CC -c -o $0 $1'
(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1992-2000
 *       All rights reserved.
 *)

--- lib: attributes ---
slash: (#exit '\\' #);

locale_pcre_compile: external
  (* pcre *pcre_compile(const char *pattern, int options,
   *        const char **errptr, int *erroffset)
   * 
   * This calls pcre_compile with the local character tables.  Added for
   * BETA because we don't have class variables (static members).
   *)
  (# pattern: @integer;
     options: @integer;
     errptr: @integer;
     erroffset: @integer;
     tableptr: @integer;
     compiled_pattern: @integer;
  enter (pattern, options, errptr, erroffset)
  do 'locale_pcre_compile'->callC   
  exit compiled_pattern
  #);

pcre_compile: external
  (* pcre *pcre_compile(const char *pattern, int options,
   *        const char **errptr, int *erroffset, const unsigned char *tableptr)
   * 
   * This compiles the regexp (given in pattern and null-terminated).  See
   * PCRE doc.
   *)
  (# pattern: @integer;
     options: @integer;
     errptr: @integer;
     erroffset: @integer;
     tableptr: @integer;
     compiled_pattern: @integer;
  enter (pattern, options, errptr, erroffset, tableptr)
  do 'pcre_compile'->callC   
  exit compiled_pattern
  #);

pcre_study: external
  (* pcre_extra *pcre_study(const pcre *re, int options, const char **errptr);
   * 
   *)
  (# re: @integer;
     options: @integer;
     errptr: @integer;
     extra: @integer;
  enter (re, options, errptr)
  do 'pcre_study'->callC   
  exit extra
  #);

pcre_exec: external
  (* int pcre_exec(const pcre *re, const pcre_extra *extra,
   *     const char *subject, int length, int startoffset, int options,
   *     int *ovector, int ovecsize); 
   * 
   *)
  (# re: @integer;
     extra: @integer;
     subject: @integer;
     length: @integer;
     startoffset: @integer;
     options: @integer;
     ovector: @integer;
     ovecsize: @integer;
     status: @integer;
  enter (re, extra, subject, length, startoffset, options, ovector, ovecsize)
  do 'pcre_exec'->callC   
  exit status
  #);

pcre_copy_substring: external
  (* int pcre_copy_substring(const char *subject, int *ovector, int stringcount,
   *     int stringnumber, char *buffer, int buffersize); 
   * 
   *)
  (# subject: @integer;
     ovector: @integer;
     stringcount: @integer;
     stringnumber: @integer;
     buffer: @integer;
     buffersize: @integer;
     status: @integer;
  enter (subject, ovector, stringcount, stringnumber, buffer, buffersize)
  do 'pcre_copy_substring'->callC   
  exit status
  #);

pcre_get_substring: external
  (* int pcre_get_substring(const char *subject, int *ovector, int stringcount,
   *     int stringnumber, const char **stringptr);
   * 
   *)
  (# subject: @integer;
     ovector: @integer;
     stringcount: @integer;
     stringnumber: @integer;
     stringptr: @integer;
     status: @integer;
  enter (subject, ovector, stringcount, stringnumber, stringptr)
  do 'pcre_get_substring'->callC   
  exit status
  #);

pcre_get_substring_list: external
  (* int pcre_get_substring_list(const char *subject, int *ovector,
   *     int stringcount, const char ***listptr);
   * 
   *)
  (# subject: @integer;
     ovector: @integer;
     stringcount: @integer;
     listptr: @integer;
     status: @integer;
  enter (subject, ovector, stringcount, listptr)
  do 'pcre_get_substring_list'->callC   
  exit status
  #);

pcre_maketables: external
  (* const unsigned char *pcre_maketables(void);
   * 
   *)
  (# tables: @integer;
  do 'pcre_maketables'->callC   
  exit tables
  #);

pcre_fullinfo: external
  (* int pcre_fullinfo(const pcre *re, const pcre_extra *extra, int what,
   *     void *where); 
   * 
   *)
  (# re: @integer;
     extra: @integer;
     what: @integer;
     where: @integer;
     status: @integer;
  enter (re, extra, what, where)
  do 'pcre_fullinfo'->callC   
  exit status
  #);

pcre_info: external
  (* int pcre_info(const pcre *re, int *optptr, int *firstcharptr);
   * 
   *)
  (# re: @integer;
     optptr: @integer;
     firstcharptr: @integer;
     status: @integer;
  enter (re, optptr, firstcharptr)
  do 'pcre_info'->callC   
  exit status
  #);

pcre_version: external
  (* char *pcre_version(void);
   * 
   *)
  (# version: @integer;
  do 'pcre_info'->callC   
  exit version
  #);
