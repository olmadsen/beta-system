ORIGIN '../betaenv';
INCLUDE '../systemenv'
---program:descriptor--
SystemEnv
(# 
   S: @ | System
     (# C1: @ | System
           (#
           do cycle(#do '1'->put; R1.get; '2'->put; R1.put #);
           #);
        C2: @ | System
           (#
           do cycle(#do 'a'->put; R2.get; 'b'->put; R2.put #)
           #)
     do alt(#do C1[]->start; C2[]->start #)
     #);
   Rtype: System
     (# get: p1.entry(#do x->screen.put; #); p1: @port;
        put: p2.entry(#do y->screen.put; #); p2: @port;
	x,y: @char
     do cycle(#do p1.accept; p2.accept #)
     #);
   R1: @ | Rtype;
   R2: @ | Rtype;

do '('->R1.x; ')'->R1.y; '['->R2.x; ']'->R2.y;
   conc(#do S[]->start; R1[]->start; R2[]->start #)
#)
