ORIGIN '../../substreams';
INCLUDE '../../formatio';
INCLUDE 'tstenv'
--- program:descriptor ---
tstenv
(# putSubstream: @t.putsubstream;
   tests::<
     (#
     do 'abcdefghijklmnopqrstuvwxyABCDEFGHIJKLMNOPQRSTUVWXYZ123456789'->value
     #);
   t1, t2: ^text;
   st, stCopy: ^subtext;
do 'hello world'->t1[];
   (7,11)->t1.subtxt->st[];
   
   ('a','hello world')->tst(# do t1[]->puttext #);
   ('b','world')->tst(# do st[]->putSubstream #);
   
   ('c','hello worxd')->tst(# do 3->st.setpos; 'x'->st.put; t1[]->puttext #);
   ('d','worx4')->tst(# do 4->st.putint; st[]->putSubstream #);
   
   'worx4'->t2[];
   ('e',true)->tstBool(# do t2[]->st.equal->value #);
   'wory4'->t2[];
   ('f',false)->tstBool(# do t2[]->st.equal->value #);
   'worx4x'->t2[];
   ('g',false)->tstBool(# do t2[]->st.equal->value #);
   'worx'->t2[];
   ('h',false)->tstBool(# do t2[]->st.equal->value #);
   'Worx4'->t2[];
   ('i',true)->tstBool(# do t2[]->st.equalNCS->value #);
   'Wory4'->t2[];
   ('j',false)->tstBool(# do t2[]->st.equalNCS->value #);
   'Worx4a'->t2[];
   ('k',false)->tstBool(# do t2[]->st.equalNCS->value #);
   'Worx'->t2[];
   ('l',false)->tstBool(# do t2[]->st.equalNCS->value #);
   
   'worx4'->t2[];
   ('m',false)->tstBool(# do t2[]->st.less->value #);
   'worx'->t2[];
   ('n',true)->tstBool(# do t2[]->st.less->value #);
   'worx4y'->t2[];
   ('o',false)->tstBool(# do t2[]->st.less->value #);

   'worx4'->t2[];
   ('p',false)->tstBool(# do t2[]->st.greater->value #);
   'worx'->t2[];
   ('q',false)->tstBool(# do t2[]->st.greater->value #);
   'worx4y'->t2[];
   ('r',true)->tstBool(# do t2[]->st.greater->value #);
   
   st.makeUC;
   'WORX4'->t2[];
   ('s',true)->tstBool(# do t2[]->st.equal->value #);
   st.makeLC;
   'worx4'->t2[];
   ('t',true)->tstBool(# do t2[]->st.equal->value #);
   
   'w'->st.findAll
   (# do ('u',1)->tstInt(# do inx->value #) #);
   'r'->st.findAll
   (# do ('v',3)->tstInt(# do inx->value #) #);
   '4'->st.findAll
   (# do ('w',5)->tstInt(# do inx->value #) #);

   2->st.setpos;
   ('x','rx4')->tst(# do st.scan(# while::< (# do true->value #) do ch->put #) #);
   ('y','worx4')->tst(# do st.scanAll(# do ch->put #) #);
   
   ('A','w')->tstChar(# do 1->st.inxGet->value #);
   ('B','o')->tstChar(# do 2->st.inxGet->value #);
   ('C','4')->tstChar(# do 5->st.inxGet->value #);
   ('D','q')->tstChar(# do ('q',1)->st.inxPut; 1->st.inxGet->value #);
   ('E','q')->tstChar(# do ('q',2)->st.inxPut; 2->st.inxGet->value #);
   ('F','q')->tstChar(# do ('q',5)->st.inxPut; 5->st.inxGet->value #);
   
   ('G',1)->tstInt(# do 1->st.setpos; st.getPos->value #);
   ('H',3)->tstInt(# do 3->st.setpos; st.getPos->value #);
   ('I',5)->tstInt(# do 5->st.setpos; st.getPos->value #);
   
   ('J','q')->tstChar(# do 0->st.setpos; st.peek->value #);
   ('K','r')->tstChar(# do 2->st.setpos; st.peek->value #);
   ('L','q')->tstChar(# do 4->st.setpos; st.peek->value #);
   
   ('M',false)->tstBool(# do 0->st.setpos; st.eos->value #);
   ('N',false)->tstBool(# do 2->st.setpos; st.eos->value #);
   ('O',true)->tstBool(# do 5->st.setpos; st.eos->value #);
   
   ('P',false)->tstBool(# do st.empty->value #);
   ('Q','')->tst(# do st.clear; st[]->putSubstream #);
   ('R','hello ')->tst(# do t1[]->puttext #);
   ('S',true)->tstBool(# do st.empty->value #);
   
   ('T','world')->tst(# do ('world',0)->st.insert; st[]->putSubstream #);
   ('U','hello world')->tst(# do t1[]->puttext #);
   
   ('V',3)->tstInt(# do 3->st.setpos; ('xx',5)->st.insert; st.getpos->value #);
   ('W',3)->tstInt(# do 3->st.setpos; ('xx',3)->st.insert; st.getpos->value #);
   ('X',5)->tstInt(# do 3->st.setpos; ('xx',2)->st.insert; st.getpos->value #);
   ('Y','woxxrxxldxx')->tst(# do st[]->putSubstream #);
   
   ('Z',4)->tstInt(# do 4->st.setpos; (10,11)->st.delete; st.getpos->value #);
   ('1',4)->tstInt(# do 4->st.setpos; (4,7)->st.delete; st.getpos->value #);
   ('2',3)->tstInt(# do 4->st.setpos; (3,4)->st.delete; st.getpos->value #);
   ('3','wod')->tst(# do st[]->putSubstream #);
   
   ('4','woddy')->tst(# do 'dy'->st.append; st[]->putSubstream #);
   ('5',3)->tstInt(# do st.getpos->value #);
   
   ('6','dear woddy')->tst(# do 'dear '->st.prepend; st[]->putSubstream #);
   ('7',8)->tstInt(# do st.getpos->value #);
   
   ('8','hello dear woddy')->tst(# do t1[]->puttext #);
   
   ('9','dear woddy')->tst(# do (st.copy)->stCopy[]; stCopy[]->putSubstream #);
#)
