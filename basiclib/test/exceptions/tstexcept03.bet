ORIGIN '~beta/basiclib/betaenv';
INCLUDE '~beta/basiclib/private/systemExceptionHandler';

-- program: descriptor --
(# z: (# x:^object 
      do x 
      #); (* RefNoneErr: Reference is none *)
   a: @|z(##);
   
do runtimeExceptionHandler##->InstallSystemExceptionHandler;
   try
   (#
      name:: (# do 'refNoneTry'->n[] #);
      handler:: 
        (# 
        do when (# type:: refNoneException
                do 'refNoneTry handler... aborting'->putline;
                   abort;
                #);
        #);
   do a 
   #);
#)

(* stack layout at dump time:
 * 
 *   |    main            |
 *   |____________________|
 *   |                    |
 *   |    M1BETAENV       |
 *   |____________________|
 *   |                    |
 *   |    M1PROGRAM       |
 *   |____________________|
 *   |                    |
 *   |    Att             |
 *   |____________________|
 *   |                    |
 *   |    M2PROGRAM       |
 *   |____________________|
 *)
