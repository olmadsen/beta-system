ORIGIN '~beta/basiclib/v1.4/endian'
(* OBS! This program has NOT yet been tested on a big endian machine *)
---program:descriptor--
(# X,Y: @integer; R: [6] @integer
do  0x01020304->X; 
   (if isBigEndian//true then
       'I am BIG'->putline;
       (if X->TOS'%getByte[0]'//1 then 'a'->put else '!'->put if);
       @@X->byteSwapLong;
       (if X->TOS'%getByte[0]'//4 then 'b'->put else '!'->put if);
       @@X->byteSwapShort;
       (if X->TOS'%getByte[0]'//3 then 'c'->put else '!'->put if);
    else
       'I am small'->putline;
       (if X->TOS'%getByte[0]'//4 then 'a'->put else '!'->put if);
       @@X->byteSwapLong;
       (if X->TOS'%getByte[0]'//1 then 'b'->put else '!'->put if);
       @@X->byteSwapShort;
       (if X->TOS'%getByte[0]'//2 then 'c'->put else '!'->put if);

   if);
   '\n\nLinear byte sequence:\n'->puttext;
   (for i: R.range*4 repeat  (R,i-1,'a'-1+i)->TOS'%inxPutByte' for);
   (for I: R.range repeat 
        R[i]->TOS'%getByte[0]'->put;
        R[i]->TOS'%getByte[1]'->put;
        R[i]->TOS'%getByte[2]'->put;
        R[i]->TOS'%getByte[3]'->put;   
        newline
   for);
   '\nByte sequence swapped pr. long:\n'->puttext;
   (for i: R.range repeat @@R[i]->byteSwapLong for);
   (for I: R.range repeat 
        R[i]->TOS'%getByte[0]'->put;
        R[i]->TOS'%getByte[1]'->put;
        R[i]->TOS'%getByte[2]'->put;
        R[i]->TOS'%getByte[3]'->put;   
        newline
   for);
   '\nByte sequence swapped pr. second short:\n'->puttext;
   (for i: R.range repeat @@R[i]->byteSwapShort for);
   (for I: R.range repeat 
        R[i]->TOS'%getByte[0]'->put;
        R[i]->TOS'%getByte[1]'->put;
        R[i]->TOS'%getByte[2]'->put;
        R[i]->TOS'%getByte[3]'->put;   
        newline
   for);

   (* R[2] =  e + f + g + h ->
    *         h + g + f + e ->
    *         g + h + f + e
    *)
   (if isLittleEndian//true then
       (if R[2]// 'e'*256*256*256 + 'f'*256*256 + 'h'*256 + 'g' then
           '\nOK:'->puttext
        else '\nNON OK:'->puttext
       if);
       'I am still small'->putline
    else
       (if R[2]// 'g'*256*256*256 + 'h'*256*256 + 'f'*256 + 'e' then
           'OK:'->puttext
        else '\nNON OK:'->puttext
       if);
       '\nI am still BIG'->putline       
   if)
#)
