
Release 4.0.2
=============

In r4.0.2, the following changes were introduced:

Introduced use of BUILD instead of OBJFILE+MAKE.

Release 4.0.1
=============

In r4.0.1, the following changes were introduced:

Added file mbs_version.bet which decribes the current version
of the Mjolner BETA System in various ways.

iget is now implemented for windows NT/95.

Corrected an error in rexexp_replace_global and
regexp_replace_literally_global

Added rexexp_replace_global and regexp_replace_literally_global
operations to regexp.bet.
 
Added timedate fragment (incl. private, demo and test files).

Corrected a potentual GC problem related to @@ in regexpbody.bet

Also corrected getNumber, such that '4.' no longer is a legal real.

private/basicsystemenv_unixbody.bet was renamed to 
private/basicsystemenv_unix.bet, and correspondingly for nti
and mac.

Version 1.5
===========

In v1.5, the following changes were introduced:

NEW exception pattern in betaenv.bet:
=====================================

A new exception pattern have been introduced in betaenv.  This new
exception pattern in backward compatible with the betaenv/v1.4
exception pattern.

The new exception pattern allows a more flexible ecxception handling
since it allows for the definition of a family of exception, that can
be handled individually, or jointly by a default handler.

NEW betaenvold.bet:
==================

New fragment, containing copyappend, copyprepend and findch to enable
backward compatability with pre-v1.5 betaenv.

regexp.bet:
==========

Corrected a bug (repetition index out of range), that appeared when
either the regexp string or the search text were empty (changed in
regexplib.bet).

basicsystemenv.bet:
==================

Changed the implementation of restrictedPort and objectPort such
that they in fact implements the proper semantics (major faults
in the pre-v1.5 versions).

NEW textUtils.bet
==================

This fragment implements various utility functions on text: 
	set, setText, setInt, setBased, setReal, setBoolean,
	getBoolean, putBoolean

NEW substreams.bet
==================

This fragment implements substream and subtext patterns.

file.bet:
=========

Made DiskEntry.modtime setable.
File creation operations now respect the UNIX umask.

betaenv.bet:
============

Optimized text.puttext, text.getAtom and text.getLine by making the
stream operations abstract (without implementation), and moving the
implementations into text operations (there have always been special
implementations for file). PLEASE NOTE, that this changes the
semantics of these stream operations, such that _any_ stram
specialization _must_ implement these operations themselves.  These
implementations have been done for text, file and substream/subtext.

Changed ascii.isLetter etc. into static procedures for efficiency.

Added Copyright clause.

Changed the SLOT names to make them less volunable to ambiguities with
user defined slots, by prefixing the slot-names with e.g. 'betaenv'.

Changed the implementation of position in text objects.  This implies
	- append: only update pos if pos=length
	- insert: only update pos, if inx<pos
	- delete: see comment in betaenv.bet

Added "exit THIS(stream/text)[]" to all operations in stream/text if
they do not return anything else.  To make 'cascading' style
programming possible in most cases, like: 
	(6->('Fetch 3 chairs!'->T).setPos).getInt->noOfChairs

Made several static instance optimizations, and removed several usages
of eos, max/min, etc. in several operation implementations to improve
efficiency.

Rearranged the sequence of definitions in betaeenv to a more natural ordering.

Rearranged the sequence of attributes in stream and text patterns to a
more natural ordering.

Changed the definitions of the screen and keyboard short-cut
operations (get, put, getInt, putInt, etc) - make them non-static to
make them work similar to the non short-cut versions (e.g. wrt. format
in putInt).

Changed the implementation of text.copy such that it returns a copy of
the same qualification as the original - not just a text instance.
The same is done for text.sub.

Added find, findAll, findText, FindTextAll operations.  All these
operations can be invoked with NCS (NonCaseSensitive) search by
e.g. findAll(# NCS:: trueObject #)

Removed findCh (replaced by findAll).

Changed the definition of equal and equalNCS (does not influence
users).  With the new definition of equal, equalNCS is merely a
short-cut, which may by removed - equalNCS is just equal(# NCS::
trueObject #).

Added attribute position to stream to offer a more elegant interface
to reading and setting the position of a stream (uses setPos and
getPos in enter and exit).  setPos and getPos can then be considered
private attributes.

Removed copyAppend and copyPrepend (can be made by
e.g. (t.copy).append).

Removed MkTextRef (superflurious now that 'xxx'->T  works).

Added asInt as a new stream attribute, returning the integer value
present in the textual contants of the stream (possibly wil leading
and training white space).

ObjectPool.strucScan was added a missing enter parameter.

Added minReal and maxReal (moved from math.bet), and updated their
values to the IEEE standard value for 64-bit reals.

Added infReal which refurns the real value 'Infinity;.

Changed several if's to simple if's, and made a few comment
corrections etc. to correct formatting errors etc.

Pattern Arguments now returns NONE if no command line argument is
present at the given position.

ForTo local variables renamed from (min,max) to (low,high) to avoid
shadowing min and max patterns.

formatio.bet:
=============

The formatio implementation is mostly rewritten to correct some minor
errors, and to enhance efficiency.  The errors were: errors in
handling fieldwidth for the s and c markers, lacking check for missing
fields, and erronious handning of the '*' marker, and missing return
values in the radix markers.

The '*' marker have been totally removed, since it is not necessary
for BETA getFormat (whereas it is needed for say scanf in C).  The
same effect can be obtained by:
	'%i, %i, %i'->getformat(# do i->i1; i; i->i2 #)
now the middle integervalue is simply skipped,

Introduced temporary text variable during the creation of the output
to speed up the operations on unbuffered streams (such as screen).

Furthermore, a few extra exceptions have been defined to handle new
error situations.

math.bet
========

Deleted minReal and maxReal (moved to betaenv.bet).

Changed the enter parameters to atan2 _from_ (x,y) to (y,x), which is
correct according to the underlying C function.

numberio.bet
================

Added asBased, asRadix, asReal and asInteger operations.

numberiobody.bet
================

Updated to new fragment syntax, and using simple if where possible.

Introduced temporary text variable during the creation of the output
to speed up the operations on unbuffered streams (such as screen).

Added support for 'Infinity" values (by removing explicit tests for
maxReal etc.).

Changes internal variables during recognition of numbers from integers
to reals, to avoid overflow during recognition of large
real values.

Made static put, get, etc. instances to improve efficiency.

basicio.c
=========

Added infReal C-function to create a real 'Infinity' value.  

The function is placed here (it may seem a little out-of-place in a
file called basicio :-) to avoid adding yet another file to the
link-phase.

external.bet
============

Moved MakeCBF and FreeCBF from Xt/v1.9/xtlib.bet.
They can be used by other programs than Xt programs.

============================================================================
VERSION 1.4 
============= 

With v1.4 the following changes were introduced:

All files:
==========

1) INCLUDE fragments have been replaced by INCLUDE properties.

2) Fragment *group* syntax ( [[ and ]] ) has been removed

betaenv.bet:
============
1) betaenv.ObjectPool redesign.
   The old design was not very useful, so the ObjectPool in betaenv has been
   totally redesigned.

2) betaenv.putline, betaenv.Put, betaenv.PutInt, betaenv.PutText, 
   betaenv.PutLine:
   These are static objects. Therefore their do-parts have been extended to
   "clear" the enter parameters just before they are done.
   In v1.3 the following statements
     'foo' -> putline; 
     putline;
     '.' -> put;
   would result in the output
     foo
     foo
     .
   In v1.4 it results in
     foo
     
     .

3) The program-descriptor is dynamically instantiated.
4) systemEnv related stuff removed apart from "theScheduler". They were not
   necessary anymore.
5) putInt have been augmented with additional formatting possiblities:
	signed, blankSign, adjustLeft, zeroPadding
   The format virtual is only kept for backwards compatability
   PutInt also now used peek for reading, thus do not any more read one
   character too much.
6) A pattern Qua has been added. This pattern is to be used instead of the
   qua-mechanism proposed for BETA in previous releases.
7) Text.less fixed. Behaved as a lessEq operation in earlier releases.
8) Pattern random has been replaced by the new fragment random.bet
9) Added CallStd and StdExternalEntry to External pattern. Used on NTI.

cstring.bet:
============
1) errors in declarations of externals fixed.

2) error in get (lgth and pos was 0) corrected

3) Moved to ~beta/sysutils/v1.4.

external.bet:
=============

1) Direct use of inlined TOS calls, and use of static pos-objects
   for efficiency.
2) Changed "inx" to "byteoffset" for increased readability.
3) Fixed boundary-check error in PutLong and GetLong.

objinterface.bet:
=================

1) Moved to ~beta/sysutils/v1.4

file.bet:
=========

1) The attributes exists, modtime, touch, rename, size, readable, writeable,
   isFile, and isDirectory of DiskEntry is made non-virtual to allow simpler
   furtherbinding of the error-exceptions local to these patterns.

2) The attributes touch, delete, flush, and close of File are made non-virtual 
   to allow simpler furtherbinding of the error-exceptions local to these 
   patterns.

3) The "formattime" attribute was moved to the file ~beta/sysutils/v1.4/time.bet.

4) Binary virtual boolean added for NT binary files.
   open operations made non-virtual
   
directory.bet:
==============

1) virtual error attribute on scan and find operations.

2) The attributes touch, delete, createFile, deleteFile, createDir, deleteDir,
   noOfEntries, and empty  of Directory are made made non-virtual to  allow 
   simpler furtherbinding of the error-exceptions local to these patterns.

putReal.bet and getNumber.bet:
==============================

Have been replaced by the numberio.bet file

numberio.bet:
================
Implements getNumber, getBased, getRadix, getReal, getInteger, putBased, and
putReal.

putReal: Have been augmented with additional formatting possibilities: plain,
signed, blankSign and zeroPadding.  The virtual format is only kept for
backwards compatability.  Default style is changed from plain to noexp.

New pattern: putBased. Allows print-out of an integer in any base from 2 to 256.
The integer is printed like 'bbbxnnnnn', where 'bbb' is the base, and 'nnnnn' is
the integer in the base. Using 0 as base prints the integer in base 16, but
prefixed with '0' instead of '16'.

Formatting possibilities are like putInt: plain, signed, blankSign and
zeroPadding.  The virtual format is only kept for backwards compatability.

However there is an additional set of formatting possibilities:
	baseWidth, baseZeroPadding, and noBasePrefix.
BaseWidth and baseZeroPadding works similar to width and zeroPadding, except
that they only controls the base part og the representation (i.e. the 'bbx'
part) NoBasePrefix controls whether the base part is generated, or not..

New pattern: getRadix.  Similar to getBased, except that it does not require the
'bbx' part of the number.  The radix (or base) of the number is specified in the
enter parameter to getRadix, such that 12->getRadix->i reads a number from input
in base 12 (i.e. reading the characters '0'-'9','A','B' and 'C') and converts
the number to an integer (base 10).

private/putrealbody.bet:
========================

An error in noexplen, which caused infinite loop if the real was bigger than
10 fixed.

New fragments: formatio.bet and random.bet:
===========================================

formatio.bet:
=============

contains two operations: getFormat and putFormat.  These operations implements
formatted input and output similar to the C functions: sprintf and sscanf.
E.g.
	'(%i,%i)'->getformat(# do i->a; i->b #) reads coordinate pairs in the
form of '(234,67)', and assigns 234 to a, and 67 to b.
	'(%i,%i)'->putformat(# do a->i; b->i #) prints coordinate pairs in the
form '(71,45)' - assuming a=71 and b=45.

random.bet:
===========

contains a number of random number generators.  These random number generators
are expected to totally replace the random pattern in betaenv (which is not
working properly).  The available random generators are:

    (1)  Beta random deviates
    (2)  Chi-square random deviates
    (3)  Exponential random deviates
    (4)  F random deviates
    (5)  Gamma random deviates
    (6)  Multivariate normal random deviates (mean and covariance
         matrix specified)
    (7)  Noncentral chi-square random deviates
    (8)  Noncentral F random deviates
    (9)  Univariate normal random deviates
    (10) Real uniform random deviates between specified limits
    (11) Binomial random deviates
    (12) Negative Binomial random deviates
    (13) Multinomial random deviates
    (14) Poisson random deviates
    (15) Integer uniform deviates between specified limits

systemEnv.bet:
==============

1) Split in three: BasicSystemEnv, systemenv and XsystemEnv.
2) Added support for combining systemEnv and X (XsystemEnv).
3) UNIX: Added I/O multiplexing on fileDescriptors using select.
3) UNIX: Keyboard reimplemented to avoid polling. (Using 3 above)
4) Added patterns kill, sleep.
5) Added tryP operation to semaphore.
6) Added onKill virtual to System. Is called when the System terminates
   (direct suspend or termination) or when the System is killed (using kill).
7) added "deadLocked" exception raised if no coroutines are ready to be
   scheduled and noone is waiting for I/O or sleeping. 
8) Static objects and doparts used where possible.
9) Mostly reimplemented to be able to support the above features.
10) Conc bug corrected.
