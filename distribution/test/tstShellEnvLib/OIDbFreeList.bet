ORIGIN '~beta/basiclib/v1.6/betaenv';
(* 
 * $RCSfile: OIDbFreeList.bet,v $ $Revision: 1.2 $ $Date: 1997-06-02 13:31:15 $
 *
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1992-94
 *       All rights reserved.
 *  
 * This group contains structures keeping track of the assignment of OIDbs 
 * to data objects used on the server-side as well on the client-side.
 *)
BODY 'OIDbFreeListBody';

---lib: attributes---
interval: (# min: @integer; max: @integer enter (min,max) #);
freeList: 
  (# init: (# do <<SLOT freeListInit: descriptor>> #);
     
     insert: 
       (* Inserting an interval [a,b], a < b , means that the values a+1, a+2,...,b-1, b 
        * are 'free' values to be used as OIDbs for new objects.
        *)
       (# freeValues: ^interval;
       enter freeValues[]
       do <<SLOT freeListInsert: descriptor>> 
       #);
     
     putFreeList: 
       (* Inserts the entered freeList into this freeList. *)
       (# aFreeList: ^freeList;
       enter aFreeList[]
       do <<SLOT freeListputFreeList: descriptor>> 
       #);
     
     noOfFree: @integer; (* number of free values in the whole freelist *)
      
     getFreeValue: 
       (* Returns a free value (if noOfFree = 0 then 0 is returned !) *)
       (# freeValue: @integer;
       do <<SLOT freeListGetFreeValue: descriptor>>
       exit freeValue
       #);
     
     getFreeList:
       (* Returns a part of this freeList, so that the noOfFree of the returned part succeeds
        * the entered wantedNoOfFree. The retuned part is removed from this freeList.
        * If wantedNoOfFree > noOfFree in this freeList, NONE is returned.
        *)
       (# wantedNoOfFree: @integer;
          newFreeList: ^freeList;
       enter wantedNoOfFree
       do <<SLOT freeListGetFreeList: descriptor>> 
       exit newFreeList[]
       #);
     
     scan: (# thisInterval: ^interval;
           do <<SLOT freeListScan: descriptor>>
           #);
     
     size: (# noOfIntervals: @integer;
           do <<SLOT freeListSize: descriptor>>;
           exit noOfIntervals
           #);
     
     FLpriv: @<<SLOT freeListPrivate: descriptor>>;
     
  #); (* end of freeList *)
