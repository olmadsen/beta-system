ORIGIN '~beta/basiclib/v1.6/betaenv';
(* 
 * $RCSfile: shellSockets.bet,v $ 
 * $Revision: 1.3 $ 
 * $Date: 1997-06-02 13:31:03 $
 *
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1992-96
 *       All rights reserved.
 *)
OBJFILE default '$/extShellSockets.o';
MAKE sun4s 'external/distributionSUN4S.make'
     default 'external/distribution.make';
LINKOPT sun4s '-lsocket -lnsl'
        default '';
INCLUDE '~beta/basiclib/v1.6/external';


--- lib:attributes ---
(* The following externals are declared and their operation explained 
 * in 'private/external/shellSockets.h' *)

initSignals: external (# #);

newPassiveSocket: external
  (# portNumberAdr: @Integer;
     sock: @Integer;
  enter portNumberAdr
  exit sock
  #);

tryAccept: external
  (# sock: @Integer;
     blocking: @Integer;
     acceptBlock: @Integer;
     acceptSock: @Integer;
  enter (sock, blocking, acceptBlock)
  exit acceptSock
  #);

newActiveSocket: external
  (# hostAdr: @Integer;  (* Internet address.         *)
     port: @Integer;     (* Port to connect to.       *)
     sockAdr: @Integer;  (* Address on which to write the new socket desc. *)
     block: @Integer;
     res: @Integer;      (* Return value              *)
  enter (hostAdr, port, sockAdr, block)
  exit res
  #);

nbReadn: external
  (# sock: @Integer;     (* Socket to read from     *)
     dataAdr: @Integer;  (* address of databuffer   *)
     nbytes: @Integer;   (* Number of bytes to read *)
     res: @Integer;
  enter (sock, dataAdr, nbytes)
  exit res
  #);

nbWriten: external
  (# sock: @Integer;     (* Socket to write to.      *)
     dataAdr: @Integer;  (* address of databuffer    *)
     nbytes: @Integer;   (* Number of bytes to write *)
     res: @Integer;
  enter (sock, dataAdr, nbytes)
  exit res
  #);

close: external
  (# sockfd: @Integer;
     res: @Integer;
  enter sockfd
  exit res
  #);

shutdown: external
  (# sockfd: @Integer;
     how: @Integer;
     res: @Integer;
  enter (sockfd, how)
  exit res
  #);
