ORIGIN '~beta/guienv/guienvsystemenv';
INCLUDE '~beta/freja/frejalib'
        '~beta/toollibs/preferences/cmdOptions'
        '~beta/toollibs/preferences/preferencesDB'
        'private/mjolnerOptions';
BODY 'private/mjolnerbody';
-- program: Descriptor --
(#
   fgb: ^guienv;
   thesystemenv: @|systemenv
     (# setWindowEnv::  (#  do fgb[]->theWindowEnv[] #);  #);
   valhallaPrefs: @valhallaPreferences;
   mjolnerPrefs: @mjolnerPreferences;
   compilerPrefs: @compilerPreferences;
   
do
   &expandWildcardsArgumentHandler[]->argumentHandler[];
   mjolnerPrefs.open
   (#  do mjolnerPrefs.registerMJOLNERcmdOptions #);

   valhallaPrefs.open
     (#  do valhallaprefs.registerVALHALLAoptions;  #);
   
   compilerPrefs.open
     (#  do compilerprefs.registerCOMPILERoptions;  #);

   (mjolneroptionsfilename,valhallaPrefs.sectionname)->valhallaPrefs.load
   (# fileerror::(# do msg[]->screen.puttext; #)
   #);
   
   (mjolneroptionsfilename,compilerPrefs.sectionname)->compilerPrefs.load
   (# fileerror::(# do msg[]->screen.puttext; #)
   #);

   
   mjolnerPrefs.readArguments;
   (if mjolnerPrefs.help then mjolnerPrefs.dumpCmds; stop if);
   mjolnerPrefs[]->objectpool.put;
   valhallaPrefs[]->objectpool.put;
   compilerPrefs[]->objectpool.put;
   false->thesystemenv.freja (#  do thefragmentbrowser[]->fgb[] #);
   thesystemenv;
   
#)  

