ORIGIN '~beta/guienv/graphicscanvas';
INCLUDE '~beta/basiclib/math';

-- program: descriptor --
GUIenv
(# 
   
   main: @Window
     (# theCanvas: @GraphicsCanvas
          (# 
             blue: @Color;
             gray: @Color;
             red: @Color;
             
             
             thePicture: @Composite;
             
             CreatePicture:
               (# CreateOval:
                    (# x, y, width, height: @integer;
                       theOval: ^Oval;
                       strokewidth: @integer;
                       stroke: ^Color;
                       fill: ^Color;
                    enter (x, y, width, height, strokewidth, stroke[], fill[])
                    do &Oval[] -> theOval[];
                       theOval.init;
                       stroke[] -> theOval.stroke[];
                       fill[] -> theOval.fill[];
                       strokewidth -> theOval.strokewidth;
                       x -> theOval.x;
                       y -> theOval.y;
                       width -> theOval.width;
                       height -> theOval.height;
                       theOval[] -> thePicture.add;
                    #);
                  cx, cy: @integer;
                  r: @integer;
               do thePicture.clear;
                  13 -> cx;
                  50  -> cy;
                  1 -> r;
                  (for 16 repeat
                       (cx - r, cy - r, 2 * r, 2 * r, 1, blue[], red[]) -> CreateOval;
                       cx + r -> cx;
                       cx + 7 -> cx;
                       r + 2 -> r;
                       cx + r -> cx;
                  for);
                  
                  60 -> cx;
                  160 -> cy;
                  30  -> r;
                  (for inx: 8  repeat
                       (cx - r, cy - r, 2 * r, 2 * r, inx, blue[], gray[]) -> CreateOval;
                       cx + r -> cx;
                       cx + 7 -> cx;
                       cx + r -> cx;
                  for);
                  
                  13 -> cx;
                  230  -> cy;
                  1 -> r;
                  (for 16 repeat
                       (cx - r, cy - r, 2 * r, 2 * r, 1, blue[], blue[]) -> CreateOval;
                       cx + r -> cx;
                       cx + 7 -> cx;
                       r + 2 -> r;
                       cx + r -> cx;
                  for);
                  
                  60 -> cx;
                  300 -> cy;
                  8 -> r;
                  (for inx: 8  repeat
                       (cx - r, cy - r, 2 * r, 2 * r, inx, blue[], gray[]) -> CreateOval;
                       cx + r -> cx;
                       cx + 7 -> cx;
                       cx + r -> cx;
                  for);
                  
                  60 -> cx;
                  370 -> cy;
                  30  -> r;
                  (for inx: 8  repeat
                       (cx - r, cy - r, 2 * r, 2 * r, inx, gray[], blue[]) -> CreateOval;
                       cx + r -> cx;
                       cx + 7 -> cx;
                       cx + r -> cx;
                  for);
                  
                  60 -> cx;
                  440 -> cy;
                  30  -> r;
                  (for inx: 8  repeat
                       (cx - r, cy - r, 2 * r, 2 * r, inx, red[], gray[]) -> CreateOval;
                       cx + r -> cx;
                       cx + 7 -> cx;
                       cx + r -> cx;
                  for);
                  
               #);
             
             open::
               (# 
               do 0.1 * 0xFFFF -> blue.red;
                  0.2 * 0xFFFF -> blue.green;
                  0.5 * 0xFFFF -> blue.blue;
                  
                  0.8 * 0xFFFF -> gray.red;
                  0.8 * 0xFFFF -> gray.green;
                  0.85 * 0xFFFF -> gray.blue;
                  
                  0.8 * 0xFFFF -> red.red;
                  0.1 * 0xFFFF -> red.green;
                  0.05 * 0xFFFF -> red.blue;
                  
                  (0xFFFF, 0xFFFF, 0xFFFF) -> backgroundColor;
                  (800, 600) -> size;
                  thePicture.init;
                  thePicture[] -> add;
                  CreatePicture;
                  
                  97 -> OvalLimit;
               #);
          #);
        open::
          (#
          do 
             'Ovals' -> Title;
             (800, 600) -> size;
             theCanvas.open;
             
          #);
     #);
do main.open;
#)
