ORIGIN '~beta/guienv/guienv';
INCLUDE '~beta/basiclib/random';
INCLUDE '~beta/basiclib/timedate';
INCLUDE '~beta/guienv/openGL/openGL';
INCLUDE '~beta/opengl/glb';
-- program:descriptor--
guienv
(# 
   owindow:@window
     (# 
        ogl:@openGLarea
          (#
          starlist:@integer;
             open::
               (# 
               do
                  (300,300)->size;
                  true->bindright;
                  true->bindbottom;
                  GL_FLAT->glShadeModel;
                  GL_MODELVIEW->glMatrixMode;
                  ((TimeNowRef).sec,31)->setall;
                  1->glGenLists->starlist;
                  (starlist,GL_COMPILE)->glNewList;
                  GL_POINTS->glBegin;
                  (for i:200 repeat
                    (i/100+0.5,i/100+0.5,i/100+0.5)->glColor3d;
                    (((1,100)->ignuin)-50,((1,100)->ignuin)-50,0)->glVertex3i;
                  for);
                  glEnd;
                  glEndList;
               #);
             eventhandler::
               (# 
                  onrefresh::
                    (# (* Draw using openGL code *)
                    do
                       (0.0,0.0,0.0,0.0)->glClearColor;
                       GL_COLOR_BUFFER_BIT->glClear;
                       (1,1,1)->glColor3d;
                       starlist->glCallList;
                       glBSwapBuffers;
                    #);
                  onFrameChanged::
                    (# h,w:@integer;
                  do
                       newframe.size->(w,h);
                       (0,0,w,h)->glViewport;
                       GL_PROJECTION->glMatrixMode;
                       glLoadIdentity;
                       (-50,50,-50,50,-50,50)->glOrtho;
                       GL_MODELVIEW->glMatrixMode;
                       glLoadIdentity;
                    #);
               #);
          #);
        open::
          (#
          do (300,300)->size;
             ogl.open;
             'openGL demo stars'->title;
          #);
          eventhandler::<
          (#
          onAboutToClose::<
            (# do terminate #);
          #);
     #);
do
   owindow.open;
#)
