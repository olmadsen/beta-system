ORIGIN '../colorsbody';
INCLUDE '../../../private/X11/guienv_unixprivate';

-- GUIENVwindowItemEnterForegroundColor: doPart --
do

-- GUIENVwindowItemExitForegroundColor: doPart --
do

-- GUIENVwindowItemEnterBackgroundColor: doPart --
do (# pixel: @integer;
      theXColor: @XColor;
      dpy: @integer;
      cmap: @integer;
      screen: @integer;
      result: @integer;
   do value.red -> theXColor.red;
      value.green -> theXColor.green;
      value.blue -> theXColor.blue;
      
      displayID -> dpy;
      
      dpy -> XDefaultScreen -> screen;
      (dpy, screen) -> XDefaultColorMap -> cmap;
      
      (dpy, cmap, theXColor[]) -> XAllocColor -> result;
      (if result = 0 then
          'XAllocColor failed in "windowItem.backgroundColor"' -> putLIne;
       else
          theXColor.pixel -> pixel;
          'pixel = ' -> putText;
          pixel -> putInt;
          newLine;
          
          (if widgetID <> 0 then
              (XtNbackground, pixel) -> setIntegerResource;
          if);
      if)
   #);

-- GUIENVwindowItemExitBackgroundColor: doPart --
do (# pixel: @integer;
      theXColor: @XColor;
      dpy: @integer;
      colorMap: @integer;
   do (if widgetID = 0 then
          XtNbackground -> father.getIntegerResource -> pixel;
          XtNcolorMap -> father.getIntegerResource -> colorMap;
       else
          XtNbackground -> getIntegerResource -> pixel;
          XtNcolorMap -> getIntegerResource -> colorMap;
      if);
      pixel -> theXColor.pixel;
      displayID -> dpy;
      (dpy, colorMap, theXColor[]) -> XQueryColor;
      &color[] -> value[];
      theXColor.red -> value.red;
      theXColor.green -> value.green;
      theXColor.blue -> value.blue;
   #);

