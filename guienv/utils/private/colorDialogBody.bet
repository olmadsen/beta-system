ORIGIN '../colorDialog';
INCLUDE '~beta/interfacebuilder/support/groupbox'
        '~beta/interfacebuilder/support/auxcontrols'
        '../../controls'
        '../../scrolllists'
        '../../figureitems'
        '../../private/pathmanager'
        '../tooltip'
        '../prompts'
        '../guienvadds'
        '../colorConverter'
        '../colorTable';

--- colordialogApply: dopart ---
do private.RGBglobal->c;
   INNER apply
   
--- colordialogSetColor: dopart ---
do (if no
    // 00 then c->private.RGBchanged;
    // 01 then c->private.customColors.customColor01.set;
       true->private.customColors.customColor01.defined;
    // 02 then c->private.customColors.customColor02.set;
       true->private.customColors.customColor02.defined;
    // 03 then c->private.customColors.customColor03.set;
       true->private.customColors.customColor03.defined;
    // 04 then c->private.customColors.customColor04.set;
       true->private.customColors.customColor04.defined;
    // 05 then c->private.customColors.customColor05.set;
       true->private.customColors.customColor05.defined;
    // 06 then c->private.customColors.customColor06.set;
       true->private.customColors.customColor06.defined;
    // 07 then c->private.customColors.customColor07.set;
       true->private.customColors.customColor07.defined;
    // 08 then c->private.customColors.customColor08.set;
       true->private.customColors.customColor08.defined;
    // 09 then c->private.customColors.customColor09.set;
       true->private.customColors.customColor09.defined;
    // 10 then c->private.customColors.customColor10.set;
       true->private.customColors.customColor10.defined;
    // 11 then c->private.customColors.customColor11.set;
       true->private.customColors.customColor11.defined;
    // 12 then c->private.customColors.customColor12.set;
       true->private.customColors.customColor12.defined;
   if)
   
--- colordialogGetColor: dopart ---
do (if no
    // 00 then private.RGBglobal->c;
    // 01 then private.customColors.customColor01.get->c;
    // 02 then private.customColors.customColor02.get->c;
    // 03 then private.customColors.customColor03.get->c;
    // 04 then private.customColors.customColor04.get->c;
    // 05 then private.customColors.customColor05.get->c;
    // 06 then private.customColors.customColor06.get->c;
    // 07 then private.customColors.customColor07.get->c;
    // 08 then private.customColors.customColor08.get->c;
    // 09 then private.customColors.customColor09.get->c;
    // 10 then private.customColors.customColor10.get->c;
    // 11 then private.customColors.customColor11.get->c;
    // 12 then private.customColors.customColor12.get->c;
   if)

--- colordialogOpen: dopart ---
do 'Color Selector Dialog'->title;
   (440,340)->size;
   private.basicColors.open;
   private.customColors.open;
   private.selectedColor.open;
   private.namedColors.open;
   private.RGBcolors.open;
   private.HSVcolors.open;
   private.colorSelector.open;
   private.closebutton.open;
   private.applyButton.open;
   private.tip.open;
   (0,0,private.cc.maxVal)->private.HSVchanged;
   true->private.p_loaded;
   'HSVscale'->private.p.read
   (# error::
        (# do (none ,'Load Pixmap Error',
           what[])->prompt; true->continue; false -> private.p_loaded;
        #)
   #);
   INNER open
   
--- colordialogPrivate: descriptor ---
(# p_loaded: @boolean;
   maxColor: (#  exit 65535 #);
   RGBglobal: @ (# R,G,B: @integer enter (R,G,B) exit (R,G,B) #);
   RGBchanged: @
     (# 
     enter RGBglobal
     do
	RGBglobal->RGBcolors.RGB;
	RGBglobal->cc.RGBtoHSV->HSVglobal->HSVcolors.HSV;
	RGBglobal->selectedColor.colorDisplay.backgroundColor;
	colorselector.adjust
     #);
   cc: @colorConverter;
   HSVglobal: @ (# H,S,V: @integer enter (H,S,V) exit (H,S,V) #);
   HSVchanged: @
     (# 
     enter HSVglobal
     do
	HSVglobal->HSVcolors.HSV;
	HSVglobal->cc.HSVtoRGB->RGBglobal->RGBcolors.RGB;
	RGBglobal->selectedColor.colorDisplay.backgroundColor;
	colorselector.adjust;
               
     #);
   p: @pixmap;
          
   basicColor: canvas
     (#
        r,g,b: @integer;
        open::<
          (#
          do
             true->border.visible;
             borderStyles.shadowIn->border.style;
             INNER
          #);
        set: (# enter (r,g,b) do (r,g,b)->backgroundColor #);
        get: (# exit (r, g, b) #)
     #);
   customColor: basicColor
     (# defined: @boolean;
        eventHandler::< 
          (# onMouseUp::<
               (# do (if defined then (r,g,b)->RGBchanged if) #) #);
     #);
   
   colornamesPathManager: pathManager
     (# init::
	  (# betalib: ^text;
	     colornamesDir: ^text;
	  do '$(BETALIB)' -> expandEnvVar
			       (# defaultValue::
				    (# 
				    do '/usr/local/lib/beta' -> envvarvalue[];
				    #);
			       #) -> betalib[];
	     ':' -> add;
	     
	     '.' -> add;
	     './bitmap' -> add;
	     '/bitmap/interfacebuilders' -> (betalib.copy).append -> add;
	     '/bitmap/objectbrowser' -> (betalib.copy).append -> add;
	     '/bitmap' -> (betalib.copy).append -> add;
	            
	     '$(PIXMAPS)' -> expandEnvVar -> colornamesDir[];
	     (if colornamesDir[] <> NONE then
		 (if colornamesDir.length > 0 then
		     (if (colornamesDir.length -> colornamesDir.inxGet) = '/' then
			 (colornamesDir.length, colornamesDir.length) -> colornamesDir.delete;
		     if);
		     colornamesDir[] -> add;
		 if);
	     if);
	  #);
     #);
   tip: @tooltipControl
     (#
	addtip:
	  (# wi: ^windowItem; msg: ^text; t: ^tool
	  enter (wi[],msg[])
	  do
	     &tool[]->t[];
	     wi[]->t.theWindowItem[];
	     msg[]->t.theTip[];
	     t[]->add
	  #);
	open:: 
	  (# 
	  do
	     (tip.AUTOPOP,30000)->setDelayTime;
	     (basicColors[],'Select a color below')->addtip;
	     (customColors[],'Select a color below')->addtip;
	     (namedColors[],'Select a color below')->addtip;
	     (namedColors.names[],'Select one of these colors')
	       ->addtip;
	     (colorSelector[],'Select a color below')->addtip;
	     (colorSelector.HSarea[],'Select a color here')->addtip;
	     (colorSelector.Vcontrol[],
	      'Change the intensity of the color by scrolling')->addtip;
	     (RGBcolors[],'Specify the RGB values here')->addtip;
	     (RGBcolors.Rvalue[],'Specify the R value here')->addtip;
	     (RGBcolors.Gvalue[],'Specify the G value here')->addtip;
	     (RGBcolors.Bvalue[],'Specify the B value here')->addtip;
	     (selectedColor[],'The specified color')->addtip;
	     (selectedColor.colorDisplay[],'The selected color')->addtip;
	     (HSVcolors[],'Specify the HSV values here')->addtip;
	     (HSVcolors.Hvalue[],'Specify the H value here')->addtip;
	     (HSVcolors.Svalue[],'Specify the S value here')->addtip;
	     (HSVcolors.Vvalue[],'Specify the V value here')->addtip;
	     (applyButton[],'Select the chosen color')->addtip;
	     (closeButton[],'Select the chosen color and close dialog')
	       ->addtip;
	  #)
     #);
   basicColors: @groupbox
     (#
	open::< 
	  (# maxColorDiv9: @integer
	  do (maxColor div 9)->maxColorDiv9;
	     'Basic Colors: '->title;
	     (145,130)->size;
	     (215,210)->position;
	     basicColor01.open;
	     (maxColor,0,0)->basicColor01.set;
	     basicColor02.open;
	     (maxColorDiv9*8,0,0)->basicColor02.set;
	     basicColor03.open;
	     (maxColorDiv9*7,0,0)->basicColor03.set;
	     basicColor04.open;
	     (maxColorDiv9*6,0,0)->basicColor04.set;
	     basicColor05.open;
	     (maxColorDiv9*5,0,0)->basicColor05.set;
	     basicColor06.open;
	     (maxColorDiv9*4,0,0)->basicColor06.set;
	     basicColor07.open;
	     (maxColorDiv9*3,0,0)->basicColor07.set;
	     basicColor08.open;
	     (maxColorDiv9*2,0,0)->basicColor08.set;
	     basicColor09.open;
	     (maxColorDiv9,0,0)->basicColor09.set;
	     basicColor10.open;
	     (0,maxColor,0)->basicColor10.set;
	     basicColor11.open;
	     (0,maxColorDiv9*8,0)->basicColor11.set;
	     basicColor12.open;
	     (0,maxColorDiv9*7,0)->basicColor12.set;
	     basicColor13.open;
	     (0,maxColorDiv9*6,0)->basicColor13.set;
	     basicColor14.open;
	     (0,maxColorDiv9*5,0)->basicColor14.set;
	     basicColor15.open;
	     (0,maxColorDiv9*4,0)->basicColor15.set;
	     basicColor16.open;
	     (0,maxColorDiv9*3,0)->basicColor16.set;
	     basicColor17.open;
	     (0,maxColorDiv9*2,0)->basicColor17.set;
	     basicColor18.open;
	     (0,maxColorDiv9,0)->basicColor18.set;
	     basicColor19.open;
	     (0,0,maxColor)->basicColor19.set;
	     basicColor20.open;
	     (0,0,maxColorDiv9*8)->basicColor20.set;
	     basicColor21.open;
	     (0,0,maxColorDiv9*7)->basicColor21.set;
	     basicColor22.open;
	     (0,0,maxColorDiv9*6)->basicColor22.set;
	     basicColor23.open;
	     (0,0,maxColorDiv9*5)->basicColor23.set;
	     basicColor24.open;
	     (0,0,maxColorDiv9*4)->basicColor24.set;
	     basicColor25.open;
	     (0,0,maxColorDiv9*3)->basicColor25.set;
	     basicColor26.open;
	     (0,0,maxColorDiv9*2)->basicColor26.set;
	     basicColor27.open;
	     (0,0,maxColorDiv9)->basicColor27.set;
	     basicColor28.open;
	     (maxColor,maxColor,maxColor)->basicColor28.set;
	     basicColor29.open;
	     (maxColorDiv9*8,maxColorDiv9*8,maxColorDiv9*8)->basicColor29.set;
	     basicColor30.open;
	     (maxColorDiv9*7,maxColorDiv9*7,maxColorDiv9*7)->basicColor30.set;
	     basicColor31.open;
	     (maxColorDiv9*6,maxColorDiv9*6,maxColorDiv9*6)->basicColor31.set;
	     basicColor32.open;
	     (maxColorDiv9*5,maxColorDiv9*5,maxColorDiv9*5)->basicColor32.set;
	     basicColor33.open;
	     (maxColorDiv9*4,maxColorDiv9*4,maxColorDiv9*4)->basicColor33.set;
	     basicColor34.open;
	     (maxColorDiv9*3,maxColorDiv9*3,maxColorDiv9*3)->basicColor34.set;
	     basicColor35.open;
	     (maxColorDiv9*2,maxColorDiv9*2,maxColorDiv9*2)->basicColor35.set;
	     basicColor36.open;
	     (0,0,0)->basicColor36.set;
	     basicColor37.open;
	     (0,maxColor,maxColor)->basicColor37.set;
	     basicColor38.open;
	     (0,maxColorDiv9*8,maxColorDiv9*8)->basicColor38.set;
	     basicColor39.open;
	     (0,maxColorDiv9*7,maxColorDiv9*7)->basicColor39.set;
	     basicColor40.open;
	     (0,maxColorDiv9*6,maxColorDiv9*6)->basicColor40.set;
	     basicColor41.open;
	     (0,maxColorDiv9*5,maxColorDiv9*5)->basicColor41.set;
	     basicColor42.open;
	     (0,maxColorDiv9*4,maxColorDiv9*4)->basicColor42.set;
	     basicColor43.open;
	     (0,maxColorDiv9*3,maxColorDiv9*3)->basicColor43.set;
	     basicColor44.open;
	     (0,maxColorDiv9*2,maxColorDiv9*2)->basicColor44.set;
	     basicColor45.open;
	     (0,maxColorDiv9,maxColorDiv9)->basicColor45.set;
	     basicColor46.open;
	     (maxColor,0,maxColor)->basicColor46.set;
	     basicColor47.open;
	     (maxColorDiv9*8,0,maxColorDiv9*8)->basicColor47.set;
	     basicColor48.open;
	     (maxColorDiv9*7,0,maxColorDiv9*7)->basicColor48.set;
	     basicColor49.open;
	     (maxColorDiv9*6,0,maxColorDiv9*6)->basicColor49.set;
	     basicColor50.open;
	     (maxColorDiv9*5,0,maxColorDiv9*5)->basicColor50.set;
	     basicColor51.open;
	     (maxColorDiv9*4,0,maxColorDiv9*4)->basicColor51.set;
	     basicColor52.open;
	     (maxColorDiv9*3,0,maxColorDiv9*3)->basicColor52.set;
	     basicColor53.open;
	     (maxColorDiv9*2,0,maxColorDiv9*2)->basicColor53.set;
	     basicColor54.open;
	     (maxColorDiv9,0,maxColorDiv9)->basicColor54.set;
	     basicColor55.open;
	     (maxColor,maxColor,0)->basicColor55.set;
	     basicColor56.open;
	     (maxColorDiv9*8,maxColorDiv9*8,0)->basicColor56.set;
	     basicColor57.open;
	     (maxColorDiv9*7,maxColorDiv9*7,0)->basicColor57.set;
	     basicColor58.open;
	     (maxColorDiv9*6,maxColorDiv9*6,0)->basicColor58.set;
	     basicColor59.open;
	     (maxColorDiv9*5,maxColorDiv9*5,0)->basicColor59.set;
	     basicColor60.open;
	     (maxColorDiv9*4,maxColorDiv9*4,0)->basicColor60.set;
	     basicColor61.open;
	     (maxColorDiv9*3,maxColorDiv9*3,0)->basicColor61.set;
	     basicColor62.open;
	     (maxColorDiv9*2,maxColorDiv9*2,0)->basicColor62.set;
	     basicColor63.open;
	     (maxColorDiv9,maxColorDiv9,0)->basicColor63.set;
	     INNER
	  #);
	basicColor01: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (4,20)->position; INNER #)
	  #);
	basicColor02: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (19,20)->position;  #)
	  #);
	basicColor03: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (34,20)->position;  #)
	  #);
	basicColor04: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (49,20)->position;  #)
	  #);
	basicColor05: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (64,20)->position;  #)
	  #);
	basicColor06: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (79,20)->position;  #)
	  #);
	basicColor07: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (94,20)->position;  #)
	  #);
	basicColor08: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (109,20)->position;  #)
	  #);
	basicColor09: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (124,20)->position;  #)
	  #);
	basicColor10: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (4,35)->position;  #)
	  #);
	basicColor11: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (19,35)->position;  #)
	  #);
	basicColor12: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (34,35)->position;  #)
	  #);
	basicColor13: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (49,35)->position;  #)
	  #);
	basicColor14: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (64,35)->position;  #)
	  #);
	basicColor15: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (79,35)->position;  #)
	  #);
	basicColor16: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (94,35)->position;  #)
	  #);
	basicColor17: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (109,35)->position;  #)
	  #);
	basicColor18: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (124,35)->position;  #)
	  #);
	basicColor19: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (4,50)->position;  #)
	  #);
	basicColor20: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (19,50)->position;  #)
	  #);
	basicColor21: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (34,50)->position;  #)
	  #);
	basicColor22: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (49,50)->position;  #)
	  #);
	basicColor23: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (64,50)->position;  #)
	  #);
	basicColor24: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (79,50)->position;  #)
	  #);
	basicColor25: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (94,50)->position;  #)
	  #);
	basicColor26: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (109,50)->position;  #)
	  #);
	basicColor27: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (124,50)->position;  #)
	  #);
	basicColor28: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (4,65)->position;  #)
	  #);
	basicColor29: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (19,65)->position;  #)
	  #);
	basicColor30: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (34,65)->position;  #)
	  #);
	basicColor31: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (49,65)->position;  #)
	  #);
	basicColor32: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (64,65)->position;  #)
	  #);
	basicColor33: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (79,65)->position;  #)
	  #);
	basicColor34: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (94,65)->position;  #)
	  #);
	basicColor35: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (109,65)->position;  #)
	  #);
	basicColor36: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (124,65)->position;  #)
	  #);
	basicColor37: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (4,80)->position;  #)
	  #);
	basicColor38: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (19,80)->position;  #)
	  #);
	basicColor39: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (34,80)->position;  #)
	  #);
	basicColor40: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (49,80)->position;  #)
	  #);
	basicColor41: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (64,80)->position;  #)
	  #);
	basicColor42: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (79,80)->position;  #)
	  #);
	basicColor43: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (94,80)->position;  #)
	  #);
	basicColor44: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (109,80)->position;  #)
	  #);
	basicColor45: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (124,80)->position;  #)
	  #);
	basicColor46: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (4,95)->position;  #)
	  #);
	basicColor47: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (19,95)->position;  #)
	  #);
	basicColor48: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (34,95)->position;  #)
	  #);
	basicColor49: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (49,95)->position;  #)
	  #);
	basicColor50: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (64,95)->position;  #)
	  #);
	basicColor51: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (79,95)->position;  #)
	  #);
	basicColor52: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (94,95)->position;  #)
	  #);
	basicColor53: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (109,95)->position;  #)
	  #);
	basicColor54: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (124,95)->position;  #)
	  #);
	basicColor55: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (4,110)->position;  #)
	  #);
	basicColor56: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (19,110)->position;  #)
	  #);
	basicColor57: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (34,110)->position;  #)
	  #);
	basicColor58: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (49,110)->position;  #)
	  #);
	basicColor59: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (64,110)->position;  #)
	  #);
	basicColor60: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (79,110)->position;  #)
	  #);
	basicColor61: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (94,110)->position;  #)
	  #);
	basicColor62: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (109,110)->position;  #)
	  #);
	basicColor63: @basicColor
	  (#
	     eventHandler::< 
	       (# onMouseUp::<  (#  do (r,g,b)->RGBchanged #) #);
	     open::<  (#  do (13,13)->size; (124,110)->position;  #)
	  #)
     #);
   customColors: @groupbox
     (# open::< 
	  (# 
	  do 'Custom: '->title;
	     (70,70)->size;
	     (365,210)->position;
	     customColor01.open;
	     customColor02.open;
	     customColor03.open;
	     customColor04.open;
	     customColor05.open;
	     customColor06.open;
	     customColor07.open;
	     customColor08.open;
	     customColor09.open;
	     customColor10.open;
	     customColor11.open;
	     customColor12.open;
	     INNER
	  #);
	customColor01: @customColor
	  (# open::<  (#  do (13,13)->size; (4,20)->position;  #) #);
	customColor02: @customColor
	  (# open::<  (#  do (13,13)->size; (19,20)->position;  #) #);
	customColor03: @customColor
	  (# open::<  (#  do (13,13)->size; (34,20)->position;  #) #);
	customColor04: @customColor
	  (# open::<  (#  do (13,13)->size; (4,35)->position;  #) #);
	customColor05: @customColor
	  (# open::<  (#  do (13,13)->size; (19,35)->position;  #) #);
	customColor06: @customColor
	  (# open::<  (#  do (13,13)->size; (34,35)->position;  #) #);
	customColor07: @customColor
	  (# open::<  (#  do (13,13)->size; (4,50)->position;  #) #);
	customColor08: @customColor
	  (# open::<  (#  do (13,13)->size; (19,50)->position;  #) #);
	customColor09: @customColor
	  (# open::<  (#  do (13,13)->size; (34,50)->position;  #) #);
	customColor10: @customColor
	  (# open::<  (#  do (13,13)->size; (49,20)->position;  #) #);
	customColor11: @customColor
	  (# open::<  (#  do (13,13)->size; (49,35)->position;  #) #);
	customColor12: @customColor
	  (# open::<  (#  do (13,13)->size; (49,50)->position;  #) #)
     #);
   namedColors: @groupbox
     (# ct: @colorTable;
	open::< 
	  (# 
	  do 'Named Colors: '->title;
	     (100,210)->size;
	     (5,0)->position;
	     names.open;
	     INNER
	  #);
	names: @textscrolllist
	  (# open::< 
	       (# i: @integer;
		  theColornamesPathManager: @colornamesPathManager
	       do theColornamesPathManager.init;
		  'colornames.small'
		    ->theColornamesPathManager.lookup
		    ->ct.loadFile(# merge:: trueobject #);
		  ct.scan
		    (#  do 1->append; (i+1->i,currentName[])->settext #);
		  (90,185)->size;
		  (5,20)->position;
		  INNER
	       #);
	     eventhandler:: 
	       (# onSelect:: 
		    (# t: ^text
		    do item->gettext->t[]; t[]->ct.lookup->RGBchanged
		    #)
	       #)
	  #)
     #);
   colorSelector: @groupbox
     (# open::< 
	  (# 
	  do 'Color Selector: '->title;
	     (250,210)->size;
	     (110,0)->position;
	     HSarea.open;
	     Vcontrol.open;
	     INNER
	  #);
	adjust: @ (#  do HSarea.adjust; Vcontrol.adjust #);
	HSarea: @canvas
	  (# c: @oval
	       (# open::  (#  do (10,10)->size; (10,10)->position;  #);
		  eventhandler:: 
		    (# onMouseDown:: 
			 (# newH,newS,newV: @integer; x,y: @integer
			 do HSarea.size->(x,y);
			    father.trackmouse
			      (# mouseMove:: 
				   (# 
				   do curPt->(h,v);
				      HSVglobal->(newH,newS,newV);
				      (if true
				       // h < 0 then
					  0->newH
				       // h > x then
					  cc.maxHue->newH
				       else
					  h / x*cc.maxHue->newH
				      if);
				      (if true
				       // v < 0 then
					  cc.maxSat->newS
				       // v > y then
					  0->newS
				       else
					  cc.maxSat-(v / y*cc.maxSat)->newS
				      if);
				      (newH,newS,newV)->HSVchanged;
				      true->selectedColor.colorDisplay.update;
				      true->RGBcolors.update;
				      true->HSVcolors.update
				   #)
			      #)
			 #);
                         
		    #)
	       #);
	     adjust: @
	       (# h,v: @integer
	       do size->(h,v);
		  ((HSVglobal.H / cc.maxHue)*h-3,
		   v-(HSVglobal.S / cc.maxSat)*v-3)
		    ->c.position;
		  true->c.update
	       #);
	     open::< 
	       (# 
	       do borderStyles.shadowIn->border.style;
		  true->border.visible;
		  (220,185)->size;
		  (5,20)->position;
		  c.open;
		  (*'HSVscale'->p.read;*)
		  INNER
	       #);
	     eventHandler:: 
	       (# onmousedown:: 
		    (# h,s,v,newH,newS,newV: @integer; x,y: @integer
		    do size->(x,y);
		       HSVglobal->(newH,newS,newV);
		       localPosition->(h,s);
		       h / x*cc.maxHue->newH;
		       cc.maxSat-(s / y*cc.maxSat)->newS;
		       (newH,newS,newV)->HSVchanged;
		       trackmouse
			 (# mouseMove:: 
			      (# 
			      do curPt->(h,s);
				 HSVglobal->(newH,newS,newV);
				 (if true
				  // h < 0 then
				     0->newH
				  // h > x then
				     cc.maxHue->newH
				  else
				     h / x*cc.maxHue->newH
				 if);
				 (if true
				  // s < 0 then
				     cc.maxSat->newS
				  // s > y then
				     0->newS
				  else
				     cc.maxSat-(s / y*cc.maxSat)->newS
				 if);
				 (newH,newS,newV)->HSVchanged;
				 true->selectedColor.colorDisplay.update;
				 true->RGBcolors.update;
				 true->HSVcolors.update
			      #)
			 #)
		    #);
		  onRefresh:: 
		    (# 
		    do (if p_loaded then
                           graphics
			   (# r: ^rectangle; w,h: @integer; 
			   do updateRect->r[];
			      r.size->(w,h);
			      (p[],r.topLeft,r.topLeft,w,h)->drawraster
                              
			   #)
                       if);
                    #);
	       #)
	  #);
	Vcontrol: @scrollbar
	  (# localUpdate: @boolean;
	     adjust: @
	       (# 
	       do true->localUpdate;
		  (HSVglobal.V / cc.maxVal)*maxValue->value;
		  false->localUpdate
	       #);
	     open::< 
	       (# 
	       do (11,185)->size;
		  (230,20)->position;
		  cc.maxVal->maxValue;
		  cc.maxVal div 10->pageScrollAmount;
		  cc.maxVal div 100->scrollAmount;
		  INNER
	       #);
	     vertical::  (#  do true->value #);
	     eventhandler:: 
	       (# onValueChanged:: 
		    (# newH,newS,newV: @integer
		    do (if not localUpdate then
			   HSVglobal->(newH,newS,newV);
			   (newH,newS,value)->HSVchanged
		       if)
		    #)
	       #);
               
	  #)
     #);
   RGBcolors: @groupbox
     (# RGBTip: @tool;
	RGB: @
	  (# 
	  enter (Rvalue.integercontents,Gvalue.integercontents,
                    Bvalue.integercontents)
	  #);
	open::< 
	  (# 
	  do 'RGB: '->title;
	     (99,130)->size;
	     (5,210)->position;
	     Rlabel.open;
	     Rvalue.open;
	     Glabel.open;
	     Gvalue.open;
	     Blabel.open;
	     Bvalue.open;
	     INNER
	  #);
	Rlabel: @statictext
	  (# open::< 
	       (# 
	       do 'R: '->label; (20,16)->size; (15,30)->position; INNER
	       #)
	  #);
	Rvalue: @dialogField
	  (# open::<  (#  do (45,21)->size; (40,30)->position; INNER #);
	     eventhandler:: 
	       (# onKeyDown:: 
		    (# t: ^text
		    do l:
			 (if ch = ascii.cr then
			     contents->t[];
			     (if t.length > 0 then
				 t.asInt
				   (# syntaxerror:: 
					(# 
					do (none ,'Illegal value',
					    'Not a valid R value')->prompt;
					   leave l
					#)
				   #)->RGBglobal.G
			      else
				 (none ,'Illegal value','Empty R value')
				   ->prompt;
				 leave l
			     if);
			     RGBchanged
			 if)
		    #)
	       #)
	  #);
	Glabel: @statictext
	  (# open::< 
	       (# 
	       do 'G: '->label; (20,16)->size; (15,60)->position; INNER
	       #)
	  #);
	Gvalue: @dialogField
	  (# open::<  (#  do (45,21)->size; (40,60)->position; INNER #);
	     eventhandler:: 
	       (# onKeyDown:: 
		    (# t: ^text
		    do l:
			 (if ch = ascii.cr then
			     contents->t[];
			     (if t.length > 0 then
				 t.asInt
				   (# syntaxerror:: 
					(# 
					do (none ,'Illegal value',
					    'Not a valid G value')->prompt;
					   leave l
					#)
				   #)->RGBglobal.G
			      else
				 (none ,'Illegal value','Empty G value')
				   ->prompt;
				 leave l
			     if);
			     RGBchanged
			 if)
		    #)
	       #)
	  #);
	Blabel: @statictext
	  (# open::< 
	       (# 
	       do 'B: '->label; (20,16)->size; (15,90)->position; INNER
	       #)
	  #);
	Bvalue: @dialogField
	  (# open::<  (#  do (45,21)->size; (40,90)->position; INNER #);
	     eventhandler:: 
	       (# onKeyDown:: 
		    (# t: ^text
		    do l:
			 (if ch = ascii.cr then
			     contents->t[];
			     (if t.length > 0 then
				 t.asInt
				   (# syntaxerror:: 
					(# 
					do (none ,'Illegal value',
					    'Not a valid B value')->prompt;
					   leave l
					#)
				   #)->RGBglobal.B
			      else
				 (none ,'Illegal value','Empty B value')
				   ->prompt;
				 leave l
			     if);
			     RGBchanged
			 if)
		    #)
	       #)
	  #)
     #);
   selectedColor: @groupbox
     (# open::< 
	  (# 
	  do 'Color: '->title;
	     (70,210)->size;
	     (365,0)->position;
	     colorDisplay.open;
	     INNER
	  #);
	colorDisplay: @canvas
	  (# open::<  (#  do (65,187)->size; (2,20)->position; INNER #);
	     eventhandler:: 
	       (# onMouseDown:: 
		    (# pos: @point;
		       drawR: @canvas
			 (# open:: 
			      (# 
			      do RGBglobal->backgroundColor; (11,11)->size
			      #);
                              
			 #);
		       drop:
			 (# p: @point; bc: ^customColor; r: @rectangle; 
			 enter (p,bc[])
			 do
			    bc.frame->r;
			    customColors.position->p.subtract;
			    (if p->r.containsPoint then
				RGBglobal->bc.set; true->bc.defined;
			    if)
			 #)
		    do THIS(colorDialog).contents->drawR.open;
		       drawR.bringToFront;
		       localPosition->pos;
		       position->pos.add;
		       selectedColor.position->pos.add;
		       (5,5)->pos.subtract;
		       pos->drawR.position;
		       true->THIS(colorDialog).update;
		       trackmouse
			 (# mouseMove:: 
			      (# 
			      do(h,v)->pos.add;
				 pos->drawR.position;
				 true->THIS(colorDialog).update
			      #)
			 #);
		       drawR.close;
		       (pos,customColors.customColor01[])->drop;
		       (pos,customColors.customColor02[])->drop;
		       (pos,customColors.customColor03[])->drop;
		       (pos,customColors.customColor04[])->drop;
		       (pos,customColors.customColor05[])->drop;
		       (pos,customColors.customColor06[])->drop;
		       (pos,customColors.customColor07[])->drop;
		       (pos,customColors.customColor08[])->drop;
		       (pos,customColors.customColor09[])->drop;
		       (pos,customColors.customColor10[])->drop;
		       (pos,customColors.customColor11[])->drop;
		       (pos,customColors.customColor12[])->drop;
		       true->THIS(colorDialog).update
		    #)
	       #)
	  #)
     #);
   HSVcolors: @groupbox
     (# HSV: @
	  (# enter (Hvalue.integercontents,Svalue.integercontents,
                    Vvalue.integercontents)
	  #);
	open::< 
	  (# 
	  do 'HSV: '->title;
	     (100,130)->size;
	     (110,210)->position;
	     Hlabel.open;
	     Hvalue.open;
	     Slabel.open;
	     Svalue.open;
	     Vlabel.open;
	     Vvalue.open;
	     INNER
	  #);
	Hlabel: @statictext
	  (# open::< 
	       (# 
	       do 'H: '->label; (20,16)->size; (15,30)->position; INNER
	       #)
	  #);
	Hvalue: @dialogField
	  (# open::<  (#  do (45,21)->size; (40,30)->position; INNER #);
	     eventhandler:: 
	       (# onKeyDown:: 
		    (# t: ^text
		    do l:
			 (if ch = ascii.cr then
			     contents->t[];
			     (if t.length > 0 then
				 t.asInt
				   (# syntaxerror:: 
					(# 
					do (none ,'Illegal value',
					    'Not a valid H value')->prompt;
					   leave l
					#)
				   #)->HSVglobal.H
			      else
				 (none ,'Illegal value','Empty H value')
				   ->prompt;
				 leave l
			     if);
			     HSVchanged
			 if)
		    #)
	       #)
	  #);
	Slabel: @statictext
	  (# open::< 
	       (# 
	       do 'S: '->label; (20,16)->size; (15,60)->position; INNER
	       #)
	  #);
	Svalue: @dialogField
	  (# open::<  (#  do (45,21)->size; (40,60)->position; INNER #);
	     eventhandler:: 
	       (# onKeyDown:: 
		    (# t: ^text
		    do l:
			 (if ch = ascii.cr then
			     contents->t[];
			     (if t.length > 0 then
				 t.asInt
				   (# syntaxerror:: 
					(# 
					do (none ,'Illegal value',
					    'Not a valid S value')->prompt;
					   leave l
					#)
				   #)->HSVglobal.S
			      else
				 (none ,'Illegal value','Empty S value')
				   ->prompt;
				 leave l
			     if);
			     HSVchanged
			 if)
		    #)
	       #)
	  #);
	Vlabel: @statictext
	  (# open::< 
	       (# 
	       do 'V: '->label; (20,16)->size; (15,90)->position; INNER
	       #)
	  #);
	Vvalue: @dialogField
	  (# open::<  (#  do (45,21)->size; (40,90)->position; INNER #);
	     eventhandler:: 
	       (# onKeyDown:: 
		    (# t: ^text
		    do l:
			 (if ch = ascii.cr then
			     contents->t[];
			     (if t.length > 0 then
				 t.asInt
				   (# syntaxerror:: 
					(# 
					do (none ,'Illegal value',
					    'Not a valid V value')->prompt;
					   leave l
					#)
				   #)->HSVglobal.V
			      else
				 (none ,'Illegal value','Empty V value')
				   ->prompt;
				 leave l
			     if);
			     HSVchanged
			 if)
		    #)
	       #)
	  #)
     #);
   applyButton: @pushbutton
     (# open:: 
	  (# do 'Apply'->label; (70,20)->size; (365,285)->position #);
	eventhandler:: 
	  (# onMouseUp::  (#  do false->THIS(colorDialog).apply #) #)
     #);
   closebutton: @pushbutton
     (# open::
	  (# do 'Close'->label; (70,20)->size; (365,315)->position #);
	eventhandler:: 
	  (# onMouseUp:: (# do true->THIS(colorDialog).apply #)
	  #)
     #)
     
#)
