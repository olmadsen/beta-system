ORIGIN '../../textfieldadds';
INCLUDE '../../../private/winnt/fields_ntibody';

-- lib: attributes --

-- GUIENVTextFieldPositionToRowCol: DescriptorForm --
assertOpen
(# location:: (# do 'posToRowCol' -> t[]; #);
   getRowCol:
     (# oldPos: @integer;
        row,col: @integer;
        curPos,prevPos,noOfChars: @integer;
        doLeave: @boolean;
        id: @integer;
     enter oldPos
     do interfaceobjectID -> id;
        (id,EM_LINEFROMCHAR,oldPos,0)->SendMessage->row;
        L1: (# 
            do curPos -> prevPos;
               (id,EM_LINEINDEX,row,0)->SendMessage->curPos;
               (id,EM_LINELENGTH,curPos,0)->SendMessage->noOfChars;
               (if curPos=-1 then prevPos->curPos; true -> doLeave; if);
               (if ((curPos<=(oldPos+row)) and ((oldPos+row) <= (curPos+noOfChars)))
                   or doLeave
                   then
                   leave L1
                else 
                   row + 1 -> row;
                   restart L1;;
               if);
            #);
        oldPos + row - curPos -> col;
     exit (row,col)
     #);
do pos -> getRowCol -> (row,col);
   row + 1 -> row;
   col + 1 -> col;
#)  

-- GUIENVTextFieldRowColToPosition: DescriptorForm --
assertOpen
(# location:: (# do 'rowColToPos' -> t[]; #);
   tempCol: @integer;
do (interfaceObjectId,EM_LINEINDEX,row-1,0) -> sendMessage -> tempCol;
   tempCol + col - row -> pos;
#)  

-- GUIENVtextFieldAutomaticScrolling: doPart --
do 
   
-- GUIENVtextFieldDisableUpdate: doPart --
do (interfaceObjectID,WM_SETREDRAW,0,0) -> SendMessage;  
   
-- GUIENVtextFieldEnableUpdate: doPart --
do (interfaceObjectID,WM_SETREDRAW,1,0) -> SendMessage; 
