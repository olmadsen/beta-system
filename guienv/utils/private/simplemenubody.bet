ORIGIN '../simplemenu';
-- SimpleMenuItemOnSelect: DoPart --
do THIS(item).onSelect; INNER  

-- SimpleMenuItemOnStatus: DoPart --
do THIS(item).onStatus->value; INNER  

-- SimpleMenuItemNew: DoPart --
do
   true->enabled;
   open;
   (if itemtext[] <> none then itemtext[]->name if);
   THIS(item)[]->append;
   INNER ;
     

-- SimpleMnuItemNewKey: DoPart --
do equiv->key  

-- SimpleMenuNoOfRadioGroups: DoPart --
do 1->value; INNER  

-- SimpleMenuRadioItemOpen: DoPart --
do 1->checkgroup; INNER ;   

-- SimpleMenuRadioItemOnSelect: DoPart --
do THIS(radioitem)[]->changechecked; INNER ;   

-- SimpleMenuToggleItemOnSelect: DoPart --
do not checked->checked; INNER ;   

-- SimpleMenuNewSeparator: DoPart --
do &separator[]->private.s[]; private.s.open; private.s[]->append;   

-- SimpleMenuNew: DoPart --
do
   open;
   (if menutext[] <> none then menutext[]->name if);
   THIS(simplemenu)[]->THIS(menubar).append;
     

-- SimpleMenuChangeChecked: DoPart --
do
   (if private.oldChecked[newitem.checkgroup][] <> newitem[] then
       (if private.oldChecked[newitem.checkgroup][] <> none then
           false->private.oldChecked[newitem.checkgroup].checked; 
       if);
       newitem[]->private.oldChecked[newitem.checkgroup][];
       true->newitem.checked;
       
   if)  

-- SimpleMenuPrivate: Descriptor --
(# oldChecked: [noOfRadioGroups] ^radioitem; s: ^separator;  #)  

