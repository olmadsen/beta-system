ORIGIN '../timerbody';
INCLUDE '../../../private/macintosh/guienv_macprivate';

-- timerLib: attributes --
unInitialized: (# exit 0 #);
active: (# exit 1 #);
sleeping: (# exit 2 #);

-- GUIenvTimerActivate: doPart --
do interval -> private.interval;
   (if private.status
    //active then 
       (* Nothing *)
    //unInitialized
    //sleeping then
	 	interval -> private.interval;
      active -> private.status;
      private.install;
   if);
   

-- GUIenvTimerPause: doPart --
do (if private.status = active then
       private.delete;
       sleeping -> private.status;
   if);

-- GUIenvTimerPrivate: descriptor --
(# theAction: @action;
   status: @integer;
   interval: @integer;
   theTimerAction: @timerAction
		(#
		do theAction;
		#);
	install: @
		(#
		do (interval * 60) div 1000 -> theTimerAction.interval;
			theTimerAction[] -> this(GUIenv).private.timerQueue.insert;
		#);
	delete: @
		(#
		do theTimerAction[] -> this(GUIenv).private.timerQueue.delete;
		#);
#)

