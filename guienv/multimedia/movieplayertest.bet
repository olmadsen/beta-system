ORIGIN '~beta/guienv/guienv';
INCLUDE '~beta/guienv/graphics';
INCLUDE 'movieplayer';


-- program: descriptor --
GUIenv
(# mv:@movie;
   t:@timer
     (# 
        action::<
          (# 
          do (* 'Time: '->puttext;theWindow.movieviewer.currenttime->screen.putint;  *)
             ' Frame: '->puttext; theWindow.movieviewer.currentframe->screen.putint; newline;
          #);
     #);;
   theWindow: @window
     (# menubarType::
          (# fileMenu: @menu
               (#	
                  openItem: @menuItem
                    (#	
                       eventHandler::
                         (# onSelect::
                              (#
                              do movieviewer.userselectfile;
                                 (movieviewer.contents).displaysize->(putint,putint);
                                 500->t.start;
                              #);
                         #);
                       open::
                         (#
                         do 'Open' -> name;
                            'O' -> key;
                         #);
                    #);
                  displayItem: @menuItem
                    (#	
                       eventHandler::
                         (# onSelect::
                              (#
                              do movieViewer.graphics
                                 (#
                                 do ((0, 0), movieViewer.size) -> fillRect;
                                 #);
                              #);
                         #);
                       open::
                         (#
                         do 'Display' -> name;
                            'D' -> key;
                         #);
                    #);
                  open::
                    (#
                    do 'File' -> name;
                       openItem.open;
                       openItem[] -> append;
                       displayItem.open;
                       displayItem[] -> append;
                    #);
               #);
             open::
               (#
               do fileMenu.open; fileMenu[] -> append;
               #);
          #);
        open::
          (#
          do 'QuickTime Test' -> title;
             (0xFFFF, 0xDDDD, 0xDDDD) -> backgroundColor;
             movieViewer.open;
          #);
        movieViewer: @moviePlayer
          (# controllerVisible::(# do true->value; #);
             automaticResize::(# do true->value #);
             open::
               (#
               do (100, 40) -> this(windowitem).position;
               #);
          #);
        close::
          (#
          do
             Terminate;
          #);
     #);
do
   theWindow.open;
#)
