ORIGIN '../figureitemsbody'
[[
-- Include 'uienv_macprivate'
-- Include 'quickdrawstuff'
-- Include 'raster_macprivate'
-- UIENVpenSetForegroundColor: descriptor --
(#
do theColor -> penForegroundColor;
#)

-- UIENVpenGetForegroundColor: descriptor --
(#
do penForegroundColor -> theColor;
#)

-- UIENVpenSetBackgroundColor: descriptor --
(#
do theColor -> penBackgroundColor;
#)

-- UIENVpenGetBackgroundColor: descriptor --
(#
do penBackgroundColor -> theColor;
#)

-- UIENVpenSetStipple: descriptor --
(#
do p[] -> penStipple;
#)

-- UIENVpenGetStipple: descriptor --
(#
do penStipple -> p[];
#)

-- UIENVpenSetSize: descriptor --
(#
do (width,height) -> figureItemPenSize;
#)

-- UIENVpenGetSize: descriptor --
(#
do figureItemPenSize -> (width,height);
#)

-- UIENVsetInk: descriptor --
(#
do (* Not implemented !!! *)
#)

-- UIENVgetInk: descriptor --
(#
do (* Not implemented !!! *)
#)

-- UIENVfigureItemOpen: descriptor --
(#
do inner open;
#)

-- UIENVfigureItemOnRefresh: descriptor --
(#
do	inner onRefresh;
#)

-- figureItemLib: attributes --
penForegroundColor:
	(#
	enter private.penForegroundColor
	exit private.penForegroundColor
	#);
penBackgroundColor:
	(#
	enter private.penBackgroundColor
	exit private.penBackgroundColor
	#);
penStipple:
	(#
	enter private.penStipple[]
	exit private.penStipple[]
	#);
figureItemPenSize:
	(#
	enter private.penSize
	exit private.penSize
	#);
figureItemInk:
	(#
	enter private.figureItemInk
	exit private.figureItemInk
	#);
usePen:
	(# data: [2] @integer;
	do (if penStipple<>None//true then
			PenNormal;
			figureItemPenSize -> PenSize;
			whiteColor -> BackColor;
			blackColor -> ForeColor;
			(if private.penStipple.isPixPat//true then
				
			else
				private.penStipple.patternData -> data;
				@@data[1] -> PenPat;
			if);
			inner;
		if);
	#);
-- UIENVfigureItemPrivate: descriptor --
(#	penForegroundColor,penBackgroundColor: @color;
	penStipple: ^raster;
	penSize: @point;
	figureItemInk: @integer;
#)

-- UIENVlineSetStart: descriptor --
(#
do theStart -> lineStart;
	adjustFrame;
#)

-- UIENVlineGetStart: descriptor --
(#
do lineStart -> theStart;
#)

-- UIENVlineSetEnd: descriptor --
(#
do theEnd -> lineEnd;
	adjustFrame;
#)

-- UIENVlineGetEnd: descriptor --
(#
do lineEnd -> theEnd;
#)

-- UIENVLineOpen: descriptor --
(#
do	inner open;
#)

-- UIENVlineOnRefresh: descriptor --
(#
do	father.focus
		(#
		do usePen
				(#
				do	lineStart -> MoveTo;
					lineEnd -> LineTo;
				#);
		#);
	inner onRefresh;
#)

-- UIENVlineonFrameChanged: descriptor --
(#
do	inner onFrameChanged;
#)

-- UIENVlineonHiliteChanged: descriptor --
(#
do	inner onHiliteChanged;
#)

-- lineLib: attributes --
lineStart:
	(#
	enter private.lineStart
	exit private.lineStart
	#);
lineEnd:
	(#
	enter private.lineEnd
	exit private.lineEnd
	#);
adjustFrame:
	(#	f: @rectangle;
	do (lineStart,lineEnd) -> f.setFromPoints;
		f -> frame;
	#);
-- UIENVlinePrivate: descriptor --
(# lineStart,lineEnd: @point;
#)

-- UIENVFillSetTile: descriptor --
(#
do	p[] -> fillTile;
#)

-- UIENVfillGetTile: descriptor --
(#
do fillTile -> p[];
#)

-- UIENVFillSetForegroundColor: descriptor --
(#
do	theColor -> fillForegroundColor;
#)

-- UIENVfillGetForegroundColor: descriptor --
(#
do fillForegroundColor -> theColor;
#)

-- UIENVFillSetBackgroundColor: descriptor --
(#
do theColor -> fillBackgroundColor;
#)

-- UIENVfillGetBackgroundColor: descriptor --
(#
do fillBackgroundColor -> theColor;
#)

-- UIENVshapeOpen: descriptor --
(#
do inner open;
#)

-- UIENVshapeOnRefresh: descriptor --
(#
do	inner onRefresh;
#)

-- UIENVshapeonHiliteChanged: descriptor --
(#
do	inner onHiliteChanged;
#)

-- shapeLib: attributes --
fillTile:
	(#
	enter private.fillTile[]
	exit private.fillTile[]
	#);
fillBackgroundColor:
	(#
	enter private.fillBackgroundColor
	exit private.fillBackgroundColor
	#);
fillForegroundColor:
	(#
	enter private.fillForegroundColor
	exit private.fillForegroundColor
	#);
getMacRect:
	(#	r: @rectangle;
		mr: ^macRect;
	do frame -> r;
		r[] -> makeMacrect -> mr[];
	exit mr[]
	#);
useFill:
	(# data: [2] @integer;
	do (if fillTile<>None//true then
			PenNormal;
			whiteColor -> BackColor;
			blackColor -> ForeColor;
			(if private.fillTile.isPixPat//true then
				
			else
				private.fillTile.patternData -> data;
				@@data[1] -> PenPat;
			if);
			inner;
		if);
	#);
-- UIENVshapePrivate: descriptor --
(# fillTile: ^raster;
	fillBackgroundColor,fillForegroundColor: @color;
#)

-- UIENVovalOpen: descriptor --
(#
do	inner open;
#)

-- UIENVovalOnRefresh: descriptor --
(#
do	father.focus
		(#	mr: ^macRect;
		do	getMacRect -> mr[];
			useFill
				(#
				do mr[] -> PaintOval;
				#);
			usePen:
				(#
				do mr[] -> FrameOval;
				#);
		#);
	inner onRefresh;
#)

-- UIENVrectOpen: descriptor --
(#
do	inner open;
#)

-- UIENVrectOnRefresh: descriptor --
(#
do	father.focus
		(#	mr: ^macRect;
		do	getMacRect -> mr[];
			useFill
				(#
				do mr[] -> PaintRect;
				#);
			usePen:
				(#
				do mr[] -> FrameRect;
				#);
		#);
	inner onRefresh;
#)

-- UIENVRoundRectOpen: descriptor --
(#
do	inner open;
#)

-- UIENVroundRectSetRoundness: descriptor --
(#
do	(theOvalHeight,theOvalWidth) ->  roundrectRoundNess
#)

-- UIENVroundRectGetRoundness: descriptor --
(#
do roundrectRoundNess -> (theOvalHeight,theOvalWidth)
#)

-- UIENVroundRectOnRefresh: descriptor --
(#
do	father.focus
		(#	mr: ^macRect;
			h,v: @integer;
		do	getMacRect -> mr[];
			roundRectRoundness -> (h,v);
			useFill
				(#
				do (mr[],h,v) -> PaintRoundRect;
				#);
			usePen:
				(#
				do (mr[],h,v) -> FrameRoundRect;
				#);
		#);
	inner onRefresh;
#)

-- roundRectLib: attributes --
roundrectRoundNess:
	(#
	enter private.roundrectRoundNess
	exit private.roundrectRoundNess
	#);
-- UIENVroundRectPrivate: descriptor --
(#	roundrectRoundNess: @point;
#)

-- UIENVWedgeOpen: descriptor --
(#
do	inner open;
#)

-- UIENVwedgeSetStartAngle: descriptor --
(#
do angle -> wedgeStartAngle;
#)

-- UIENVwedgeGetStartAngle: descriptor --
(#
do wedgeStartAngle -> angle;
#)

-- UIENVwedgeSetEndAngle: descriptor --
(#
do angle -> wedgeEndAngle;
#)

-- UIENVwedgeGetEndAngle: descriptor --
(#
do wedgeEndAngle -> angle;
#)

-- UIENVwedgeOnRefresh: descriptor --
(#
do	father.focus
		(#	mr: ^macRect;
			start,end: @integer;
		do	getMacRect -> mr[];
			wedgeStartAngle -> start;
			wedgeEndAngle -> end;
			useFill
				(#
				do (mr[],start,end) -> PaintArc;
				#);
			usePen:
				(#
				do (mr[],start,end) -> FrameArc;
				#);
		#);
	inner onRefresh;
#)

-- wedgeLib: attributes --
wedgeStartAngle:
	(#
	enter private.wedgeStartAngle
	exit private.wedgeStartAngle
	#);
wedgeEndAngle:
	(#
	enter private.wedgeEndAngle
	exit private.wedgeEndAngle
	#);
-- UIENVwedgePrivate: descriptor --
(#	wedgeStartAngle,wedgeEndAngle: @integer;
#)

-- UIENVpolygonSetPoints: descriptor --
(#
do	(if private.polygonMacPoly<>0//true then
		private.polygonMacPoly -> KillPoly;
		0 -> private.polygonMacPoly;
	if);
	thePoints[] -> makeMacPoly -> private.polygonMacPoly;
#)

-- UIENVpolygonGetPoints: descriptor --
(#
do	(* Not implemented !!! *)
#)

-- UIENVpolygonOpen: descriptor --
(#
do	inner open;
#)

-- UIENVpolygonOnRefresh: descriptor --
(#
do	(if private.polygonMacPoly<>0//true then
		father.focus
			(#
			do	useFill
					(#
					do private.polygonMacPoly -> PaintPoly;
					#);
				usePen:
					(#
					do private.polygonMacPoly -> FramePoly;
					#);
			#);
	if);
	inner onRefresh;
#)

-- UIENVpolygononFrameChanged: descriptor --
(#
do	inner onFrameChanged;
#)

-- UIENVpolygonPrivate: descriptor --
(#	polygonMacPoly: @integer;
#)

--]]
