ORIGIN '~beta/guienv/guienv';
INCLUDE '~beta/guienv/private/X11/guienv_unixprivate';
INCLUDE '~beta/guienv/graphics';
INCLUDE '~beta/guienv/private/X11/graphics_unixbody';



-- program: descriptor --
guienv
(#
   XImage: data
     (# width: @integer;
        height: @integer;
        xoffset: @integer;
        format: @integer;
        data: @integer;
        byte_order: @integer;
        bitmap_unit: @integer;
        bitmap_bit_order: @integer;
        bitmap_pat: @integer;
        depth: @integer;
        bytes_per_line: @integer;
        bits_per_pixel: @integer;
        red_mask: @integer;
        green_mask: @integer;
        blue_mask: @integer;
        obdata: @integer;
        hook1, hook2, hook3, hook4, hook5, hook6: @integer;
     #);
   XPutImage: External (* 6.7 *)
     (# display,drawable,gc,srcX,srcY,dstX,dstY,width,height: @integer;
        image: ^XImage;
     enter (display,drawable,gc,image[],srcX,srcY,dstX,dstY,width,height)
     #);
   
   MandelbrotImage: External 
     (# display: @integer;
        image: @integer;
     enter (display, image)
     #);
   image: ^XImage;
   error: @integer;
   w: @window
     (# c: @canvas
          (# eventHandler::
               (# 
                  onRefresh::
                    (#
                    do graphics
                       (#
                       do (private.display, private.window, private.gc,
                          image[], 0, 0, 0, 0, image.width, image.height) -> XPutImage;
                       #);
                    #);
                  
               #);
             open::
               (#
               do (image.width, image.height) -> size;
               #);
          #);
        open::
          (#
          do (image.width, image.height) -> size;
             c.open;
          #);
     #);
   name: ^text;
do (this(guienv).private.display, @@image) -> MandelbrotImage;
   w.open;
#)

