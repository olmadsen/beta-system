ORIGIN '../toolbarBody';

INCLUDE 
'~beta/guienv/v1.6/private/winnt/guienv_ntiprivate';

-- toolBarButtonLib: attributes --
toolBarButtonMethods: windowItemMethods
  (# dispatchMessage::
       (# processCommand:
            (# type: @integer;
               id: @integer;
            do info.wParam.hiWord -> type;
               info.wParam.loWord -> id;
               (if type
                //CBN_SELENDOK then
                   
                   
                //CBN_DROPDOWN then
                   
                else
                   false -> didSomething;
               if);
            #);
          didSomething: @boolean;
       do true -> didSomething;
          (if info.message 
           //WM_COMMAND then processCommand; 
           else
              false -> didSomething;
          if);
          didSomething or info.handled -> info.handled;
       #);
  #);

-- GUIEnvTbButtonSetToolTip: doPart --
do theTip[] -> private.theTip[];
   
-- GUIEnvTbButtonGetToolTip: doPart --
do private.theTip[] -> theTip[];

-- GUIEnvToolBarButtonCreate: doPart --
do inner;
   
-- GUIEnvToolBarButtonOpen: doPart --
do (24,22) -> size;
   (0,0) -> position;
   false -> showLabel;
   true -> border.visible;
   borderStyles.shadowOut -> border.style;
   inner;
   
-- GUIEnvToolBarButtonOnMouseDown: doPart --
do (* (if buttonState=1 then
    *        borderStyles.shadowIn -> border.style;
    *        true -> update;
    *        trackMouse
    *        (# mouseMove::
    *             (# r: @rectangle; 
    *             do ((0,0),size) -> r;
    *                (if (curPt -> r.containsPoint) then
    *                    (if border.style=borderStyles.shadowOut then
    *                        borderStyles.shadowIn -> border.style;
    *                        true -> update;
    *                    if);
    *                 else
    *                    (if border.style=borderStyles.shadowIn then
    *                        borderStyles.shadowOut -> border.style;
    *                        true -> update;
    *                    if);
    *                if);
    *             #);
    *           MouseRelease::
    *             (#
    *             do borderStyles.shadowOut -> border.style;
    *                true -> update;
    *             #); 
    *        #);
    *    if);
    *)
   inner;
   
-- GUIEnvToolBarButtonOnMouseUp: doPart --
do inner;
   
-- GUIEnvToolBarButtonOnStyleChanged: doPart --
do inner;
   
-- GUIEnvToolBarButtonPrivateAttr: descriptor --
(# 
   theTip: ^text;
   predefined: @boolean;
#)

-- toolbarLib: attributes --


-- GUIEnvToolbarCreate: doPart --
do 
   false -> this(windowItem).private.borderHandledLocally;
   inner create;
   
   
-- GUIEnvToolbarOpen: doPart --
do (# w,h: @integer;
   do 
      true -> border.visible;
      borderStyles.shadowOut -> border.style;
      (if father[]<>NONE then 
          father.size -> (w,h);
       else
          100 -> w;
      if);
      (w-4,30) -> size;
      (2,1) -> position;
      true -> bindRight;
   #);
   
   inner;
   
   
-- GUIEnvToolbarAdd: doPart --
do (# w,h,w2,h2,x,y: @integer;
   do (if theButton[]<>NONE then
          theButton.size -> (w,h);
          (private.theButtons.lastX+4,4) -> theButton.position;
          w + 4 + private.theButtons.lastX -> private.theButtons.lastX;
          this(toolBar).size -> (w2,h2);
          (if h+4>h2 then
              (w2,h+6) -> this(toolBar).size;
          if);
      if);
   #);
   
-- GUIEnvTBonFatherFrameChanged: doPart --
do 
   inner;
   
-- GUIEnvTBonFrameChanged: doPart --
do 
   inner;
   
-- GUIEnvTBonRefresh: doPart --
do 
   inner onRefresh;
   (* (# width,height: @integer;
    *    do size -> (width,height);
    *       (this(toolBar)[],borderStyles.shadowOut,0,0,width,height) -> drawBorder;
    *    #);
    *)

-- GUIenvToolbarPrivate: descriptor --
(# 
   theButtons: @list
     (# element:: toolBarButton;
        lastX: @integer;
     #);
#)
