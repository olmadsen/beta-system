ORIGIN '~beta/guienv/guienv';

BODY 'private/movieplayerbody';


-- guienvLib: attributes --

movie:
	(* A movie represents quicktime movies that can be
	 * played in a moviePlayer.
	 *)
	(# <<SLOT movieLib: attributes>>;
		read:
			(* Read the specified movie file. *)
			(# theFileName: ^text;
			enter theFileName[]
			<<SLOT movieRead: doPart>>
			#);
		userSelectFile:
			(* Let the user select a movie file in a standard file
			 * dialog.
			 *)
			(# success: @boolean;
			<<SLOT movieUserSelectFile: doPart>>
			exit success
			#);
		length:
		   (* Return the length of the movie. *)
			(# theLength: @integer;
			<<SLOT movieLength: doPart>>
			exit theLength
			#);
		fileName:
			(* The name of the movie file. *)
			(# theFileName: ^text;
			<<SLOT movieFilename: doPart>>
			exit theFileName[]
			#);
		displaySize:
			(* The natural width and height of the movie. *)
			(# width, height: @integer;
			<<SLOT movieDisplaySize: doPart>>
			exit (width, height)
			#);
		private: @<<SLOT moviePrivate: descriptor>>;
	#);
	

-- windowLib: attributes --

moviePlayer: canvas
	(# <<SLOT moviePlayerLib: attributes>>;
	
		contents:
		   (* The movie that are selected in the moviePlayer. *)
			(#
			enter (# enter  theMovie[] <<SLOT moviePlayerSetContents: doPart>> #)
			exit theMovie[]
			#);
		read:
			(* Read the specified movie file. This is a shortcut for initialising a 
			 * Movie.
			 *)
			(# theFileName: ^text;
			enter theFileName[]
			<<SLOT movieplayerRead: doPart>>
			#);
		userSelectFile:
			(* Let the user select a movie file in a standard file
			 * dialog.This is a shortcut for initialising a 
			 * Movie.
			 *)
			(# success: @boolean;
			<<SLOT movieplayerUserSelectFile: doPart>>
			exit success
			#);
			
		moviePosition:
			(# thePosition: @real;
			enter (# enter thePosition <<SLOT moviePlayerSetMoviePosition: doPart>> #)
			exit (# <<SLOT moviePlayerGetMoviePosition: doPart>> #)
			#);
			
		start:
			(* Start playing. *)
			(# <<SLOT moviePlayerStart: doPart>> #);
		stop:
			(* Stop playing. *)
			(# <<SLOT moviePlayerStop: doPart>> #);
		pause:
			(* Pause playing. *)
			(# <<SLOT moviePlayerPause: doPart>> #);
		open::<
			(#
			<<SLOT moviePlayerOpen: doPart>>
			#);
		close::<
			(#
			<<SLOT moviePlayerClose: doPart>>
			#);
		eventHandler::<
			(# contentsChanged: event
					(#
					do INNER;
					#);
				onContentsChanged:< contentsChanged;
				
				onActivate::<
					(# <<SLOT moviePlayerOnActivate: doPart>> #);
				onDeactivate::<
					(# <<SLOT moviePlayerOnDeactivate: doPart>> #);
				onMouseDown::<
					(# <<SLOT moviePlayerOnMouseDown: doPart>> #);
				onRefresh::<
					(# <<SLOT moviePlayerOnRefresh: doPart>> #);
			#);
		theMovie: ^movie;
		private: @<<SLOT moviePlayerPrivate: descriptor>>;
	#);