ORIGIN '~beta/guienv/v1.6/guienv';
BODY 'private/treeViewBody';
(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1997
 *       All rights reserved.
 *)

-- windowLib: attributes --
treeView: canvas
  (# <<SLOT treeViewLib: attributes>>;
     
     resourceAllocationError:< exception
       (# errorMsg: ^text;
       enter errorMsg[]
       do inner;
       #);
     
     apiError:< exception
       (# errorMsg: ^text;
       enter errorMsg[]
       do inner;
       #);
     
     initialNoOfIcons:< integerValue
       (# do 4 -> value; inner; #);
     
     initialNoOfStateIcons:< integerValue
       (# do 2 -> value; inner; #);
     
     treeItem: interfaceObject
       (# <<SLOT treeItemLib: attributes>>;
          name:
            (# theName: ^text;
            enter (# enter theName[] <<SLOT GUIEnvTreeItemSetName: doPart>> #)
            exit (# <<SLOT GUIenvTreeItemGetName: doPart>> exit theName[] #)
            #);
          
          icons:
            (# selectedIcon, notSelectedIcon, overlayIcon, stateIcon: ^pixmap;
            enter (# 
                  enter (selectedIcon[], notSelectedIcon[], overlayIcon[], stateIcon[])
                  <<SLOT GUIEnvTreeItemSetIcons: doPart>>
                  #)
            exit (# 
                 <<SLOT GUIEnvTreeItemGetIcons: doPart>> 
                 exit (selectedIcon[], notSelectedIcon[], overlayIcon[], stateIcon[])
                 #)
            #);                    
          
          append:
            (# theItem: ^treeItem;
            enter theItem[]
            <<SLOT GUIEnvTreeItemAppend: doPart>>
            #);
          
          prepend:
            (# theItem: ^treeItem;
            enter theItem[]
            <<SLOT GUIEnvTreeItemPrepend: doPart>>
            #);
          
          insert:
            (# theAfterItem: ^treeItem;
               theItem: ^treeItem;
            enter (theItem[], theAfterItem[])
            <<SLOT GUIEnvTreeItemInsert: doPart>>
            #);                    
          
          delete:<
            (* Deletes this(treeItem) from this(treeView). *)
            (# <<SLOT GUIEnvTreeItemDelete: doPart>> #);
          
          (* The programmer should not call open directly. Open is called
           * when the item is appended, prepended or inserted. 
           *)
          open::<
            (# create::<
                 (# <<SLOT GUIEnvTreeItemCreate: doPart>> #);
               <<SLOT GUIEnvTreeItemOpen: doPart>> 
            #);
          
          scan:
            (# current: ^treeItem;
            <<SLOT GUIEnvTreeItemScan: doPart>>
            #);
          
          select:
            (# <<SLOT GUIEnvTreeItemSelect: doPart>> #);
          
          deSelect:
            (* Call this to deSelect this(treeItem). *)
            (# <<SLOT GUIEnvTreeItemDeSelect: doPart>> #);
          
          expand:
            (# 
            <<SLOT GUIEnvTreeItemExpand: doPart>>
            #);
          
          collapse:
            (# 
            <<SLOT GUIEnvTreeItemCollapse: doPart>>
            #);
          
          (******* Events ********)
          onBeforeNameChange:<
            (# allow: @boolean;
            do true -> allow;
               inner;
            exit allow
            #);
          
          onNameChanged:<
            (# newName: ^text;
            enter newName[]
            do inner;
            #);
          
          onSelect:<
            (* Called when this(treeItem) is selected by the user or
             * the programmer. 
             *)
            (# do inner; #);                    
          
          onDoubleClick:<
            (# do inner; #);
          
          onRMouseUp:<
            (# globalPosition: @point;
            enter globalPosition
            do INNER ; 
            #);
          
          onBeforeExpand:<
            (# allow: @boolean;
            do true -> allow;
               inner;
            exit allow
            #);
          
          onExpand:<
            (* Called when this(treeItem) is expanded by the user or
             * the programmer. 
             *)
            (# flag: @integer; (* expandFlags *)
            enter flag
            do inner; 
            #);
          
          onBeforeCollapse:<
            (# allow: @boolean;
            do true -> allow;
               inner;
            exit allow
            #);
          
          onCollapse:<
            (* Called when this(treeItem) is expanded by the user or
             * the programmer. 
             *)
            (# flag: @integer; (* expandFlags *)
            enter flag
            do inner; 
            #);
          
          tiPrivate: @<<SLOT GUIEnvTreeItemPrivate: descriptor>>;
       #);
     
     append:
       (# theItem: ^treeItem;
       enter theItem[]
       <<SLOT GUIEnvTreeViewAppend: doPart>>
       #);
     
     prepend:
       (# theItem: ^treeItem;
       enter theItem[]
       <<SLOT GUIEnvTreeViewPrepend: doPart>>
       #);
     
     insert:
       (# theAfterItem: ^treeItem;
          theItem: ^treeItem;
       enter (theItem[], theAfterItem[])
       <<SLOT GUIEnvTreeViewInsert: doPart>>
       #);
     
     scan:
       (# current: ^treeItem;
       <<SLOT GUIEnvTreeViewScan: doPart>>
       #);
     
     selection: @
       (# 
          first: 
            (# theItem: ^treeItem;
            <<SLOT GUIEnvTreeViewSelectionFirst: doPart>> 
            exit theItem[]
            #);
       #);
     
     noOfElms: integerValue
       (# <<SLOT GUIEnvTreeViewNoOfElms: doPart>> #);
     
     clear: (* Removes all treeItems. *)
       (# <<SLOT GUIEnvTreeViewClear: doPart>> #);
     
     open::<
       (# create::<
            (# <<SLOT GUIenvTreeViewCreate: doPart>> #);
       <<SLOT GUIEnvTreeViewOpen: doPart>> 
       #);
     
     close::<
       (# <<SLOT GUIEnvTreeViewClose: doPart>> #);
     
     eventHandler::<
       (# onMouseUp::<
            (# <<SLOT GUIEnvTreeViewEventHandlerOnMouseUp: doPart>> #);
          onMouseDown::<
            (# <<SLOT GUIEnvTreeViewEventHandlerOnMouseDown: doPart>> #);
       #);
     
     tvPrivate: @<<SLOT GUIEnvTreeViewPrivate: descriptor>>;
  #)
