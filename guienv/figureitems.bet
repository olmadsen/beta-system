ORIGIN 'guienv';
BODY 'private/figureitemsbody'
(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1991-96
 *       All rights reserved.
 *)
-- windowLib: attributes --
(* idx=2 *)
figureItem: windowitem
  (* superclass for all vector graphics *)
  (# <<SLOT figureItemLib: attributes>>;
     (* idx+ *)
     pen: @
       (* this item models the properties of the pen used to draw the
        * outline of THIS(figureItem)
        *)
       (# foregroundColor: 
            (* sets the foreground color of the pen used to draw
             * THIS(figureItem)
             *)
            (# theColor: @color;
            enter (# enter theColor do <<SLOT GUIENVpenSetForegroundColor: descriptor>> #)
            exit (# do <<SLOT GUIENVpenGetForegroundColor: descriptor>> exit theColor #)
            #);
          backgroundColor: 
            (* sets the background color of the pen used to draw
             * THIS(figureItem)
             *)
            (# theColor: @color;
            enter (# enter theColor do <<SLOT GUIENVpenSetBackgroundColor: descriptor>> #)
            exit (# do <<SLOT GUIENVpenGetBackgroundColor: descriptor>> exit theColor #)
            #);
          stipple:
            (* The pattern used for stippling when drawing with the
             * pen
             *)
            (# p: ^raster;
            enter (# enter p[] do <<SLOT GUIENVpenSetStipple: descriptor>> #)
            exit (# do <<SLOT GUIENVpenGetStipple: descriptor>> exit p[] #)
            #);
          size: 
            (* sets the size of the pen used to draw THIS(figureItem)
             *)
            (# value: @integer;
            enter (# enter value do <<SLOT GUIENVpenSetSize: descriptor>> #)
            exit (# do <<SLOT GUIENVpenGetSize: descriptor>> exit value #)
            #);
       #) (* pen *);
     (* idx- *)
     open::< 
       (* The initialy pen characteristics of THIS(figureItem) are 
        *   stiple          = patterns.black
        *   foreGroundColor = colors.black
        *   backGroundColor = colors.white
        *   size      = 1
        *)
       (# create::< (# do <<SLOT GUIENVfigureItemCreate: descriptor>> #);
       do <<SLOT GUIENVfigureItemOpen: descriptor>> 
       #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVfigureItemOnRefresh: descriptor>>; #);
       #);
     (* idx- *)
     layoutType::< figureItemLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVfigureItemputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVfigureItemgetLayout: doPart>> #);
     private: @<<SLOT GUIENVfigureItemPrivate: descriptor>>;
  #) (* figureItem *);
line: figureItem
  (* straight line defined by a startPt and a endPt *)
  (# <<SLOT lineLib: attributes>>;
     start: 
       (# theStart: @point;
       enter (# enter theStart do <<SLOT GUIENVlineSetStart: descriptor>> #)
       exit (# do <<SLOT GUIENVlineGetStart: descriptor>> exit theStart #)
       #);
     end: 
       (# theEnd: @point;
       enter (# enter theEnd do <<SLOT GUIENVlineSetEnd: descriptor>> #)
       exit (# do <<SLOT GUIENVlineGetEnd: descriptor>> exit theEnd #)
       #);
     open::< 
       (# do <<SLOT GUIENVLineOpen: descriptor>> #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVlineOnRefresh: descriptor>> #);
          onFrameChanged::<
            (# do <<SLOT GUIENVlineonFrameChanged: descriptor>> #);
          onHiliteChanged::<
            (#  do <<SLOT GUIENVlineonHiliteChanged: descriptor>> #);
       #);
     (* idx- *)
     layoutType::< lineLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVlineputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVlinegetLayout: doPart>> #);
     private: @<<SLOT GUIENVlinePrivate: descriptor>>;
  #) (* line *);
shape: figureItem
  (* figures that can be filled *)
  (# <<SLOT shapeLib: attributes>>;
     (* idx+ *)
     fill: @
       (* This item models the properties of the fill of THIS(shape)
        *)
       (# tile: 
            (* Sets the tile raster used to fill THIS(figureItem) *)
            (# p: ^raster;
            enter (# enter p[] do <<SLOT GUIENVFillSetTile: descriptor>> #)
            exit (# do <<SLOT GUIENVfillGetTile: descriptor>> exit p[] #)
            #);
          foregroundColor: 
            (* Sets the foreground color of the pen used to draw
             * THIS(figureItem).
             *)
            (# theColor: @color;
            enter (# enter theColor do <<SLOT GUIENVFillSetForegroundColor: descriptor>> #)
            exit (# do <<SLOT GUIENVfillGetForegroundColor: descriptor>> exit theColor #)
            #);
          backgroundColor: 
            (* Sets the background color of the pen used to draw
             * THIS(figureItem).
             *)
            (# theColor: @color;
            enter (# enter theColor do <<SLOT GUIENVFillSetBackgroundColor: descriptor>> #)
            exit (# do <<SLOT GUIENVfillGetBackgroundColor: descriptor>> exit theColor #)
            #);
       #);
     (* idx- *)
     open::< 
       (* The fill of THIS(shape) is initially: 
        *   colorForeground = black
        *   colorBackground = white
        *)
       (# do <<SLOT GUIENVshapeOpen: descriptor>> #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVshapeOnRefresh: descriptor>> #);
          onHiliteChanged::<
            (#  do <<SLOT GUIENVshapeonHiliteChanged: descriptor>> #);
       #);
     (* idx- *)
     layoutType::< shapeLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVshapeputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVshapegetLayout: doPart>> #);
     private: @<<SLOT GUIENVshapePrivate: descriptor>>;
  #) (* shape *);
oval: shape
  (* the oval is defined by a rectangle *)
  (# <<SLOT ovalLib: attributes>>;
     open::< (# do <<SLOT GUIENVovalOpen: descriptor>> #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVovalOnRefresh: descriptor>> #);
       #);
     (* idx- *)
     layoutType::< ovalLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVovalputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVovalgetLayout: doPart>> #);
  #) (* oval *);
rect: shape
  (# <<SLOT rectLib: attributes>>;
     open::< (# do <<SLOT GUIENVrectOpen: descriptor>> #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVrectOnRefresh: descriptor>> #);
       #);
     (* idx- *)
     layoutType::< rectLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVrectputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVrectgetLayout: doPart>> #);
  #) (* rect *);
roundRect: shape
  (* rectangular shape with rounded corners *)
  (# <<SLOT roundRectLib: attributes>>;
     open::< 
       (# do <<SLOT GUIENVRoundRectOpen: descriptor>> #);
     roundness: 
       (* the corner roundness is specified by means of an Oval *)
       (# theOvalHeight,theOvalWidth: @integer;
       enter (# enter (theOvalHeight,theOvalWidth) do <<SLOT GUIENVroundRectSetRoundness: descriptor>> #)
       exit (# do <<SLOT GUIENVroundRectGetRoundness: descriptor>> exit (theOvalHeight,theOvalWidth) #)
       #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVroundRectOnRefresh: descriptor>> #);
       #);
     (* idx- *)
     layoutType::< roundRectLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVroundRectputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVroundRectgetLayout: doPart>> #);
     private: @<<SLOT GUIENVroundRectPrivate: descriptor>>;
  #) (* roundRect *);
wedge: shape
  (* a piece of cake *)
  (# <<SLOT wedgeLib: attributes>>;
     open::< 
       (# do <<SLOT GUIENVWedgeOpen: descriptor>> #);
     startAngle: 
       (* evaluate the enter part to set the angle, where THIS(wedge)
        * starts.  Evaluate the exit part to get it
        *)
       (# angle: @integer;
       enter (# enter angle do <<SLOT GUIENVwedgeSetStartAngle: descriptor>> #)
       exit (# do <<SLOT GUIENVwedgeGetStartAngle: descriptor>> exit angle #)
       #);
     endAngle: 
       (* evaluate the enter part to set the angle, where THIS(wedge)
        * ends.  Evaluate the exit part to get it
        *)
       (# angle: @integer;
       enter (# enter angle do <<SLOT GUIENVwedgeSetEndAngle: descriptor>> #)
       exit (# do <<SLOT GUIENVwedgeGetEndAngle: descriptor>> exit angle #)
       #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVwedgeOnRefresh: descriptor>> #);
       #);
     (* idx- *)
     layoutType::< wedgeLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVwedgeputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVwedgegetLayout: doPart>> #);
     private: @<<SLOT GUIENVwedgePrivate: descriptor>>;
  #) (* wedge *);
polygon: shape
  (# <<SLOT polygonLib: attributes>>;
     points: 
       (* set or get the points that represents THIS(polygon).  There
        * must be at least 3 points
        *)
       (# thePoints: [3] ^point;
       enter (# enter thePoints do <<SLOT GUIENVpolygonSetPoints: descriptor>> #)
       exit (# do <<SLOT GUIENVpolygonGetPoints: descriptor>> exit thePoints #)
       #);
     open::<
       (#  
       do <<SLOT GUIENVpolygonOpen: descriptor>>;
       #);
     (* idx+ *)
     eventhandler::<
       (# onRefresh::<
            (# do <<SLOT GUIENVpolygonOnRefresh: descriptor>> #);
          onFrameChanged::<
            (# do <<SLOT GUIENVpolygononFrameChanged: descriptor>> #);
       #);
     (* idx- *)
     layoutType::< polygonLayout;
     putLayout::< (* private *) (# <<SLOT GUIENVpolygonputLayout: doPart>> #);
     getLayout::< (* private *) (# <<SLOT GUIENVpolygongetLayout: doPart>> #);
     private: @<<SLOT GUIENVpolygonPrivate: descriptor>>;
  #) (* polygon *);
