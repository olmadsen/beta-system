<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>

<HEAD>




<TITLE> An Example of Modifying the Pretty-print Specification</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING33></A>


<P><A HREF=yggdrasil-34.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=yggdrasil-32.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=yggdrasil-30.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> 6.2.8 Modifying the Pretty-print Specification</P>


<A NAME=HEADING33-0></A>
<H1> An Example of Modifying the Pretty-print Specification</H1>
<P> As mentioned the makepretty script generates a default pretty-print specification. This section illustrates the default pretty-print specification of the sample grammar and how the specification can be improved to obtain a more &quot;pretty&quot; pretty-printing.</P>
<P> The default pretty-print specification for mylang (mylang-pretty.pgram) might looks like<EM><A REL=FOOTNOTE HREF="#FOOTNOTE-5">[5]</A></EM>: </P>

<PRE class=beta>
-- mylang: prettyprint: prettyprint --
PrettyPrintScheme mylangSpec
for mylang:
module =  T:1 $$ * $$ N:1 $$ T:2 $$ N:2 $$ T:3 $$ N:3 $$ T:4;
id =  N:1;
importOpt =  N:1 ;
import =  T:1 $$ * $$ N:1 $$ T:2;
nameList =  ( {c T:1 $$ } );
statement =  N:1 ;
if =  T:1 $$ * $$ N:1 $$ T:2 $$ N:2 $$ T:3 $$ N:3 $$ T:4;
while =  T:1 $$ * $$ N:1 $$ T:2 $$ N:2 $$ T:3;
statementList =  ( {c T:1 $$ } );
exp =  N:1 ;
text =  N:1;
number =  N:1;
expProcCall =  N:1;
procCall =  N:1 $$ T:1 $$ * $$ T:2
</PRE>

<P> As can be seen the default specification uses default breaks; there are no blocks except in lists; the block type of a list is consistent and only the list separator is specified; comments are only associated with constructor productions and always after the first terminal symbol. </P>
<P> Let us look at the following source file:</P>

<PRE class=beta>
-- test: module: mylang --
module pip;
(* Copyright 1992*)
(* Mj&oslash;lner Informatics *)
import dyt, baat, olsen; (* some imported operations *)
begin
  while olsen() do
     if (* the test condition will be filled out later *) &lt;&lt;condition:exp&gt;&gt;
     then
        dyt()
     else if &lt;&lt;condition:exp&gt;&gt; then baat() else &lt;&lt;elsePart:statement&gt;&gt; endif
     endif;
     &lt;&lt;statement&gt;&gt;
  end
end
</PRE>

<P> Using the default pretty-printer specification as generated by the makepretty tool (see above) results in the following pretty-print<EM><A REL=FOOTNOTE HREF="#FOOTNOTE-6">[6]</A></EM>: </P>

<PRE class=beta>
-- test: module: mylang --
module (* Copyright 1992 *)
(* Mj&oslash;lner Informatics *) pip ; import
(* some imported operations *) dyt, baat, olsen ; begin while olsen ( ) do
if
(* the test condition will be filled out later *)
&lt;&lt;condition: exp&gt;&gt;
then
dyt
(
)
else
if
&lt;&lt;condition: exp&gt;&gt;
then
baat
(
)
else
&lt;&lt;elsePart: statement&gt;&gt;
endif
endif;
&lt;&lt;statement&gt;&gt; end end  
</PRE>


<P> Because there are no blocks in the specification, the pretty-printer tries to write as much as possible on each line as can be seen on the first three lines of the program. Note that no blocks in the specification has the same effect as one surrounding inconsistent block. After the third line each item is written on a separate line. This is caused by the statementList, that introduces a consistent block of statements. </P>
<P> This pretty-printing is certainly not very pretty, but only a few
modifications of the specifiation improves the layout
drastically. Consider the following modified specification: </P>

<PRE class=beta>
-- mylang: prettyprint: prettyprint --
PrettyPrintScheme mylangSpec
for mylang:
module =  [c [i T:1 $$ N:1 T:2 ] $$ * $$ N:2 $$ [c T:3 $1,2 N:3 $$ T:4] ];
id =  N:1;
importOpt =  N:1 ;
import =  [i T:1 $$ N:1 T:2 $$ *];
nameList =  ( {i T:1 $$ } );
statement =  N:1 ;
if =  [c [i T:1 $$ * $1,3 N:1 $$ T:2 ] $1,3 N:2 $$ [i T:3 $1,3 N:3] $$ T:4 ];
while =  [c [i T:1 $$ * $$ N:1 $$ T:2 ] $1,3 N:2 $$ T:3];
statementList =  ( {c T:1 $$ } );
exp =  N:1 ;
text =  N:1;
number =  N:1;
expProcCall =  N:1;
procCall =  N:1 T:1 T:2 $$ *
</PRE>

<P> The test program now looks much nicer: </P>

<PRE class=beta>
-- test: module: mylang --
module pip;
(* Copyright 1992 *)
(* Mj&oslash;lner Informatics *)
import dyt, baat, olsen; (* some imported operations *)
begin
  while olsen() do
     if (* the test condition will be filled out later *)
        &lt;&lt;condition: exp&gt;&gt; then
        dyt()
     else
        if &lt;&lt;condition: exp&gt;&gt; then
           baat()
        else &lt;&lt;elsePart: statement&gt;&gt;
        endif
     endif;
     &lt;&lt;statement&gt;&gt;
  end
end  
</PRE>

<P> The following changes have been made: In the module production
some blocks have been introduced: one that surrounds the whole
production, one that surrounds the header of the module and one that
surrounds the body of the module. It is important that the block types
of the first and the last block are consistent. The break between the
module name and the &quot;:&quot; have been removed. The comment
character have been moved. The break between the begin keyword and the
&lt;statement&gt; has been changed to an indention of two
characters. </P> <P> In the nameList production, the block type has
been changed to inconsistent. The import production is surrounded by
an inconsistent block in order to &quot;overload&quot; the consistent
block of the start production. In the if and while productions, blocks
has been introduced and the indention has been changed. In the
procCall production, the breaks has been removed. </P> <P> The reader
is recommended to try to understand the effect of these modifications
in order to gain insight into the workings of the pretty-print
specification.</P>






<HR>

<A NAME=FOOTNOTE-5>[5] </A>
 This default pretty-print speficication is subject to changes. The default pretty-print specification on your system might differ from the one shown here. Especially will all construction nonterminals have consistent blocks surrounding their right-hand pretty-print specifications.
<HR>

<A NAME=FOOTNOTE-6>[6] </A>
 Since the default pretty-print specification might differ on your system, the same applies for this pretty-print example.









<!-- TOC -->



<HR>
<P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="33%" align="left">
<ADDRESS>Metaprogramming System</ADDRESS>
</TD>
<TD width="34%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="33%" align="right"><FONT size=-1><SCRIPT LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></FONT></TD>
</TABLE>
<P>
<P><A HREF=yggdrasil-34.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=yggdrasil-32.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=yggdrasil-30.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
