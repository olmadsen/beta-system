<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>

<HEAD>
<LINK REL=TOP HREF=index.html>
<LINK REL=UP HREF=distribution-19.html>
<LINK REL=PREV HREF=distribution-20.html>
<LINK REL=NEXT HREF=distribution-22.html>
<TITLE> 4.5.2. CreateShell Implementation</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>

<DIV>
<A NAME=HEADING21></A>

<DIV>
<P><A HREF=distribution-22.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=distribution-20.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=distribution-19.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=contents.html><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> 4.5. The ensemble pattern</P>

</DIV>
<A NAME=HEADING21-0></A>
<H1> 4.5.2. CreateShell Implementation</H1>
<P> Since the distribution library is currently available only on UNIX platforms, the description in this section is UNIX specific. The implementation of CreateShell on e.g. a Macintosh target is different. See also section 5 that describes system dependencies.</P>
<!-- FM pgf ignored -->
<P> Below, &quot;old shell&quot; refers to the shell executing a createShell, whereas &quot;new shell&quot; refers to the shell being created. Assuming the new shell is created on a remote host, CreateShell uses UNIX rsh <A NAME=MARKER-2-32></A>to run the remoteStart script on the remote host. If the rsh process could not be forked, the processCreationFailed exception is raised. Thus, processCreationFailed signals lack of resources on the local host. </P>
<!-- FM pgf ignored -->
<P> Otherwise, if forking rsh succeeds, the old shell reads from the standard output of the rsh process, i.e. what is written by the remoteStart script, to determine whether things went all right. remoteStart determines the target machine type and then executes the machine specific startAsDeamon executable. If the startAsDeamon executable or the shell executable could not be found, the execNotFound exception is raised. Errors different from processCreationFailed, relating to process start, raise the unknownError exception.</P>
<P> Finally, if the new shell process seems to have been successfully created, the thread in the old shell thread doing createShell waits for a callback from the new shell. If the callback<EM><A REL=FOOTNOTE HREF="#FOOTNOTE-8">[8]</A></EM> is not received within the time limit set by the active errorHandler, a timeOut exception is raised in that errorHandler. In the mean time, other threads in the old shell are allowed to do some work.</P>
<P> When the callback arrives, a reference to the new shell is included as a parameter. If the new shell does not qualify to the type entered as parameter to createShell, the typeError exception is raised.</P>
<P> The above description assumed that the target host was different from the local host. If the new shell is created on the local host, sh is used to execute the remoteStart script directly. That is, rsh is not used in the local case, making local createShell calls more efficient.</P>

</DIV>

<DIV>

<DIV>
<HR>

<A NAME=FOOTNOTE-8>[8] </A>
 The callback is of course made automatically be the system.

</DIV>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="33%" align="left">
<ADDRESS>Distribution Reference Manual</ADDRESS>
</TD>
<TD width="34%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="33%" align="right"><FONT size=-1><SCRIPT LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></FONT></TD>
</TABLE>
<P>
<P><A HREF=distribution-22.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=distribution-20.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=distribution-19.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=contents.html><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
