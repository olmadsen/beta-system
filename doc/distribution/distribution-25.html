<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>

<HEAD>
<LINK REL=TOP HREF=index.html>
<LINK REL=UP HREF=distribution-23.html>
<LINK REL=PREV HREF=distribution-24.html>
<LINK REL=NEXT HREF=distribution-26.html>
<TITLE> 4.6.2. Error handling</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING25></A>


<P><A HREF=distribution-26.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=distribution-24.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=distribution-23.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=contents.html><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> 4.6. The errorHandler pattern</P>


<A NAME=HEADING25-0></A>
<H1> 4.6.2. Error handling</H1>



<P> To handle network errors, further bind the corresponding error virtual as listed above. Within further bindings, one of the patterns ignore, continue or abort should be called as the last action. Note that if there are imperatives following the call to e.g. continue, they will not be executed! ignore, continue and abort are described below.</P>
<P> abort: <A NAME=MARKER-2-50></A>is default if the further binding of some error does not call either ignore, continue or abort. If abort is called and not further specified, the remote call that failed is aborted, and the shell killed. However, to prevent the calling shell from being killed, abort can be further specified. In the further specification, it is allowed to do a leave in the dopart. For example:</P>
<PRE CLASS=beta>
do myLabel: errorHandler
     (# connectionFailed:: 
          (# 
          do abort (# do leave myLabel #)
          #);
     do server.op1; ...; server.opn;
     #);
</PRE>
<P>  To ensure proper clean up, it is not allowed to leave the dopart of an error virtual outside the scope of an abort.</P>
<P>  That is, the following code is not allowed. In the worst case it may lead to segmentation faults. In the best case, a number of communication resources may not be released properly.</P>
<PRE CLASS=beta>
do myLabel: errorHandler
     (# connectionFailed:: 
          (# 
          do leave myLabel
          #);
     do server.op1; ...; server.opn;
     #);

</PRE>
<P> ignore<A NAME=MARKER-2-51></A>: Terminates the failing remote call, but pretends as if the remote call succeded. Control flow continues after the remote call causing the error. For example:</P>
<PRE CLASS=beta>
do errorHandler
   (# connectionFailed:: (# do ignore #);
   do server1.op1; server2.op2;
   #);
</PRE>
<P>  If the server.op1 remote call fails, control flow continues with the server.op2 call. This may of course result in rather strange program behaviour, but is the responsibility of the programmer. It makes no sense to further specify the ignore pattern since it never calls INNER.</P>
<P> continue<A NAME=MARKER-2-52></A>: Depending on the actual exception, retries or continues the operation that caused the error. For example. in the case of a timeOut, continue means that the communication subsystem will wait once again for the number of seconds specified in the timeOutValue virtual in effect. In the case of a connectionFailed, connection is retried. As with ignore, it makes no sense the further bind continue.</P>
<P> In order to maintain the errorHandler chain, it is not allowed to leave the dopart of an errorHandler directly. Leaving an errorHandler must be done from inside the dopart of a leaveHandler:</P>
<PRE CLASS=beta>
do someLabel: errorHandler
   (#
   do ...;
      leaveHandler (# do leave someLabel #)
   #);
</PRE>
<P> However, from inside the error.abort pattern, the errorHandler currently handling the error may be left directly, as was shown in the abort example above.</P>
<P> NOTICE: It is not allowed to leave the dopart of an errorHandler outside the scope of a leaveHandler.</P>
<P> If multiple errorHandlers are left simultaneously, the leaveHandler <A NAME=MARKER-2-53></A>nested inside the outermost errorHandler in the dynamic call chain must be used. For example:</P>
<PRE CLASS=beta>
do e1: errorHandler
   (# leaveFirst: leaveHandler (# do INNER #);
   do e2: errorHandler
      (# leaveSecond: leaveHandler (# do INNER #)
      do e3: errorHandler
         (#
         do leaveFirst (# do leave e1 #);
         #)
      #)
   #);
</PRE>







<!-- TOC -->



<HR>
<P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="33%" align="left">
<ADDRESS>Distribution Reference Manual</ADDRESS>
</TD>
<TD width="34%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="33%" align="right"><FONT size=-1><SCRIPT LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></FONT></TD>
</TABLE>
<P>
<P><A HREF=distribution-26.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=distribution-24.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=distribution-23.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=contents.html><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
