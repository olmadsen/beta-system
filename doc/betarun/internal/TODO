Subject: ComponentPVValue etc som enum

kan g|re "reached end of nonvoid function" fjernet.
Og kan muligvis eliminere ProtoSwitch hacket.

-----------------------------------


Eliminate LazyItem, CallLazyItem:
Change DOT to contain *handles* to BETA objects instead of
pointers as now.
Allocate LazyItem in lazyref_gc.c and add a handle to it to
DOT (then GC does not have to have special knowledge about
LazyItem, since it will be handled via DOT).

-------------------------------------
Her er lidt til TODO-listen:

   1) Hvis man er uheldig, kan AOAtoIOAReAlloc's egne AOAtoIOAInsert's
      udl|se en ny AOAtoIOAReAlloc, hvilket s} vidst jeg umiddelbart kan
      se ikke vil fungere korrekt.

   2) Det ville v{re en god ide at rense ud i AOAtoIOAtable i stedet for
      at allokere en ny og st|rre tabel. Praktiske erfaringer viser, at
      langt hovedparten af indgangene typisk er for{ldede, n}r tabellen
      l|ber fuld, fordi de udpegede objekter i mellemtiden er flyttet
      til AOA.

      Som det var f|r, lavedes der kun udrensning i tabellen ved AOAGc;
      nu sker det ogs} ved AOAtoIOAReAlloc, hvilket jo egentlig er for
      sent (men bedre end ingenting).

      Det er virkelig noget skidt, hvis tabellen vokser un|digt, da det
      |ger tiden for hver eneste IOAGc, at den skal genneml|bes; og med
      den nuv{rende heuristik s{ttes st|rrelsen aldrig ned igen.

   3) Jens Cornelius Olsen og J|rgen Greve havde problemer med at
      InfoFile gav sideeffekter p} programafviklingen. Det kan muligvis
      skyldes, at der var rod i den pga. inkonsistens skyldet min lidt
      for optimistiske udrensningsalgoritme (jeg glemte at ToSpace-
      referencer er lovlige hvis AOAtoIOAReAlloc sker ved AOAGc). Hvis
      de stadig har problemet, skal vi have set p} det.

/Jacob


-------

CInterface:
----------
Nu hvor beta char-reps allokeres som i C, s} kan CInitT undv{res, hvis
CpkVT afl|ses af at compileren beregner offset'et til 1. char.
Kr{ver dog, at der ikke kommer GC'er.


GC:
-------------------------------------
scavenging.c, aoa.c etc: use GCEntry* in steping through static GC tables 

Lad v{re med at opbygge IOAtoAOAtable under hver IOAGc, g|r det i stedet
f|r hver AOAGc vha IOAGc med flag sat.

Rutine til at kalde AOAGc direkte (foruds{tter at AOAtoIOATable laves af AOAGc direkte.

Hvis man løber tør for primes: Kopier alt til AOA.


RUN:
-------------------------------------

Make GCEntry, CBFAEntry etc. datatype. (Is now defined, not used yet)

ExitObjects.run: 
   exitObj = theObj not enough. Should be checked if it IS a reference!
   next must not be in beta heap.
   
   ORIGIN 'betaenv'
   ---program:descriptor--
   (# A:
	(#
	do 'b' -> put; 
	   L: (# S: @| (#
		       do 'c' -> put;
			  suspend;
			  'e' -> put;
			  P
		       #);
		 P: @| (# do 'f' -> put; leave L #)
	      do S; 'd'->put; S; 'q'->put
	      #);
	   'r'->put
	#);
   
   do 'a' ->put; A; 'w'->put
   #) 

RUN:
CRUN:
LVRA check missing in CopyText+CopyCText+CopySliceValRep+MakeTextObject

RUN: Passing arguments in pReg1 when DataReg1 is not used is a waste 
(e.g. AlloI).

CRUN:
=====

Clean up in SnakeAdditions.S (RefSP loaded/saved too often?).
Remove all saved{IOA,IOATopOff,RefSP} in snake code (currently undef'ed).

Dynamic allocation of ReferenceStack. Check for more than 50% filled in AlloI.


Beta.dump:
==========

See TST/tstdump/README for status.

