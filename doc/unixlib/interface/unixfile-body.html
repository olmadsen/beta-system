<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<!-- Autogenerated file - do not edit -->
<HEAD>
<TITLE>Unixfile Interface</TITLE>
<LINK REL="stylesheet" HREF="../../style/miadoc.css" TYPE="text/css">
<SCRIPT DEFER TYPE="text/javascript" LANGUAGE="JavaScript" SRC="../../javascript/hashfromparent.js"></SCRIPT>
<SCRIPT DEFER TYPE="text/javascript" LANGUAGE="JavaScript" SRC="../../javascript/printframe.js"></SCRIPT>
<BASE TARGET="_top">
</HEAD>
<BODY onLoad='HashFromParent()'>
<H1><A name="unixfile">Unixfile Interface</A></H1>
<PRE CLASS=interface>
ORIGIN '~beta/basiclib/file';
LIB_DEF 'unixfile' '../lib';
BODY 'private/unixfile_body';

---- LIB: attributes ----

<B>UnixEntry</B><A name="UnixEntry.1(1)"></A>: DiskEntry
  (* Pattern describing unix specific attributes of disk-entries like
   * files and directories in a hierarchic unix file system
   *)
  (# 
     &lt;&lt;SLOT UnixEntryLib: attributes&gt;&gt;;
     
     <B>UnixEntryExisted</B><A name="UnixEntry.1:UnixEntryExisted.2(2)"></A><A name="UnixEntryExisted.2(2)"></A>: Exception
       (* Raised on attempt to make an existing unix entry into a
        * symbolic link using linkTo or linkFrom. Message: "Attempt to
        * make an existing UnixEntry into a symbolic link"
        *)
       (# ... #);

     <B>followlinks</B><A name="UnixEntry.1:followlinks.2(3)"></A><A name="followlinks.2(3)"></A>: 
       (* If the disk entry corresponding to THIS(UnixEntry).path
        * exists and is a link to some other entry, then if
        * followlinks is true the disk entry pointed to is manipulated
        * by the operations below, otherwise the link itself is
        * manipulated.  Defaults to TRUE.
        *)
       (# f: @boolean;
       enter (# enter f ... #)
       exit (# ... exit f #)
       #);
     
     <B>permission</B><A name="UnixEntry.1:permission.2(4)"></A><A name="permission.2(4)"></A>: @permissiondesc
       (* An object to manipulate the protection and mode of
        * THIS(UnixEntry).  This gives a more fine-grained access to
        * the unix permissions than the inherited attributes
        * "readable" and "writeable".  All operations on "permission"
        * are used like this :
        * 
        * (who,mode) -&gt; permission.operation ... ;
        * 
        * "who" denotes a category of users : 'a' -- all, 'u' -- user
        * (owner), 'g' -- group, 'o' -- other.
        * 
        * "mode" denotes the mode of THIS(UnixEntry) : 'r' -- read,
        * 'w' -- write, 'x' -- execute.
        *);
     <B>permissiondesc</B><A name="UnixEntry.1:permissiondesc.2(5)"></A><A name="permissiondesc.2(5)"></A>:&lt;
       (# &lt;&lt;SLOT UnixFilePermLib: attributes&gt;&gt;;
          
          (* PERMISSION EXCEPTIONS *)
          <B>WrongUserError</B><A name="UnixEntry.1:permissiondesc.2:WrongUserError.3(6)"></A><A name="WrongUserError.3(6)"></A>:&lt; Exception
            (* Raised if something other than 'a', 'u', 'g', or 'o'
             * is specified for "who". Message: "Wrong user
             * specification for disk entry permission."
             *)
            (# ... #);
          <B>WrongModeError</B><A name="UnixEntry.1:permissiondesc.2:WrongModeError.3(7)"></A><A name="WrongModeError.3(7)"></A>:&lt; Exception
            (* Raised if something other than 'r', 'w', or 'x' is
             * specified for "mode". Message: "Wrong mode
             * specification for disk entry permission."
             *)
            (# ... #);
          <B>ChangePermError</B><A name="UnixEntry.1:permissiondesc.2:ChangePermError.3(8)"></A><A name="ChangePermError.3(8)"></A>:&lt; DiskEntryException
            (* Raised if a change of permissions has failed for
             * THIS(UnixEntry).  Message: "Failed to change permission
             * for disk entry."
             *)
            (# ... #);
          <B>OtherError</B><A name="UnixEntry.1:permissiondesc.2:OtherError.3(9)"></A><A name="OtherError.3(9)"></A>:&lt; DiskEntryException
            (* Raised if other errors occurred *);
          
          <B>has</B><A name="UnixEntry.1:permissiondesc.2:has.3(10)"></A><A name="has.3(10)"></A>:
            (* True if "who" has the "mode" access to
             * THIS(UnixEntry).
             *)
            (# mode,who: @char;
               result: @boolean;
            enter (who,mode)
            ...
            exit result
            #);
          <B>add</B><A name="UnixEntry.1:permissiondesc.2:add.3(11)"></A><A name="add.3(11)"></A>: 
            (* Give "who" the "mode" access to THIS(UnixEntry) *)
            (# mode,who: @char;
            enter (who,mode)
            ...
            #);
          <B>remove</B><A name="UnixEntry.1:permissiondesc.2:remove.3(12)"></A><A name="remove.3(12)"></A>: 
            (* Remove the "mode" from the way "who" may access
             * THIS(UnixEntry).
             *) 
            (# mode,who: @char;
            enter (who,mode)
            ...
            #);
       #); (* permission *)
     <B>device</B><A name="UnixEntry.1:device.2(13)"></A><A name="device.2(13)"></A>: IntegerValue
       (* Integer denoting the device on which the Inode of
        * THIS(UnixEntry) resides
        *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>inode</B><A name="UnixEntry.1:inode.2(14)"></A><A name="inode.2(14)"></A>: IntegerValue
       (* Unambigous integer denoting the identity of this unix entry
        *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>isCharSpecial</B><A name="UnixEntry.1:isCharSpecial.2(15)"></A><A name="isCharSpecial.2(15)"></A>: BooleanValue
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>isBlockSpecial</B><A name="UnixEntry.1:isBlockSpecial.2(16)"></A><A name="isBlockSpecial.2(16)"></A>: BooleanValue
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>isSymbolicLink</B><A name="UnixEntry.1:isSymbolicLink.2(17)"></A><A name="isSymbolicLink.2(17)"></A>: BooleanValue
       (* True if THIS(UnixEntry) is a symbolic link.  Always false
        * if followlinks is set to true (default)
        *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>isSocket</B><A name="UnixEntry.1:isSocket.2(18)"></A><A name="isSocket.2(18)"></A>: BooleanValue
       (* True if THIS(UnixEntry) is a socket *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>hardLinks</B><A name="UnixEntry.1:hardLinks.2(19)"></A><A name="hardLinks.2(19)"></A>: IntegerValue
       (* Number of hard links to THIS(UnixEntry) *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>deviceType</B><A name="UnixEntry.1:deviceType.2(20)"></A><A name="deviceType.2(20)"></A>: IntegerValue
       (* If THIS(UnixEntry) is a device, the integer exited denotes
        * the type of the device
        *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>owner</B><A name="UnixEntry.1:owner.2(21)"></A><A name="owner.2(21)"></A>:
       (* Set/get the userid (an integer) denoting the identity of
        * the owner of THIS(UnixEntry)
        *) 
       (# uid: @integer;
          error:&lt;DiskEntryException;
          set: (# enter uid do ... #);
          get: (# ... exit uid #);
       enter set
       exit get
       #);
     <B>group</B><A name="UnixEntry.1:group.2(22)"></A><A name="group.2(22)"></A>:
       (* Set/get the group id (an integer) denoting the identity of
        * the group to which the owner of THIS(UnixEntry) belongs
        *) 
       (# gid: @integer;
          error:&lt;DiskEntryException;
          set: (# enter gid do ... #);
          get: (# ... exit gid #);
       enter set
       exit get
       #);
     <B>accessTime</B><A name="UnixEntry.1:accessTime.2(23)"></A><A name="accessTime.2(23)"></A>: IntegerValue
       (* The (system) time of the last read or write manipulation of
        * THIS(UnixEntry)
        *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>statusTime</B><A name="UnixEntry.1:statusTime.2(24)"></A><A name="statusTime.2(24)"></A>: IntegerValue
       (* System time of the last status change of
        * THIS(UnixEntry). In our case a status change occurs when the
        * following operations are activated on THIS(UnixEntry):
        * touch, permission.add, permission.remove
        *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>optimalBlockSize</B><A name="UnixEntry.1:optimalBlockSize.2(25)"></A><A name="optimalBlockSize.2(25)"></A>: IntegerValue
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>blocks</B><A name="UnixEntry.1:blocks.2(26)"></A><A name="blocks.2(26)"></A>: IntegerValue 
       (* The actual number of blocks allocated for THIS(UnixEntry) *)
       (# error:&lt;DiskEntryException;
       ...
       #);
     <B>linkTo</B><A name="UnixEntry.1:linkTo.2(27)"></A><A name="linkTo.2(27)"></A>:
       (* Make THIS(UnixEntry) be a symbolic link to dst. The
        * 'exists' exception is raised if THIS(UnixEntry) allready
        * exists.
        *)
       (# dst: ^text;
          error:&lt; DiskEntryException;
          exists:&lt; UnixEntryExisted;
          link: ^UnixEntry;
       enter dst[]
       do ...;
       #);
     <B>linkFrom</B><A name="UnixEntry.1:linkFrom.2(28)"></A><A name="linkFrom.2(28)"></A>:
       (* Make src be a symbolic link to THIS(UnixEntry). The
        * 'exists' exception is raised if src allready exists. If no
        * errors occur, link is a UnixEntry for the link, with
        * followlinks set to false.
        *)
       (# src: ^text;
          error:&lt;DiskEntryException;
          exists:&lt; UnixEntryExisted;
          link: ^UnixEntry;
       enter src[]
       do ...;
       exit link
       #);
     
  #); (* UnixEntry *)

<B>UnixFile</B><A name="UnixFile.1(29)"></A>: File
  (* BETA interface to disk files in UNIX *)
  (#
     &lt;&lt;SLOT UnixFileLib: attributes&gt;&gt;;
     
     <B>EntryDesc</B><A name="UnixFile.1:EntryDesc.2(30)"></A><A name="EntryDesc.2(30)"></A>::&lt; UnixEntry;
     
     <B>OpenExeWrite</B><A name="UnixFile.1:OpenExeWrite.2(31)"></A><A name="OpenExeWrite.2(31)"></A>: 
       (* Like OpenWrite, except that the file written will be
        * executable
        *)
       (# ... #);
     <B>OpenExeAppend</B><A name="UnixFile.1:OpenExeAppend.2(32)"></A><A name="OpenExeAppend.2(32)"></A>:
       (* Like OpenAppend, except that the file written will be
        * executable
        *)
       (# ... #);
  #)
</PRE>
<!---------------------------------------------------------->
<HR>
<P></P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="40%" align="left"><ADDRESS>Unixfile Interface</ADDRESS></TD>
<TD width="20%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT LANGUAGE=JavaScript SRC="../../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
</BODY>
</HTML>
