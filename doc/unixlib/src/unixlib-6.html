<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE> Using the unixDirectory Fragment</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING6></A>


<P><A HREF=unixlib-7.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=unixlib-5.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=unixlib-5.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html#_toc"><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> The unixDirectory Library</P>


<A NAME=HEADING6-0></A>
<H1> Using the unixDirectory Fragment</H1>
<P> A program using the unixDirectory fragment will have the following structure:</P>
<PRE CLASS=beta>
INCLUDE '~beta/unixlib/unixDirectory'
--- program: descriptor ---
(# ...
   ud: @unixDirectory;
do ...
   'unixDirectory.bet' -&gt; ud.findEntry(# ... do ... #);
#)
</PRE>
<A NAME=HEADING6-10></A>
<H1> Listing Unix Directory Example</H1>
<P> Program showing a simple use of UNIX directory: The directory with the path given as argument is scanned, and the names of all the entries are printed with an indication of what type of entry it is. This is done using the select pattern of <A NAME=MARKER-scanEntries>scanEntries</A>. This is a more efficient strategy than using found.entry.isFile etc., possibly correcting for the case that 'd' is not current <A NAME=MARKER-working>working</A> directory.</P>
<P> If the path given is not a directory, an exception will be raised: </P>

<H4 CLASS=betacaption>listUnix.bet</H4>
<PRE CLASS=beta>
ORIGIN '~beta/unixlib/unixdirectory';
-- PROGRAM: descriptor --

(* Program showing a simple use of UNIX directory: The directory with the path 
 * given as argument is scanned, and the names of all the entries are printed
 * with an indication of what type of entry it is.
 * This is done using the 'select' pattern of 'scanentries'. This is a more
 * efficient startegy than using 'found.entry.isFile' etc., possibly 
 * correcting for the case that 'd' is not current working directory.
 * If the path given is not a directory, an exception will be raised.
 *)

(# arg: ^text; 
   d: @UnixDirectory; 
   nl: @boolean; 
   full: @boolean;
   usage:
     (# do 'Usage: ' -&gt; puttext; 
        1-&gt;arguments-&gt;puttext; 
        ' [-f] path' -&gt; putline;
        stop;
     #);
do (* Parse command line *)
   (if noOfArguments
    // 1 then '.' -&gt; d.name
    // 2 then
       2 -&gt; arguments -&gt; arg[];
       (if '-f' -&gt; arg.equal
        // true then
           true -&gt; full;
           '.' -&gt; d.name;
        // false then
           arg[] -&gt; d.name;
       if)
    // 3 then
       2 -&gt; arguments -&gt; arg[];
       (if '-f' -&gt; arg.equal
        // true then
           true -&gt; full;
        // false then usage;
       if);
       3 -&gt; arguments -&gt; d.name;
    else
       usage;
   if);
   
   (* Scan directory *)
   newline;
   'The content of '''-&gt; puttext;
   d.name -&gt; puttext;
   ''' is: ' -&gt; putline;
   d.scanEntries
   (# 
   do false -&gt; found.followlinks;
      select
      (# whenFile::&lt;
           (# do 'File:          ' -&gt; puttext; #);
         whenDir::&lt;
           (# do 'Directory:     ' -&gt; puttext; #);
         whenSocket::&lt;  
           (# do 'Socket:        ' -&gt; puttext; #);
         whenSymboliclink::&lt; 
           (# do 'Link:          ' -&gt; puttext; #);
         whenCharSpecial::&lt;  
           (# do 'Char special:  ' -&gt; puttext; #);
         whenBlockSpecial::&lt; 
           (# do 'Block special: ' -&gt; puttext; #);
         whenOther::&lt;
           (# do '(Unknown):     ' -&gt; puttext; #);
      #);
      (if full
       // true then foundFullPath -&gt; putline; 
       // false then found.path -&gt; putline; 
      if);
   #);
   newline;
#)
</PRE>




<HR>
<P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left">
<ADDRESS>UNIX Libraries</ADDRESS>
</TD>
<TD width="20%" align="center"><FONT SIZE="-1">&#169; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
<P>
<P><A HREF=unixlib-7.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=unixlib-5.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=unixlib-5.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html#_toc"><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
