<body>

<H2> 8. The Use of this(P) for Component Objects </H3>

Consider the following example: </P>
<PRE class=beta>
P: (#  A: (# X: ^P; (* reference to item qualified by P *)
       B: ^|P (* reference to component qualified by P *)
   do this(P)[] -&gt; X[];   (* legal use of this(P)[] *)
      this(P)[] -&gt; R[];   (* illegal use of this(P)[] *)
   #)
</PRE>

<P>The compiler assumes that <tt>this(P)[]</tt> is a reference to an
item object. Since an item reference cannot be assigned to a component
reference the evaluation <tt>this(P)[] -&gt; R[]</tt> is illegal.

<P> It is, however, possible to use a run-time routine to convert
an item reference to a component reference, provided that the item
is part of a component. Consider:

<PRE class=beta>
(# P: (# B: |^ P
      do this(P)[] -> objectToComponent -> B[] 
      #);
   X: |@ P;
   Y: @ P;
do X;  (* OK *)
   Y; (* a run-time error will happen *)
#)
</PRE>

When <tt>X</tt> is executed, the P-object is part of the component 
X and <tt>objectToComponent</tt> will return a reference to X.

<P> When <tt>Y</tt> is executed, the P-object is not part of a
component and <tt>objectToComponent</tt> will fail.

<P>It is also possible to get a reference to the item-part of a component
by using the pattern <tt>componentToObject</tt> as shown in:
<PRE class=beta>X[] -> componentToObject</PRE>

<P>The patterns <tt>objectToComponent</tt> and <tt>componentToObject</tt>
are placed in the library:
<PRE class=beta>sysutils/objinterface.bet</PRE>

</body>
