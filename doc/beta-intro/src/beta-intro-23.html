<H1> <A NAME="LINK-beta-intro-_Toc403635897"><A NAME=MARKER-9-129></A>Control Patterns</A></H1>
<P> Sub (procedure) patterns are used intensively in BETA for defining control patterns<A NAME=MARKER-2-131></A> (control structures). This includes simple control patterns like cycle, forTo, etc. It also includes so-called iterators on data objects like list, set and register. A pattern describing a register of objects may have the following interface:</P>
<A NAME=HEADING23-2></A>
<H1> scan is a control pattern</H1>
<PRE CLASS=beta>
register:
  (# has: (# E: ^type; B: @boolean enter E[] do  exit B #);
     insert: (# E: ^type enter E[] do  #);
     delete: (# E: ^type enter E[] do  #);
     scan: (# current: ^type do  inner  #);
     
  #)
</PRE>
<P> A number of details have been left out from the example. These include the representation and implementation of the register. A register may include instances of the pattern type, which has not been specified. Type is an example of a virtual class pattern which will be introduced later. For the moment type is assumed to stand for the pattern object which is a superclass of all patterns, i.e. a register may include instances of all patterns. An instance of register may be declared and used as follows:</P>
<PRE CLASS=beta>
employees: @register;

mary[]-&gt;employees.insert; 
(if boss[]-&gt;employees.has then  if)
</PRE>
<P> The control pattern scan may be used as follows:</P>
<A NAME=HEADING23-7></A>
<H1> Using a control pattern</H1>
<PRE CLASS=beta>
0-&gt;totalSalary;
employees.scan
  (# do current.computeSalary+totalSalary-&gt;totalSalary #);
totalSalary-&gt;screen.putint
</PRE>
<P> This works as follows:</P>
<UL>
<LI> The imperative employees.scan(#  #) is an example of a singular action object<A NAME=MARKER-2-132></A> as mentioned in section 4. 
<LI> The do-part of scan has an inner imperative which is executed for each element in the register. The details of this are not shown, but it may be implemented as a loop that steps through the elements of the register and executes inner for each element.
<LI> The attribute current of scan is used as an index variable that for each iteration refers to the current element of the register. This may be implemented by assigning the reference of the current element to current before inner is executed.
<LI> The effect of executing the above singular action object is that current.computeSalary+totalSalary-&gt;totalSalary is executed for each element in the register.
</UL>











