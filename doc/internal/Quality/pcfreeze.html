<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>

<HEAD>
<LINK REL="stylesheet" HREF="http://www.mjolner.dk/style/mjolner.css" TYPE="text/css">
<TITLE>PC frysning</TITLE>
<LINK REV=MADE HREF="mailto:falk@mjolner.dk">
</HEAD>

<BODY>
<H1>PC frysning</H1>

<H2><A NAME="pcfreeze">Frysning af release: Windows</A></H2>

Frysning af et release til Windows (her eksemplificeret af r5.2.1).
Frysningen skal foregå på en windowsmaskine, der har InstallSheild 6 installeret:

<OL>
<LI><A HREF="#udcheck">Udcheckning og konfigurering af alle libraries.</A></LI>
<LI><A HREF="#oversat">Oversættelse af alle libraries/tools til både gnu og ms</LI></A>
<LI><A HREF="#test">Aftestning af Mjølner systemet</A></LI>
<LI><A HREF="#opryd">Oprydning</A></LI>
<LI><A HREF="#doc">Bygning af DOC dir</A></LI>
<LI><A HREF="#pak">Pakning af system</A></LI>
<LI>Kopiering af pakkede filer til daimi:~beta</LI>
<LI>udlægning af tar filer til FTP på mjolner</LI>
</OL>

<HR>

Sørg for at betacompileren og runtimesystemet er uptodate. Dette gøres som beskrevet i <a href="unixfreeze.html">unixfreeze.html</a>

<A name="udcheck"><H2>Udcheckning og konfigurering af alle libraries/tools.</H2></A>
Se <A HREF="mbsboot.html">mbsboot.html</A>


<A name="oversat"><H2>Oversættelse af alle libraries/tools til både gnu og ms</H2></A>
<PRE>
Afprøv først med 

	mbs_cvscheckupdate

om alle libraries/tools er i "sync" med UNIX.

Inden oversættelse bør man kalde scriptet 
<CODE>mbs_checkbet</CODE>, som checker, at der ikke ligger <CODE>.ast(L)</CODE>
filer i relaset, uden at have tilhørende source fil.

Tjek at MIASDK til "gnu"

Dernæst oversætter man alle relevante libraries med

	mbs_compile

og alle tools med

	mbs_compiletools

&gt;&gt;&gt;Ret MIASDK til "ms" og gentag.
</PRE>

<P>
Efter oversættelse bør man kalde scriptet 
<CODE>mbs_checkdb</CODE>, som checker, at alle <CODE>.bet</CODE>
filer i releaset, som har en <CODE>.o</CODE> fil, også har en
<CODE>.db</CODE> fil.
</LI>

<A name="test"><H2>Aftestning af Mjølner systemet</H2></A>
Se <A HREF="betatest.html">betatest.html</A>
</LI>

<A name="opryd"><H2>Oprydning</H2></A>
<PRE>
a. Fjern alle automatisk genererede filer fra hele %BETALIB%:

	mbs_clean -f -r
	
b. I %BETALIB%\demo\ fjernes desuden binære og objektfiler:

	cd %BETALIB%\demo\
	mbs_recursiveclean

c. Check for eventuel anden garbage rundt omkring
</PRE>
</LI>
<H2><A NAME="doc">Bygning af DOC dir</A></H2>
<PRE>
I %BETALIB%\doc udføres:
       make 
denne fejler sikkert første gang da man skal have
fat i htmldoc. Hvordan man henter den er beskrevet i fejl udskriften.
</PRE>
<A NAME="pak"><H2>Pakning af system vha InstallSHEILD</H2></A>
<PRE>
Dette skal gøres både for gnu og ms. Nedenfor er brugt ms som
eksempel. 
<p>
kør <CODE>scp -r beta@ariel:r5.2.1/export/tarfiles/nti.pe .</CODE><br> 

I det directory, som netop er blevet hentet:<br>
kør <code>extractexportfiles ms *.cmd</code><p>

Åbn InstallSheild og vælg <code>Mjølner System</code>. Hvis denne ikke
eksistere skal den hentes og udpakkes et passende sted. <p>

Vælg fanebladet <code>scripts</code>:<p>

vælg <code>setup.rul</code> under 'Mjolner systems' Script Files.
søg efter szSDK (med ctrl-f, pg find næste med F3) 
Ret szSDK(cirka hit nr. 3 i søgningen) til "ms" 
vælg <code>compile</code> i build menuen (jeg ved ikke hvorfor)<br> 

Vælg fanebladet <code>filegroups</code>:

Både i BaseSystem og doc expanderes og alle 'Static File Links'
slettes, ved at højre klik på static links og sige cut. 

I højre side af vinduet kan man nu højreklikke og 'Lanche Explorer'
Træk alle de filer(Som skulle ligge i C:\beta-export\ms\base), der
skal pakkes (-doc), over i folderen <code>Basesystem</code>. Til
folderen <code>doc</code> trækkes kun doc.<br>  
Altså de filer som <code>extractexportfiles ...</code> har lavet.<br>

Vælg fanebladet <code>Media</code>:

Tjek at den er sat til <code>"ms"</code><br>

Man skal nu tjekke at Licens texten er uptodate (!?!). 

Under menuen <code>Build</code> vælges build. <br>

Klik på <code>Package for the web wizard</code>(ikon i toolbaren): 

Svar på dens spørgsmål. (Læk mærke til at der bliver spurt om hvilke
filer som skal pakkes, her skal tjekkes om det er du rigtige.)
Kald filen ms-r5.2.2.2.exe.

</PRE>
</BODY>
</HTML>
