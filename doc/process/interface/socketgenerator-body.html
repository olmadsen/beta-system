<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<!-- Autogenerated file - do not edit -->
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE>Socketgenerator Interface</TITLE>
<LINK REL="stylesheet" HREF="../../style/miadoc.css" TYPE="text/css">

<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript" SRC="../../javascript/hashfromparent.js"></SCRIPT>
<BASE TARGET="_parent">
</HEAD>
<BODY onLoad='HashFromParent()'>
<H1><A name="socketgenerator">Socketgenerator Interface</A></H1>

<PRE CLASS=interface>
ORIGIN '~beta/basiclib/basicsystemenv';
LIB_DEF 'processsockgen' '../lib';

(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics 1995-97
 *       All rights reserved.
 *)

INCLUDE 'basicsocket';
BODY 'private/socketgenbody';

--- systemlib:attributes ---

<B>SocketGenerator</B><A name="SocketGenerator.1(179)"></A>:
  (# &lt;&lt;SLOT socketgeneratorlib:attributes&gt;&gt;;

     (* OPERATIONS
      * ==========
      *)

     (* Setting 'port'=0 and executing 'bind' gives you 
      * a SocketGeneratorthat accepts connections on a 
      * randomly chosen portnumer, which may be found in 'port'.
      *)
     <B>bind</B><A name="SocketGenerator.1.bind.2(180)"></A><A name="bind.2(180)"></A>: withIdleAndPE
       (# 
       enter port
       ...
       #);
     
     (* construct portable address for this generator *)
     <B>getPortableAddress</B><A name="SocketGenerator.1.getPortableAddress.2(181)"></A><A name="getPortableAddress.2(181)"></A>:
       (# addr: ^portablePortAddress;
       ...
       exit addr[]
       #);

     (* De-register the bind *)
     <B>close</B><A name="SocketGenerator.1.close.2(182)"></A><A name="close.2(182)"></A>: withIdleAndPE
       (# 
       ...
       #);

     (* provoke a timeout error in the current operation *)
     <B>forceTimeout</B><A name="SocketGenerator.1.forceTimeout.2(183)"></A><A name="forceTimeout.2(183)"></A>: @
       (#
       ...
       #);
     
     (* return timestamp of latest operation on this generator *)
     <B>usageTimestamp</B><A name="SocketGenerator.1.usageTimestamp.2(184)"></A><A name="usageTimestamp.2(184)"></A>: @integerValue
       (#
       ...
       #);

     (* CALLBACKS
      * =========
      *)

     (* every local 'idle' executes this global one *)
     <B>idle</B><A name="SocketGenerator.1.idle.2(185)"></A><A name="idle.2(185)"></A>:&lt; object;

     (* socket level error callback *)
     <B>error</B><A name="SocketGenerator.1.error.2(186)"></A><A name="error.2(186)"></A>:&lt; hiErrCB(# do INNER #);

     (* EXPLICIT SCHEDULING
      * ===================
      *)

     (* NB: don`t 'leave' a 'nonBlockingScope'. 
      * Use 'leaveNBScope'. 
      *)
     <B>nonBlockingScope</B><A name="SocketGenerator.1.nonBlockingScope.2(187)"></A><A name="nonBlockingScope.2(187)"></A>: (# ... #);
     <B>leaveNBScope</B><A name="SocketGenerator.1.leaveNBScope.2(188)"></A><A name="leaveNBScope.2(188)"></A>: (# ... #);

     (* ATTRIBUTES
      * ==========
      *)
     
     <B>port</B><A name="SocketGenerator.1.port.2(189)"></A><A name="port.2(189)"></A>: @assignGuard(# rep: @integer enter rep exit rep #);

     (* AUXILIARY PATTERNS
      * ==================
      *)
     
     <B>withIdleAndPE</B><A name="SocketGenerator.1.withIdleAndPE.2(190)"></A><A name="withIdleAndPE.2(190)"></A>:
       (# error:&lt; hiErrCB (* operation level error callback *)
            (#
            do INNER;
               (if errCB_initialValue=value then 
                   (value,cleanup[])-&gt;
                   this(socketGenerator).error-&gt;value;
               if);
            #);
          loErrCB: errCB (* superpattern for 
                          * concrete error callbacks 
                          *)
            (#
            do INNER;
               (if errCB_initialValue=value then 
                   (value,cleanup[])-&gt;error-&gt;value;
               if);
            #);
          usageError:&lt; loErrCB(# do INNER #);
          resourceError:&lt; loErrCB(# do INNER #);
          accessError:&lt; loErrCB(# do INNER #);
          addressError:&lt; loErrCB(# do INNER #);
          connBrokenError:&lt; loErrCB(# do INNER #);
          intrError:&lt; loErrCB(# do INNER #);
          internalError:&lt; loErrCB(# do INNER #);
          unknownError:&lt; loErrCB(# do INNER #);
          timedOut:&lt; loErrCB(# do INNER #);
          Idle:&lt; (# do INNER; this(socketGenerator).Idle #);
          Blocking:&lt;(# continue: (# do true-&gt;doContinue #);
               doContinue: @boolean;
            do INNER;
               (if not doContinue then leaveNBScope if);
               Idle;
            #);
       do INNER
       #);

     (* PRIVATE
      * =======
      *)
     
     <B>private</B><A name="SocketGenerator.1.private.2(191)"></A><A name="private.2(191)"></A>: @...;
  #)
</PRE>
<TABLE BORDER=0 ALIGN=RIGHT>
<TR>
<TD>
<A HREF="http://validator.w3.org/check/referer">
<IMG BORDER=0 SRC="../../images/vh40.gif" ALT="Valid HTML 4.01!" HEIGHT=31 WIDTH=88>
</A>
</TD>
</TR>
</TABLE>
<BR CLEAR=right>
<P></P>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<HR>
<P></P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left"><ADDRESS>Socketgenerator Interface</ADDRESS></TD>
<TD width="20%" align="center"><FONT size="-1">&#169; <A HREF="http://www.mjolner.com" TARGET="_top">Mj&oslash;lner Informatics</A></FONT>
</TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
</BODY>
</HTML>
