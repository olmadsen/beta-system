<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>Socketgenerator Interface</TITLE>
<LINK REL="stylesheet" HREF="../../style/miadoc.css" TYPE="text/css">
</HEAD>
<BODY>
<P></P>
<A HREF="streamgenerator.html"><IMG ALIGN=BOTTOM SRC="../../images/next.gif" ALT=Next BORDER=0></A>
<A HREF="processmanager.html"><IMG ALIGN=BOTTOM SRC="../../images/prev.gif" ALT=Prev BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html"><IMG ALIGN=BOTTOM SRC="../../images/content.gif" ALT=Content BORDER=0></A>
<A HREF="inx.html"><IMG ALIGN=BOTTOM SRC="../../images/index.gif" ALT=Index BORDER=0></A>
<P></P>
<P>Interface Description</P>
<HR>
<!---------------------------------------------------------->

<H1>Socketgenerator Interface</H1>
<PRE CLASS=interface>
ORIGIN '~beta/basiclib/basicsystemenv';
LIB_DEF 'processsockgen' '../lib';

(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics 1995-97
 *       All rights reserved.
 *)

INCLUDE 'basicsocket';
BODY 'private/socketgenbody';

--- systemlib:attributes ---

<B>SocketGenerator</B><A name="SocketGenerator.1(197)"></A>:
  (# &lt;&lt;SLOT socketgeneratorlib:attributes&gt;&gt;;

     (* OPERATIONS
      * ==========
      *)

     (* Setting 'port'=0 and executing 'bind' gives you 
      * a SocketGeneratorthat accepts connections on a 
      * randomly chosen portnumer, which may be found in 'port'.
      *)
     <B>bind</B><A name="SocketGenerator.1:bind.2(198)"></A><A name="bind.2(198)"></A>: withIdleAndPE
       (# 
       enter port
       ...
       #);
     
     (* construct portable address for this generator *)
     <B>getPortableAddress</B><A name="SocketGenerator.1:getPortableAddress.2(199)"></A><A name="getPortableAddress.2(199)"></A>:
       (# addr: ^portablePortAddress;
       ...
       exit addr[]
       #);

     (* De-register the bind *)
     <B>close</B><A name="SocketGenerator.1:close.2(200)"></A><A name="close.2(200)"></A>: withIdleAndPE
       (# 
       ...
       #);

     (* provoke a timeout error in the current operation *)
     <B>forceTimeout</B><A name="SocketGenerator.1:forceTimeout.2(201)"></A><A name="forceTimeout.2(201)"></A>: @
       (#
       ...
       #);
     
     (* return timestamp of latest operation on this generator *)
     <B>usageTimestamp</B><A name="SocketGenerator.1:usageTimestamp.2(202)"></A><A name="usageTimestamp.2(202)"></A>: @integerValue
       (#
       ...
       #);

     (* CALLBACKS
      * =========
      *)

     (* every local 'idle' executes this global one *)
     <B>idle</B><A name="SocketGenerator.1:idle.2(203)"></A><A name="idle.2(203)"></A>:&lt; object;

     (* socket level error callback *)
     <B>error</B><A name="SocketGenerator.1:error.2(204)"></A><A name="error.2(204)"></A>:&lt; hiErrCB(# do INNER #);

     (* EXPLICIT SCHEDULING
      * ===================
      *)

     (* NB: don`t 'leave' a 'nonBlockingScope'. 
      * Use 'leaveNBScope'. 
      *)
     <B>nonBlockingScope</B><A name="SocketGenerator.1:nonBlockingScope.2(205)"></A><A name="nonBlockingScope.2(205)"></A>: (# ... #);
     <B>leaveNBScope</B><A name="SocketGenerator.1:leaveNBScope.2(206)"></A><A name="leaveNBScope.2(206)"></A>: (# ... #);

     (* ATTRIBUTES
      * ==========
      *)
     
     <B>port</B><A name="SocketGenerator.1:port.2(207)"></A><A name="port.2(207)"></A>: @assignGuard(# rep: @integer enter rep exit rep #);

     (* AUXILIARY PATTERNS
      * ==================
      *)
     
     <B>withIdleAndPE</B><A name="SocketGenerator.1:withIdleAndPE.2(208)"></A><A name="withIdleAndPE.2(208)"></A>:
       (# error:&lt; hiErrCB (* operation level error callback *)
            (#
            do INNER;
               (if errCB_initialValue=value then 
                   (value,cleanup[])-&gt;
                   this(socketGenerator).error-&gt;value;
               if);
            #);
          loErrCB: errCB (* superpattern for 
                          * concrete error callbacks 
                          *)
            (#
            do INNER;
               (if errCB_initialValue=value then 
                   (value,cleanup[])-&gt;error-&gt;value;
               if);
            #);
          usageError:&lt; loErrCB(# do INNER #);
          resourceError:&lt; loErrCB(# do INNER #);
          accessError:&lt; loErrCB(# do INNER #);
          addressError:&lt; loErrCB(# do INNER #);
          connBrokenError:&lt; loErrCB(# do INNER #);
          intrError:&lt; loErrCB(# do INNER #);
          internalError:&lt; loErrCB(# do INNER #);
          unknownError:&lt; loErrCB(# do INNER #);
          timedOut:&lt; loErrCB(# do INNER #);
          Idle:&lt; (# do INNER; this(socketGenerator).Idle #);
          Blocking:&lt;(# continue: (# do true-&gt;doContinue #);
               doContinue: @boolean;
            do INNER;
               (if not doContinue then leaveNBScope if);
               Idle;
            #);
       do INNER
       #);

     (* PRIVATE
      * =======
      *)
     
     <B>private</B><A name="SocketGenerator.1:private.2(209)"></A><A name="private.2(209)"></A>: @...;
  #)
</PRE>
<!---------------------------------------------------------->
<HR>
<P></P>
<TABLE border=0 width=100%>
<TR><TD><ADDRESS>Interface Description</ADDRESS></TD>
<SCRIPT LANGUAGE=JavaScript SRC="../../javascript/lastmod.js"></SCRIPT>
</TABLE>
<P></P>
<A HREF="streamgenerator.html"><IMG ALIGN=BOTTOM SRC="../../images/next.gif" ALT=Next BORDER=0></A>
<A HREF="processmanager.html"><IMG ALIGN=BOTTOM SRC="../../images/prev.gif" ALT=Prev BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html"><IMG ALIGN=BOTTOM SRC="../../images/content.gif" ALT=Content BORDER=0></A>
<A HREF="inx.html"><IMG ALIGN=BOTTOM SRC="../../images/index.gif" ALT=Index BORDER=0></A>
</BODY>
</HTML>
