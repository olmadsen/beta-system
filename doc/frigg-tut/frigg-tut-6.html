<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>

<HEAD>
<LINK REL=TOP HREF=../mjolner-tut/index.html>
<LINK REL=UP HREF=frigg-tut-3.html>
<LINK REL=PREV HREF=frigg-tut-5.html>
<LINK REL=NEXT HREF=frigg-tut-7.html>
<TITLE> Building the Application</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING6></A>


<P><A HREF=frigg-tut-7.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=frigg-tut-5.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=frigg-tut-3.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html#_toc"><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> Interface Builder</P>


<A NAME=HEADING6-0></A>
<H1> Building the Application</H1>
<A NAME=HEADING6-1></A>
<H1> Structure of Generated Code<A NAME=MARKER-2-18></A></H1>
<P> The code generated by Frigg is divided into two different files:</P>
<P> addressbookgui The public accessible portion of the window i.e. the declaration of the addressbook window.</P>
<P> addressbookguibody The private attributes of the window.</P>
<P> The addressbookgui fragmentgroup are named by the user when choosing the &ograve;New Window Library&oacute; command. The body file is created by Frigg. A Sif editor is opened on the declaration of the addressbook window by selecting the content area of the window and choosing &ograve;Open Subeditor&oacute; in the &ograve;Edit&oacute; menu:</P>
<P> &lt;&lt;fig&gt;&gt;</P>
<P> </P>
<P> All the items of the window are hidden in the private attributes of the window. These attributes can be edited in Sif by double-clicking</P>
<P>  &lt;&lt;SLOT addressBookWindowPrivate: descriptor&gt;&gt;</P>
<P> The addressBookWindowPrivate fragment is located in &ograve;addressbookguibody&quot;. Here is a portion of this fragmentgroup:</P>
<P> </P>
<P> ORIGIN 'addressbookgui'</P>
<P> -- addressBookWindowPrivate: Descriptor --</P>
<P> (# ...</P>
<P>    nameField: @editText</P>
<P>      (# open::&lt;</P>
<P>           (# </P>
<P>           do (346,30)-&gt;size;</P>
<P>              (54,14)-&gt;position;</P>
<P>           #)</P>
<P>      #);</P>
<P>    addressGroup: @canvas</P>
<P>      (# streetField: @editText</P>
<P>           (# ... #);</P>
<P>         ...</P>
<P>      #);</P>
<P>    ...</P>
<P> #)</P>
<P> </P>
<A NAME=HEADING6-30></A>
<H1> Extending the Public Interface<A NAME=MARKER-2-19></A></H1>
<P> The interface of the addressBookWindow needs to be extended to allow the application to access certain parts of the implementation of the window.</P>
<P> In this example two principles will be used:</P>
<P> Text Fields:  For each text field in the addressBookWindow a simple attribute is added to the interface of addressBookWindow that changes the content of the  text field.</P>
<P> Push buttons: For each push-button, a virtual procedure is added that is called when the user presses the button.</P>
<P> In the following code this is done for &ograve;nameField&oacute; and &ograve;findBtn&oacute;:</P>
<P> </P>
<P> addressBookWindow: window</P>
<P>   (#</P>
<P>      nameField:</P>
<P>        (* Changes the content of the textfield &ograve;NameField&oacute; *)</P>
<P>        (# theName: ^text </P>
<P>        enter theName[] </P>
<P>        &lt;&lt;SLOT enterNameField:DoPart&gt;&gt; </P>
<P>        #);</P>
<P> </P>
<P>      onFind:&lt;</P>
<P>        (* Is called when the user presses the &ograve;Find&oacute; button *)</P>
<P>        (#  do INNER #);</P>
<P>      ...</P>
<P>   #)  </P>
<P> </P>
<P> The implementation<A NAME=MARKER-2-20></A> of  &lt;&lt;SLOT enterNameField:DoPart&gt;&gt;, must be placed in the &ograve;addressbookguibody&oacute;. The implementation looks like this:</P>
<P> </P>
<P> -- enterNameField:DoPart --</P>
<P> do theName[] -&gt; private.nameField.contents</P>
<P> </P>
<P> The &ograve;find&oacute; button needs to call the &ograve;onFind&oacute; virtual. This is done by selecting the &ograve;find&oacute; button in the graphical editor and choosing &ograve;Edit Virtuals&oacute; in the &ograve;Edit&oacute; menu.</P>
<P> &lt;&lt;fig&gt;&gt;</P>
<P> </P>
<P> The invoked dialog presents the available event types<A NAME=MARKER-2-21></A> of the push-button. &ograve;onFind&oacute; should be called in the &ograve;onMouseUp&oacute; event. Selecting &ograve;onMouseUp<A NAME=MARKER-2-22></A>&oacute; and pressing &ograve;edit&oacute; will open a Sif editor on a furtherbinding of &ograve;onMouseUp&oacute;.</P>
<P> </P>
<P> &lt;&lt;fig&gt;&gt;</P>
<P> </P>
<P> Here &ograve;onMouseUp<A NAME=MARKER-2-23></A>&oacute; is furtherbound to call &ograve;onFind&oacute;.</P>
<A NAME=HEADING6-65></A>
<H1> The Application</H1>
<P> The application module<A NAME=MARKER-2-24></A>, &ograve;addressbookAppl&oacute; includes both the user interface and the data model<A NAME=MARKER-2-25></A>. </P>
<P> </P>
<P> ORIGIN 'addressbookgui';</P>
<P> INCLUDE '~beta/persistentstore/persistentstore';</P>
<P> INCLUDE 'addressbook';</P>
<P> -- program: Descriptor --</P>
<P> GUIenv</P>
<P> (# PS: @persistentStore;</P>
<P>      (* Use persistentstore to store the data objects *)</P>
<P>    theAddressBook: ^addressBook;</P>
<P>    theAddressBookWindow: @addressBookWindow </P>
<P>      (# currentInx: @integer;</P>
<P>         </P>
<P>         showPerson:</P>
<P>           (# thePerson: ^addressBook.person;</P>
<P>           enter thePerson[]</P>
<P>           do (* </P>
<P>               * Change the content of the name field etc.</P>
<P>               *)</P>
<P> </P>
<P>              thePerson.name[] -&gt; nameField;</P>
<P>              ...;</P>
<P>           #);</P>
<P> </P>
<P>         onFind::</P>
<P>           (# do (* Invoke a find dialog *) #);</P>
<P> </P>
<P>         open::</P>
<P>           (# </P>
<P>           do (*</P>
<P>               * Fetch the first person</P>
<P>               *)</P>
<P>               </P>
<P>              1 -&gt; currentInx</P>
<P>                -&gt; theAddressBook.inxGet -&gt; showPerson;</P>
<P>           #);</P>
<P>      #)</P>
<P> do (*</P>
<P>     * Get the addressbook data in &ograve;uni&oacute;</P>
<P>     *)</P>
<P> </P>
<P>     'uni' -&gt; PS.openWrite;</P>
<P>    ('AddressBook', addressBook##) </P>
<P>        -&gt; PS.get -&gt; theAddressBook[];</P>
<P> </P>
<P>    (*</P>
<P>     * Open the addressbook window</P>
<P>     *)</P>
<P> </P>
<P>    theAddressBookWindow.open;</P>
<P> #)  </P>
<P> </P>
<P> Here the extended interface of the addressBookWindow are used to make the data model and the graphical user interface work together. The interface to the text fields in the window are used to show a person in the address book window. The  virtual procedure &ograve;onFind&oacute; are furtherbound to invoke a &ograve;find&oacute; dialog. Persistentstore is used to retrieve the addressbook data objects.</P>




<HR>
<P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="33%" align="left">
<ADDRESS>Interface Builder - Tutorial</ADDRESS>
</TD>
<TD width="34%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="33%" align="right"><FONT size=-1><SCRIPT LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></FONT></TD>
</TABLE>
<P>
<P><A HREF=frigg-tut-7.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=frigg-tut-5.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=frigg-tut-3.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html#_toc"><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
