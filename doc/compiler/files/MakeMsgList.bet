origin '~beta/betaast/semanticerrortext';
include '~beta/basiclib/file'
---program:descriptor---
(# printT:
     (# T: ^text
     enter T[]
     do T.scanAll
        (#
        do (if ch = ascii.newline then
               '<br>\n   ' -> msg.puttext
            else
               ch -> msg.put
           if);
        #)
     #);
   msg: @file;
   T: ^text
do 'Generating \'messages.html\'' -> screen.putline;
   'messages.html' -> msg.name;
   msg.openWrite;
   
   '<h1>Semantic Error Messages</h1>' -> msg.putline;
   '<DL>' -> msg.putline;
   (*    (For i: lastMsgNo repeat
    *         (if not(i -> isWarning) then
    *             i 
    *               -> semanticErrortext 
    *             (# noMsg::(#do true -> skip #)#)
    *             -> T[];
    *             (if t.length > 0 then
    *                 '<DT>Error  ' -> msg.putline;
    *                 i -> msg.putint;
    *                 ': <DD><tt>' -> msg.puttext;
    *                 T[] -> printT;
    *                 '</tt>\n' -> msg.puttext
    *             if)
    *         if)
    *    for);
    * 
    *)
   '</DL>' -> msg.putline;

   '<h1>\nSemantic Warnings</h1>' -> msg.putline;   
    '<DL>' -> msg.putline;
   (*    (For i: lastMsgNo repeat
    *         (if (i -> isWarning) then
    *             i 
    *               -> semanticErrortext 
    *             (# noMsg::(#do true -> skip #)#)
    *             -> T[];
    *             (if t.length > 0 then
    *                 '<DT>Warning  ' -> msg.putline;
    *                 i -> msg.putint;
    *                 ': <DD><tt>' -> msg.puttext;
    *                 T[] -> printT;
    *                 '</tt>\n' -> msg.puttext
    *             if)
    *         if)
    *    for);
    * 
    *)   
   '</DL>' -> msg.putline;
   
   
   msg.close
#)
