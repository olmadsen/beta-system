origin '~beta/betaast/semanticerrortext';
include '~beta/basiclib/file'
---program:descriptor---
(# printT:
     (# T: ^text
     enter T[]
     do T.scanAll
        (#
        do (if ch = ascii.newline then
               '<br>\n   ' -> msg.puttext
            else
               ch -> msg.put
           if);
        #)
     #);
   msg: @file;
   T: ^text
do 'Generating \'messages.html\'' -> screen.putline;
   'messages.html' -> msg.name;
   msg.openWrite;
   
   '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">\n'
   '<HTML>\n'
   '<HEAD>\n'
   '<TITLE>Semantic Error- and Warning Messages</TITLE>\n'
   '<LINK REL="stylesheet" HREF="../style/miadoc.css" TYPE="text/css">\n'
   '</HEAD>\n'
   '<BODY>\n'
   '<P></P>\n'
   '<A HREF="compiler-ref.html#HEADING2-1885"><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>\n'
   '<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>\n'
   '<P></P>\n'
     -> msg.puttext;
   
   '<h1>Semantic Error Messages</h1>' -> msg.putline;
   '<DL>' -> msg.putline;
   (For i: lastMsgNo repeat
        (if not(i -> isWarning) then
            i 
              -> semanticErrortext 
            (# noMsg::(#do true -> skip #)#)
            -> T[];
            (if t.length > 0 then
                '<DT>Error  ' -> msg.putline;
                i -> msg.putint;
                ': <DD><tt>' -> msg.puttext;
                T[] -> printT;
                '</tt>\n' -> msg.puttext
            if)
        if)
   for);
   '</DL>' -> msg.putline;

   '<h1>\nSemantic Warnings</h1>' -> msg.putline;   
    '<DL>' -> msg.putline;
   (For i: lastMsgNo repeat
        (if (i -> isWarning) then
            i 
              -> semanticErrortext 
            (# noMsg::(#do true -> skip #)#)
            -> T[];
            (if t.length > 0 then
                '<DT>Warning  ' -> msg.putline;
                i -> msg.putint;
                ': <DD><tt>' -> msg.puttext;
                T[] -> printT;
                '</tt>\n' -> msg.puttext
            if)
        if)
   for);
   
   '</DL>' -> msg.putline;
   
   '<!---------------------------------------------------------->\n'
   '<HR>\n'
   '<P></P>\n'
   '<TABLE cols=3 border=0 width=100%>\n'
   '<TR>\n'
   '<TD width="40%" align="left"><ADDRESS>Semantic Error- and Warning Messages</ADDRESS></TD>\n'
   '<TD width="20%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>\n'
   '<TD width="40%" align="right"><SCRIPT LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></TD>\n'
   '</TABLE>\n'
   '<P></P>\n'
   '<A HREF="compiler-ref.html#HEADING2-1885"><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>\n'
   '<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>\n'
   '</BODY>\n'
   '</HTML>\n'
     -> msg.puttext;

   
   msg.close
#)
