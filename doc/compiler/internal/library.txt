Date: Tue, 25 Jan 2000 00:06:01 +0100 (MET)
From: Ole Lehrmann Madsen <olm@daimi.cs.au.dk>
Subject: Re: LIB_DEF/ITEM
To: olm@mjolner.dk, datpete@mjolner.dk

Det må komme på en fremtidig liste; dvs det skal diskuteres om det
skal prioriteres. Vi vidste godt at der skulle erfaring til med LIB
får vi kunne lave en version for alm. brugere. Jeg mener at hovedproblemet
er at folk ikke satte sig ind i hvordan det skulle bruges dengang det blev
aftalt for MEGET længe siden. Det er helt klart et issue som folk
har ignoreret. Men lad os tage det op. Du kan jo putte det på
'ånskelisten'

---olm

> From: datpete@mjolner.dk
> Subject: LIB_DEF/ITEM
> To: olm@mjolner.dk (Ole Lehrmann Madsen)
> Date: Mon, 24 Jan 100 21:18:34 +0100 (MET)
> Cc: pa@mjolner.dk (Peter Andersen)
> 
> Ole,
> 
> jeg synes klart at de seneste uger viser at den nuværende
> LIB_DEF/LIB_ITEM konstuktion er for indviklet at bruge til at den
> nogensinde vil kunne bruges af "almindelige" brugere.
> Og det skulle vi vel også genre frem til.
> Men selv for os selv er det for indviklet, og man får ikke gjort det
> med mindre man piskes.
> 
> Jeg vil derfor foreslå den model, som jeg skitserede på tavlen for
> nyligt:
> 
> 1. Der er KUN een property
>    LIBRARY 'foo' '../lib';
> 2. Man placerer LIBRARY properties i passende interface filer.
>    Disse definerer uafhængige shared libraries, som extend for
>    interface filen kommer med i automatisk.
> 3. Compileren/dependency implementerer (2) ved fålgende regel:
>    a. hvis en fil 'foo' rummer en LIBRARY property, kommer filens objekt fil
>       med i dette LIBRARY.
>    b. Ellers såges langs ORIGIN kæden (kun), og hvis der findes en
>       anden fil 'bar' med en LIBRARY erklæring herved, så kommer objektfilen
>       for 'foo' med i det i 'bar' angivene LIBRARY.
>       Men KUN hvis 'foo' kan nås fra 'bar' ved at fålge BODY/MDBODY relationer.
> 4. Hvis en fil, der indgår i et LIBRARY efter ovenstående regler genoversættes
>    så skal LIBRARY genlinkes.
> 5. Hvis en fil 'foo' rummer en BUILD property, der giver anledning til
>    en objektfil 'cfoo', så skal 'cfoo' med i samme LIBRARY som 'foo'.
>    Hvis BUILD reglerne giver anledning til at 'cfoo' gen-genereres, så
>    skal LIBRARY genlinkes.
> 
> Jeg mener dette er simpelt, og holder vand:
> Der bliver ingen problemer med at alting havner i libbetaenv (som jo findes
> som ultimative ORIGIN), da kun ting, som betaenv.bet BODY'er kommer med i
> libbetaenv.
> 
> Tilsvarende bliver der ingen problemer med at studenters kode, med ORIGIN
> i guienv, kommer ind i libguienv. Igen fordi guienv jo ikke BODY'er
> de studerendes kode.
> 
> Men bemærk at der ingen test for 'i hvilket directory' filer ligger
> er nådvendigt.
> 
> Det er klart at man får en del små shared libraries ud af det (det går vi
> jo også med det nuværende). Men fin granularitet er jo OK, i forhold til
> genbrug: Alle de studerendes guienv programmer vil jo dele samme libguienv,
> og hvis de ikke bruger alle den mange ting i guienv/utils, så er det jo kun
> fint at disse ikke er med i libguienv.
> 
> Til listen (men ikke alt for langt nede (:-))
> 
> /Peter
> 
