<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE>Makedoc</TITLE>
<LINK REV="made" HREF="mailto:pa@mjolner.com">
<LINK REL="stylesheet" HREF="../style/miadoc.css" TYPE="text/css">
</HEAD>

<BODY>

<P align=center style="align=center;color=red;font-style=italic;font-size=18pt">
Draft!
</P>


<H1>Makedoc</H1>

Utility to generate HTML and PDF files for Mjølner System manuals.
<A NAME="synopsis"><H2>1. SYNOPSIS</H2></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<PRE class=BETA>
makedoc [-f] [-p] [-v] [-d] <EM>manual</EM>.book | <EM>file</EM>.html
  -f   use full urls in HREFs (http://www.mjolner.com/...)
  -p   do not generate PDF
  -v   verbose output
  -d   debug makedoc script
</PRE>

<A NAME="description"><H2>2. DESCRIPTION</H2></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<PRE class=BETA>
makedoc <EM>options</EM> <EM>manual</EM>.book
</PRE>
will create html and PDF documentation corresponding to the
list of source files listed in <EM>manual</EM>.book.
<P>
See <A HREF="#bookfile">THE BOOK FILE</A> for a description of the book
file, and <A HREF="#files">FILES</A> for a survey of files generated.
<P>
For each HTML file in the <CODE>src</CODE> subdirectory listed in the 
<CODE><EM>manual</EM>.book</CODE>, a corresponding HTML file is
generated in the current directory. The source files are searched for
<OL>
<LI>HTML headings (<CODE>H1</CODE>-<CODE>H6</CODE>), which will be
automatically numbered and then extracted to a TABLE OF
CONTENTS in the generated <CODE>index.html</CODE> file
<LI><CODE>INX</CODE> tags, which marks words or sentences for the
ALPHABETIC INDEX in the genrated <CODE>inx.html</CODE> file.
<LI><CODE>BETA</CODE> tags, which marks BETA source code to be
formatted and possibly be included in the LIST OF PROGRAMS in the
generated <CODE>programs.html</CODE> file, if marked
with the <CODE>LOP</CODE> property.
<LI><CODE>FIG</CODE> tags, which marks words or sentences to be listed
in the LIST OF FIGURES in the generated <CODE>figures.html</CODE> file.
</OL>

The generated files are placed in the current directory and the
<CODE>interface</CODE> subdirectory. The generated files will have
navigation code attached, that will allow user to easily navigate the
resulting manuals. The writer of the manuals does not have to maintain
the navigation links, as these are derived by <CODE>makedoc</CODE>
from the sequence of files in the book file, and from the order of
HTML headings in the source files.

<PRE class=BETA>
makedoc <EM>options</EM> src/foo.html
</PRE>

will produce a preview of <CODE>src/foo.html</CODE> with
special tags processed etc.<BR>
The output will be printed to standard output - no files are written.

<A NAME="interface"><H3>3. INTERFACE DESCRIPTION</H3></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

Files to be included in the interface descriptions are listed with the
<CODE>int:</CODE> prefix in the book file. 
<P>
Example:

<PRE class=beta>
int:$BETALIB/basiclib/betaenv.bet
</PRE>


The files listed are
preprocesed with SLOTs being replaced by <CODE>...</CODE> etc. to
make them "abstract". Pattern names are boldfaced and are extracted to
the ALPHABETIC INDEX.
<P>
The generated files are placed in an <CODE>interface</CODE>
subdirectory of the current directory.
<P>
The HTML generator uses comments in the interface files to determine
what words to generate index entries for.
By default (i.e. with no comments), all declarations on the two
outermost block levels in the BETA code is indexed. This may be changed
by the following idx-comments:
<UL>
<LI><CODE>(* idx: x *)</CODE> changes index level to x
<LI><CODE>(* idx- *)</CODE> changes index level to one less than current
<LI><CODE>(* idx+ *)</CODE> changes index level to one more than current
</UL>

After generation, it may show, that some idx comments have to be changed
in order to produce a reasonable index. In HTML
the indexed word are shown in <STRONG>bold</STRONG> - this makes it
easy to check the generated interface descriptions manually.


<A NAME="beta"><H3>4. INCLUSION OF BETA FILES</H3></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

Formatted BETA source code can be included in the output in one
of two ways.

<H4>4.1. INCLUSION FROM EXTERNAL FILES</H4>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<PRE class=BETA>
&lt;BETA SRC="foo.bet"&gt;&lt;/BETA&gt;
</PRE>

Please notice that the closing <CODE>&lt;/BETA&gt;</CODE>
tag is <EM>optional</EM>when the <CODE>SRC</CODE> attribute is specified.
<P>
You may use environment variables in the path for the SRC file, e.g.

<PRE class=BETA>
&lt;BETA SRC="$BETALIB/foobar/foo.bet"&gt;&lt;/BETA&gt;
</PRE>

The meaning of the above example is that the <CODE>BETALIB</CODE>
environment variable is expanded to obtain the path of the
file.

<H4>4.2. IN-LINE BETA CODE</H4>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

You can include formatted BETA code using the <CODE>BETA</CODE>
tag without a <CODE>SRC</CODE> property:

<PRE class=BETA>
&lt;BETA&gt;
ORIGIN '~beta/basiclib/betaenv';
--PROGRAM: descriptor--
(# 
do ...
#)
&lt;/BETA&gt;
</PRE>

<H4>4.3. ENTRIES FOR LIST OF PROGRAMS</H4>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

If the <CODE>LIST</CODE> property is given to the
<CODE>&lt;BETA&gt;</CODE>
start tag, the program will be included in the generated
LIST OF PROGRAMS. The value of the property will be used as title in
the list of programs:

<PRE class=BETA>
&lt;BETA LIST="Foo program" SRC="$BETALIB/foobar/foo.bet"&gt;&lt;/BETA&gt;
</PRE>

This can be used for in-line BETA sources too.

<A NAME="figures"><H3>5. FIGURES</H3></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

Words or sentences marked up with 

<PRE class=BETA>
&lt;FIG&gt;...&lt;/FIG&gt;
</PRE>

will be included in the generated LIST OF FIGURES with a link to the
definition site.

<A NAME="index"><H3>6. INDEX ANCHORS</H3></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

Words or sentences marked up with 

<PRE class=BETA>
&lt;INX&gt;...&lt;/INX&gt;
</PRE>

will be included in the generated alphabetic index with a link to the
definition site.

<A NAME="bookfile"><H2>7. THE BOOK FILE</H2></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

The so-called BOOK FILE is a textual file used by <CODE>makedoc</CODE>
to define the order in which files are to be treated for inclusion in
the resulting manuals.
<P>
The file contain listings of
<OL>
<LI>HTML source files that consitue the manual body
<LI>BETA files to be included in interface descriptions
<LI>Variable definitions
</OL>

one item per line.

<H3>7.1. HTML source files</H3>

These are simply the name of the file in the <CODE>src</CODE>
subdirectory (without the <CODE>src/</CODE> prefix).
<P>
Example:
<PRE class=beta>
betaenv.html
</PRE>

<H3>7.2. BETA files to be included in interface descriptions</H3>

These lines each consist of the prefix <CODE>int:</CODE> 
followed by the full path of the BETA file to use.
The path may contain environment varibles, notably BETALIB, 
which are expanded by <CODE>makedoc</CODE>.
<P>
Example:
<PRE class=beta>
int:$BETALIB/basiclib/betaenv.bet
</PRE>
The result of this will be that <CODE>betaenv.bet</CODE>
is processed and placed as <CODE>betaenv.html</CODE>
in the <CODE>interface</CODE> subdirectory, and the identifiers
(pattern names) from betaenv.bet are included in the ALPHABETIC INDEX.

<H3>7.3. Variable definitions</H3>
A number of variables can be defined in the book file, using the
syntax

<PRE class=beta>
<EM>variable_name</EM>:<EM>value</EM>
</PRE>

The variables supported are:

<BLOCKQUOTE>
<DL>
<DT><B>title</B>
<DD>The title of the document. Used on generated front page
<DT><B>mia</B>
<DD>The MIADOC number for the manual. See <A
HREF="document-list.html">doc/admin/document-list.html</A>.
<DT><B>pdf</B>
<DD>The file name to use for the generated PDF file.
If not specified, it will get the name of the book file, but with
<CODE>.pdf</CODE> extension instead of <CODE>.book</CODE>.
<DT><B>list</B>
<DD>What lists to generate. May hold the values <CODE>programs</CODE>
(for list of programs) and <CODE>figures</CODE> (for list of figures).
<DT><B>src</B>
<DD>Directory where to find source HTML files. May change during the 
sequence of a book file. Default is <CODE>"src/"</CODE>
<DT><B>dst</B>
<DD>Directory where to place generated HTML files. May change during the 
sequence of a book file. Default is <CODE>""</CODE>, i.e. the current
directory. 
<DT><B>date</B>
<DD>Release date to use on generated front page
<DT><B>copyright</B>
<DD>Year for which to claim the copyright on generated front page
</DL>
</BLOCKQUOTE>



<H3>7.4. Example book file</H3>
<P>
Example book file:
<P>
<H4 class=betacaption>basiclib.book</H4>
<PRE class=beta>
betaenv.html
file.html
directory.html
int:$BETALIB/basiclib/betaenv
int:$BETALIB/basiclib/file
int:$BETALIB/basiclib/directory
pdf: basiclib.pdf
title: Basic Libraries - Reference Manual
mia: MIA 91-13
date: August 2000
copyright: 1991-2000
</PRE>

<A NAME="files"><H2>8. FILES</H2></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

By issuing

<PRE class=BETA>
makedoc <EM>manual</EM>.book
</PRE>

the following files will be generated:

<BLOCKQUOTE>
<DL>
<DT><CODE>index.html</CODE>
<DD>Frontpage for the manual including table of contents
<DT><CODE>inx.html</CODE>
<DD>File with alphabetic index
<DT><CODE>figures.html</CODE>
<DD>File with list of figures. Only generated if document contains
figure anchors. See <A HREF="#figures">FIGURES</A>.
<DT><CODE>programs.html</CODE>
<DD>File with list of programs. Only generated if document contains
included BETA files with <CODE>LIST</CODE> property. 
See <A HREF="#beta">INCLUSION OF BETA PROGRAMS</A>.
<DT><CODE><EM>manual</EM>.pdf</CODE>
<DD>PDF file for easy print of <EM>manual</EM>.
<DT><CODE>*.html</CODE>
<DD>For each HTML file in the <CODE>src</CODE> subdirectory
a corresponding HTML file will be generated in the current directory
with the preprosessing described in 
<A HREF="description">DESCRIPTION</A> performed.<BR>
Furthermore an HTML file will be generated in the
<CODE>interface</CODE> directory for each BETA file specified as
described in <A HREF="interface">INTERFACE DESCRIPTIONS</A>.
</DL>
</BLOCKQUOTE>

<A NAME="directories"><H2>9. DIRECTORIES</H2></A>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

<BLOCKQUOTE>
<DL>
<DT><CODE>src</CODE>
<DD>Directory containing files with HTML markup for the body of the
manual. HTML does not include navigation etc., since this is
generated.
<DT><CODE>interface</CODE>
<DD>Directory in which HTML files for the BETA files specified to be
in the interface descriptions are generated.
</DL>
</BLOCKQUOTE>


<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<HR>
<P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left">
<ADDRESS>Makedoc</ADDRESS>
</TD>
<TD width="20%" align="center"><FONT SIZE="-1">&#169; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>

</BODY>
</HTML>