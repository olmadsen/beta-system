<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>

<HEAD>



<TITLE>4	 Subprocedure</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING6></A>


<P><A HREF=BetaOverview-7.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=BetaOverview-5.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<P> </P>


<A NAME=HEADING6-0></A>
<H1>4  Subprocedure</H1>
<DL>
<DT><DD>The previous section has showed examples of patterns used as classes and procedures. For class patterns, examples of subpatterns have been given. Subpatterns may, also be used for procedure patterns. For attributes, subpatterns may add new attributes and extend definitions of virtual patterns in the superpattern. In addition a subpattern may specify further imperatives which have to be combined with the imperatives of the superpattern. The combination of the imperatives is handled by the <EM>inner</EM> construct. Consider the following objects:
</DL>
<PRE CLASS=beta>
mutex: @ Semaphore;
sharedVar: @Integer
</PRE>
<DL>
<DT><DD>The variable <CODE>sharedVar</CODE> is shared by a number of concurrent processes. Mutual access to the variable is handled by the semaphore <CODE>mutex</CODE>. <EM>Update</EM> of <CODE>shared</CODE> should then be performed as follows:
</DL>
<PRE CLASS=beta>
mutex.P; m+sharedVar -> sharedVar; mutex.V
</PRE>
<DL>
<DT><DD>This pattern of actions must be used whenever <CODE>shared</CODE> and other shared objects have to be accessed. Instead of manipulating the semaphore directly it is possible to encapsulate these operations in an abstract procedure pattern. Consider the following pattern <CODE>entry</CODE>:
</DL>
<PRE CLASS=beta>
 entry: (#<EM>do</EM> mutex.P; <EM>inner</EM>; mutex.V #)
</PRE>
<DL>
<DT><DD>Execution of <CODE>entry</CODE> locks <CODE>mutex</CODE> before the <EM>inner</EM> and releases it afterwards. <EM>inner</EM> may then in subpatterns of <CODE>entry</CODE> be replaced by arbitrary imperatives. Consider the following subpattern of <CODE>entry</CODE>:
</DL>
<PRE CLASS=beta>
updateShared: entry
  (# m: @ integer
  <EM>enter</EM> m
  <EM>do</EM> sharedVar+m-> sharedVar
  #)
</PRE>
<DL>
<DT><DD>Execution of an imperative
</DL>
<PRE CLASS=beta>
123 -> updateShared
</PRE>
<DL>
<DT><DD>will then result in execution of the actions
</DL>
<PRE CLASS=beta>
mutex.P; sharedVar+123->sharedVar; mutex.V
</PRE>
<DL>
<DT><DD>We may now define an abstract superpattern corresponding to a monitor:
</DL>
<PRE CLASS=beta>
monitor:
  <EM>(#</EM> mutex: <EM>@</EM> semaphore;
     entry: <EM>(#do</EM> mutex.P; <EM>inner</EM>; mutex.V <EM>#)</EM>;
     init:<EM>&lt; (#do</EM> mutex.V<EM>{</EM>initially open<EM>}</EM>; <EM>inner</EM> <EM>#)</EM>
  <EM>#);</EM>
</PRE>
<DL>
<DT><DD>A (singular) monitor object may now be declared as follows:
</DL>
<PRE CLASS=beta>
shared: <EM>@</EM> monitor
  <EM>(#</EM>var: <EM>@</EM> Integer;
     update: entry<EM>(#</EM> m: @ Integer <EM>enter</EM> m <EM>do</EM> var+m->var <EM>#)</EM>;
     get: entry<EM>(# </EM>v: @ Integer<EM> do </EM>var<EM>-></EM>v<EM> exit</EM> v <EM>#)</EM>
  <EM>#)</EM>
</PRE>
<DL>
<DT><DD>Semaphore is the basic mechanism in BETA for synchronization. They can express most synchronization problems, but may be complicated to use. It is therefore mandatory that high level abstraction mechanisms like <CODE>monitor</CODE> can be defined. In section 8 below, further details about concurrency in BETA will be given.
</DL>







<!-- TOC -->



<HR>
<P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="40%" align="left">
<ADDRESS>An Overview of BETA</ADDRESS>
</TD>
<TD width="20%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
<P>
<P><A HREF=BetaOverview-7.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=BetaOverview-5.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>


</BODY>
</HTML>
