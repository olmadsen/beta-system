<H1>7.2  Virtual class pattern</H1>
<DL>
<DT><DD>Virtual patterns may also be used to parameterize general container patterns such as the <CODE>Register</CODE> pattern described above. For the <CODE>Register</CODE> pattern we assumed the existence of a <CODE>type</CODE> pattern defining the elements of the <CODE>Register</CODE>. I.e. elements of a <CODE>Register</CODE> must be instances of the pattern <CODE>type</CODE>. The pattern <CODE>type</CODE> may be declared as a virtual pattern attribute of <CODE>Register</CODE> as shown below:
</DL>
<PRE CLASS=beta>
Register:
  (# type:&lt; Object;
     insert:&lt; (# e: ^ type <EM>enter</EM> e[] <EM>do</EM> ...#)
     ...
  #)
</PRE>
<DL>
<DT><DD>The declaration <CODE>type:&lt; Object</CODE> specifies that <CODE>type</CODE> is either the pattern <CODE>Object</CODE> or some subpattern of <CODE>Object</CODE>. In the definition of <CODE>Register</CODE>, <CODE>type</CODE> may be used as an alias for <CODE>Object</CODE>. E.g. references qualified by <CODE>type</CODE> are know to be at least <CODE>Objects</CODE>. Since <CODE>Object</CODE> is the most general superpattern, <CODE>type</CODE> may potentially be any other pattern. The virtual attribute <CODE>type</CODE> may be bound to a subpattern of <CODE>Object</CODE> in subpatterns of <CODE>Register</CODE>. The following declaration shows a pattern <CODE>WorkerRegister</CODE> which is a <CODE>Register</CODE> where the <CODE>type</CODE> attribute has been bound to <CODE>Worker</CODE>.
</DL>
<PRE CLASS=beta>
WorkerRegister: Register
  (# type::&lt; Worker;
     findOldestSeniority:
       (# old: @ Integer
            <EM>do</EM> scan
          (#<EM>do</EM> (<EM>if</EM> thisElm.seniority &gt; old 
           // true <EM>then</EM> thisElm.seniority<EM>-></EM>old
             <EM>if</EM>)#)
          <EM>exit</EM> old
       #)
  #);
</PRE>
<DL>
<DT><DD>In the definition of <CODE>WorkerRegister</CODE>, the virtual pattern <CODE>type</CODE> may be used as a synonym for the pattern <CODE>Worker</CODE>. This means that all references qualified by <CODE>type</CODE> may be used as if they were qualified by <CODE>Worker</CODE>. The reference <CODE>thisElm</CODE> of the <CODE>scan</CODE> operation is used in this way by the operation <CODE>findOldestSeniority</CODE> which computes the oldest seniority of the register. The expression <CODE>thisElm.seniority</CODE> is legal since <CODE>thisElm</CODE> is qualified by <CODE>type</CODE> which in <CODE>WorkerRegister</CODE> is at least a <CODE>Worker</CODE>.
</DL>
<P> In subpatterns of <CODE>WorkerRegister</CODE> it is possible to make further bindings of <CODE>type</CODE> thereby restricting the possible members of the register. Suppose that <CODE>Manager</CODE> is a subpattern of <CODE>Worker</CODE>. A manager register may then be defined as a subpattern of <CODE>WorkerRegister</CODE>:</P>
<PRE CLASS=beta>
ManagerRegister: WorkerRegister
  (# type::&lt; Manager
  #)
</PRE>
<DL>
<DT><DD>In the definition of <CODE>ManagerRegister</CODE>, <CODE>type</CODE> may be used as a synonym for <CODE>manager</CODE>. I.e. all references qualified by <CODE>type</CODE> are also qualified by <CODE>Manager</CODE>.
</DL>
<P> Virtual patterns make it possible to define general parameterized patterns like <CODE>Register</CODE> and to restrict the member type of the elements. In this way virtual class patterns provides an alternative to generic classes as found in Eiffel. A further discussion of virtual class patterns may be found in [MM 89].</P>







<!-- TOC -->




