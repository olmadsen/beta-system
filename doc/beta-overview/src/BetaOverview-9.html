<H1>7  Virtual Pattern</H1>
<DL>
<DT><DD>In the example in section 2, it was mentioned that a redefinition of a virtual procedure pattern is not a redefinition (overriding) as in Simula. In fact a virtual pattern in BETA can only be extended and cannot be completely redefined. The rationale behind this is that a subpattern should have the same properties as its superpattern including which imperatives that are executed. Ideally a subpattern should be behavioral equivalent to its superpattern. This will, however, require a correctness proof. The subpattern mechanism of BETA supports a form of structural equivalence between a subpattern and its superpattern. 
</DL>
<P> Consider the following patterns:</P>
<PRE CLASS=beta>
A: (# V:&lt; (# x: ...<EM>do I1; inner; I2 #) #);
AA: A(# V::&lt; (# y: ...do I3; inner; I4#) #)</EM>
</PRE>
<DL>
<DT><DD><CODE>The pattern A has a virtual procedure attribute V. V has an attribute x and its do-part contains the execution of I1; <EM>inner; I2. The subpattern AA of A extends the definition of V. The extended definition of V in AA corresponds to the following object-descriptor (except for scope rules):</EM></CODE>
</DL>
<PRE CLASS=beta>
(# x: ...; y: ... <EM>do</EM> I1; I3; <EM>inner</EM>; I4; I2 #)
</PRE>
<DL>
<DT><DD>As it may be seen the <CODE>V</CODE> attribute of <CODE>AA</CODE> has the attributes <CODE>x</CODE> and <CODE>y</CODE> and the do-part consists of <CODE>I1; I3; <EM>inner; I4; I2</EM></CODE>. The definition of <CODE>V</CODE> is an extension of the one from <CODE>A</CODE> and <EM>not</EM> a replacement.
</DL>
<P> The subpattern <CODE>AB</CODE> of <CODE>A</CODE> describes another extension of <CODE>V:</CODE></P>
<PRE CLASS=beta>
AB: A(# V::&lt; (# z: ... <EM>do I5: inner; I6 #) #)</EM>
</PRE>
<DL>
<DT><DD>Here <CODE>V</CODE> corresponds to the following object descriptor:
</DL>
<PRE CLASS=beta>
V: (# x: ...; z: ... <EM>do</EM> I1; I5; <EM>inner</EM>; I6; I2 #)
</PRE>
<DL>
<DT><DD>The definition of <CODE>V</CODE> may be further extended in subpatterns of <CODE>AA</CODE> also as shown in the definition <CODE>AAA</CODE>:
</DL>
<PRE CLASS=beta>
AAA: AA(# V::&lt; (# q: ... <EM>do</EM> I7; <EM>inner</EM>; I8 #) #)
</PRE>
<DL>
<DT><DD>The definition of <CODE>V</CODE> corresponds to the following object descriptor:
</DL>
<P> V: (# x: ...; y: ...; q: ... <EM>do</EM> I1; I3; I7; <EM>inner</EM>; I8; I4; I2 #)</P>
<DL>
<DT><DD>As it may be seen, the pattern <CODE>V</CODE> is a combination of the definitions of <CODE>V</CODE> from <CODE>A</CODE>, <CODE>AA</CODE> and <CODE>AAA</CODE>. 
</DL>
<P> The virtual mechanism in BETA guarantees that behavior defined in a superpattern cannot be replaced in a subpattern. This form of structural equivalence is useful when defining libraries of patterns that are supposed to execute a certain sequence of actions. In Smalltalk the programmer must explicitly invoke the actions from the superpattern by means of <CODE>super</CODE>. This is illustrated by the example in the next section.</P>
<P> The <EM>inner</EM> construct is more general than shown above, since a pattern may have more than one <CODE>inner</CODE> and <EM>inner</EM> may appear inside control structures and nested singular object descriptors. In Simula there may only one <EM>inner</EM> in a class and it must appear at the outermost level of imperatives.</P>







<!-- TOC -->




