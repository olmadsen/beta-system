<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>

<HEAD>




<TITLE> Using call back from C</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING80></A>


<P><A HREF=basiclib-81.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=basiclib-79.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=basiclib-79.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> Interfacing to External C Functions</P>


<A NAME=HEADING80-0></A>
<H1> Using call back from C</H1>
<P> The following example shows how to install call backs from C to BETA. Readers not familiar with call backs should skip this section.</P>
<P> We use declarations like:</P>
<PRE CLASS=beta>
callBackProc: external
(* This pattern describes the interface to the procedure
that is called on the call back. It may have the
following type definition in C:
*
typedef void (*callBackProcPtr)(int i)
*)
(# i: @integer;
enter i
(* only the types shortInt, integer, char and boolean
can be used in the enter and exit parts
*)
do cExternalEntry;
inner;
(* Had the return type not been void,
the exit part should have appeared here.
*)
#);

installCallBack: external
(* This pattern describes the interface for the C
function that installs the call back.
It has the following C description:
*
void installCallBack(callBackProcPtr theProcPtr,int j)
*)
(# theProcPtr: ##callBackProc;
j: @integer;
enter (theProcPtr##,j)
do callC;
#);
</PRE>
<P> When writing the actual procedure to be called on the call back, it is easiest to specialise the above callBackProc pattern, as in:</P>
<PRE CLASS=beta>
(# ...
myCallBack: callBackProc
(# ...
(* do not specialise the enter part *)
do 'There is a call back.' -&gt; putline;
'Value received in parameter i is ' -&gt; puttext;
i -&gt; putint; '.' -&gt; put; newline;
(* do not specialise the exit part *)
#);
j: @integer;
do 46 -&gt; j;
(* install the call back: *)
(myCallBack##, j) -&gt; installCallBack;
...
#)
</PRE>










<HR>
<P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="33%" align="left">
<ADDRESS>Basic Libraries - Reference Manual</ADDRESS>
</TD>
<TD width="34%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="33%" align="right"><FONT size=-1><SCRIPT LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></FONT></TD>
</TABLE>
<P>
<P><A HREF=basiclib-81.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=basiclib-79.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=basiclib-79.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
