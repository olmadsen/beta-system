<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE> Using the file Fragment</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING26></A>


<P><A HREF=basiclib-27.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=basiclib-25.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=basiclib-25.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html#_toc"><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> The file Library</P>


<A NAME=HEADING26-0></A>
<H1> Using the file Fragment</H1>
<P> A program using the file fragment will have the following structure:</P>
<PRE CLASS=beta>
INCLUDE '~beta/basiclib/file
--- program: descriptor ---
(# ...
   f: @file;
do ...
   'Hello world' -&gt; f.putline;
...
#)
</PRE>
<A NAME=HEADING26-11></A>
<H1> Using diskEntry</H1>
<P> An example showing the use of the path attribute of DiskEntry: The path specified on the command line is decomposed, and the various parts of it are printed: </P>

<A NAME=decompose.bet><H4 CLASS=betacaption>decompose.bet</H4></A>
<PRE CLASS=beta>
ORIGIN '~beta/basiclib/file';

--- program: descriptor ---
(* An example showing the use of the 'path' attribute of DiskEntry: The path
 * specified on the command line is decomposed, and the various parts of it are
 * printed.
 *)

(# e: @diskentry;
do (if noOfArguments &lt;&gt; 2 then
       'Usage: ' -&gt; puttext; 1-&gt;arguments-&gt;puttext; ' path' -&gt; putline;
       stop;
   if);
   2 -&gt; arguments -&gt; e.path;
   'The path '''-&gt;puttext; 
   e.path -&gt; puttext;
   ''' is composed like this:'-&gt;putline;
   'Head of path:      '-&gt;puttext; e.path.head -&gt; putline;
   'Name:              '-&gt;puttext; e.path.name -&gt; putline;
   'Prefix of name:    '-&gt;puttext; e.path.name.prefix -&gt; putline;
   'Suffix of name:    '-&gt;puttext; e.path.name.suffix -&gt; putline;
   'Extension of name: '-&gt;puttext; e.path.name.extension -&gt; putline;
   (if e.exists then '(and the entry exists on disk)' -&gt; putline;
    else '(there is no such entry on disk)' -&gt; putline;
   if);
#)
</PRE>
<A NAME=HEADING26-43></A>
<H1> Using File</H1>
<P> Program showing the use of exceptions in files: if the input file specified on the command line cannot be opened, the exception noSuchFileError is raised. In this example, it is further bound specifying that the program should continue after the exception is raised. Then a new file name is prompted for. Instead of this approach, of course, the attributes exists of diskEntry could have been used.</P>
<P> If the output file could not be opened, the exception noSpaceError is raised, and this exception is further bound to print a message:</P>

<A NAME=fileerror.bet><H4 CLASS=betacaption>fileerror.bet</H4></A>
<PRE CLASS=beta>
ORIGIN '~beta/basiclib/file';
--- program: descriptor ---

(* Program showing the use of exceptions in files: if the input file
 * specified on the command line cannot be opened, the exception
 * NoSuchFileError is raised. In this example, it is further bound
 * specifying that the program should continue after the exception is raised.
 * Then a new file name is prompted for.
 * Instead of this approach, of course, the attributes 'exists' of DiskEntry
 * could have been used.
 * If the output file could not be opened, the exception NoSpaceError is raised,
 * and this exception is further bound to print a message.
 *)
 
(# outFile: @file
     (# NoSpaceError ::&lt; 
          (# do 'It is time to delete garbage!' -&gt; msg.putLine #); 
     #);     
   inFile: @ file 
     (# NoSuchFileError ::&lt; (# do true -&gt; continue; false -&gt; OK #); 
     #);
   OK: @ boolean; 
   
do (if noOfArguments &lt;&gt; 2 then
       'Usage: ' -&gt; puttext; 1-&gt;arguments-&gt;puttext; ' out-file' -&gt; putline;
       stop;
   if);
   2 -&gt; arguments -&gt; outFile.name;
   outFile.OpenWrite;
   
   'nofile.bet' -&gt; inFile.name;
   true -&gt; OK;
   openFile: 
     (# 
     do inFile.OpenRead;
        (if not OK then
            'File does not exist: ' -&gt;  screen.puttext;
            infile.name -&gt; putline;
            'Type input file name: ' -&gt;  screen.putText;
            inFile.name.read;
            true -&gt; OK;
            restart openFile
        if);
     #);
   
   readFile: 
     (# 
     do (if not inFile.eos then 
            inFile.getatom -&gt; outFile.putText;
            outFile.newLine;
            restart readFile
            else leave readFile
        if)
     #);
   inFile.close;
   outFile.close;
   'Tokens from '''-&gt;puttext; infile.name -&gt; puttext;
   ''' copied to '''-&gt;puttext; outfile.name -&gt; puttext;
   ''''-&gt;putline;
#)
</PRE>
<P> </P>




<HR>
<P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left">
<ADDRESS>Basic Libraries</ADDRESS>
</TD>
<TD width="20%" align="center"><FONT SIZE="-1">&#169; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
<P>
<P><A HREF=basiclib-27.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=basiclib-25.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=basiclib-25.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF="../index.html"><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF="index.html#_toc"><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
