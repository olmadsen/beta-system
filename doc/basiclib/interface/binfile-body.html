<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<!-- Autogenerated file - do not edit -->
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE>Binfile Interface</TITLE>
<LINK REL="stylesheet" HREF="../../style/miadoc.css" TYPE="text/css">

<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript" SRC="../../javascript/hashfromparent.js"></SCRIPT>
<BASE TARGET="_parent">
</HEAD>
<BODY onLoad='HashFromParent()'>
<H1><A name="binfile">Binfile Interface</A></H1>

<PRE CLASS=interface>
ORIGIN '~beta/basiclib/file';
LIB_DEF 'binfile' '../lib';
BODY 'private/binfilebody';

(* binfile:
 *   These fragments declare attributes for direct reading/writing 
 *   of various data sizes to a file. The data is written out exactly
 *   as is:
 *      64 -&gt; aBinFile.putLong 
 *   will write the number 0x00000020 to aBinFile, whereas 
 *      64 -&gt; aBinFile.putInt
 *   will write the two characters '6' (ascii 54) and '4' (ascii 52)
 *   to the file.
 * 
 *   The operations putBytes and getBytes allow an arbitrary
 *   sequence of bytes to be written/read to/from a file.
 *   E.g. 
 *      buffer: [1000]@char;
 *      putB: @aFile.putBytes;
 *   do ...
 *      (@@buffer[1],500) -&gt; putB;
 *   This will write the first 500 characters from the buffer
 *   repetition to the file. NOTICE, that you must have a static
 *   instance of putBytes/getBytes when using them, since they require
 *   an address argument. If dynamic instances are used, a garbage-
 *   collection may be triggered, and the address argument would be
 *   illegal.
 * 
 *   These operations are declared in FileLib, e.g. they become
 *   usable for any file, by just including this fragment file.
 *   However, on some platforms, the "binary" virtual of File
 *   MUST be further bound to TrueObject for these operations
 *   to work. The binfile pattern below adds this further binding.
 * 
 *   You should remember this further binding if you are using 
 *   these operations on a file, that is not a binfile.
 * 
 *   Exceptions: 
 *   If any of the put-operations fail, they raise the WriteError 
 *   file-exception. If any of the get-operations fail, they raise 
 *   the ReadError file-exception.
 *)

-- LIB: attributes --

<B>binfile</B><A name="binfile.1(446)"></A>: file
  (# &lt;&lt;SLOT BinFileLib: attributes&gt;&gt;;
     <B>binary </B><A name="binfile.1.binary.2(447)"></A><A name="binary.2(447)"></A>:: trueobject
  #);

-- FileLib: attributes --
<B>putdouble</B><A name="putdouble.1(448)"></A>: 
  (* Write binary representation of i (8 bytes) to file *)
  (# <B>i</B><A name="putdouble.1.i.2(449)"></A><A name="i.2(449)"></A>: @real;
  enter i
  ...
  #);
<B>putlong</B><A name="putlong.1(450)"></A>: 
  (* Write binary representation of i (4 bytes) to file *)
  (# <B>i</B><A name="putlong.1.i.2(451)"></A><A name="i.2(451)"></A>: @integer;
  enter i
  ...
  #);
<B>putshort</B><A name="putshort.1(452)"></A>: 
  (* Write binary representation of i (2 bytes) to file *)
  (# <B>i</B><A name="putshort.1.i.2(453)"></A><A name="i.2(453)"></A>: @int16;
  enter i
  ...
  #);
<B>putbyte</B><A name="putbyte.1(454)"></A>: 
  (* Write binary representation of i (1 byte) to file *)
  (# <B>i</B><A name="putbyte.1.i.2(455)"></A><A name="i.2(455)"></A>: @char;
  enter i
  ...
  #);
<B>getDouble</B><A name="getDouble.1(456)"></A>:
  (* Read binary representation of i (8 bytes) from file *)
  (# <B>i</B><A name="getDouble.1.i.2(457)"></A><A name="i.2(457)"></A>: @real;
  ...
  exit i
  #);
<B>getLong</B><A name="getLong.1(458)"></A>:
  (* Read binary representation of i (4 bytes) from file *)
  (# <B>i</B><A name="getLong.1.i.2(459)"></A><A name="i.2(459)"></A>: @integer;
  ...
  exit i
  #);
<B>getShort</B><A name="getShort.1(460)"></A>:
  (* Read binary representation of i (2 bytes) from file *)
  (# <B>i</B><A name="getShort.1.i.2(461)"></A><A name="i.2(461)"></A>: @int16;
  ...
  exit i
  #);
<B>getByte</B><A name="getByte.1(462)"></A>:
  (* Read binary representation of i (1 byte) from file *)
  (# <B>i</B><A name="getByte.1.i.2(463)"></A><A name="i.2(463)"></A>: @char;
  ...
  exit i
  #);

<B>putBytes</B><A name="putBytes.1(464)"></A>:
  (* Write num bytes to file from memory
   * starting at address addr.
   *)
  (# <B>addr</B><A name="putBytes.1.addr.2(465)"></A><A name="addr.2(465)"></A>,<B> num</B><A name="putBytes.1.num.2(466)"></A><A name="num.2(466)"></A>: @integer;
  enter (addr, num)
  ...
  #);
<B>getBytes</B><A name="getBytes.1(467)"></A>:
  (* Read in num bytes from file to memory
   * starting at address addr.
   *)
  (# <B>addr</B><A name="getBytes.1.addr.2(468)"></A><A name="addr.2(468)"></A>,<B> num</B><A name="getBytes.1.num.2(469)"></A><A name="num.2(469)"></A>: @integer;
  enter (addr, num)
  ...
  #)
</PRE>
<TABLE BORDER=0 ALIGN=RIGHT>
<TR>
<TD>
<A HREF="http://validator.w3.org/check/referer">
<IMG BORDER=0 SRC="../../images/vh40.gif" ALT="Valid HTML 4.0!" HEIGHT=31 WIDTH=88>
</A>
</TD>
</TR>
</TABLE>
<BR CLEAR=right>
<P></P>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<HR>
<P></P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left"><ADDRESS>Binfile Interface</ADDRESS></TD>
<TD width="20%" align="center"><FONT size=-1>&#169; <A HREF="http://www.mjolner.com" TARGET="_top">Mj&oslash;lner Informatics</A></FONT>
</TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
</BODY>
</HTML>
