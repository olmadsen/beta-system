<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<!-- Autogenerated file - do not edit -->
<HEAD>
<TITLE>Substreams Interface</TITLE>
<LINK REL="stylesheet" HREF="../../style/miadoc.css" TYPE="text/css">
<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript" SRC="../../javascript/hashfromparent.js"></SCRIPT>
<BASE TARGET="_top">
</HEAD>
<BODY onLoad='HashFromParent()'>
<H1><A name="substreams">Substreams Interface</A></H1>
<PRE CLASS=interface>
ORIGIN 'betaenv';
BODY 'private/substreamsbody'
(*
 * COPYRIGHT
 *       Copyright (C) Mjolner Informatics, 1995-96
 *       All rights reserved.
 *
 * This fragment implements a substream and a subtext pattern
 * The operations of substream and subtext are essentially the same
 * as the operations on stream, respectively, text.  See these patterns
 * in betaenv for a description of the semantics of the operations.
 *)
--- lib: attributes ---
<B>substream</B><A name="substream.1(1010)"></A>: stream
  (# &lt;&lt;SLOT substreamLib: attributes&gt;&gt;;
     <B>streamType</B><A name="substream.1:streamType.2(1011)"></A><A name="streamType.2(1011)"></A>:&lt; stream;
     <B>stm</B><A name="substream.1:stm.2(1012)"></A><A name="stm.2(1012)"></A>: (* the attached stream *) ^streamType;
     <B>high</B><A name="substream.1:high.2(1013)"></A><A name="high.2(1013)"></A>,<B> low</B><A name="substream.1:low.2(1014)"></A><A name="low.2(1014)"></A>: @integer;
     <B>init</B><A name="substream.1:init.2(1015)"></A><A name="init.2(1015)"></A>:
       (#
       enter (stm[], low, high)
       do check
       #);
     <B>attach</B><A name="substream.1:attach.2(1016)"></A><A name="attach.2(1016)"></A>:
       (# enter stm[] #);
     <B>range</B><A name="substream.1:range.2(1017)"></A><A name="range.2(1017)"></A>:
       (#
       enter (low,high)
       do check; high-low+1-&gt;lgth
       exit (low,high)
       #);
     <B>check</B><A name="substream.1:check.2(1018)"></A><A name="check.2(1018)"></A>:
       (#
       do (if true
           // stm[]=NONE then notAttachedError
           // low&gt;high then illegalRangeError
           // low&lt;0 then illegalRangeError
           // low&gt;stm.length then illegalRangeError
           // high&gt;stm.length then illegalRangeError
          if)
       #);
     <B>length</B><A name="substream.1:length.2(1019)"></A><A name="length.2(1019)"></A>::&lt;(# ... #);
     <B>eos</B><A name="substream.1:eos.2(1020)"></A><A name="eos.2(1020)"></A>::&lt;(# ... #);
     <B>empty</B><A name="substream.1:empty.2(1021)"></A><A name="empty.2(1021)"></A>: booleanValue
       (# ... #);
     <B>copy</B><A name="substream.1:copy.2(1022)"></A><A name="copy.2(1022)"></A>:
       (# theCopy: ^substream;
          copyI: @...
       do copyI
       exit theCopy[]
       #);
     <B>notAttachedError</B><A name="substream.1:notAttachedError.2(1023)"></A><A name="notAttachedError.2(1023)"></A>:&lt; StreamException
       (* Raised when this(substream) is not attached to any stream.
        * Message: "The substream is not attached to any stream!".
        *)
       (# ... #);
     <B>illegalRangeError</B><A name="substream.1:illegalRangeError.2(1024)"></A><A name="illegalRangeError.2(1024)"></A>:&lt; StreamException
       (* Raised when the substream range specified does not lie
        * within the range of the attached stream.  Message: "The
        * substream range is not within the attached stream range!".
        *)
       (# ... #);
     <B>indexError</B><A name="substream.1:indexError.2(1025)"></A><A name="indexError.2(1025)"></A>:&lt; StreamException
       (* Raised when the index goes outside the range of the
        * substream.  Message: "Index error in stream! (index &lt;num&gt;)".
        *)
       (# inx: @integer
       enter inx ...
       #);
     <B>EOSerror</B><A name="substream.1:EOSerror.2(1026)"></A><A name="EOSerror.2(1026)"></A>::&lt;
       (* Raised from Get and Peek when the end of the substream is
        * passed.
        *)
       (# ... #);
     <B>otherError</B><A name="substream.1:otherError.2(1027)"></A><A name="otherError.2(1027)"></A>::&lt;
       (* Raised when an error other than the Index-/EOSerror occurs.
        *)
       (# ... #);
     <B>setpos</B><A name="substream.1:setpos.2(1028)"></A><A name="setpos.2(1028)"></A>::&lt;(# ... #);
     <B>getpos</B><A name="substream.1:getpos.2(1029)"></A><A name="getpos.2(1029)"></A>::&lt;(# ... #);
     <B>pos</B><A name="substream.1:pos.2(1030)"></A><A name="pos.2(1030)"></A>,<B> lgth</B><A name="substream.1:lgth.2(1031)"></A><A name="lgth.2(1031)"></A>: (* private *) @integer;
  enter (attach,range)
  #);

<B>subtext</B><A name="subtext.1(1032)"></A>: substream
  (# &lt;&lt;SLOT subtextLib: attributes&gt;&gt;;
     <B>streamType</B><A name="subtext.1:streamType.2(1033)"></A><A name="streamType.2(1033)"></A>::&lt; text;
     <B>put</B><A name="subtext.1:put.2(1034)"></A><A name="put.2(1034)"></A>::&lt;(# ... #);
     <B>putText</B><A name="subtext.1:putText.2(1035)"></A><A name="putText.2(1035)"></A>::&lt;(# ... #);
     <B>get</B><A name="subtext.1:get.2(1036)"></A><A name="get.2(1036)"></A>::&lt;(# ... #);
     <B>getAtom</B><A name="subtext.1:getAtom.2(1037)"></A><A name="getAtom.2(1037)"></A>::&lt;(# ... #);
     <B>getLine</B><A name="subtext.1:getLine.2(1038)"></A><A name="getLine.2(1038)"></A>::&lt;(# ... #);
     <B>peek</B><A name="subtext.1:peek.2(1039)"></A><A name="peek.2(1039)"></A>::&lt;(# ... #);
     <B>clear</B><A name="subtext.1:clear.2(1040)"></A><A name="clear.2(1040)"></A>:
       (# ... #);
     <B>inxGet</B><A name="subtext.1:inxGet.2(1041)"></A><A name="inxGet.2(1041)"></A>: charValue
       (# i: @integer
       enter i
       ...
       #);
     <B>inxPut</B><A name="subtext.1:inxPut.2(1042)"></A><A name="inxPut.2(1042)"></A>:
       (# ch: @char; i: @integer
       enter (ch,i)
       ...
       #);
     <B>append</B><A name="subtext.1:append.2(1043)"></A><A name="append.2(1043)"></A>:
       (# S1: ^streamType; S1lgt: @integer
       enter S1[]
       ...
       #);
     <B>prepend</B><A name="subtext.1:prepend.2(1044)"></A><A name="prepend.2(1044)"></A>:
       (# S1: ^streamType; S1lgt: @integer
       enter S1[]
       ...
       #);
     <B>scanAll</B><A name="subtext.1:scanAll.2(1045)"></A><A name="scanAll.2(1045)"></A>:
       (# ch: @char
       ...
       #);
     <B>sub</B><A name="subtext.1:sub.2(1046)"></A><A name="sub.2(1046)"></A>: 
       (# i,j: @integer
       enter (i,j)
       exit (i,j)-&gt;stm.sub
       #);
     <B>insert</B><A name="subtext.1:insert.2(1047)"></A><A name="insert.2(1047)"></A>:
       (# T1: ^streamType;
          inx: @integer;
          P: @integer
       enter (T1[],inx)
       ...
       #);
     <B>delete</B><A name="subtext.1:delete.2(1048)"></A><A name="delete.2(1048)"></A>:
       (# i,j: @integer
       enter (i,j)
       ...
       #);
     <B>equal</B><A name="subtext.1:equal.2(1049)"></A><A name="equal.2(1049)"></A>: booleanValue
       (# S1: ^streamType;
          S1pos, lgt: @integer;
          NCS:&lt; booleanObject
       enter S1[]
       ...
       #);
     <B>equalNCS</B><A name="subtext.1:equalNCS.2(1050)"></A><A name="equalNCS.2(1050)"></A>: equal
       (* As 'equal', except the the comparison will be done Non
        * Case Sensitive
        *)
       (# NCS:: trueObject #);
     <B>less</B><A name="subtext.1:less.2(1051)"></A><A name="less.2(1051)"></A>: booleanValue
       (# S1: ^streamType;
          S1pos, lgt: @integer; ch, ch1: @char
       enter S1[]     
       ...
       #);
     <B>greater</B><A name="subtext.1:greater.2(1052)"></A><A name="greater.2(1052)"></A>: booleanValue
       (# S1: ^streamType;
          S1pos, lgt: @integer; ch, ch1: @char
       enter S1[]
       ...
       #);
     <B>makeLC</B><A name="subtext.1:makeLC.2(1053)"></A><A name="makeLC.2(1053)"></A>:
       (# ... #);
     <B>makeUC</B><A name="subtext.1:makeUC.2(1054)"></A><A name="makeUC.2(1054)"></A>:
       (# ... #);
     <B>find</B><A name="subtext.1:find.2(1055)"></A><A name="find.2(1055)"></A>:
       (# ch: @char;
          inx: @integer;
          NCS:&lt; booleanObject;
          from:&lt; integerObject(# do pos-&gt;value; INNER from #)
       enter ch
       ...
       #);
     <B>findAll</B><A name="subtext.1:findAll.2(1056)"></A><A name="findAll.2(1056)"></A>: find
       (# from:: (# do 0-&gt;value #)
       do INNER findAll
       #);
     <B>findText</B><A name="subtext.1:findText.2(1057)"></A><A name="findText.2(1057)"></A>:
       (# txt: ^text;
          inx: @integer;
          NCS:&lt; booleanObject;
          from:&lt; integerObject(# do pos-&gt;value; INNER from #)
       enter txt[]
       ...
       #);
     <B>findTextAll</B><A name="subtext.1:findTextAll.2(1058)"></A><A name="findTextAll.2(1058)"></A>: findText
       (# from:: (# do 0-&gt;value #)
       do INNER findTextAll
       #);
  exit stm.T[<B>low</B><A name="subtext.1:low.2(1059)"></A><A name="low.2(1059)"></A>:high]
  #);

<B>putSubStream</B><A name="putSubStream.1(1060)"></A>: screen.putSubstream(# do INNER putSubstream #)

--- textLib: attributes ---
<B>subtxt</B><A name="subtxt.1(1061)"></A>:
  (# <B>low</B><A name="subtxt.1:low.2(1062)"></A><A name="low.2(1062)"></A>,<B>high</B><A name="subtxt.1:high.2(1063)"></A><A name="high.2(1063)"></A>: @integer;
     <B>theSubtext</B><A name="subtxt.1:theSubtext.2(1064)"></A><A name="theSubtext.2(1064)"></A>: ^subtext
  enter (low,high)
  do &amp;subtext[]-&gt;theSubtext[];
     (this(text)[],(low,high))-&gt;theSubtext;
     theSubtext.init
  exit theSubtext[]
  #)

--- streamLib: attributes ---
<B>putSubstream</B><A name="putSubstream.1(1065)"></A>:
  (# <B>stm</B><A name="putSubstream.1:stm.2(1066)"></A><A name="stm.2(1066)"></A>: ^substream;
     <B>p</B><A name="putSubstream.1:p.2(1067)"></A><A name="p.2(1067)"></A>: (*private*)@integer
  enter stm[]
  ...
  #)
</PRE>
<!---------------------------------------------------------->
<HR>
<P></P>
<TABLE cols=3 border=0 width=100%>
<TR>
<TD width="40%" align="left"><ADDRESS>Substreams Interface</ADDRESS></TD>
<TD width="20%" align="center"><FONT size=-1>&COPY; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT LANGUAGE=JavaScript SRC="../../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
</BODY>
</HTML>
