<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE> 19.1 Interface and Implementation</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING41></A>


<P><A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=tutorial-40.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=tutorial-40.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P> 19 The Fragment System</P>


<A NAME=HEADING41-0></A>
<H2> 19.1 Interface<A NAME=MARKER-2-138></A> and Implementation<A NAME=MARKER-2-139></A></H2>
<P> The fragment system can be used to separate interface from implementation. In the putBoxed example above we included the implementation of the operation in the interface. We can move the implementation of putBoxed to another file using a dopart slot. This is specified as follows:</P>

<PRE CLASS=beta>
  putBoxed: 
     (* print the text with a box surrounding: 
      * 'text'-&gt;putBoxed results in '[text]'
      *)
    (# t: ^Text;
    enter t[]
    &lt;&lt;SLOT putBoxed: dopart&gt;&gt;
    #);
</PRE>
<P> Here we have described only the interface of putBoxed, i.e. it can be seen that the operation takes a text as a argument (and the comment states that the operation will print the text with a surrounding box). The implementation is hidden. The implementation can be described in a dopart fragment:</P>

<PRE CLASS=beta>
---putBoxed: dopart---
    do '['-&gt;put; t[]-&gt; puttext; ']'-&gt;put;
</PRE>
<P> In order to make things work we must specify where the implementation can be found. This is done using a BODY<A NAME=MARKER-2-140></A> specification in the putBoxed.bet file:</P>
<H4 CLASS=betacaption><A NAME="fig:Program 19.6: putBoxed.bet"> Program 19.6: putBoxed.bet</A></H4>
<P> The file with the ---putBoxed: dopart--- fragment must specify where the dopart fragment is to be filled. This is done using the ORIGIN:</P>
<PRE CLASS=beta>
ORIGIN '~beta/basiclib/betaenv';
BODY 'putBoxedBody'
---LIB: Attributes---
  putBoxed: 
     (* print the text with a box surrounding: 
      * 'text'-&gt;putBoxed results in '[text]'
      *)
    (# t: ^Text;
    enter t[]
    &lt;&lt;SLOT putBoxed: dopart&gt;&gt;
    #);
</PRE>
<A NAME=HEADING41-9></A>
<A NAME=HEADING41-12></A>
<H4 CLASS=betacaption><A NAME="fig:Program 19.7: putBoxedBody.bet"> Program 19.7: putBoxedBody.bet</A></H4>
<PRE CLASS=beta>
ORIGIN 'putBoxed'
---putBoxed: dopart---
    do '['-&gt;put; t[]-&gt; puttext; ']'-&gt;put;
</PRE>

<P> Another major advantage of separating the implementation from the interface is separate compilation. The putBoxed.bet and the putBoxedBody.bet file can be separately compiled, and the putBoxedBody.bet file can be changed and recompiled without recompiling the interface file putBoxed.bet or any of the programs that are using the library putBoxed.</P>
<P> The HelloWorld program using the putBoxed library has not changed:</P>
<A NAME=HEADING41-17></A>
<H4 CLASS=betacaption><A NAME="fig:Program 19.8: HelloWorld.bet"> Program 19.8: HelloWorld.bet</A></H4>
<PRE CLASS=beta>
ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'putBoxed'
---program: descriptor---
(#
do 'Hello World!'-&gt;putBoxed;
#)
</PRE>
<P> And the expanded BETA program, using the files: betaenv, HelloWorld, putBoxed, and putBoxedBody is (exactly as above):</P>
<A NAME=HEADING41-20></A>
<H4 CLASS=betacaption><A NAME="fig:Program 19.9: HelloWorld with filled program and LIB slot"> Program 19.9: HelloWorld with filled program and LIB slot</A></H4>
<PRE CLASS=beta>
(* The basic BETA environment betaenv *)
(# ...
   put: (# c: @char; enter c do ... #);
   puttext: (# t: ^text; enter t[] do ... #);
   putline: (# t: ^text; enter t[] do t[]-&gt;puttext; newline #);
   newline: (# do ... #);
   text: (# ... #);
   putBoxed: 
     (* print the text with a box surrounding: 
      * 'text'-&gt;putBoxed results in '[text]'
      *)
    (# t: ^Text;
    enter t[]
    do '['-&gt;put; t[]-&gt; puttext; ']'-&gt;put;
    #);
   ...
do (* initialize for execution *)
   (#
   do 'Hello World!'-&gt;putline;
   #)
   (* terminate execution *)
#)
</PRE>

<P> The fragment system is described in abstract terms in the BETA book <A HREF="../bibliography/index.html#mmn93">[MMN 93]</A>. That description also suggests many ideas of how to use the fragment system. The current implementation of the fragment system is described in the compiler manual <A HREF="../bibliography/index.html#mia90-2">[MIA 90-2]</A>.</P>











<HR>
<P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left">
<ADDRESS>Libraries Tutorial</ADDRESS>
</TD>
<TD width="20%" align="center"><FONT SIZE="-1">&#169; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
<P>
<P><A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=tutorial-40.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>
<A HREF=tutorial-40.html><IMG ALIGN=BOTTOM SRC="../images/up.gif" ALT=Up BORDER=0></A>
<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
