<H2> 10.1 Command-line arguments<A NAME=MARKER-2-80></A></H2>
<P> At present, our program only works with one file data1. It would be more useful if the name of the file could be specified by the user. A common way to allow this in UNIX is to pass the name of the files to be used as arguments on the command line used to invoke the program. For example, to count the characters in file data2, we would like to invoke count as follows:</P>
<PRE CLASS=beta>
% CountChar data2
</PRE>
<P> The demo file programs that come with BETA all work this way. To do this, there are two useful functions in the standard environment which correspond to the UNIX C argc and argv variables. These are:</P>
<UL>
<LI> noOfArguments: which returns the number of arguments on the command line and
<LI> arguments: which given an integer parameter N returns the n'th argument on the command line. Remember that argument 1 is the name used for the program - CountChar1 in our example - and that the one we want will be argument 2.
</UL>
<P> Below, we show how count has been modified to use the command argument. To keep things simple, we do not check the number of arguments or provide for an error message. For examples of how to do this, see the demo programs.</P>
<A NAME=HEADING21-8></A>
<H4 CLASS=betacaption><A NAME="fig:Program 10.2: CountChar1.bet"> Program 10.2: CountChar1.bet</A></H4>
<PRE CLASS=beta>
ORIGIN '~beta/basiclib/file'
---- program: descriptor ----
ORIGIN '~beta/basiclib/file'
---- program: descriptor ----

(# (* ----------------------------------------------
    *   count.bet: Simple file handling program
    *              -Counting characters-
    * ----------------------------------------------*)
   
   inFile: @file;
   Ch: @char;
   nc: @integer;
do
   (if  NoofArguments = 2 then
       2->ARGUMENTS->inFile.name ;
       inFile.openRead;  (* OPENING *)
       
       'Reading: '->puttext;   inFile.name->putline;
       Loop: 
	 (if not inFile.eos then
	     inFile.get->Ch; 
	     nc + 1->nc;
	     (if nc mod 10 = 0 then '.'->put  if);
	     restart Loop
	 if);
       newline;
       nc->putint; ' characters in file'->putline;
       inFile.close;
    else 
       'Missing Arguments'->putline;
   if)
#)
</PRE>
<P> And below we show the application of CountChar1 to the count program itself.</P>
<PRE CLASS=beta>
nil% CountChar1 CountChar1.bet
Reading: CountChar1.bet
.......................................................................
681 characters in file
nil% 
</PRE>
<P> A nice thing about passing file names as command line arguments is that the shell will expand the file name as expected. In particular, the '~' and '*' characters are interpreted correctly in the example below:<EM><A REL=FOOTNOTE HREF="#FOOTNOTE-2">[2]</A></EM></P>
<PRE CLASS=beta>
nil% count ~/Beta/dat*
Reading: ../Beta/data1
....
41 characters in file
</PRE>
<P> These also work:</P>
<UL>
<LI> count ~vaucher/Beta/data1
<LI> count ./data1
<LI> count ../Beta/file/../data1
</UL>
<P> Were we to set the filename directly, it would be OK to include '.' and '..' in the path name but '~' would not be handled properly.</P>






<HR>

<A NAME=FOOTNOTE-2>[2] </A>
 For Unix shells only.














