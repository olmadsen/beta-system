<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE> 5 Loops and Functions</TITLE>
<LINK REL=stylesheet HREF=../style/miadoc.css TYPE=text/css>

</HEAD>
<BODY>


<A NAME=HEADING11></A>


<P><A HREF=tutorial-12.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=tutorial-10.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>

<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>
<P>Libraries Tutorial</P>


<A NAME=HEADING11-0></A>
<H1> 5 Loops and Functions</H1>
<P> In this section, we take on the task of writing a function that computes square roots. This will lead us to consider conditional looping and the definitions of functions, or in BETA terms, patterns that can return values.</P>
<P> To compute a square root we will use Newton's algorithm where the computation is done by successive approximations until the error is less than a preset level (epsilon).</P>
<P> The usual way to program this involves a while loop. In C, the code to get the root of X could look like this:</P>
<PRE CLASS=beta>
Root= X;
while (abs(X-Root**2) &gt; epsilon) {
  Root= (Root+X/root) / 2;
}
</PRE>
<P> Assuming that X = 100, the calculated values of Root in each iteration will be:</P>
<PRE CLASS=beta>
150.5
226.2401
315.0255
410.8404
510.0326
610.0001
710.0000... and the loop ends.
</PRE>
<P> Surprisingly, there is no while loop in BETA language. BETA is designed with a more fundamental (and extensible) feature as the ability to either leave or restart any labeled imperative. In the basic BETA environment betaenv, a loop pattern using these features is defined and can be used like:</P>

<PRE CLASS=beta>
X -&gt; Root;
Loop(# while::(# do (X-Root*Root -&gt; fabs) &gt; X / 10E6 -&gt; value #);
    do (Root + X/root) / 2 -&gt; root;
    #);
</PRE>
<P> A while loop can also directly be implemented using a labeled imperative with a restart. The following BETA code is a repeated conditional imperative implemented using a labeled if with a restart imperative at the end:</P>

<PRE CLASS=beta>
X -&gt; Root;
L: (if (X-Root*Root -&gt; fabs) &gt; X / 10E6 then
       0.5 * (Root + X div Root) -&gt; Root;
       restart L;
   if);
</PRE>
<P> Here, the error, epsilon, is set at one part in a million. The complete program code is given in Program 5 below. Here the code for the Square Root has been put in the form of a procedure which returns a value: that is to say a function. As shown in the example, a function call has the following syntax:</P>
<PRE CLASS=beta>
i -&gt; Sqrt -&gt; Res;
</PRE>
<P> We have already seen the notation &lt;parameters&gt; -&gt; &lt;procedure&gt; whereby data is passed (as parameters) to the procedure object. In BETA, the same syntax is used to show that results are obtained from Sqrt and passed on to Res. </P>
<A NAME=HEADING11-17></A>
<H4 CLASS=betacaption><A NAME="fig:Program 5:  SquareRoot.bet"> Program 5:  SquareRoot.bet</A></H4>
<PRE CLASS=beta>
ORIGIN '~beta/basiclib/betaenv';
INCLUDE '~beta/basiclib/numberio'
        '~beta/basiclib/math';
---- program: descriptor ----
(#

(*  SquareRoot.bet: Exploring functions
 *                  + conditional loops
 *)

  Res: @real;

  Sqrt:
    (# X, Root: @real;
    enter X
    do X -&gt; Root;
       Loop(# while::
                (# do (X-Root*Root -&gt; fabs) &gt; X / 10E6 -&gt; value #)
           do (Root + X/root) / 2 -&gt; root;
           #);
    exit Root
    #);

  tab:
    (# N: @integer;
    enter N
    do (for N repeat ' '-&gt; put for)
    #);

do '\n\t ** Functions and variables **\n' -&gt; putline;
   ' I   sqrt(i) ' -&gt; putline;
   (for i:10 repeat
        i -&gt; Sqrt -&gt; Res;
        i -&gt; putint(# format::(# do 2 -&gt; width#)#);
        3-&gt; tab;
        Res -&gt; putreal;
        newline;
   for)
#)
</PRE>

<P> The declaration of Sqrt shows an exit list which defines the list of values obtained after executing the body of the function. In this case, there is only one value, a real, but BETA functions could return multiple results. </P>
<P> The output obtained upon execution are shown below.</P>
<P> </P>
<PRE CLASS=beta>
	 ** Functions and variables **

 I   sqrt(i) 
 1   1.000000
 2   1.414214
 3   1.732051
 4   2.000000
 5   2.236068
 6   2.449490
 7   2.645751
 8   2.828427
 9   3.000000
10   3.162278
</PRE>










<HR>
<P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left">
<ADDRESS>Libraries Tutorial</ADDRESS>
</TD>
<TD width="20%" align="center"><FONT SIZE="-1">&#169; <A HREF="http://www.mjolner.com">Mj&oslash;lner Informatics</A></FONT></TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
<P>
<P><A HREF=tutorial-12.html><IMG ALIGN=BOTTOM SRC="../images/next.gif" ALT=Next BORDER=0></A>
<A HREF=tutorial-10.html><IMG ALIGN=BOTTOM SRC="../images/prev.gif" ALT=Previous BORDER=0></A>

<A HREF=../index.html><IMG ALIGN=BOTTOM SRC="../images/top.gif" ALT=Top BORDER=0></A>
<A HREF=index.html#_toc><IMG ALIGN=BOTTOM SRC="../images/content.gif" ALT=Contents BORDER=0></A>
<A HREF=inx.html><IMG ALIGN=BOTTOM SRC="../images/index.gif" ALT=Index BORDER=0></A></P>


</BODY>
</HTML>
