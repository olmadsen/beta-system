<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<!-- Autogenerated file - do not edit -->
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE>Samefile Interface</TITLE>
<LINK REL="stylesheet" HREF="../../style/miadoc.css" TYPE="text/css">

<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript" SRC="../../javascript/hashfromparent.js"></SCRIPT>
<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript">
<!--
    CheckParent("samefile");
//-->
</SCRIPT>
<BASE TARGET="_parent">
</HEAD>
<BODY onLoad='HashFromParent()'>
<H1><A name="samefile">Samefile Interface</A></H1>

<PRE CLASS=interface>
ORIGIN '~beta/basiclib/betaenv';
INCLUDE '~beta/basiclib/regexp';
(* File samefile.bet
 * =================
 * This file contains the method 'samefile', which exits true, if
 * the two entered files are the same and false otherwise. This library 
 * is used instead of file1name[]-&gt;file2name.equal because the
 * same file can have different names dependent on the machine, where a
 * process starts.
 * F.eks. /a/home/scandium9/jojo/speciale/pstore1
 * and    ~jojo/speciale/pstore1 are the same files, but would result
 * in false, if using the .equal operation.
 *)
-- lib: Attributes --
<B>cutafterusers</B><A name="cutafterusers.1(283)"></A>:
  (# <B>path1</B><A name="cutafterusers.1.path1.2(284)"></A><A name="path1.2(284)"></A>,<B>path2</B><A name="cutafterusers.1.path2.2(285)"></A><A name="path2.2(285)"></A>: ^text; <B>regex</B><A name="cutafterusers.1.regex.2(286)"></A><A name="regex.2(286)"></A>: ^text; 
  enter path1[]
  do path1.copy-&gt;path2[];
     0-&gt;path2.pos;
     '/users/'-&gt;regex[];
     (if
     regex[]
       -&gt;path2.regexp_search
         (# posToMatchEnd::&lt;  (#  do true-&gt;value #); ; 
         do (if (0-&gt;regs.start) &gt;= 0 then (1,0-&gt;regs.end)-&gt;path2.delete;  if)
         #) then
         
      else
         '/a/home/[^/]*/'-&gt;regex[];
         (if
         regex[]
           -&gt;path2.regexp_search
             (# posToMatchEnd::&lt;  (#  do true-&gt;value #); ; 
             do (if (0-&gt;regs.start) &gt;= 0 then
                    (1,0-&gt;regs.end)-&gt;path2.delete; 
                if)
             #) then
             
          else
             
         if);
         
     if);
     
  exit path2[]
  #);
<B>cutPath</B><A name="cutPath.1(287)"></A>: (* removes everything before the last '\' or '/' including that char *)
  (#
     <B>path1</B><A name="cutPath.1.path1.2(288)"></A><A name="path1.2(288)"></A>: ^text;
     <B>charIndex</B><A name="cutPath.1.charIndex.2(289)"></A><A name="charIndex.2(289)"></A>: (* the index in path1 of the last '/' or '\' *) @integer
  enter path1[]
  do - 1-&gt;charIndex;
     '/'
       -&gt;path1.findAll
         (#  do (if inx &gt; charIndex then inx-&gt;charIndex if) #);
     '\\'
       -&gt;path1.findAll
         (#  do (if inx &gt; charIndex then inx-&gt;charIndex if) #);
     (if charIndex &gt; - 1 then
         (charIndex+1,path1.length)-&gt;path1.sub-&gt;path1[]
     if)
  exit path1[]
  #);
<B>sameFile</B><A name="sameFile.1(290)"></A>: (* Ignores the _path_ of the file *) booleanValue
  (# <B>path1</B><A name="sameFile.1.path1.2(291)"></A><A name="path1.2(291)"></A>,<B>path2</B><A name="sameFile.1.path2.2(292)"></A><A name="path2.2(292)"></A>: ^text; 
  enter (path1[],path2[])
  do path1[]-&gt;cutPath-&gt;path1[];
     path2[]-&gt;cutPath-&gt;path2[];
     (if path1[]-&gt;path2.equalNCS then true-&gt;value;  else false-&gt;value;  if)
  #);
<B>sameFileUnix</B><A name="sameFileUnix.1(293)"></A>:
(* Simple routine to test if two files are identical from
 their names. Works on UNIX *) booleanValue
  (# <B>path1</B><A name="sameFileUnix.1.path1.2(294)"></A><A name="path1.2(294)"></A>,<B>path2</B><A name="sameFileUnix.1.path2.2(295)"></A><A name="path2.2(295)"></A>: ^text; 
  enter (path1[],path2[])
  do path1[]-&gt;cutafterusers-&gt;path1[];
     path2[]-&gt;cutafterusers-&gt;path2[];
     (if path1[]-&gt;path2.equalNCS then true-&gt;value;  else false-&gt;value;  if);
     <B>debugInfo</B><A name="sameFileUnix.1.debugInfo.2(296)"></A><A name="debugInfo.2(296)"></A>:
       (# 
       do (if false then
              'sps.samefile: "'-&gt;puttext;
              path1[]-&gt;puttext;
              '" and "'-&gt;puttext;
              path2[]-&gt;puttext;
              '" are'-&gt;puttext;
              (if value then
                  ' the same'-&gt;putline
               else
                  ' NOT the same!!!'-&gt;putline
              if)
          if)
       #)
  #)
</PRE>
<P></P>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<HR>
<P></P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left"><ADDRESS>Samefile Interface</ADDRESS></TD>
<TD width="20%" align="center"><FONT size="-1">&#169; <A HREF="http://www.mjolner.com" TARGET="_top">Mj&oslash;lner Informatics</A></FONT>
</TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
</BODY>
</HTML>
