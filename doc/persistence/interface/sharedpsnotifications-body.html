<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd"
>
<HTML>
<!-- Autogenerated file - do not edit -->
<HEAD>
<META http-equiv="Content-Type" CONTENT="text/html; CHARSET=ISO-8859-1">
<TITLE>Sharedpsnotifications Interface</TITLE>
<LINK REL="stylesheet" HREF="../../style/miadoc.css" TYPE="text/css">

<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript" SRC="../../javascript/hashfromparent.js"></SCRIPT>
<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript">
<!--
    CheckParent("sharedpsnotifications");
//-->
</SCRIPT>
<BASE TARGET="_parent">
</HEAD>
<BODY onLoad='HashFromParent()'>
<H1><A name="sharedpsnotifications">Sharedpsnotifications Interface</A></H1>

<PRE CLASS=interface>
ORIGIN '~beta/distribution/basicshell';
INCLUDE 'notification'
        'notificationmanager';
(* This file is included by the sharedpersistentstore - library
 * in order to send notifications to the PersistentStoreManager.
 *)
-- shellEnvLib: Attributes --
<B>notificationmanagement</B><A name="notificationmanagement.1(251)"></A>:
  (#
     <B>server</B><A name="notificationmanagement.1.server.2(252)"></A><A name="server.2(252)"></A>: ^notificationmanager;
     <B>serverEnsemblename</B><A name="notificationmanagement.1.serverEnsemblename.2(253)"></A><A name="serverEnsemblename.2(253)"></A>: ^text;
     <B>serverensemble</B><A name="notificationmanagement.1.serverensemble.2(254)"></A><A name="serverensemble.2(254)"></A>: ^ensemble;
     <B>init</B><A name="notificationmanagement.1.init.2(255)"></A><A name="init.2(255)"></A>:
       (# s: ^notificationmanager; n: ^text; 
       enter (s[],n[])
       do s[]-&gt;server[]; n[]-&gt;serverEnsemblename[]
       #);
     <B>notify</B><A name="notificationmanagement.1.notify.2(256)"></A><A name="notify.2(256)"></A>:
       (#
          c: ^NPSclient;
          user: ^text;
          PSname: ^text;
          type: @integer;
          thenotification: ^notification
       enter (c[],user[],PSname[],type)
       do notifyserver: theNoterrorhandler
            (# 
            do (c[],user[],PSname[],type)-&gt;sendPSnotification
                 -&gt;theNotification[];
               true-&gt;successful;
               (c[],theNotification[])-&gt;server.notify;
               (if not successful then restart notifyserver if)
            #)
       #);
     <B>theNotErrorhandler</B><A name="notificationmanagement.1.theNotErrorhandler.2(257)"></A><A name="theNotErrorhandler.2(257)"></A>: errorhandler
       (#
          successful: @boolean;
          onFailure:
            (# theError: ^error; 
            enter theError[]
            do (if theError.theObj## &lt;= NotificationManager## then
                   getHost:
                     (# 
                     do none -&gt;serverensemble[];
                        (ensemble##,serverEnsembleName[])
                          -&gt;theShell.myEnsemble.ns.get
                            (#
                               notFound:: 
                                 (# 
                                 do serverEnsembleName[]-&gt;screen.putText;
                                    ' not found. '-&gt;putline;
                                    
                                 #)
                            #)-&gt;serverEnsemble[];
                        (if serverEnsemble[]
                         // none then
                            'Please, start new Ensemble on '-&gt;puttext;
                            serverEnsemblename[]-&gt;putline;
                            5-&gt;sleep;
                            restart gethost
                        if);
                        
                     #);
                   getserver:
                     (# 
                     do (NotificationManager##,'Notificationmanager')
                          -&gt;serverEnsemble.ns.get
                            (#
                               notFound:: 
                                 (# 
                                 do 'No Notificationmanager on '
                                      -&gt;screen.putText;
                                    serverEnsembleName[]-&gt;screen.putLine;
                                    'Please, restart new server on '-&gt;puttext;
                                    serverEnsemblename[]-&gt;putline;
                                    5-&gt;sleep;
                                    restart getserver;
                                    
                                 #)
                            #)-&gt;server[];
                        
                     #);
                   theError.ignore
                else
                   theError.abort; 
               if)
            #);
          connectionBroken::&lt; 
            (# 
            do false-&gt;successful; INNER ; THIS(connectionBroken)[]-&gt;onFailure
            #);
          connectionFailed::&lt; 
            (# 
            do false-&gt;successful; INNER ; THIS(connectionFailed)[]-&gt;onFailure
            #);
          timeOut::&lt; 
            (# 
            do false-&gt;successful; INNER ; THIS(timeOut)[]-&gt;onFailure
            #);
          timeOutValue::&lt;  (# do INNER #);
       do INNER
       #)
  #)
</PRE>
<P></P>
<!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<HR>
<P></P>
<TABLE border=0 width="100%">
<TR>
<TD width="40%" align="left"><ADDRESS>Sharedpsnotifications Interface</ADDRESS></TD>
<TD width="20%" align="center"><FONT size="-1">&#169; <A HREF="http://www.mjolner.com" TARGET="_top">Mj&oslash;lner Informatics</A></FONT>
</TD>
<TD width="40%" align="right"><SCRIPT TYPE="text/javascript" LANGUAGE=JavaScript SRC="../../javascript/lastmod.js"></SCRIPT></TD>
</TABLE>
</BODY>
</HTML>
