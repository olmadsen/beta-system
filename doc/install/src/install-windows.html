<H1>Installation Guide for PC's running Windows NT / 95 / 98 / 2000</H1>
<P> This chapter contains the installation guide for the Mj&oslash;lner System on Windows NT and Windows 95 using the Microsoft or GNU SDK.</P>
<H2><INX>Minimum Requirements</INX></H2>
<P> Requirements for using the Mj&oslash;lner System on Windows NT/95/98/2000:</P>
<P> </P>
<UL>
<LI>CPU: 386/486/586/Pentium or compatible.
<LI>RAM: At least 16Mb RAM. 32Mb (or more) recommended.
<LI>Free disk space: Approximately 100Mb
<LI>Linker and standard C libraries from either Microsoft or GNU
<LI>Windows 95/98/2000 or Windows NT 3.5.1/NT 4.0 or later.
</UL>
<H2>Installation</H2>

<P>Before you install the Mjølner System, please install your
SDK libraries and utilities.  This can be either the
MicroSoft or the GNU SDK.

<H3>Run the <A NAME="setup"><INX><CODE>Setup</CODE> program</INX></A></H3>
<P> To install The Mj&oslash;lner System, run the <CODE>Setup</CODE> Program, which can be found on the Mj&oslash;lner System CD in the folder named</P>
<P> </P>
<BETA>
\windows\<SDK>\Disk1
</BETA>
<P> </P>
<P> where &lt;SDK&gt; is one of the following: <CODE>ms</CODE> or <CODE>gnu</CODE>.</P>
<P> </P>
<P> The <CODE>Setup</CODE> Program installs The Mj&oslash;lner System
on your system in the directory you specify. Throughout the rest of
this document, BETALIB refers to the directory chosen here.</P>

<H3>Set up <INX>Environment Variables</INX></H3>

<P> The Mjølner System installation script sets up the necessary
environment variables for you.  You can skip this section if you
are running under Windows95, Windows98 or WindowsME or if you
are running under WindowsNT or Windows2000 and always log in as
the Administrator.  (The environment variables are only
set up for the user running the installation program, normally
the Administrator.)</P>

<P>When the installation is completed you should make sure that the
programs and batch files are in your path. If you installed the
Mj&oslash;lner System in e.g.<CODE> C:\BETA</CODE>, the batch files are located in
<CODE>C:\BETA\bin</CODE> and the programs are in
<CODE>C:\BETA\bin\nti_&lt;SDK&gt;</CODE>.  The programs from your
SDK also need to be in your path.</P>

<P> </P>
<P> The setup for the Microsoft tools could look something like:</P>
<P> </P>
<BETA>
set PATH=C:\MSDEV\BIN;%PATH%
set LIB=C:\MSDEV\LIB;
set PATH=C:\BETA\BIN;C:\BETA\BIN\NTI_MS;%PATH%
</BETA>
<P> </P>
<P> The setup for the Gnu tools could look something like:</P>
<P> </P>
<BETA>
set PATH=%GNU%\BIN;%PATH%
set PATH=C:\BETA\BIN;C:\BETA\BIN\NTI_GNU;%PATH%
</BETA>

<P>If you are upgrading from a previous version of the GNU SDK
for Windows then you may need to remove the following obsolete
environment variables from your environment;</P>

<BETA>
GCC_EXEC_PREFIX
C_INCLUDE_PATH
LIBRARY_PATH
</BETA>

<P>You can make Windows NT/2000 set the environment variables
automatically each time you log in via the dialog found under
My Computer -&gt; Control Panel -&gt; System -&gt; Environment.</P>

<P> You can make Windows 95/98/ME set the environment variables
automatically each time you log in by setting them in the file
c:\autoexec.bat.</P>

<P> If you install the Mj&oslash;lner System for more than one SDK,
you can use the same location for all installations, as most of the
files are shared.</P>

<H2>Installing an SDK</H2>
<P>  To use the Mj&oslash;lner System you must also install one of the
following:</P>

<UL>
<LI>Microsoft Win32SDK including: a linker: <CODE>LINK.EXE</CODE>, a make program:
<CODE>NMAKE.EXE</CODE> (optional) and C libraries. These can be obtained through
e.g. Microsoft Visual C++ v4.0 or later. <CODE>NMAKE.EXE</CODE> is only needed if
the MAKE property is used, which is not recommended.
<P></P>
<LI>GNU Win32SDK including: a linker: <CODE>LD.EXE</CODE> and <CODE>GCC.EXE</CODE>, a make
program: <CODE>GMAKE.EXE</CODE> (optional) and C libraries. <CODE>GMAKE.EXE</CODE> is only
needed if the MAKE property is used, which is not recommended.
</UL>
<P> </P>

<H3> Installing the Microsoft Win32SDK</H3>
<P> You will need to install the Microsoft SDK including all library
files. Also, make sure that you have the LINK.EXE program in your
path. This program may not be installed automatically - if this is the
case simply locate it on your CD-ROM and copy it to a directory in
your path. </P> 

<H3> Installing the Gnu Win32SDK</H3>
<P> You will find the GNU sdk on the CD in <a href="../../utils/windows/GNU/"><CODE>utils/windows/GNU</CODE></a> or at

<BLOCKQUOTE>
<A HREF="ftp://ftp.mjolner.com/mjolner-system/r5.2/utils/GNU/">
<CODE>ftp://ftp.mjolner.com/mjolner-system/r5.2/utils/GNU/</CODE>
</A>
</BLOCKQUOTE>

<P> </P>
<P> Execute the package <CODE>gcc-2.95.2-qf-runtime-2000-03-27.exe</CODE>.  The recommended
place to install it is in <CODE>c:\gcc-2.95.2</CODE> or in a similar
directory on a different drive.</P>

<H2>Notes</H2>
<UL>
<LI>You must NOT install the Mj&oslash;lner System in a directory
containing spaces in the path.  
<LI>Unfortunately, due to a last minute bug in the installer, you
cannot call the Program Group a different name from 'Mjølner System'.
<LI>If you are installing on Windows NT you must have Administrator
privileges. Otherwise no program group will be created.

<LI>The file <INX><CODE>DelsLog.1</CODE></INX> located in BETALIB is a file used
by the uninstall mechanism. It should not be deleted. 
</UL>

<H2>Windows Specific Issues</H2>

<H3>Using <INX>Windows Resource Files</INX></H3>
<P> You may use Windows resource files in your BETA programs. You do
this by specifying a <INX>RESOURCE property</INX>,
e.g.</P> 

<BETA>
ORIGIN '~beta/basiclib/betaenv';
RESOURCE nti 'foo.res';
-- PROGRAM:descriptor--
(# do ...
#)
</BETA>

<P> This specifies, that when linking, the <CODE>foo.res</CODE> precompiled
resource file should be included. You may also specify inclusion of a
non-compiled resource file (<CODE>foo.rc</CODE>). This will make the compiler
generate appropriate calls of the resource compiler for the SDK
used. If you are using Microsoft SDK, this requires, that you have the
<INX><CODE>RC.EXE</CODE></INX> tool installed, and that it can be
found in your path. </P>

<H3>Calling External Functions</H3>
<P> As shown in, e.g. <A
HREF="../bibliography/index.html#mia94-24">[MIA 94-24]</A>, functions
and procedures produced by the C compilers can be called from within
BETA. Normally you will just prefix your pattern with <INX>external</INX> to achieve this. On Windows there are,
however, two different ways to call C:</P>

<OL>
<LI>If the C function is declared as
<INX><CODE>__stdcall</CODE></INX>,
 you must specify <INX><CODE>callStd</CODE></INX>
in the do-part of the BETA external declaration,
e.g. 
<UL>
<LI> In C: 
<BETA>
int __stdcall foo1();
</BETA>
<LI> In BETA:
<BETA>
foo1: external
  (# result: @integer;
  do callStd;
  exit result
  #);
</BETA>
</UL>
Notice, that many C header files has defined <INX><CODE>WINAPI</CODE></INX>
as an alias for <CODE>__stdcall</CODE>. 
<LI>Otherwise you can specify <INX><CODE>callC</CODE></INX> 
in the do-part. This is default, so leaving out
the do-part is equivalent. 
</OL>

<H3><INX>Linking without Console</INX></H3>
<P> By default the programs are linked in such a way that they always
include a console. To avoid this you can use 'switch 71' on the
compiler, e.g., run 
</P>

<BETA>
beta -s 71 foo.bet
</BETA>

<P>
to link <CODE>foo.exe</CODE>
without a console.
</P> 


<H2>Additional Information for the Windows Implementation</H2>

<H3>Limitations for the Windows Implementation</H3>

<P>
See the BETA FAQ: 
<A HREF="http://www.daimi.au.dk/~beta/doc/faq/beta-language-faq.html#SectionVI">
<CODE>http://www.daimi.au.dk/~beta/doc/faq/beta-language-faq.html#SectionVI</CODE>
</A>
</P>


