ORIGIN '~beta/guienv/guienvsystemenv';
INCLUDE '~beta/qBetaSystem/VM/betaVM';
INCLUDE '~beta/qBetaSystem/compiler_IF/directoryComponents';
---program:descriptor---
SystemEnv
(# VM: @ betaVM
     (# putCh:: (# do ch -> put #);  
        done::
          (#
          do stop
          #)
     #);
   setWindowEnv:: (# do myWindowEnv[] -> theWindowEnv[]#);
   myWIndowEnv: @ guienv;  
   D: @DirectoryModules;
   F: @File
     (# NoSuchFileError:: (# do true -> continue; (*false -> ok*) #)
     #);
   srcExt,altSrcExt: ^Text;
   FN: ^Text;
   FBC: ^Binfile;
   BC: @ByteImage;
   imageSize: @integer
     
do 'Hello world' -> putline;
   (if noOfArguments <= 1 then
       '**** missing argument'->putline
    else
       noOfArguments -> arguments -> FN[];
       FN[] -> putline;
   if);
   
   ('/qBetaSystem/qbeta/BETAworld/','.qbeta' -> srcExt[],'.xbeta' -> altSrcExt[]) 
         -> D.initDirectoryModules;
   FN[] -> D.fixExtension_xbeta -> FN[] -> putline;
   (FN[],'..bc') -> mkAuxName -> FN[] -> putline;
   &binFile[] -> FBC[];
   FN[] -> FBC.name;
   FBC.openRead;
   (if false then
       FBC.getByte -> put;
       FBC.getByte -> put;
       FBC.getByte -> put;
       FBC.getByte -> put;
       newline;
    else
       read:
         (if not FBC.eos then
             FBC.getByte -> BC.put;
             imageSize + 1 -> imageSize;
             restart read
   if)if);
   'imageSize: ' -> puttext; imageSize -> putint; newline;
   (0,true) -> VM.init;
   (@@BC.B[1],imageSize,true) -> init_interpreter;
   true -> run_interpreter;
   true -> getEvent;
   (*stop*)
#)
