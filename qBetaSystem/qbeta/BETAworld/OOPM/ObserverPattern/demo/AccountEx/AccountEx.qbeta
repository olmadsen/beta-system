AccountEx: obj
   class AccountSubject(whichAccount: ref Account): Subject
      subscribe::
         obs.print
         " subscribes to ".print	 
         print
         newline	 
      issueWithTransactions:
         "issue with account: ".print
         print
      print::
         whichAccount.owner.print
         "-account ".print	 

   class Account(owner: ref Customer, OK: var Boolean):
      transactions: obj Set(Transaction)
      checkTransactions:
         sameAmountSameDay -> b: var Boolean:
            scan:  
               transactionsOfToday.scan
                  amount: var float  
                  b := current.whichAmount = amount	
                  if (current.what = "deposit") :then
                     amount := current.whichAmount
                     transactionsOfToday.scan
                        if (current.what = "transferTo") :then
                           if (current.whichAmount = amount) :then
                              b := true
                              leave(scan)
            b := OK.not			   
         if (sameAmountSameDay) :then   
            asSubject.notifyObservers
      asSubject: obj AccountSubject(this(Account))
      
   class Customer(name: var String):
      asObserver: obj Observer
         class ObservedSubject:: AccountSubject         	 
         notify::
            print
            " notified: " .print          
            theSubject.issueWithTransactions
            newline	    
         print::
            this(Customer).print
      print:
         name.print

   alarm: obj Observer
      class ObservedSubject:: AccountSubject
      notify::
         print
         " notified: ".print
         theSubject.issueWithTransactions
         newline	 
         -- typen til theSubject er AccountSubject
      print::
         "Alarm ".print
      setUp:
         accounts.scan
            current.asSubject.subscribe(alarm)
   transActionsOfToday: obj Set(#Transaction)
   accounts: obj OrderedList(#Account)
      transaction:
         ...
   transaction:
      %globals
      what: var String
      whichAmount: var float
      amount: var float
      B: var boolean
      B := whichAmount = amount
      ...
   accounts.insert(Account(Customer("John Smith"),true))
   accounts.insert(Account(Customer("Liza Jones"),false))
   accounts.insert(Account(Customer("Tommy Jones"),true))
   accounts.insert(Account(Customer("Barbara Nelson"),false))
   alarm.setUp
   accounts.scan
      --current.asSubject.subscribe(alarm)
      current.asSubject.subscribe(current.owner.asObserver)
   newline
   accounts.scan
      current.checkTransactions