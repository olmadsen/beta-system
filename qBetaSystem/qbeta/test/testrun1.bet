ORIGIN '~beta/basiclib/betaenv';
INCLUDE 'testlib'
--- program:descriptor ---
Tester
(# (*sys: @ SysEnv;*)
   arg: ^Text; resetLog: @boolean;
   WS,testDir,S: ^text;   
   log: ^text
do 'qBeta test run: ' -> puttext;
   (if false then
       (if noOfArguments > 1 then
           2 -> arguments -> arg[];
           (if '-r' -> arg.equalNCS then
               true -> resetLog;
               'Log file is reset' -> puttext
           if)
        else
           'test against A_mastertrace.txt: ' -> puttext           
   if)if);
   newline;
   'pwd' -> system;
   (* The  path '/home/olm/...' has been working fine for many years,
    * but starting nov 2022, it failed for chdir - dont know why?
    * 
    * '/home/olm/beta/r5.5/MiniSystem/qbeta/BETAworld/workspace/' -> WS[];
    * By changing to 'C:/beta/...' it works again!?
    *)
   (*'C:/beta/r5.5/MiniSystem/qbeta/BETAworld/workspace/' -> WS[];*)

   'C:/beta/r5.5/MiniSystem/qbeta/test/' -> testDir[];
   'Compiler_test'-> (testDir.copy).append -> S[];
   '> C_list &' -> S.append;
   (* the idea ws to run S in the background but it does not work
    * so we does this manually 
    * S[]->putline;
    * S -> system;
    *)
   (if resetLog then
       'A_mastertrace.txt' -> (testDir.copy).append -> log[]
    else
       'A_trace.txt' -> (testDir.copy).append -> log[]
   if);
   ('C:/beta/r5.5/MiniSystem/qbeta/BETAworld/workspace/',log[]) -> sys.init;
   sys.WS -> chdir;
   ('TST','',true,true,false)-> sys.run;
   ('ValueEx','',true,true,false)-> sys.run;
   ('MiniVal','',true,true,false) -> sys.run;
   ('RemoteSuperVC','',true,true,false) -> sys.run;
   ('Bank','demo/',true,true,false) -> sys.run;
   ('ComplexEx','demo/',true,true,false) -> sys.run;
   ('BinTreeMerge','demo/',true,true,false) -> sys.run;
   ('CoArg','demo/',true,true,false) -> sys.run;
   ('CollectionEx','demo/',true,true,false) -> sys.run;
   ('Static','demo/',true,true,false) -> sys.run;
   ('ArrayExperiment','demo/ArrayDemos/',true,true,false) -> sys.run;
   ('EMC2arrayEx','demo/ArrayDemos/',true,true,false) -> sys.run;
   'Done:testrun1'->putline;
   (if not resetLog then
       'diff -a A_mastertrace.txt A_trace.txt' -> putline;
       'diff -a A_mastertrace.txt A_trace.txt' -> System
   if);
#)

   
