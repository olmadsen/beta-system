Uref: @
  (# uClass: (# [unique] a,b: @integer do inner #);
     testUnique:
       (# R1, R2: ^uClass;
          testNested:
            (# 
            do 100 -> R1.a;
               300  -> R1.b;
               R1[] -> R2[];
               (if (R2.a + R2.b) = 400 then 'd' -> put else '?' -> put if);
               (if R1[] = none then 'e'->put else '?'->put if);
            #);               
       do &uClass[] -> R1[];
          12 -> R1.a;
          13 -> R1.b;
          R1[] -> R2[];
          (if (R2.a + R2.b) = 25 then 'a'->put else '?' -> put if);
          (if R1[] = none then 'b' -> put else '?' -> put if);
          (* as of now R2[]= implies none -> R2[]
           * requires expansion of 'L'
           * and rethink 
           *    foo: (# ... exit R2[] #)
           * which then always impkies none
           *    foo = bar
           *    for -> R1[]
           * 
           * (if R2[] = none then '!'->put if);
           *)
          3 -> R2.a; 5 -> R2.b;
          R2[] -> R1[];
          (if (R1.a + R1.b) = 8 then 'c'->put else '?' -> put if);
          testNested
       #);
  do testUnique;
     'e' -> last
  #);
