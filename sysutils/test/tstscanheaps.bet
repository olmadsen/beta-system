ORIGIN '../scanobjects';
INCLUDE '../objinterface';
--PROGRAM: descriptor--
(# pre: (# r: @real #);
   foo: pre(# i: @Integer; #);
   aFoo: ^foo;
   sioa: @scanIOA
     (# 
        callback::<
          (# 
          do (* %GetLongAt(@@obj)->putInt; newLine; *)
             obj[]->getPatternName->putLine;
          #)
     do 'Searcing IOA:'->putLine;
     #);
   
   saoa: @scanAOA
     (# 
        callback::<
          (# 
          do (* %GetLongAt(@@obj)->putInt; newLine; *)
             obj[]->getPatternName->putLine;
          #)
     do 'Searcing AOA:'->putLine;
     #);

do &foo[]->aFoo[];
   
   sioa;
   saoa;
   'Setting root so that only "foo" is found'->putLine;
   foo## -> sioa.root##;
   foo## -> saoa.root##;
   
   sioa;
   saoa;
   'doGC'->putLine; doGC;
   sioa;
   saoa;
   
   '128 x doGC'->putLine;
   (for i: 128 repeat 
        doGC;
   for);
   sioa;
   saoa;
   
   'Setting root to pre.'->putLine;
   pre## -> sioa.root##;
   pre## -> saoa.root##;

   sioa;
   saoa;

#)
