ORIGIN '../time';
INCLUDE '~beta/basiclib/private/betaenv_clrbody';
INCLUDE '~beta/dotnetlib/beta_helpers';
INCLUDE '~beta/dotnetlib/System/DateTime';
INCLUDE '~beta/dotnetlib/System/Globalization/DateTimeFormatInfo';

-- systemTimeDoPart: dopart --
do 'time_clrbody: systemTimeDoPart'  -> NYI;
   
-- cpuTimeDoPart: dopart --
do 'time_clrbody: cpuTimeDoPart'  -> NYI;

-- formatTimeDoPart: dopart--
do (* FIXME: fails: ((t->BetaHelpers.modtimeToFileTime)->DateTime.FromFileTime->asDateTime).ToString -> readable[];*)
   (if true then
       (# i: @int64;
          dt: ^DateTime;
          s: ^String;
       do t->BetaHelpers.modtimeToFileTime->i;
          i->DateTime.FromFileTime->dt[];
          dt.ToString -> s[];
          s[] -> readable[];
       #)
    else
       (* Attempt to format date. Problems with DateTimeFormatInfo which implements
        * multiple interfaces. This cannot currently be expressed in BETA and
        * the attempt below to use a qualification of just object fails.
        *)
       (# i: @int64;
          dt: ^DateTime;
          s: ^String;
          ii: ^object;
       do t->BetaHelpers.modtimeToFileTime->i;
          i->DateTime.FromFileTime->dt[];
          DateTimeFormatInfo.get_InvariantInfo -> ii[];
          ('ddd MMM dd HH\':\'mm\':\'ss yyyy', ii[]) -> dt.ToString_String_IFormatProvider -> s[];
          s[] -> readable[];
       #)
   if);
   
-- preciseTimeBody: descriptor --
(# 
do 'time_clrbody: preciseTimeBody'  -> NYI;
#)
