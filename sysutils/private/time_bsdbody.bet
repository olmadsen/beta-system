ORIGIN 'time_unixbody';
LIB_ITEM 'sysutilstime';


-- preciseTimeBody: descriptor --
(# stat: @integer;
   timeval: externalRecord
     (# tv_sec: @long(# pos::< (# do 0->value #) #);
        tv_usec: @long(# pos::< (# do 4->value #) #);
     #);
   gettimeofday: external
     (# timeval_ptr, timezone_ptr: @Integer;
        status: @Integer;
     enter (timeval_ptr, timezone_ptr)
     exit status
     #);
   tp: @timeval;
do 8->malloc->tp.ptr;
   (if tp.ptr<>0 then
       (tp.ptr,0)->gettimeofday->stat;
       tp.tv_sec -> time; 
       tp.tv_usec -> millitm;
       INNER preciseTime;
       tp.ptr -> free;
   if)
#)
