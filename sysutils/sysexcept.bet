ORIGIN '~beta/basiclib/betaenv';
--LIB: attributes--

(* sysexcept.bet:
 *    Low level support for BETA runtime system exception catching
 *)

(* Basic System Exception Handler Type *)
RuntimeErrorHandler: external
  (# error: @integer (* Error number - see below *);
     SP: @integer (* Stack pointer at error *);
     PC: @integer (* Program conter at error *);
     currentObject: @integer (* Current object at error *);
     skip_dump: @boolean (* Set to true to ignore dumping stack and exiting *);
  enter (error, currentObject[], PC, SP)
  do cExternalEntry;
     INNER;
  exit skip_dump
  #);

(* Call InstallSystemExceptionHandler once to get a RuntimeErrorHandler
 * called for System Exceptions.
 *)
InstallSystemExceptionHandler: External
  (# handler: ##RuntimeErrorHandler;
  enter handler##
  #);

(* BETA System Exception error codes. *)
RefNoneErr:        (# exit -1 #) (* Reference is none *);
CompTerminatedErr: (# exit -2 #) (* Executing terminated component *);
RepRangeErr:       (# exit -3 #) (* Repetition index out of range *);
ArithExceptErr:    (# exit -4 #) (* Arithmetic exception *);
RepSubRangeErr:    (# exit -5 #) (* Repetition subrange out of range *);
RepLowRangeErr:    (# exit -6 #) (* Repetition subrange out of range (low) *);
RepHighRangeErr:   (# exit -7 #) (* Repetition subrange out of range (high) *);
StopCalledErr:     (# exit -8 #) (* Stop is called *);
LVRAfullErr:       (# exit -9 #) (* LVRA is full *);
ZeroDivErr:        (# exit -10 #) (* Integer division by zero *);
CBFAfullErr:       (# exit -11 #) (* Call back function area (CBFA) is full (obsolete) *);
PascalCallBackErr: (# exit -12 #) (* Call back Pascal function has wrong return size *);
CompCallBackErr:   (# exit -13 #) (* Suspending component involving call backs *);
LeaveBasicCompErr: (# exit -14 #) (* Illegal leave/restart *);
QuaErr:            (# exit -15 #) (* Qualification error in reference assignment *);
QuaOrigErr:        (# exit -16 #) (* Qualification error in reference assignment; origins differ *);
RecursiveAttErr:   (# exit -17 #) (* Attempt to attach a component that is already attached *);
IOAFullErr:        (# exit -18 #) (* IOA heap is full *);
FpZeroDivErr:      (# exit -19 #) (* Floating Point division by zero *);
FpExceptErr:       (# exit -20 #) (* Floating Point exception *);
FpStackUflowErr:   (# exit -21 #) (* Floating Point Stack Underflow *);
FpStackOflowErr:   (# exit -22 #) (* Floating Point Stack Overflow *);
InterruptErr:      (# exit -28 #) (* User Interupt *);

EmulatorTrapErr:   (# exit -29 #) (* Breakpoint trap *);
IllegalInstErr:    (# exit -30 #) (* Illegal instruction *);
BusErr:            (# exit -31 #) (* Bus error *);
SegmentationErr:   (# exit -32 #) (* Segmentation fault *);
AOAtoIOAfullErr:   (# exit -33 #) (* AOAtoIOAtable is full *);
AOAtoLVRAfullErr:  (# exit -34 #) (* AOAtoLVRAtable is full *);
CTextPoolErr:      (# exit -35 #) (* Text parameter to C routine too big (max. 1000 bytes) *);
AOAtoIOAallocErr:  (# exit -36 #) (* Failed to allocate AOAtoIOAtable *);
UnorderedFval:     (# exit -37 #) (* Unordered Floating Point Value *);
StackErr:          (# exit -38 #) (* Stack Overflow *);
DumpStackErr:      (# exit -39 #) (* Dump stack and continue *);
InternalErr:       (# exit -98 #) (* Internal Error *);
SignalErr:         (# exit -99 #) (* Unexpected Signal *);
UnknownSigErr:     (# exit -100 #) (* Unknown signal *);
