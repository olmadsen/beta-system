
1) mjolnerprop:

Der er en fejl i mjolnerprop.bet, der bevirker at f|rste indgang
i mjolnerrc ikke l{ses.

Idag ser ~beta/configuration/r3.0/mjolnerrc s}dan ud:

(* -------------------- Definition of machine dependencies
------------------ *)
   The properties machine.xxx: yyy zzz have the following semantics:
   xxx is a machine type symbol.
   yyy is the name of a subdirectory in which code for that machine
type 
       is placed 
   zzz is the default host on which jobfiles for that machine type
are executed.
*)
machine.xxx:     yyy FindesIkke
machine.sun4s:   sun4s clematis
machine.sun4:    sun4 tatra
machine.hpux9pa: hpux9pa angers
machine.hpux9mc: hpux9mc thelma
machine.linux:   linux ceres
machine.hpux8:   hpux8 telena
machine.sgi:     sgi lithium
machine.nti:     nti FindesIkke
machine.b2c:     b2c FindesIkke
machine.sun3os3: sun3 oberon
machine.sun3os4: sun3 saturn
machine.hp:      hp janne
machine.sun3:    sun3 jupiter
machine.apollo:  apollo FindesIkke
machine.mac:     mac FindesIkke
machine.dx200:   dx200 FindesIkke
machine.snake:   snake FindesIkke
(*
---------------------------------------------------------------------
----- *)

betaprof.manfilename: /usr/local/lib/beta/bin/betaprof.man
betaprof.tmpfilename: tmpBETAPROFtmp.tmp
Bem{rk den f|rste dummy property, der er n|dv. pga fejlen i
mjolnerprop.
Hvis man g|r som compileren under scanning af denne, men sl}r trace
til f]r man f|lgende output:

Prop: testing global
Prop: opening mjolnerrc file
Read prop: *
   The properties machine.xxx: yyy zzz have the following semantics:
Read prop: xxx is a machine type symbol.yyy is the name of a
subdirectory in which code for that machine type 
       is placed 
   zzz is the default host on which jobfiles for that machine type
are executed.
*
machine.xxx: yyy FindesIkke
Read prop: machine.sun4s: sun4s clematis
Read prop: machine.sun4: sun4 tatra
Read prop: machine.hpux9pa: hpux9pa angers
Read prop: machine.hpux9mc: hpux9mc thelma
Read prop: machine.linux: linux ceres
Read prop: machine.hpux8: hpux8 telena
Read prop: machine.sgi: sgi lithium
Read prop: machine.nti: nti FindesIkke
Read prop: machine.b2c: b2c FindesIkke
Read prop: machine.sun3os3: sun3 oberon
Read prop: machine.sun3os4: sun3 saturn
Read prop: machine.hp: hp janne
Read prop: machine.sun3: sun3 jupiter
Read prop: machine.apollo: apollo FindesIkke
Read prop: machine.mac: mac FindesIkke
Read prop: machine.dx200: dx200 FindesIkke
Read prop: machine.snake: snake FindesIkke
Read prop: *

betaprof.manfilename: /usr/local/lib/beta/bin/betaprof.man
Read prop: betaprof.tmpfilename: tmpBETAPROFtmp.tmp
Prop: testing global


Bem{rk, at der ikke st}r "Read Prop" ved den f|rste linie.

Programmet jeg har brugt er f|lgende:

ORIGIN '~beta/basiclib/v1.4/betaenv';
include '~beta/sysutils/v1.4.1/mjolnerprop';
--PROGRAM: descriptor--
(# 
   (* dummy stuff *)
   found: @boolean;
   messagestream: ^stream;
   asmlink: @
     (# jobFileMachine: ^text;
     #);
   targetmachine, targetdirectory : @text;
   setJobFileMachine: @boolean;
   
   
   (* scan som i compiler *)
   smp: @ScanMjolnerProps
     (# count: @integer;
     do
        propVal.scanTokens
        (#
        do count+1->count;
           (if true
            //(count=1) then
               token->targetDirectory;
            //((count=2) and setJobFileMachine) then
               token[]->asmlink.jobFileMachine[];
           if);
        #);
        (if true//found then
            'Multiple defined property,
machine.'->messagestream.puttext;
            TargetMachine[]-> messagestream.putline;
            (failure,'')->STOP;
        if);
        true->found;
     #);

do 'sun4s' -> TargetMachine;
   screen[] -> messagestream[];
   true -> smp.trace;
   (GlobalOnly,'machine',TargetMachine)->smp;
   (if false//found then
       'Unknown target machine type: '->messagestream.puttext;
       TargetMachine[]-> messagestream.putline;
       (failure,'')->STOP;
   if);
#)

/Peter
PS. Jeg ved ikke hvem der er ansvarlig for dette kode.
PPS koden i mjolnerprop kunne tr{nge til en gevaldig modernisering!

-------------------------------------------------------------------------

2) Use of environment variables on NT gives a lot of problems 
(Out of environment space). Use the registry instead.
Should probably be done in envstring_ntibody.bet

