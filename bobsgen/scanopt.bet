ORIGIN '~beta/newmps/metagrammarcfl';
--- AGrammarAttributes: attributes ---
ScanOptionSpecification:
  (# optSpec: ^optionSpecification;
     current: ^singleOption;
     currentText: ^text
  enter optSpec[]
  do (# optSpecLst: ^optionSpecLst;
        optSpecList: ^optionSpecList;
        setText: @
          (# n: ^nameAppl;
             c: ^const;
             s: ^string
          do (if current.symbol
              // optionName then
                 ((current[] -> QUA(# AS::optionName #)).getNameAppl
                   -> QUA(# AS::nameAppl #)).gettext -> currentText[];
              // optionConst then
                 ((current[] -> QUA(# AS::optionConst #)).getConst
                   -> QUA(# AS::const #)).gettext -> currentText[];

              // optionString then
                 ((current[] -> QUA(# AS::optionString #)).getString
                   -> QUA(# AS::string #)).gettext -> currentText[];
             if)
          #);
     do (if optSpec.symbol = optionSpecLst then
            (optSpec[] -> optSpecLst[]).getOptionSpecList -> optSpecList[];
            optSpecList.scan
            (#
            do current[] 
                 -> this(ScanOptionSpecification).current[];
               Settext;
               INNER ScanOptionSpecification
            #);
         else
            optSpec[] -> current[];
            SetText;
            INNER ScanOptionSpecification
        if);
     #);
  #)
     
  
