ORIGIN '../clientwindows';
-- openClientOpen: DoPart --
do
   (550,213)->size;
   private.host_label.open;
   private.host_field.open;
   private.fullPath_label.open;
   private.fullPath_field.open;
   'masterbrew'->private.host_field.contents;
   'z:/current GCSS version/persistent/testSharedPS.ps'
     ->private.fullpath_field.contents;
   'test'->private.fullpath_field.contents;
   private.ok_btn.open;
   private.host_field[]->target;
   private.ok_btn[]->defaultButton;
   INNER  

-- openClientPrivate: Descriptor --
(#
   host_label: @staticText
     (#
        open::< 
          (# 
          do
             'The host machine of the persistent store:'->label;
             (238,16)->size;
             (32,55)->position;
             
          #)
     #);
   host_field: @editText
     (# open::<  (#  do (168,30)->size; (346,48)->position;  #) #);
   fullPath_label: @staticText
     (#
        open::< 
          (# 
          do
             'The full path of the persistent store (on the host):'->label;
             (279,16)->size;
             (32,98)->position;
             
          #)
     #);
   fullPath_field: @editText
     (# open::<  (#  do (169,30)->size; (346,91)->position;  #) #);
   ok_btn: @pushButton
     (#
        open::<  (#  do 'OK'->label; (60,20)->size; (35,168)->position;  #);
        eventHandler::<  (# onMouseUp::<  (#  do onOK #) #)
     #)
#)  

-- openClientClearView: DoPart --
do (private.host_field.contents).clear; (private.fullPath_field.contents).clear  

-- openClientGetView: DoPart --
do
     (# tmp: ^text
     do
        private.host_field.contents->tmp[];
        tmp->host;
        private.fullPath_field.contents->tmp[];
        tmp->fullPath
     #)  

-- openClientSetView: DoPart --
do
   host[]->private.host_field.contents;
   fullpath[]->private.fullpath_field.contents  

-- transactionLoopOpen: DoPart --
do
   (548,419)->size;
   'Client'->title;
   private.getLock_btn.open;
   private.releaseLock_btn.open;
   private.endSession_btn.open;
   private.read_radiobtn.open;
   private.write_radiobtn.open;
   private.exclusive_radiobtn.open;
   private.shared_radiobtn.open;
   private.readOrWrite_label.open;
   private.sharedOrExclusive_label.open;
   private.info_label.open;
   private.status_label.open;
   private.notifications_field.open;
   private.notifications_label.open;
   INNER  

-- transactionLoopPrivate: Descriptor --
(#
   getLock_btn: @pushButton
     (#
        open::< 
          (#  do 'Get lock'->label; (60,20)->size; (20,214)->position;  #);
        eventHandler::<  (# onMouseUp::<  (#  do onGetLock #) #)
     #);
   releaseLock_btn: @pushButton
     (#
        open::< 
          (# 
          do 'Release Lock'->label; (90,20)->size; (110,214)->position; 
          #);
        eventHandler::<  (# onMouseUp::<  (#  do onReleaseLock #) #)
     #);
   endSession_btn: @pushButton
     (#
        open::< 
          (# 
          do 'End session'->label; (78,20)->size; (437,213)->position; 
          #);
        eventHandler::<  (# onMouseUp::<  (#  do onEndSession #) #)
     #);
   ;
   readOrWrite_label: @staticText
     (#
        open::< 
          (# 
          do
             (343,16)->size;
             (21,17)->position;
             'Would you like to read from or write to the persistent store?'
               ->label
          #)
     #);
   sharedOrExclusive_label: @staticText
     (#
        open::< 
          (# 
          do
             'Do you want shared (MRWS - Multiple Readers Single Writer) or exclusive access?'
               ->label;
             (491,16)->size;
             (21,117)->position;
             
          #)
     #);
   read_radiobtn: @radioButton
     (#
        calledByProgrammer:
        (* Used when the programmer sets the state of the 
         radiobutton. Then nothing should be done to the other radiobuttons *)
          @boolean;
        open::< 
          (#  do 'Read'->label; (100,20)->size; (21,49)->position;  #);
        eventHandler::< 
          (#
             onStateChanged::< 
               (# 
               do
                  (if not calledByProgrammer then
                      (if state = true then
                          true->write_radiobtn.calledByProgrammer;
                          false->write_radiobtn.state;
                          false->write_radiobtn.calledByProgrammer
                       else
                          true->calledByProgrammer;
                          true->state;
                          false->calledByProgrammer
                      if)
                  if)
               #)
          #)
     #);
   write_radiobtn: @radioButton
     (#
        calledByProgrammer:
        (* Used when the programmer sets the state of the 
         radiobutton. Then nothing should be done to the other radiobuttons *)
          @boolean;
        open::< 
          (#  do 'Write'->label; (100,20)->size; (21,74)->position;  #);
        eventHandler::< 
          (#
             onStateChanged::< 
               (# 
               do
                  (if not calledByProgrammer then
                      (if state = true then
                          true->read_radiobtn.calledByProgrammer;
                          false->read_radiobtn.state;
                          false->read_radiobtn.calledByProgrammer
                       else
                          true->calledByProgrammer;
                          true->state;
                          false->calledByProgrammer
                      if)
                  if)
               #)
          #)
     #);
   exclusive_radiobtn: @radioButton
     (#
        calledByProgrammer:
        (* Used when the programmer sets the state of the 
         radiobutton. Then nothing should be done to the other radiobuttons *)
          @boolean;
        open::< 
          (# 
          do 'Exclusive'->label; (100,20)->size; (21,173)->position; 
          #);
        eventHandler::< 
          (#
             onStateChanged::< 
               (# 
               do
                  (if not calledByProgrammer then
                      (if state = true then
                          true->shared_radiobtn.calledByProgrammer;
                          false->shared_radiobtn.state;
                          false->shared_radiobtn.calledByProgrammer
                       else
                          true->calledByProgrammer;
                          true->state;
                          false->calledByProgrammer
                      if)
                  if)
               #)
          #)
     #);
   shared_radiobtn: @radioButton
     (#
        calledByProgrammer:
        (* Used when the programmer sets the state of the 
         radiobutton. Then nothing should be done to the other radiobuttons *)
          @boolean;
        open::< 
          (#  do 'Shared'->label; (100,20)->size; (21,147)->position;  #);
        eventHandler::< 
          (#
             onStateChanged::< 
               (# 
               do
                  (if not calledByProgrammer then
                      (if state = true then
                          true->exclusive_radiobtn.calledByProgrammer;
                          false->exclusive_radiobtn.state;
                          false->exclusive_radiobtn.calledByProgrammer
                       else
                          true->calledByProgrammer;
                          true->state;
                          false->calledByProgrammer
                      if)
                  if)
               #)
          #)
     #);
   ;
   info_label: @staticText
     (#
        open::< 
          (#  do 'Info:'->label; (24,16)->size; (14,386)->position;  #)
     #);
   status_label: @staticText
     (# open::<  (#  do ''->label; (475,16)->size; (46,386)->position;  #)
     #);
   ;
   notifications_field: @textField
     (#
        open::< 
          (# 
          do
             4->border.style;
             true->border.visible;
             (504,107)->size;
             (19,270)->position;
             
          #)
     #);
   notifications_label: @staticText
     (#
        open::< 
          (# 
          do 'Notifications:'->label; (76,16)->size; (20,252)->position; 
          #)
     #)
#)  

-- transactionLoopClearView: DoPart --
do
   true->private.read_radiobtn.calledByProgrammer;
   true->private.read_radiobtn.state;
   false->private.read_radiobtn.calledByProgrammer;
   ;
   true->private.write_radiobtn.calledByProgrammer;
   false->private.write_radiobtn.state;
   false->private.write_radiobtn.calledByProgrammer;
   ;
   true->private.exclusive_radiobtn.calledByProgrammer;
   false->private.exclusive_radiobtn.state;
   false->private.exclusive_radiobtn.calledByProgrammer;
   ;
   true->private.shared_radiobtn.calledByProgrammer;
   true->private.shared_radiobtn.state;
   false->private.shared_radiobtn.calledByProgrammer;
   ;
   &styledtext[]->private.notifications_field.contents;
   &styledtext[]->private.status_label.label  

-- transactionLoopGetView: DoPart --
do
     (# tmp: ^text
     do
        private.read_radiobtn.state->read;
        private.write_radiobtn.state->write;
        private.exclusive_radiobtn.state->exclusive;
        private.shared_radiobtn.state->shared;
        private.notifications_field.contents->tmp[];
        tmp->notifications;
        private.status_label.label->tmp[];
        tmp->status
     #)  

-- transactionLoopSetView: DoPart --
do
     (#
        toStyledText:
          (# t: ^text; st: ^styledText; 
          enter t[]
          do &styledText[]->st[]; t->st; 
          exit st[]
          #)
     do
        true->private.read_radiobtn.calledByProgrammer;
        read->private.read_radiobtn.state;
        false->private.read_radiobtn.calledByProgrammer;
        ;
        true->private.write_radiobtn.calledByProgrammer;
        (if read = true then
            false->private.write_radiobtn.state
         else
            true->private.write_radiobtn.state
        if);
        false->private.write_radiobtn.calledByProgrammer;
        ;
        true->private.exclusive_radiobtn.calledByProgrammer;
        exclusive->private.exclusive_radiobtn.state;
        false->private.exclusive_radiobtn.calledByProgrammer;
        ;
        true->private.shared_radiobtn.calledByProgrammer;
        (if exclusive = true then
            false->private.shared_radiobtn.state
         else
            true->private.shared_radiobtn.state
        if);
        false->private.shared_radiobtn.calledByProgrammer;
        ;
        notifications[]->tostyledtext->private.notifications_field.contents;
        status[]->tostyledtext->private.status_label.label
     #)  

-- transactionLoopSetViewNotifications: DoPart --
do
     (#
        toStyledText:
          (# t: ^text; st: ^styledText; 
          enter t[]
          do &styledText[]->st[]; t->st; 
          exit st[]
          #)
     do notifications[]->tostyledtext->private.notifications_field.contents
     #)  

-- transactionLoopSetViewStatus: DoPart --
do
     (#
        toStyledText:
          (# t: ^text; st: ^styledText; 
          enter t[]
          do &styledText[]->st[]; t->st; 
          exit st[]
          #)
     do status[]->tostyledtext->private.status_label.label
     #)  

-- lockStatusWindowClassprivate: Descriptor --
(#
   customerDatabase_label: @staticText
     (#
        open::< 
          (# 
          do 'Customer Database:'->label; (123,16)->size; (14,25)->position; 
          #)
     #);
   customerReadLock_checkbox: @checkBox
     (#
        open::< 
          (# 
          do
             'Readlock'->label;
             false->state;
             (81,18)->size;
             (141,24)->position;
             
          #)
     #);
   customerWriteLock_checkbox: @checkBox
     (#
        open::< 
          (# 
          do
             'Writelock'->label;
             false->state;
             (78,18)->size;
             (141,48)->position;
             
          #)
     #);
   customerGetReadLock_btn: @pushButton
     (#
        open::< 
          (# 
          do 'Get readlock'->label; (89,22)->size; (229,22)->position; 
          #);
        eventHandler::<  (# onMouseUp::<  (#  #) #)
     #);
   customerGetWriteLock_btn: @pushButton
     (#
        open::< 
          (# 
          do 'Get writelock'->label; (89,22)->size; (338,22)->position; 
          #);
        eventHandler::<  (# onMouseUp::<  (#  #) #)
     #);
   customerReleaseLock_btn: @pushButton
     (#
        open::< 
          (# 
          do 'Release lock'->label; (89,22)->size; (447,22)->position; 
          #);
        eventHandler::<  (# onMouseUp::<  (#  #) #)
     #)
#)  

-- lockStatusWindowClassOpen: DoPart --
do
   (562,133)->size;
   private.customerDatabase_label.open;
   private.customerReadLock_checkbox.open;
   private.customerWriteLock_checkbox.open;
   private.customerGetReadLock_btn.open;
   private.customerGetWriteLock_btn.open;
   private.customerReleaseLock_btn.open;
   private.customerGetReadLock_btn.disable;
   private.customerGetWriteLock_btn.disable;
   private.customerReleaseLock_btn.disable;
   INNER  

-- lockStatusCustomerReadLockEnter: DoPart --
do state->private.customerReadLock_checkbox.state  

-- lockStatusCustomerReadLockExit: DoPart --
do private.customerReadLock_checkbox.state->state  

-- lockStatusCustomerWriteLockEnter: DoPart --
do state->private.customerWriteLock_checkbox.state  

-- lockStatusCustomerWriteLockExit: DoPart --
do private.customerWriteLock_checkbox.state->state  

-- lockStatusClearView: DoPart --
do
   false->private.customerReadLock_checkbox.state;
   false->private.customerWriteLock_checkbox.state  

