ORIGIN '~beta/basiclib/systemenv';
INCLUDE '~beta/persistentstore/virtualobjectstore';
INCLUDE 'systemenvdemolib';

--PROGRAM: descriptor--
systemenv
(# PS: @persistentstore
     (# rebindSpecialReference::
          (# toSpecialObject::
               (# 
               do
                  (if objectTag = systemEnvTag then
                      this(systemEnv)[] -> target[];
                  if)
               #)
          #)
     #);
   myr: ^myRecord;
do PS.init;
   'sysenvStore' -> PS.create (# exists::< (# do true -> continue #)#);
   'created' -> putLine;
   
   (this(systemEnv)[], systemEnvTag) -> PS.registerSpecialInstance;
   
   &myRecord[]->myr[];
   'Holger Olger'->myr;
   (myr[], 'myr')->PS.put;
   
   PS.close;   
#)
