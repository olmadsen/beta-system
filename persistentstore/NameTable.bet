ORIGIN '~beta/basiclib/v1.4/betaenv';

(* 
 * COPYRIGHT
 *       Copyright Mjolner Informatics, 1992-94
 *       All rights reserved.
 *)


BODY 'private/NameTableBody';

(* This fragment is generated automatically from
 * the ECOOL spec in NameTable.ecool. For ease
 * of use a few (for persistence matters) 
 * insignificant changes have been made after the
 * automatic generation.
 * 
 * Hashfunction used: (Only 7 last chars considered significant.) 
 *    
 *   hashFunction: 
 *     (# t: ^Text; inx, value: @Integer;
 *     enter t[]
 *     do 0 -> value;
 *        loop:
 *          (for i: 7 repeat
 *             t.lgth-i+1 -> inx;
 *             (if inx < 1 // true then leave loop if);
 *             t.T[inx]+value->value;
 *          for)
 *     exit value
 *     #);
 * 
 *)

--- lib: Attributes ---
ECOOLOID: 
  (# a,b: @Integer; 
  enter (a,b)
  exit (a,b)
  #);

NameTableElement:
  (# name: ^Text;
     oid: @ECOOLOID;
     next: ^NameTableElement;
  #);

NameTable:
  (# table: [97]^NameTableElement;
     saveName:
       (# new: ^NameTableElement;
       enter new[]
       do <<SLOT saveName:descriptor>>
       #);
     findName:
       (# name: ^Text; found: ^NameTableElement;
       enter name[]
       do <<SLOT findName:descriptor>>
       exit found[]
       #);
     scan:
       (# current: ^NameTableElement;
       do <<SLOT NameTableScan:descriptor>>
       #);
  #);

