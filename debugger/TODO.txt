
Er det muligt at faa et callback naar en menu poppes ned?



Det er efterhaanden MEGET VIGTIGT at faa rettet et antal fejl i guienv,
hvis debuggeren skal vaere nogenlunde klar 1. februar.
PRIORITERING PLEASE!!!

Jeg mangler:

  1. Keyboard acceleratorer er meget ustabile. I mange tilfaelde hjaelper 
     det hvis man lige popper den relaterede menu op, og derefter popper 
     den ned igen.
      
  2. Popup menuer:
         a. For menuItems i popup menuer kaldes eventhandler.onStatus
            ikke. Som en konsekvens kan saadanne menuItems ikke disables.
         b. menu.eventhandler.onSelect kaldes ikke i en menu der poppes op som
            submenu.
         c. Ved popup er det defaulte menuitem ikke valgt. Musen staar ganske
            vist over default item, men det er ikke selekteret.

  3. En BringBack paa window items.

  4. Naar textScrollList.mouseDown kaldes, er selection.first endnu ikke sat.
     Det er altsaa ikke muligt at udfoere noget selektions-specifikt paa
     andet end dobbelt-click. 

  6. henryml: I graphicaleditorbody bruger du nogle "stripes" til at
     lave en "loebende outline". Kan du ikke goere det tilgaengeligt
     saa jeg kan komme til at bruge disse "stripes".

  7. system.wait duer ikke for tider mindre end 60 ticks. tv_usec feltet
     i en timeval er *micro* sekunder, og ikke 1/60 sekund. En wait der
     duer er:

          wait: 
            (# timeVal: data
                 (# tv_sec: @integer;
                    tv_usec: @integer;
                 #);
               select: external
                 (# nfds, readfds, writefds, exceptfds: @integer;
                    timeout: ^timeVal;
                    result: @integer;
                 enter (nfds, readfds, writefds, exceptfds, timeout[])
                 exit result
                 #);
               tv: @timeVal;
               ticks: @Integer;
            enter ticks
            do ticks div 60->tv.tv_sec;
               (ticks mod 60)*(1000000 div 60)->tv.tv_usec;
               (0, 0, 0, 0, tv[]) -> select;
            #);

Noget doer med "reference is NONE" hvis betaObjectObjectDescriptor returnerer
NONE. Der skal i stedet rejses en exception om at man ikke kender typen
af et givet objekt.

  1. betaObject.description skriver nu "UNKNOWN" hvis 
     betaObjectObjectDescriptor fejler.

  2. Et ObjectView skal aendres saa det viser noget low-level
     information hvis et objekts type ikke er kendt. Dette kan fx.
     goeres ved at bede objektet beskrive sig selv via et "scanLowLevelDesc"
     interface. Evt. kan hver low-level linie forbindes med en "onSelect"
     action, saa det kan tillades at dobbelt-clicke ogsaa paa saadanne
     linier og faa mere info. Dette low-level view kan ogsaa bruges som
     "alternativt view" paa et objekt, der angiver addresse, hvor objektet
     "bor" (AOA eller IOA), prototype addresse i low-level termer, navnet
     paa gruppen som prototypen stammer fra, prototype nummer i denne 
     gruppe, T label for prototypen, objektets stoerrelse i bytes, ...

Dialog til indstilling af environment variable.

Visning af shortInt attributter duer tilsyneladende ikke.

Keyboard aekvivalenter paa "Go Back", "Close", ... i objekt viewere.

   shift-control-leftmouse paa header eller icon lukker nu en moveable
   
   dobbelt-click paa "iconify-button" iconiserer.
   enkelt-click/hold nede paa "iconify-button" popper moveable menuen op.
 
   enkelt-click/hold paa objectviews popper itemmenu'en op.

   Maalet er at afskaffe brug af andet end venstre musetast.

   Hvis "DragOnOpen" option'en er TRUE, vises initielt en outline af
   en moveable. ctrl-leftmouse giver mulighed for at placere vieweren.
   leftmouse flytter naermeste hjoerne af vieweren til musen (derved aendres
   stoerrelsen), og yderligere drag vil resize. Naar musen slippes vil
   vieweren aabnes.

"Close Multiple" skal aendres saa viewere selekteret for lukning er fremhaevet.

DisplayBetaStack i outpattern.c skal kalde valhalla funktion der skal afgoere
hvad der skal ske:

  1. Hvis processen allerede debugges skal der kommunikeres med valhalla.
  2. Hvis processen ikke debugges skal brugeren spoerges om valhalla skal
     startes og/eller kontaktes.

Da det ser ud til at vi kan klare os fint med ptrace droppes "/proc" 
fil systemet paa solaris indtil videre.

Check at valhalla kan finde ud af at vise det fejlende imperativ i tilfaelde
af runtime fejl.


   >
   >
   > Er det helt umuligt for Valhalla, at kunne udpege denne reference ?
   > Det ville v{re en utrolig rar facilitet.
   >
   > --- jlk
   >

   Skal spoergsmaalet forstaas saadan at du i generel forstand vil have
   valhalla til at udpege hvilken reference attribut der var NONE?

   I saa fald er svaret nok noget i stil med *naesten*.

   Naar der opstaar en "Reference is NONE" fejl er PC og current object
   de eneste oplysninger valhalla har at arbejde med. Man kunne saa godt
   forestille sig at den scannede det fejlende imperativ for at lokalisere
   "remote"'s paa dynamiske referencer, og derefter checkede vaerdien af
   disse referencer. Hvis een af dem var NONE (der kan jo vaere nogen stykker)
   kunne den jo foreslaas som synderen.

   Men der er jo lige en del tilfaelde at tage hoejde for... De fleste kan
   klares med en fortolkning af expressions, men generelt computed remote er
   nok ikke lige inden for raekkevidde.

   OLE: Kan der siges noget om implementationen af Computed Remote der goer
   at det maaske alligevel er muligt?

   Saa vi kommer nok ikke naermere end en 90% loesning. Det er jo som regel
   ogsaa godt nok.
TODO liste for valhalla. 

1.      Det er forvirrende at 
        - man trykker på debug
        - sætter argumenter i command line, og
        - de ignoreres ved første kørsel

2.      objekt vinduer bør 'fitte to content' med mindre de er meget store

3.      fit-to-content virker ikke hvis en object evaluator er åben

4.      fit-to-content ser ikke ud til at beregne den korrekte bredde
        og højde

5.      Det er ikke helt nemt at finde ud af hvordan man får vist
        char-reps som tekster

6.      Et STEP tager også lokalt på alex urimelig lang tid; faktisk 
        adskillige sekunder. Jeg tror at en analyse af dette problem 
        bør have høj prioritet. Altså i hvilke situationer tager det tid
        og kan der gøres noget ved det. Det er nok i forbindelse med
        programmer der bruger megen library kode.

7.      Det er uhensigtsmæssigt at vinduer altid kommer i øverste venstre 
	hjørne

8.      Man kommmer ikke altid ud af read-onlymode efter debug

9.      Efter editering kan det ske at debuggeren bliver ved med at  
   	sige at der skal recompileres
   
10.     Man kan nogen gange ikke steppe i et tidligere debugget program

11.    	Det kan give problemer hvis man både bruger run og debug, med gamle
        processer

12.     Når man forsøger at benytte valhalla til at lokalisere f.eks.
   	en ref-none fejl, sker det meget ofte stadig det at den ikke kan finde
   	de øverste dele af stakken, men kommer istedet med beskeden:
   	"Could not find do part ....." eller lign.

13.     Man kan ikke steppe ind i doparts i exit patterns.

14.     Lowlevel dump (Instruktioner og registre) og instruktions level step.

15.     Debugging af distr. BETA programmer (fra John Brøndums speciale)

16. 	Forloekkers indexvar vises ikke i objectview.

17.     Debug af koerende process. (Attach)

18.     Breakpoints gemmes ikke mellem debugsessioner.
	  - Der saettes en kommentar naar man lukker debugvinduet, men 
	    Breakpointet blive ikke sat naar man starter debuggeren igen.

19.     Rettelse af simple attributter virker ikke

===== FORBEDRINGER ======
C Bedre keyboard shortcuts.(objectview)
S Bedre support for Evaluators
C Stackbrowser kan forbedres, Eller Valhalla Vinduet erstattes af "Stackbrowser". 

===== ER I GANG ======
- ScanHeap for objekter med bestemt prototype 
- ScanHeap for objekt referenter. 


===== GAMLE WISHES =====
sæt breakpoint i navngivet ptn.
M Stabilitet ved processFejl (Maa ikke crashe hele mjolner, kun Valhalla

===== Er klaret =====
- Det er meget svært at ramme "resize-region" på movables. Bør udvides.
- ;1; forvirrer step (Den stepper over)
- StepOver paa en restart L 
- Beslutning om codeViews. (De skal ikke vaere der)
- StepOver-fejl ved sidste imperativ.
- Man kan aabne flere debuggere.