ORIGIN 'valhallaapplication' (*
 * COPYRIGHT
 *   Copyright Mjolner Informatics, 1995-98
 *   All rights reserved.
 *)
;
INCLUDE '~beta/guienv/guienvsystemenv'
        'processInterface'
        'processCommCodes'
        'breakpoints'
        'UI/GUIprocess'
        'UI/stackview'
        'UI/stackbrowser'
        'UI/objectviewadds'
        'UI/enveditor'
        '~beta/guienv/utils/promptForArgs'
        '~beta/toollibs/utils/options'
        '~beta/toollibs/utils/systemenvcompspawner'
        '~beta/guienv/stddialogs'
        '~beta/guienv/utils/simplemenu'
        '~beta/process/systemcomm'
        '~beta/objectbrowser/UI/evaluatormoveable'
        '~beta/compiler/DYN/dynlib'
        '~beta/compiler/DYN/AstOfObject'
        '~beta/compiler/DYN/treelib'
        '~beta/pretty/astviewer';
LIB_DEF 'valhalla' '../lib';
BODY 'private/valhallabody';
BODY 'private/breakpointMenus';
BODY 'private/dynamic_compilation';
BODY 'private/valhallabodyext';
BODY '~beta/editor/private/compiler'
     '~beta/editor/private/nouser';
-- lib: Attributes --
DEFAULT_SIZE: (#  exit (250,250) #);   

-- program: Descriptor --
(#
   <<SLOT valhallalib:Attributes>>;
   thesystemenv: @|systemenv
     (#
        setWindowEnv:: 
          (# 
          do valhalla[]->theWindowEnv[]
          #);
        valhalla: @valhallaapplication
          (#
             titleText:
               (# 
               exit
               'Valhalla - Source Level Debugger '
               #);
             editMode::  (#  do false->value;  #);
             ymerBrowserWindow::< 
               (#
                  open::<  (#  do THIS(window).hide;  #);
                  isEditor::<  (#  do false->value;  #);
                  initCompiler::  (#  do dc[]->compiler[];  #);
                  
               #);
             init::< 
               (# 
               do
                  true->isStandAloneValhalla->isDebugging;
                  ymerbrowser[]->sources[];
                  main.open;
                  INNER ;
                  main.theMenuBar->main.mainMenuBar[];
                  (*     (if sources[]<>none then
                   &ymerCall
                   (#
                   getFragmentGroup:: 
                   (# 
                   do name[]->mps.fragmentGroupTable.getFragmentGroup->fg[]
                   #);
                   machineType::  (#  do machine_type->t[] #);
                   
                   #)[]->sources.edenv.ymerCallback[];
                   sources.loadSettings;
                   if);
                   *)
                  
               #);
             afterInit::<  (#  #);
             
          do
             true->isStandAloneValhalla;
             true->valhallaPrefs.dynamiccompilation;
             
          #);
        
     do 
     #);
   valhallaPrefs: @valhallaPreferences;
   mjolnerPrefs: @mjolnerPreferences;
   obp: @objectPreferences;
   
do
   &expandWildcardsArgumentHandler[]->argumentHandler[];
   valhallaPrefs.open
     (#  do valhallaprefs.registerVALHALLAoptions;  #);
   valhallaPrefs[]->objectpool.put;
   valhallaPrefs[]->theSystemenv.valhalla.valhallaPrefs[];
   thesystemenv.valhalla.globaloptions.init;
   thesystemenv.valhalla.globaloptions[]->objectpool.put;
   valhallaprefs[]->obp.p[];
   obp[]->objectpool.put;
   thesystemenv;
   
#)  

